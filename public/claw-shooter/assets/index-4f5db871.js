var YH=Object.defineProperty;var ZH=(n,e,t)=>e in n?YH(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ee=(n,e,t)=>(ZH(n,typeof e!="symbol"?e+"":e,t),t),SE=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var N=(n,e,t)=>(SE(n,e,"read from private field"),t?t.call(n):e.get(n)),Be=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},oe=(n,e,t,r)=>(SE(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t);var pg=(n,e,t,r)=>({set _(i){oe(n,e,i,t)},get _(){return N(n,e,r)}}),st=(n,e,t)=>(SE(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function dC(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var UD={exports:{}},g_={},FD={exports:{}},pn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fv=Symbol.for("react.element"),qH=Symbol.for("react.portal"),$H=Symbol.for("react.fragment"),e5=Symbol.for("react.strict_mode"),t5=Symbol.for("react.profiler"),n5=Symbol.for("react.provider"),r5=Symbol.for("react.context"),i5=Symbol.for("react.forward_ref"),s5=Symbol.for("react.suspense"),o5=Symbol.for("react.memo"),a5=Symbol.for("react.lazy"),SP=Symbol.iterator;function l5(n){return n===null||typeof n!="object"?null:(n=SP&&n[SP]||n["@@iterator"],typeof n=="function"?n:null)}var OD={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kD=Object.assign,GD={};function Lm(n,e,t){this.props=n,this.context=e,this.refs=GD,this.updater=t||OD}Lm.prototype.isReactComponent={};Lm.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Lm.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function zD(){}zD.prototype=Lm.prototype;function pC(n,e,t){this.props=n,this.context=e,this.refs=GD,this.updater=t||OD}var mC=pC.prototype=new zD;mC.constructor=pC;kD(mC,Lm.prototype);mC.isPureReactComponent=!0;var bP=Array.isArray,HD=Object.prototype.hasOwnProperty,gC={current:null},VD={key:!0,ref:!0,__self:!0,__source:!0};function WD(n,e,t){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)HD.call(e,r)&&!VD.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Fv,type:n,key:s,ref:o,props:i,_owner:gC.current}}function c5(n,e){return{$$typeof:Fv,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function vC(n){return typeof n=="object"&&n!==null&&n.$$typeof===Fv}function u5(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var MP=/\/+/g;function bE(n,e){return typeof n=="object"&&n!==null&&n.key!=null?u5(""+n.key):e.toString(36)}function I1(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case Fv:case qH:o=!0}}if(o)return o=n,i=i(o),n=r===""?"."+bE(o,0):r,bP(i)?(t="",n!=null&&(t=n.replace(MP,"$&/")+"/"),I1(i,e,t,"",function(c){return c})):i!=null&&(vC(i)&&(i=c5(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(MP,"$&/")+"/")+n)),e.push(i)),1;if(o=0,r=r===""?".":r+":",bP(n))for(var a=0;a<n.length;a++){s=n[a];var l=r+bE(s,a);o+=I1(s,e,t,l,i)}else if(l=l5(n),typeof l=="function")for(n=l.call(n),a=0;!(s=n.next()).done;)s=s.value,l=r+bE(s,a++),o+=I1(s,e,t,l,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function $y(n,e,t){if(n==null)return n;var r=[],i=0;return I1(n,r,"","",function(s){return e.call(t,s,i++)}),r}function f5(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var ss={current:null},L1={transition:null},h5={ReactCurrentDispatcher:ss,ReactCurrentBatchConfig:L1,ReactCurrentOwner:gC};function XD(){throw Error("act(...) is not supported in production builds of React.")}pn.Children={map:$y,forEach:function(n,e,t){$y(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return $y(n,function(){e++}),e},toArray:function(n){return $y(n,function(e){return e})||[]},only:function(n){if(!vC(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};pn.Component=Lm;pn.Fragment=$H;pn.Profiler=t5;pn.PureComponent=pC;pn.StrictMode=e5;pn.Suspense=s5;pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=h5;pn.act=XD;pn.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=kD({},n.props),i=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=gC.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)HD.call(e,l)&&!VD.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Fv,type:n.type,key:i,ref:s,props:r,_owner:o}};pn.createContext=function(n){return n={$$typeof:r5,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:n5,_context:n},n.Consumer=n};pn.createElement=WD;pn.createFactory=function(n){var e=WD.bind(null,n);return e.type=n,e};pn.createRef=function(){return{current:null}};pn.forwardRef=function(n){return{$$typeof:i5,render:n}};pn.isValidElement=vC;pn.lazy=function(n){return{$$typeof:a5,_payload:{_status:-1,_result:n},_init:f5}};pn.memo=function(n,e){return{$$typeof:o5,type:n,compare:e===void 0?null:e}};pn.startTransition=function(n){var e=L1.transition;L1.transition={};try{n()}finally{L1.transition=e}};pn.unstable_act=XD;pn.useCallback=function(n,e){return ss.current.useCallback(n,e)};pn.useContext=function(n){return ss.current.useContext(n)};pn.useDebugValue=function(){};pn.useDeferredValue=function(n){return ss.current.useDeferredValue(n)};pn.useEffect=function(n,e){return ss.current.useEffect(n,e)};pn.useId=function(){return ss.current.useId()};pn.useImperativeHandle=function(n,e,t){return ss.current.useImperativeHandle(n,e,t)};pn.useInsertionEffect=function(n,e){return ss.current.useInsertionEffect(n,e)};pn.useLayoutEffect=function(n,e){return ss.current.useLayoutEffect(n,e)};pn.useMemo=function(n,e){return ss.current.useMemo(n,e)};pn.useReducer=function(n,e,t){return ss.current.useReducer(n,e,t)};pn.useRef=function(n){return ss.current.useRef(n)};pn.useState=function(n){return ss.current.useState(n)};pn.useSyncExternalStore=function(n,e,t){return ss.current.useSyncExternalStore(n,e,t)};pn.useTransition=function(){return ss.current.useTransition()};pn.version="18.3.1";FD.exports=pn;var te=FD.exports;const um=dC(te);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d5=te,p5=Symbol.for("react.element"),m5=Symbol.for("react.fragment"),g5=Object.prototype.hasOwnProperty,v5=d5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,y5={key:!0,ref:!0,__self:!0,__source:!0};function JD(n,e,t){var r,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)g5.call(e,r)&&!y5.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:p5,type:n,key:s,ref:o,props:i,_owner:v5.current}}g_.Fragment=m5;g_.jsx=JD;g_.jsxs=JD;UD.exports=g_;var yC=UD.exports;const sh=yC.Fragment,Me=yC.jsx,je=yC.jsxs;var bb={},KD={exports:{}},Qs={},QD={exports:{}},jD={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(X,K){var W=X.length;X.push(K);e:for(;0<W;){var V=W-1>>>1,Q=X[V];if(0<i(Q,K))X[V]=K,X[W]=Q,W=V;else break e}}function t(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var K=X[0],W=X.pop();if(W!==K){X[0]=W;e:for(var V=0,Q=X.length,q=Q>>>1;V<q;){var ne=2*(V+1)-1,fe=X[ne],pe=ne+1,ge=X[pe];if(0>i(fe,W))pe<Q&&0>i(ge,fe)?(X[V]=ge,X[pe]=W,V=pe):(X[V]=fe,X[ne]=W,V=ne);else if(pe<Q&&0>i(ge,W))X[V]=ge,X[pe]=W,V=pe;else break e}}return K}function i(X,K){var W=X.sortIndex-K.sortIndex;return W!==0?W:X.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,f=null,d=3,m=!1,g=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(X){for(var K=t(c);K!==null;){if(K.callback===null)r(c);else if(K.startTime<=X)r(c),K.sortIndex=K.expirationTime,e(l,K);else break;K=t(c)}}function S(X){if(y=!1,w(X),!g)if(t(l)!==null)g=!0,O(M);else{var K=t(c);K!==null&&ie(S,K.startTime-X)}}function M(X,K){g=!1,y&&(y=!1,v(P),P=-1),m=!0;var W=d;try{for(w(K),f=t(l);f!==null&&(!(f.expirationTime>K)||X&&!H());){var V=f.callback;if(typeof V=="function"){f.callback=null,d=f.priorityLevel;var Q=V(f.expirationTime<=K);K=n.unstable_now(),typeof Q=="function"?f.callback=Q:f===t(l)&&r(l),w(K)}else r(l);f=t(l)}if(f!==null)var q=!0;else{var ne=t(c);ne!==null&&ie(S,ne.startTime-K),q=!1}return q}finally{f=null,d=W,m=!1}}var b=!1,R=null,P=-1,C=5,B=-1;function H(){return!(n.unstable_now()-B<C)}function k(){if(R!==null){var X=n.unstable_now();B=X;var K=!0;try{K=R(!0,X)}finally{K?$():(b=!1,R=null)}}else b=!1}var $;if(typeof A=="function")$=function(){A(k)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,z=U.port2;U.port1.onmessage=k,$=function(){z.postMessage(null)}}else $=function(){x(k,0)};function O(X){R=X,b||(b=!0,$())}function ie(X,K){P=x(function(){X(n.unstable_now())},K)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_continueExecution=function(){g||m||(g=!0,O(M))},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(X){switch(d){case 1:case 2:case 3:var K=3;break;default:K=d}var W=d;d=K;try{return X()}finally{d=W}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(X,K){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var W=d;d=X;try{return K()}finally{d=W}},n.unstable_scheduleCallback=function(X,K,W){var V=n.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?V+W:V):W=V,X){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=W+Q,X={id:u++,callback:K,priorityLevel:X,startTime:W,expirationTime:Q,sortIndex:-1},W>V?(X.sortIndex=W,e(c,X),t(l)===null&&X===t(c)&&(y?(v(P),P=-1):y=!0,ie(S,W-V))):(X.sortIndex=Q,e(l,X),g||m||(g=!0,O(M))),X},n.unstable_shouldYield=H,n.unstable_wrapCallback=function(X){var K=d;return function(){var W=d;d=K;try{return X.apply(this,arguments)}finally{d=W}}}})(jD);QD.exports=jD;var x5=QD.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A5=te,Ks=x5;function lt(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var YD=new Set,b0={};function Ch(n,e){fm(n,e),fm(n+"Capture",e)}function fm(n,e){for(b0[n]=e,n=0;n<e.length;n++)YD.add(e[n])}var kl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Mb=Object.prototype.hasOwnProperty,_5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,TP={},CP={};function w5(n){return Mb.call(CP,n)?!0:Mb.call(TP,n)?!1:_5.test(n)?CP[n]=!0:(TP[n]=!0,!1)}function E5(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function S5(n,e,t,r){if(e===null||typeof e>"u"||E5(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function os(n,e,t,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var xi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){xi[n]=new os(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];xi[e]=new os(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){xi[n]=new os(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){xi[n]=new os(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){xi[n]=new os(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){xi[n]=new os(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){xi[n]=new os(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){xi[n]=new os(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){xi[n]=new os(n,5,!1,n.toLowerCase(),null,!1,!1)});var xC=/[\-:]([a-z])/g;function AC(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(xC,AC);xi[e]=new os(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(xC,AC);xi[e]=new os(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(xC,AC);xi[e]=new os(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){xi[n]=new os(n,1,!1,n.toLowerCase(),null,!1,!1)});xi.xlinkHref=new os("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){xi[n]=new os(n,1,!1,n.toLowerCase(),null,!0,!0)});function _C(n,e,t,r){var i=xi.hasOwnProperty(e)?xi[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(S5(e,t,i,r)&&(t=null),r||i===null?w5(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Ql=A5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ex=Symbol.for("react.element"),Nd=Symbol.for("react.portal"),Dd=Symbol.for("react.fragment"),wC=Symbol.for("react.strict_mode"),Tb=Symbol.for("react.profiler"),ZD=Symbol.for("react.provider"),qD=Symbol.for("react.context"),EC=Symbol.for("react.forward_ref"),Cb=Symbol.for("react.suspense"),Rb=Symbol.for("react.suspense_list"),SC=Symbol.for("react.memo"),Ec=Symbol.for("react.lazy"),$D=Symbol.for("react.offscreen"),RP=Symbol.iterator;function mg(n){return n===null||typeof n!="object"?null:(n=RP&&n[RP]||n["@@iterator"],typeof n=="function"?n:null)}var fr=Object.assign,ME;function jg(n){if(ME===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);ME=e&&e[1]||""}return`
`+ME+n}var TE=!1;function CE(n,e){if(!n||TE)return"";TE=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{TE=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?jg(n):""}function b5(n){switch(n.tag){case 5:return jg(n.type);case 16:return jg("Lazy");case 13:return jg("Suspense");case 19:return jg("SuspenseList");case 0:case 2:case 15:return n=CE(n.type,!1),n;case 11:return n=CE(n.type.render,!1),n;case 1:return n=CE(n.type,!0),n;default:return""}}function Bb(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Dd:return"Fragment";case Nd:return"Portal";case Tb:return"Profiler";case wC:return"StrictMode";case Cb:return"Suspense";case Rb:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case qD:return(n.displayName||"Context")+".Consumer";case ZD:return(n._context.displayName||"Context")+".Provider";case EC:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case SC:return e=n.displayName||null,e!==null?e:Bb(n.type)||"Memo";case Ec:e=n._payload,n=n._init;try{return Bb(n(e))}catch{}}return null}function M5(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bb(e);case 8:return e===wC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function hu(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function eU(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function T5(n){var e=eU(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function tx(n){n._valueTracker||(n._valueTracker=T5(n))}function tU(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=eU(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function mA(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Pb(n,e){var t=e.checked;return fr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function BP(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=hu(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function nU(n,e){e=e.checked,e!=null&&_C(n,"checked",e,!1)}function Ib(n,e){nU(n,e);var t=hu(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Lb(n,e.type,t):e.hasOwnProperty("defaultValue")&&Lb(n,e.type,hu(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function PP(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Lb(n,e,t){(e!=="number"||mA(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Yg=Array.isArray;function sp(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+hu(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function Nb(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(lt(91));return fr({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function IP(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(lt(92));if(Yg(t)){if(1<t.length)throw Error(lt(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:hu(t)}}function rU(n,e){var t=hu(e.value),r=hu(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function LP(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function iU(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Db(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?iU(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var nx,sU=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(nx=nx||document.createElement("div"),nx.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=nx.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function M0(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var o0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},C5=["Webkit","ms","Moz","O"];Object.keys(o0).forEach(function(n){C5.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),o0[e]=o0[n]})});function oU(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||o0.hasOwnProperty(n)&&o0[n]?(""+e).trim():e+"px"}function aU(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=oU(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var R5=fr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ub(n,e){if(e){if(R5[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(lt(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(lt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(lt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(lt(62))}}function Fb(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ob=null;function bC(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var kb=null,op=null,ap=null;function NP(n){if(n=Gv(n)){if(typeof kb!="function")throw Error(lt(280));var e=n.stateNode;e&&(e=__(e),kb(n.stateNode,n.type,e))}}function lU(n){op?ap?ap.push(n):ap=[n]:op=n}function cU(){if(op){var n=op,e=ap;if(ap=op=null,NP(n),e)for(n=0;n<e.length;n++)NP(e[n])}}function uU(n,e){return n(e)}function fU(){}var RE=!1;function hU(n,e,t){if(RE)return n(e,t);RE=!0;try{return uU(n,e,t)}finally{RE=!1,(op!==null||ap!==null)&&(fU(),cU())}}function T0(n,e){var t=n.stateNode;if(t===null)return null;var r=__(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(lt(231,e,typeof t));return t}var Gb=!1;if(kl)try{var gg={};Object.defineProperty(gg,"passive",{get:function(){Gb=!0}}),window.addEventListener("test",gg,gg),window.removeEventListener("test",gg,gg)}catch{Gb=!1}function B5(n,e,t,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var a0=!1,gA=null,vA=!1,zb=null,P5={onError:function(n){a0=!0,gA=n}};function I5(n,e,t,r,i,s,o,a,l){a0=!1,gA=null,B5.apply(P5,arguments)}function L5(n,e,t,r,i,s,o,a,l){if(I5.apply(this,arguments),a0){if(a0){var c=gA;a0=!1,gA=null}else throw Error(lt(198));vA||(vA=!0,zb=c)}}function Rh(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function dU(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function DP(n){if(Rh(n)!==n)throw Error(lt(188))}function N5(n){var e=n.alternate;if(!e){if(e=Rh(n),e===null)throw Error(lt(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return DP(i),n;if(s===r)return DP(i),e;s=s.sibling}throw Error(lt(188))}if(t.return!==r.return)t=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===t){o=!0,t=i,r=s;break}if(a===r){o=!0,r=i,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,r=i;break}if(a===r){o=!0,r=s,t=i;break}a=a.sibling}if(!o)throw Error(lt(189))}}if(t.alternate!==r)throw Error(lt(190))}if(t.tag!==3)throw Error(lt(188));return t.stateNode.current===t?n:e}function pU(n){return n=N5(n),n!==null?mU(n):null}function mU(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=mU(n);if(e!==null)return e;n=n.sibling}return null}var gU=Ks.unstable_scheduleCallback,UP=Ks.unstable_cancelCallback,D5=Ks.unstable_shouldYield,U5=Ks.unstable_requestPaint,Mr=Ks.unstable_now,F5=Ks.unstable_getCurrentPriorityLevel,MC=Ks.unstable_ImmediatePriority,vU=Ks.unstable_UserBlockingPriority,yA=Ks.unstable_NormalPriority,O5=Ks.unstable_LowPriority,yU=Ks.unstable_IdlePriority,v_=null,Fa=null;function k5(n){if(Fa&&typeof Fa.onCommitFiberRoot=="function")try{Fa.onCommitFiberRoot(v_,n,void 0,(n.current.flags&128)===128)}catch{}}var ea=Math.clz32?Math.clz32:H5,G5=Math.log,z5=Math.LN2;function H5(n){return n>>>=0,n===0?32:31-(G5(n)/z5|0)|0}var rx=64,ix=4194304;function Zg(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function xA(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~i;a!==0?r=Zg(a):(s&=o,s!==0&&(r=Zg(s)))}else o=t&~i,o!==0?r=Zg(o):s!==0&&(r=Zg(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-ea(e),i=1<<t,r|=n[t],e&=~i;return r}function V5(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function W5(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-ea(s),a=1<<o,l=i[o];l===-1?(!(a&t)||a&r)&&(i[o]=V5(a,e)):l<=e&&(n.expiredLanes|=a),s&=~a}}function Hb(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function xU(){var n=rx;return rx<<=1,!(rx&4194240)&&(rx=64),n}function BE(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Ov(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-ea(e),n[e]=t}function X5(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-ea(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function TC(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-ea(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var In=0;function AU(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var _U,CC,wU,EU,SU,Vb=!1,sx=[],Zc=null,qc=null,$c=null,C0=new Map,R0=new Map,Tc=[],J5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function FP(n,e){switch(n){case"focusin":case"focusout":Zc=null;break;case"dragenter":case"dragleave":qc=null;break;case"mouseover":case"mouseout":$c=null;break;case"pointerover":case"pointerout":C0.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":R0.delete(e.pointerId)}}function vg(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Gv(e),e!==null&&CC(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function K5(n,e,t,r,i){switch(e){case"focusin":return Zc=vg(Zc,n,e,t,r,i),!0;case"dragenter":return qc=vg(qc,n,e,t,r,i),!0;case"mouseover":return $c=vg($c,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return C0.set(s,vg(C0.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,R0.set(s,vg(R0.get(s)||null,n,e,t,r,i)),!0}return!1}function bU(n){var e=Sf(n.target);if(e!==null){var t=Rh(e);if(t!==null){if(e=t.tag,e===13){if(e=dU(t),e!==null){n.blockedOn=e,SU(n.priority,function(){wU(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function N1(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Wb(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Ob=r,t.target.dispatchEvent(r),Ob=null}else return e=Gv(t),e!==null&&CC(e),n.blockedOn=t,!1;e.shift()}return!0}function OP(n,e,t){N1(n)&&t.delete(e)}function Q5(){Vb=!1,Zc!==null&&N1(Zc)&&(Zc=null),qc!==null&&N1(qc)&&(qc=null),$c!==null&&N1($c)&&($c=null),C0.forEach(OP),R0.forEach(OP)}function yg(n,e){n.blockedOn===e&&(n.blockedOn=null,Vb||(Vb=!0,Ks.unstable_scheduleCallback(Ks.unstable_NormalPriority,Q5)))}function B0(n){function e(i){return yg(i,n)}if(0<sx.length){yg(sx[0],n);for(var t=1;t<sx.length;t++){var r=sx[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Zc!==null&&yg(Zc,n),qc!==null&&yg(qc,n),$c!==null&&yg($c,n),C0.forEach(e),R0.forEach(e),t=0;t<Tc.length;t++)r=Tc[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Tc.length&&(t=Tc[0],t.blockedOn===null);)bU(t),t.blockedOn===null&&Tc.shift()}var lp=Ql.ReactCurrentBatchConfig,AA=!0;function j5(n,e,t,r){var i=In,s=lp.transition;lp.transition=null;try{In=1,RC(n,e,t,r)}finally{In=i,lp.transition=s}}function Y5(n,e,t,r){var i=In,s=lp.transition;lp.transition=null;try{In=4,RC(n,e,t,r)}finally{In=i,lp.transition=s}}function RC(n,e,t,r){if(AA){var i=Wb(n,e,t,r);if(i===null)GE(n,e,r,_A,t),FP(n,r);else if(K5(i,n,e,t,r))r.stopPropagation();else if(FP(n,r),e&4&&-1<J5.indexOf(n)){for(;i!==null;){var s=Gv(i);if(s!==null&&_U(s),s=Wb(n,e,t,r),s===null&&GE(n,e,r,_A,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else GE(n,e,r,null,t)}}var _A=null;function Wb(n,e,t,r){if(_A=null,n=bC(r),n=Sf(n),n!==null)if(e=Rh(n),e===null)n=null;else if(t=e.tag,t===13){if(n=dU(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return _A=n,null}function MU(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(F5()){case MC:return 1;case vU:return 4;case yA:case O5:return 16;case yU:return 536870912;default:return 16}default:return 16}}var Qc=null,BC=null,D1=null;function TU(){if(D1)return D1;var n,e=BC,t=e.length,r,i="value"in Qc?Qc.value:Qc.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===i[s-r];r++);return D1=i.slice(n,1<r?1-r:void 0)}function U1(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function ox(){return!0}function kP(){return!1}function js(n){function e(t,r,i,s,o){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ox:kP,this.isPropagationStopped=kP,this}return fr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=ox)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=ox)},persist:function(){},isPersistent:ox}),e}var Nm={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},PC=js(Nm),kv=fr({},Nm,{view:0,detail:0}),Z5=js(kv),PE,IE,xg,y_=fr({},kv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:IC,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==xg&&(xg&&n.type==="mousemove"?(PE=n.screenX-xg.screenX,IE=n.screenY-xg.screenY):IE=PE=0,xg=n),PE)},movementY:function(n){return"movementY"in n?n.movementY:IE}}),GP=js(y_),q5=fr({},y_,{dataTransfer:0}),$5=js(q5),e8=fr({},kv,{relatedTarget:0}),LE=js(e8),t8=fr({},Nm,{animationName:0,elapsedTime:0,pseudoElement:0}),n8=js(t8),r8=fr({},Nm,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),i8=js(r8),s8=fr({},Nm,{data:0}),zP=js(s8),o8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},a8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},l8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function c8(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=l8[n])?!!e[n]:!1}function IC(){return c8}var u8=fr({},kv,{key:function(n){if(n.key){var e=o8[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=U1(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?a8[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:IC,charCode:function(n){return n.type==="keypress"?U1(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?U1(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),f8=js(u8),h8=fr({},y_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),HP=js(h8),d8=fr({},kv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:IC}),p8=js(d8),m8=fr({},Nm,{propertyName:0,elapsedTime:0,pseudoElement:0}),g8=js(m8),v8=fr({},y_,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),y8=js(v8),x8=[9,13,27,32],LC=kl&&"CompositionEvent"in window,l0=null;kl&&"documentMode"in document&&(l0=document.documentMode);var A8=kl&&"TextEvent"in window&&!l0,CU=kl&&(!LC||l0&&8<l0&&11>=l0),VP=String.fromCharCode(32),WP=!1;function RU(n,e){switch(n){case"keyup":return x8.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function BU(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Ud=!1;function _8(n,e){switch(n){case"compositionend":return BU(e);case"keypress":return e.which!==32?null:(WP=!0,VP);case"textInput":return n=e.data,n===VP&&WP?null:n;default:return null}}function w8(n,e){if(Ud)return n==="compositionend"||!LC&&RU(n,e)?(n=TU(),D1=BC=Qc=null,Ud=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return CU&&e.locale!=="ko"?null:e.data;default:return null}}var E8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function XP(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!E8[n.type]:e==="textarea"}function PU(n,e,t,r){lU(r),e=wA(e,"onChange"),0<e.length&&(t=new PC("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var c0=null,P0=null;function S8(n){HU(n,0)}function x_(n){var e=kd(n);if(tU(e))return n}function b8(n,e){if(n==="change")return e}var IU=!1;if(kl){var NE;if(kl){var DE="oninput"in document;if(!DE){var JP=document.createElement("div");JP.setAttribute("oninput","return;"),DE=typeof JP.oninput=="function"}NE=DE}else NE=!1;IU=NE&&(!document.documentMode||9<document.documentMode)}function KP(){c0&&(c0.detachEvent("onpropertychange",LU),P0=c0=null)}function LU(n){if(n.propertyName==="value"&&x_(P0)){var e=[];PU(e,P0,n,bC(n)),hU(S8,e)}}function M8(n,e,t){n==="focusin"?(KP(),c0=e,P0=t,c0.attachEvent("onpropertychange",LU)):n==="focusout"&&KP()}function T8(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return x_(P0)}function C8(n,e){if(n==="click")return x_(e)}function R8(n,e){if(n==="input"||n==="change")return x_(e)}function B8(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var ia=typeof Object.is=="function"?Object.is:B8;function I0(n,e){if(ia(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!Mb.call(e,i)||!ia(n[i],e[i]))return!1}return!0}function QP(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function jP(n,e){var t=QP(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=QP(t)}}function NU(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?NU(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function DU(){for(var n=window,e=mA();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=mA(n.document)}return e}function NC(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function P8(n){var e=DU(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&NU(t.ownerDocument.documentElement,t)){if(r!==null&&NC(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=jP(t,s);var o=jP(t,r);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var I8=kl&&"documentMode"in document&&11>=document.documentMode,Fd=null,Xb=null,u0=null,Jb=!1;function YP(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Jb||Fd==null||Fd!==mA(r)||(r=Fd,"selectionStart"in r&&NC(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),u0&&I0(u0,r)||(u0=r,r=wA(Xb,"onSelect"),0<r.length&&(e=new PC("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Fd)))}function ax(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Od={animationend:ax("Animation","AnimationEnd"),animationiteration:ax("Animation","AnimationIteration"),animationstart:ax("Animation","AnimationStart"),transitionend:ax("Transition","TransitionEnd")},UE={},UU={};kl&&(UU=document.createElement("div").style,"AnimationEvent"in window||(delete Od.animationend.animation,delete Od.animationiteration.animation,delete Od.animationstart.animation),"TransitionEvent"in window||delete Od.transitionend.transition);function A_(n){if(UE[n])return UE[n];if(!Od[n])return n;var e=Od[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in UU)return UE[n]=e[t];return n}var FU=A_("animationend"),OU=A_("animationiteration"),kU=A_("animationstart"),GU=A_("transitionend"),zU=new Map,ZP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Su(n,e){zU.set(n,e),Ch(e,[n])}for(var FE=0;FE<ZP.length;FE++){var OE=ZP[FE],L8=OE.toLowerCase(),N8=OE[0].toUpperCase()+OE.slice(1);Su(L8,"on"+N8)}Su(FU,"onAnimationEnd");Su(OU,"onAnimationIteration");Su(kU,"onAnimationStart");Su("dblclick","onDoubleClick");Su("focusin","onFocus");Su("focusout","onBlur");Su(GU,"onTransitionEnd");fm("onMouseEnter",["mouseout","mouseover"]);fm("onMouseLeave",["mouseout","mouseover"]);fm("onPointerEnter",["pointerout","pointerover"]);fm("onPointerLeave",["pointerout","pointerover"]);Ch("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ch("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ch("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ch("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ch("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ch("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D8=new Set("cancel close invalid load scroll toggle".split(" ").concat(qg));function qP(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,L5(r,e,void 0,n),n.currentTarget=null}function HU(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;qP(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;qP(i,a,c),s=l}}}if(vA)throw n=zb,vA=!1,zb=null,n}function Jn(n,e){var t=e[Zb];t===void 0&&(t=e[Zb]=new Set);var r=n+"__bubble";t.has(r)||(VU(e,n,2,!1),t.add(r))}function kE(n,e,t){var r=0;e&&(r|=4),VU(t,n,r,e)}var lx="_reactListening"+Math.random().toString(36).slice(2);function L0(n){if(!n[lx]){n[lx]=!0,YD.forEach(function(t){t!=="selectionchange"&&(D8.has(t)||kE(t,!1,n),kE(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[lx]||(e[lx]=!0,kE("selectionchange",!1,e))}}function VU(n,e,t,r){switch(MU(e)){case 1:var i=j5;break;case 4:i=Y5;break;default:i=RC}t=i.bind(null,e,t,n),i=void 0,!Gb||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function GE(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Sf(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}hU(function(){var c=s,u=bC(t),f=[];e:{var d=zU.get(n);if(d!==void 0){var m=PC,g=n;switch(n){case"keypress":if(U1(t)===0)break e;case"keydown":case"keyup":m=f8;break;case"focusin":g="focus",m=LE;break;case"focusout":g="blur",m=LE;break;case"beforeblur":case"afterblur":m=LE;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=GP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=$5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=p8;break;case FU:case OU:case kU:m=n8;break;case GU:m=g8;break;case"scroll":m=Z5;break;case"wheel":m=y8;break;case"copy":case"cut":case"paste":m=i8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=HP}var y=(e&4)!==0,x=!y&&n==="scroll",v=y?d!==null?d+"Capture":null:d;y=[];for(var A=c,w;A!==null;){w=A;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,v!==null&&(S=T0(A,v),S!=null&&y.push(N0(A,S,w)))),x)break;A=A.return}0<y.length&&(d=new m(d,g,null,t,u),f.push({event:d,listeners:y}))}}if(!(e&7)){e:{if(d=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",d&&t!==Ob&&(g=t.relatedTarget||t.fromElement)&&(Sf(g)||g[Gl]))break e;if((m||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,m?(g=t.relatedTarget||t.toElement,m=c,g=g?Sf(g):null,g!==null&&(x=Rh(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=c),m!==g)){if(y=GP,S="onMouseLeave",v="onMouseEnter",A="mouse",(n==="pointerout"||n==="pointerover")&&(y=HP,S="onPointerLeave",v="onPointerEnter",A="pointer"),x=m==null?d:kd(m),w=g==null?d:kd(g),d=new y(S,A+"leave",m,t,u),d.target=x,d.relatedTarget=w,S=null,Sf(u)===c&&(y=new y(v,A+"enter",g,t,u),y.target=w,y.relatedTarget=x,S=y),x=S,m&&g)t:{for(y=m,v=g,A=0,w=y;w;w=$h(w))A++;for(w=0,S=v;S;S=$h(S))w++;for(;0<A-w;)y=$h(y),A--;for(;0<w-A;)v=$h(v),w--;for(;A--;){if(y===v||v!==null&&y===v.alternate)break t;y=$h(y),v=$h(v)}y=null}else y=null;m!==null&&$P(f,d,m,y,!1),g!==null&&x!==null&&$P(f,x,g,y,!0)}}e:{if(d=c?kd(c):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var M=b8;else if(XP(d))if(IU)M=R8;else{M=T8;var b=M8}else(m=d.nodeName)&&m.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(M=C8);if(M&&(M=M(n,c))){PU(f,M,t,u);break e}b&&b(n,d,c),n==="focusout"&&(b=d._wrapperState)&&b.controlled&&d.type==="number"&&Lb(d,"number",d.value)}switch(b=c?kd(c):window,n){case"focusin":(XP(b)||b.contentEditable==="true")&&(Fd=b,Xb=c,u0=null);break;case"focusout":u0=Xb=Fd=null;break;case"mousedown":Jb=!0;break;case"contextmenu":case"mouseup":case"dragend":Jb=!1,YP(f,t,u);break;case"selectionchange":if(I8)break;case"keydown":case"keyup":YP(f,t,u)}var R;if(LC)e:{switch(n){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Ud?RU(n,t)&&(P="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(P="onCompositionStart");P&&(CU&&t.locale!=="ko"&&(Ud||P!=="onCompositionStart"?P==="onCompositionEnd"&&Ud&&(R=TU()):(Qc=u,BC="value"in Qc?Qc.value:Qc.textContent,Ud=!0)),b=wA(c,P),0<b.length&&(P=new zP(P,n,null,t,u),f.push({event:P,listeners:b}),R?P.data=R:(R=BU(t),R!==null&&(P.data=R)))),(R=A8?_8(n,t):w8(n,t))&&(c=wA(c,"onBeforeInput"),0<c.length&&(u=new zP("onBeforeInput","beforeinput",null,t,u),f.push({event:u,listeners:c}),u.data=R))}HU(f,e)})}function N0(n,e,t){return{instance:n,listener:e,currentTarget:t}}function wA(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=T0(n,t),s!=null&&r.unshift(N0(n,s,i)),s=T0(n,e),s!=null&&r.push(N0(n,s,i))),n=n.return}return r}function $h(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function $P(n,e,t,r,i){for(var s=e._reactName,o=[];t!==null&&t!==r;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=T0(t,s),l!=null&&o.unshift(N0(t,l,a))):i||(l=T0(t,s),l!=null&&o.push(N0(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var U8=/\r\n?/g,F8=/\u0000|\uFFFD/g;function eI(n){return(typeof n=="string"?n:""+n).replace(U8,`
`).replace(F8,"")}function cx(n,e,t){if(e=eI(e),eI(n)!==e&&t)throw Error(lt(425))}function EA(){}var Kb=null,Qb=null;function jb(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Yb=typeof setTimeout=="function"?setTimeout:void 0,O8=typeof clearTimeout=="function"?clearTimeout:void 0,tI=typeof Promise=="function"?Promise:void 0,k8=typeof queueMicrotask=="function"?queueMicrotask:typeof tI<"u"?function(n){return tI.resolve(null).then(n).catch(G8)}:Yb;function G8(n){setTimeout(function(){throw n})}function zE(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),B0(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);B0(e)}function eu(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function nI(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Dm=Math.random().toString(36).slice(2),Ia="__reactFiber$"+Dm,D0="__reactProps$"+Dm,Gl="__reactContainer$"+Dm,Zb="__reactEvents$"+Dm,z8="__reactListeners$"+Dm,H8="__reactHandles$"+Dm;function Sf(n){var e=n[Ia];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Gl]||t[Ia]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=nI(n);n!==null;){if(t=n[Ia])return t;n=nI(n)}return e}n=t,t=n.parentNode}return null}function Gv(n){return n=n[Ia]||n[Gl],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function kd(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(lt(33))}function __(n){return n[D0]||null}var qb=[],Gd=-1;function bu(n){return{current:n}}function Yn(n){0>Gd||(n.current=qb[Gd],qb[Gd]=null,Gd--)}function Wn(n,e){Gd++,qb[Gd]=n.current,n.current=e}var du={},Fi=bu(du),_s=bu(!1),mh=du;function hm(n,e){var t=n.type.contextTypes;if(!t)return du;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function ws(n){return n=n.childContextTypes,n!=null}function SA(){Yn(_s),Yn(Fi)}function rI(n,e,t){if(Fi.current!==du)throw Error(lt(168));Wn(Fi,e),Wn(_s,t)}function WU(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(lt(108,M5(n)||"Unknown",i));return fr({},t,r)}function bA(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||du,mh=Fi.current,Wn(Fi,n),Wn(_s,_s.current),!0}function iI(n,e,t){var r=n.stateNode;if(!r)throw Error(lt(169));t?(n=WU(n,e,mh),r.__reactInternalMemoizedMergedChildContext=n,Yn(_s),Yn(Fi),Wn(Fi,n)):Yn(_s),Wn(_s,t)}var hl=null,w_=!1,HE=!1;function XU(n){hl===null?hl=[n]:hl.push(n)}function V8(n){w_=!0,XU(n)}function Mu(){if(!HE&&hl!==null){HE=!0;var n=0,e=In;try{var t=hl;for(In=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}hl=null,w_=!1}catch(i){throw hl!==null&&(hl=hl.slice(n+1)),gU(MC,Mu),i}finally{In=e,HE=!1}}return null}var zd=[],Hd=0,MA=null,TA=0,vo=[],yo=0,gh=null,Rl=1,Bl="";function uf(n,e){zd[Hd++]=TA,zd[Hd++]=MA,MA=n,TA=e}function JU(n,e,t){vo[yo++]=Rl,vo[yo++]=Bl,vo[yo++]=gh,gh=n;var r=Rl;n=Bl;var i=32-ea(r)-1;r&=~(1<<i),t+=1;var s=32-ea(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Rl=1<<32-ea(e)+i|t<<i|r,Bl=s+n}else Rl=1<<s|t<<i|r,Bl=n}function DC(n){n.return!==null&&(uf(n,1),JU(n,1,0))}function UC(n){for(;n===MA;)MA=zd[--Hd],zd[Hd]=null,TA=zd[--Hd],zd[Hd]=null;for(;n===gh;)gh=vo[--yo],vo[yo]=null,Bl=vo[--yo],vo[yo]=null,Rl=vo[--yo],vo[yo]=null}var Xs=null,Ws=null,er=!1,Qo=null;function KU(n,e){var t=_o(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function sI(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Xs=n,Ws=eu(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Xs=n,Ws=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=gh!==null?{id:Rl,overflow:Bl}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=_o(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Xs=n,Ws=null,!0):!1;default:return!1}}function $b(n){return(n.mode&1)!==0&&(n.flags&128)===0}function eM(n){if(er){var e=Ws;if(e){var t=e;if(!sI(n,e)){if($b(n))throw Error(lt(418));e=eu(t.nextSibling);var r=Xs;e&&sI(n,e)?KU(r,t):(n.flags=n.flags&-4097|2,er=!1,Xs=n)}}else{if($b(n))throw Error(lt(418));n.flags=n.flags&-4097|2,er=!1,Xs=n}}}function oI(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Xs=n}function ux(n){if(n!==Xs)return!1;if(!er)return oI(n),er=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!jb(n.type,n.memoizedProps)),e&&(e=Ws)){if($b(n))throw QU(),Error(lt(418));for(;e;)KU(n,e),e=eu(e.nextSibling)}if(oI(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(lt(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Ws=eu(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Ws=null}}else Ws=Xs?eu(n.stateNode.nextSibling):null;return!0}function QU(){for(var n=Ws;n;)n=eu(n.nextSibling)}function dm(){Ws=Xs=null,er=!1}function FC(n){Qo===null?Qo=[n]:Qo.push(n)}var W8=Ql.ReactCurrentBatchConfig;function Ag(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(lt(309));var r=t.stateNode}if(!r)throw Error(lt(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(lt(284));if(!t._owner)throw Error(lt(290,n))}return n}function fx(n,e){throw n=Object.prototype.toString.call(e),Error(lt(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function aI(n){var e=n._init;return e(n._payload)}function jU(n){function e(v,A){if(n){var w=v.deletions;w===null?(v.deletions=[A],v.flags|=16):w.push(A)}}function t(v,A){if(!n)return null;for(;A!==null;)e(v,A),A=A.sibling;return null}function r(v,A){for(v=new Map;A!==null;)A.key!==null?v.set(A.key,A):v.set(A.index,A),A=A.sibling;return v}function i(v,A){return v=iu(v,A),v.index=0,v.sibling=null,v}function s(v,A,w){return v.index=w,n?(w=v.alternate,w!==null?(w=w.index,w<A?(v.flags|=2,A):w):(v.flags|=2,A)):(v.flags|=1048576,A)}function o(v){return n&&v.alternate===null&&(v.flags|=2),v}function a(v,A,w,S){return A===null||A.tag!==6?(A=jE(w,v.mode,S),A.return=v,A):(A=i(A,w),A.return=v,A)}function l(v,A,w,S){var M=w.type;return M===Dd?u(v,A,w.props.children,S,w.key):A!==null&&(A.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Ec&&aI(M)===A.type)?(S=i(A,w.props),S.ref=Ag(v,A,w),S.return=v,S):(S=V1(w.type,w.key,w.props,null,v.mode,S),S.ref=Ag(v,A,w),S.return=v,S)}function c(v,A,w,S){return A===null||A.tag!==4||A.stateNode.containerInfo!==w.containerInfo||A.stateNode.implementation!==w.implementation?(A=YE(w,v.mode,S),A.return=v,A):(A=i(A,w.children||[]),A.return=v,A)}function u(v,A,w,S,M){return A===null||A.tag!==7?(A=ah(w,v.mode,S,M),A.return=v,A):(A=i(A,w),A.return=v,A)}function f(v,A,w){if(typeof A=="string"&&A!==""||typeof A=="number")return A=jE(""+A,v.mode,w),A.return=v,A;if(typeof A=="object"&&A!==null){switch(A.$$typeof){case ex:return w=V1(A.type,A.key,A.props,null,v.mode,w),w.ref=Ag(v,null,A),w.return=v,w;case Nd:return A=YE(A,v.mode,w),A.return=v,A;case Ec:var S=A._init;return f(v,S(A._payload),w)}if(Yg(A)||mg(A))return A=ah(A,v.mode,w,null),A.return=v,A;fx(v,A)}return null}function d(v,A,w,S){var M=A!==null?A.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return M!==null?null:a(v,A,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ex:return w.key===M?l(v,A,w,S):null;case Nd:return w.key===M?c(v,A,w,S):null;case Ec:return M=w._init,d(v,A,M(w._payload),S)}if(Yg(w)||mg(w))return M!==null?null:u(v,A,w,S,null);fx(v,w)}return null}function m(v,A,w,S,M){if(typeof S=="string"&&S!==""||typeof S=="number")return v=v.get(w)||null,a(A,v,""+S,M);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ex:return v=v.get(S.key===null?w:S.key)||null,l(A,v,S,M);case Nd:return v=v.get(S.key===null?w:S.key)||null,c(A,v,S,M);case Ec:var b=S._init;return m(v,A,w,b(S._payload),M)}if(Yg(S)||mg(S))return v=v.get(w)||null,u(A,v,S,M,null);fx(A,S)}return null}function g(v,A,w,S){for(var M=null,b=null,R=A,P=A=0,C=null;R!==null&&P<w.length;P++){R.index>P?(C=R,R=null):C=R.sibling;var B=d(v,R,w[P],S);if(B===null){R===null&&(R=C);break}n&&R&&B.alternate===null&&e(v,R),A=s(B,A,P),b===null?M=B:b.sibling=B,b=B,R=C}if(P===w.length)return t(v,R),er&&uf(v,P),M;if(R===null){for(;P<w.length;P++)R=f(v,w[P],S),R!==null&&(A=s(R,A,P),b===null?M=R:b.sibling=R,b=R);return er&&uf(v,P),M}for(R=r(v,R);P<w.length;P++)C=m(R,v,P,w[P],S),C!==null&&(n&&C.alternate!==null&&R.delete(C.key===null?P:C.key),A=s(C,A,P),b===null?M=C:b.sibling=C,b=C);return n&&R.forEach(function(H){return e(v,H)}),er&&uf(v,P),M}function y(v,A,w,S){var M=mg(w);if(typeof M!="function")throw Error(lt(150));if(w=M.call(w),w==null)throw Error(lt(151));for(var b=M=null,R=A,P=A=0,C=null,B=w.next();R!==null&&!B.done;P++,B=w.next()){R.index>P?(C=R,R=null):C=R.sibling;var H=d(v,R,B.value,S);if(H===null){R===null&&(R=C);break}n&&R&&H.alternate===null&&e(v,R),A=s(H,A,P),b===null?M=H:b.sibling=H,b=H,R=C}if(B.done)return t(v,R),er&&uf(v,P),M;if(R===null){for(;!B.done;P++,B=w.next())B=f(v,B.value,S),B!==null&&(A=s(B,A,P),b===null?M=B:b.sibling=B,b=B);return er&&uf(v,P),M}for(R=r(v,R);!B.done;P++,B=w.next())B=m(R,v,P,B.value,S),B!==null&&(n&&B.alternate!==null&&R.delete(B.key===null?P:B.key),A=s(B,A,P),b===null?M=B:b.sibling=B,b=B);return n&&R.forEach(function(k){return e(v,k)}),er&&uf(v,P),M}function x(v,A,w,S){if(typeof w=="object"&&w!==null&&w.type===Dd&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ex:e:{for(var M=w.key,b=A;b!==null;){if(b.key===M){if(M=w.type,M===Dd){if(b.tag===7){t(v,b.sibling),A=i(b,w.props.children),A.return=v,v=A;break e}}else if(b.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Ec&&aI(M)===b.type){t(v,b.sibling),A=i(b,w.props),A.ref=Ag(v,b,w),A.return=v,v=A;break e}t(v,b);break}else e(v,b);b=b.sibling}w.type===Dd?(A=ah(w.props.children,v.mode,S,w.key),A.return=v,v=A):(S=V1(w.type,w.key,w.props,null,v.mode,S),S.ref=Ag(v,A,w),S.return=v,v=S)}return o(v);case Nd:e:{for(b=w.key;A!==null;){if(A.key===b)if(A.tag===4&&A.stateNode.containerInfo===w.containerInfo&&A.stateNode.implementation===w.implementation){t(v,A.sibling),A=i(A,w.children||[]),A.return=v,v=A;break e}else{t(v,A);break}else e(v,A);A=A.sibling}A=YE(w,v.mode,S),A.return=v,v=A}return o(v);case Ec:return b=w._init,x(v,A,b(w._payload),S)}if(Yg(w))return g(v,A,w,S);if(mg(w))return y(v,A,w,S);fx(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,A!==null&&A.tag===6?(t(v,A.sibling),A=i(A,w),A.return=v,v=A):(t(v,A),A=jE(w,v.mode,S),A.return=v,v=A),o(v)):t(v,A)}return x}var pm=jU(!0),YU=jU(!1),CA=bu(null),RA=null,Vd=null,OC=null;function kC(){OC=Vd=RA=null}function GC(n){var e=CA.current;Yn(CA),n._currentValue=e}function tM(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function cp(n,e){RA=n,OC=Vd=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(As=!0),n.firstContext=null)}function Eo(n){var e=n._currentValue;if(OC!==n)if(n={context:n,memoizedValue:e,next:null},Vd===null){if(RA===null)throw Error(lt(308));Vd=n,RA.dependencies={lanes:0,firstContext:n}}else Vd=Vd.next=n;return e}var bf=null;function zC(n){bf===null?bf=[n]:bf.push(n)}function ZU(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,zC(e)):(t.next=i.next,i.next=t),e.interleaved=t,zl(n,r)}function zl(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Sc=!1;function HC(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qU(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ll(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function tu(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,En&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,zl(n,t)}return i=r.interleaved,i===null?(e.next=e,zC(r)):(e.next=i.next,i.next=e),r.interleaved=e,zl(n,t)}function F1(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,TC(n,t)}}function lI(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function BA(n,e,t,r){var i=n.updateQueue;Sc=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=n.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,u=c=l=null,a=s;do{var d=a.lane,m=a.eventTime;if((r&d)===d){u!==null&&(u=u.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=n,y=a;switch(d=e,m=t,y.tag){case 1:if(g=y.payload,typeof g=="function"){f=g.call(m,f,d);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=y.payload,d=typeof g=="function"?g.call(m,f,d):g,d==null)break e;f=fr({},f,d);break e;case 2:Sc=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,d=i.effects,d===null?i.effects=[a]:d.push(a))}else m={eventTime:m,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=m,l=f):u=u.next=m,o|=d;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;d=a,a=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(1);if(u===null&&(l=f),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);yh|=o,n.lanes=o,n.memoizedState=f}}function cI(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(lt(191,i));i.call(r)}}}var zv={},Oa=bu(zv),U0=bu(zv),F0=bu(zv);function Mf(n){if(n===zv)throw Error(lt(174));return n}function VC(n,e){switch(Wn(F0,e),Wn(U0,n),Wn(Oa,zv),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Db(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Db(e,n)}Yn(Oa),Wn(Oa,e)}function mm(){Yn(Oa),Yn(U0),Yn(F0)}function $U(n){Mf(F0.current);var e=Mf(Oa.current),t=Db(e,n.type);e!==t&&(Wn(U0,n),Wn(Oa,t))}function WC(n){U0.current===n&&(Yn(Oa),Yn(U0))}var sr=bu(0);function PA(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var VE=[];function XC(){for(var n=0;n<VE.length;n++)VE[n]._workInProgressVersionPrimary=null;VE.length=0}var O1=Ql.ReactCurrentDispatcher,WE=Ql.ReactCurrentBatchConfig,vh=0,cr=null,Vr=null,ti=null,IA=!1,f0=!1,O0=0,X8=0;function bi(){throw Error(lt(321))}function JC(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!ia(n[t],e[t]))return!1;return!0}function KC(n,e,t,r,i,s){if(vh=s,cr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,O1.current=n===null||n.memoizedState===null?j8:Y8,n=t(r,i),f0){s=0;do{if(f0=!1,O0=0,25<=s)throw Error(lt(301));s+=1,ti=Vr=null,e.updateQueue=null,O1.current=Z8,n=t(r,i)}while(f0)}if(O1.current=LA,e=Vr!==null&&Vr.next!==null,vh=0,ti=Vr=cr=null,IA=!1,e)throw Error(lt(300));return n}function QC(){var n=O0!==0;return O0=0,n}function _a(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ti===null?cr.memoizedState=ti=n:ti=ti.next=n,ti}function So(){if(Vr===null){var n=cr.alternate;n=n!==null?n.memoizedState:null}else n=Vr.next;var e=ti===null?cr.memoizedState:ti.next;if(e!==null)ti=e,Vr=n;else{if(n===null)throw Error(lt(310));Vr=n,n={memoizedState:Vr.memoizedState,baseState:Vr.baseState,baseQueue:Vr.baseQueue,queue:Vr.queue,next:null},ti===null?cr.memoizedState=ti=n:ti=ti.next=n}return ti}function k0(n,e){return typeof e=="function"?e(n):e}function XE(n){var e=So(),t=e.queue;if(t===null)throw Error(lt(311));t.lastRenderedReducer=n;var r=Vr,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((vh&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,cr.lanes|=u,yh|=u}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,ia(r,e.memoizedState)||(As=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,cr.lanes|=s,yh|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function JE(n){var e=So(),t=e.queue;if(t===null)throw Error(lt(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do s=n(s,o.action),o=o.next;while(o!==i);ia(s,e.memoizedState)||(As=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function eF(){}function tF(n,e){var t=cr,r=So(),i=e(),s=!ia(r.memoizedState,i);if(s&&(r.memoizedState=i,As=!0),r=r.queue,jC(iF.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||ti!==null&&ti.memoizedState.tag&1){if(t.flags|=2048,G0(9,rF.bind(null,t,r,i,e),void 0,null),ii===null)throw Error(lt(349));vh&30||nF(t,e,i)}return i}function nF(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=cr.updateQueue,e===null?(e={lastEffect:null,stores:null},cr.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function rF(n,e,t,r){e.value=t,e.getSnapshot=r,sF(e)&&oF(n)}function iF(n,e,t){return t(function(){sF(e)&&oF(n)})}function sF(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!ia(n,t)}catch{return!0}}function oF(n){var e=zl(n,1);e!==null&&ta(e,n,1,-1)}function uI(n){var e=_a();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:k0,lastRenderedState:n},e.queue=n,n=n.dispatch=Q8.bind(null,cr,n),[e.memoizedState,n]}function G0(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=cr.updateQueue,e===null?(e={lastEffect:null,stores:null},cr.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function aF(){return So().memoizedState}function k1(n,e,t,r){var i=_a();cr.flags|=n,i.memoizedState=G0(1|e,t,void 0,r===void 0?null:r)}function E_(n,e,t,r){var i=So();r=r===void 0?null:r;var s=void 0;if(Vr!==null){var o=Vr.memoizedState;if(s=o.destroy,r!==null&&JC(r,o.deps)){i.memoizedState=G0(e,t,s,r);return}}cr.flags|=n,i.memoizedState=G0(1|e,t,s,r)}function fI(n,e){return k1(8390656,8,n,e)}function jC(n,e){return E_(2048,8,n,e)}function lF(n,e){return E_(4,2,n,e)}function cF(n,e){return E_(4,4,n,e)}function uF(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function fF(n,e,t){return t=t!=null?t.concat([n]):null,E_(4,4,uF.bind(null,e,n),t)}function YC(){}function hF(n,e){var t=So();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&JC(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function dF(n,e){var t=So();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&JC(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function pF(n,e,t){return vh&21?(ia(t,e)||(t=xU(),cr.lanes|=t,yh|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,As=!0),n.memoizedState=t)}function J8(n,e){var t=In;In=t!==0&&4>t?t:4,n(!0);var r=WE.transition;WE.transition={};try{n(!1),e()}finally{In=t,WE.transition=r}}function mF(){return So().memoizedState}function K8(n,e,t){var r=ru(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},gF(n))vF(e,t);else if(t=ZU(n,e,t,r),t!==null){var i=rs();ta(t,n,r,i),yF(t,e,r)}}function Q8(n,e,t){var r=ru(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(gF(n))vF(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(i.hasEagerState=!0,i.eagerState=a,ia(a,o)){var l=e.interleaved;l===null?(i.next=i,zC(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=ZU(n,e,i,r),t!==null&&(i=rs(),ta(t,n,r,i),yF(t,e,r))}}function gF(n){var e=n.alternate;return n===cr||e!==null&&e===cr}function vF(n,e){f0=IA=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function yF(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,TC(n,t)}}var LA={readContext:Eo,useCallback:bi,useContext:bi,useEffect:bi,useImperativeHandle:bi,useInsertionEffect:bi,useLayoutEffect:bi,useMemo:bi,useReducer:bi,useRef:bi,useState:bi,useDebugValue:bi,useDeferredValue:bi,useTransition:bi,useMutableSource:bi,useSyncExternalStore:bi,useId:bi,unstable_isNewReconciler:!1},j8={readContext:Eo,useCallback:function(n,e){return _a().memoizedState=[n,e===void 0?null:e],n},useContext:Eo,useEffect:fI,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,k1(4194308,4,uF.bind(null,e,n),t)},useLayoutEffect:function(n,e){return k1(4194308,4,n,e)},useInsertionEffect:function(n,e){return k1(4,2,n,e)},useMemo:function(n,e){var t=_a();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=_a();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=K8.bind(null,cr,n),[r.memoizedState,n]},useRef:function(n){var e=_a();return n={current:n},e.memoizedState=n},useState:uI,useDebugValue:YC,useDeferredValue:function(n){return _a().memoizedState=n},useTransition:function(){var n=uI(!1),e=n[0];return n=J8.bind(null,n[1]),_a().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=cr,i=_a();if(er){if(t===void 0)throw Error(lt(407));t=t()}else{if(t=e(),ii===null)throw Error(lt(349));vh&30||nF(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,fI(iF.bind(null,r,s,n),[n]),r.flags|=2048,G0(9,rF.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=_a(),e=ii.identifierPrefix;if(er){var t=Bl,r=Rl;t=(r&~(1<<32-ea(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=O0++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=X8++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},Y8={readContext:Eo,useCallback:hF,useContext:Eo,useEffect:jC,useImperativeHandle:fF,useInsertionEffect:lF,useLayoutEffect:cF,useMemo:dF,useReducer:XE,useRef:aF,useState:function(){return XE(k0)},useDebugValue:YC,useDeferredValue:function(n){var e=So();return pF(e,Vr.memoizedState,n)},useTransition:function(){var n=XE(k0)[0],e=So().memoizedState;return[n,e]},useMutableSource:eF,useSyncExternalStore:tF,useId:mF,unstable_isNewReconciler:!1},Z8={readContext:Eo,useCallback:hF,useContext:Eo,useEffect:jC,useImperativeHandle:fF,useInsertionEffect:lF,useLayoutEffect:cF,useMemo:dF,useReducer:JE,useRef:aF,useState:function(){return JE(k0)},useDebugValue:YC,useDeferredValue:function(n){var e=So();return Vr===null?e.memoizedState=n:pF(e,Vr.memoizedState,n)},useTransition:function(){var n=JE(k0)[0],e=So().memoizedState;return[n,e]},useMutableSource:eF,useSyncExternalStore:tF,useId:mF,unstable_isNewReconciler:!1};function Uo(n,e){if(n&&n.defaultProps){e=fr({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function nM(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:fr({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var S_={isMounted:function(n){return(n=n._reactInternals)?Rh(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=rs(),i=ru(n),s=Ll(r,i);s.payload=e,t!=null&&(s.callback=t),e=tu(n,s,i),e!==null&&(ta(e,n,i,r),F1(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=rs(),i=ru(n),s=Ll(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=tu(n,s,i),e!==null&&(ta(e,n,i,r),F1(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=rs(),r=ru(n),i=Ll(t,r);i.tag=2,e!=null&&(i.callback=e),e=tu(n,i,r),e!==null&&(ta(e,n,r,t),F1(e,n,r))}};function hI(n,e,t,r,i,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!I0(t,r)||!I0(i,s):!0}function xF(n,e,t){var r=!1,i=du,s=e.contextType;return typeof s=="object"&&s!==null?s=Eo(s):(i=ws(e)?mh:Fi.current,r=e.contextTypes,s=(r=r!=null)?hm(n,i):du),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=S_,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function dI(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&S_.enqueueReplaceState(e,e.state,null)}function rM(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},HC(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Eo(s):(s=ws(e)?mh:Fi.current,i.context=hm(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(nM(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&S_.enqueueReplaceState(i,i.state,null),BA(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function gm(n,e){try{var t="",r=e;do t+=b5(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function KE(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function iM(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var q8=typeof WeakMap=="function"?WeakMap:Map;function AF(n,e,t){t=Ll(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){DA||(DA=!0,pM=r),iM(n,e)},t}function _F(n,e,t){t=Ll(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){iM(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){iM(n,e),typeof r!="function"&&(nu===null?nu=new Set([this]):nu.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function pI(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new q8;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=h6.bind(null,n,e,t),e.then(n,n))}function mI(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function gI(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ll(-1,1),e.tag=2,tu(t,e,1))),t.lanes|=1),n)}var $8=Ql.ReactCurrentOwner,As=!1;function Yi(n,e,t,r){e.child=n===null?YU(e,null,t,r):pm(e,n.child,t,r)}function vI(n,e,t,r,i){t=t.render;var s=e.ref;return cp(e,i),r=KC(n,e,t,r,s,i),t=QC(),n!==null&&!As?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Hl(n,e,i)):(er&&t&&DC(e),e.flags|=1,Yi(n,e,r,i),e.child)}function yI(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!i2(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,wF(n,e,s,r,i)):(n=V1(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:I0,t(o,r)&&n.ref===e.ref)return Hl(n,e,i)}return e.flags|=1,n=iu(s,r),n.ref=e.ref,n.return=e,e.child=n}function wF(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(I0(s,r)&&n.ref===e.ref)if(As=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(As=!0);else return e.lanes=n.lanes,Hl(n,e,i)}return sM(n,e,t,r,i)}function EF(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wn(Xd,Vs),Vs|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Wn(Xd,Vs),Vs|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,Wn(Xd,Vs),Vs|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,Wn(Xd,Vs),Vs|=r;return Yi(n,e,i,t),e.child}function SF(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function sM(n,e,t,r,i){var s=ws(t)?mh:Fi.current;return s=hm(e,s),cp(e,i),t=KC(n,e,t,r,s,i),r=QC(),n!==null&&!As?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Hl(n,e,i)):(er&&r&&DC(e),e.flags|=1,Yi(n,e,t,i),e.child)}function xI(n,e,t,r,i){if(ws(t)){var s=!0;bA(e)}else s=!1;if(cp(e,i),e.stateNode===null)G1(n,e),xF(e,t,r),rM(e,t,r,i),r=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=Eo(c):(c=ws(t)?mh:Fi.current,c=hm(e,c));var u=t.getDerivedStateFromProps,f=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&dI(e,o,r,c),Sc=!1;var d=e.memoizedState;o.state=d,BA(e,r,o,i),l=e.memoizedState,a!==r||d!==l||_s.current||Sc?(typeof u=="function"&&(nM(e,t,u,r),l=e.memoizedState),(a=Sc||hI(e,t,a,r,d,l,c))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,qU(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:Uo(e.type,a),o.props=c,f=e.pendingProps,d=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Eo(l):(l=ws(t)?mh:Fi.current,l=hm(e,l));var m=t.getDerivedStateFromProps;(u=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||d!==l)&&dI(e,o,r,l),Sc=!1,d=e.memoizedState,o.state=d,BA(e,r,o,i);var g=e.memoizedState;a!==f||d!==g||_s.current||Sc?(typeof m=="function"&&(nM(e,t,m,r),g=e.memoizedState),(c=Sc||hI(e,t,c,r,d,g,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),r=!1)}return oM(n,e,t,r,s,i)}function oM(n,e,t,r,i,s){SF(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&iI(e,t,!1),Hl(n,e,s);r=e.stateNode,$8.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=pm(e,n.child,null,s),e.child=pm(e,null,a,s)):Yi(n,e,a,s),e.memoizedState=r.state,i&&iI(e,t,!0),e.child}function bF(n){var e=n.stateNode;e.pendingContext?rI(n,e.pendingContext,e.pendingContext!==e.context):e.context&&rI(n,e.context,!1),VC(n,e.containerInfo)}function AI(n,e,t,r,i){return dm(),FC(i),e.flags|=256,Yi(n,e,t,r),e.child}var aM={dehydrated:null,treeContext:null,retryLane:0};function lM(n){return{baseLanes:n,cachePool:null,transitions:null}}function MF(n,e,t){var r=e.pendingProps,i=sr.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Wn(sr,i&1),n===null)return eM(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=T_(o,r,0,null),n=ah(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=lM(t),e.memoizedState=aM,n):ZC(e,o));if(i=n.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return e6(n,e,o,r,a,i,t);if(s){s=r.fallback,o=e.mode,i=n.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=iu(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=iu(a,s):(s=ah(s,o,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=n.child.memoizedState,o=o===null?lM(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=aM,r}return s=n.child,n=s.sibling,r=iu(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function ZC(n,e){return e=T_({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function hx(n,e,t,r){return r!==null&&FC(r),pm(e,n.child,null,t),n=ZC(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function e6(n,e,t,r,i,s,o){if(t)return e.flags&256?(e.flags&=-257,r=KE(Error(lt(422))),hx(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=T_({mode:"visible",children:r.children},i,0,null),s=ah(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&pm(e,n.child,null,o),e.child.memoizedState=lM(o),e.memoizedState=aM,s);if(!(e.mode&1))return hx(n,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(lt(419)),r=KE(s,r,void 0),hx(n,e,o,r)}if(a=(o&n.childLanes)!==0,As||a){if(r=ii,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,zl(n,i),ta(r,n,i,-1))}return r2(),r=KE(Error(lt(421))),hx(n,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=d6.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,Ws=eu(i.nextSibling),Xs=e,er=!0,Qo=null,n!==null&&(vo[yo++]=Rl,vo[yo++]=Bl,vo[yo++]=gh,Rl=n.id,Bl=n.overflow,gh=e),e=ZC(e,r.children),e.flags|=4096,e)}function _I(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),tM(n.return,e,t)}function QE(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function TF(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Yi(n,e,r.children,t),r=sr.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&_I(n,t,e);else if(n.tag===19)_I(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Wn(sr,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&PA(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),QE(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&PA(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}QE(e,!0,t,null,s);break;case"together":QE(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function G1(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Hl(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),yh|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(lt(153));if(e.child!==null){for(n=e.child,t=iu(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=iu(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function t6(n,e,t){switch(e.tag){case 3:bF(e),dm();break;case 5:$U(e);break;case 1:ws(e.type)&&bA(e);break;case 4:VC(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Wn(CA,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Wn(sr,sr.current&1),e.flags|=128,null):t&e.child.childLanes?MF(n,e,t):(Wn(sr,sr.current&1),n=Hl(n,e,t),n!==null?n.sibling:null);Wn(sr,sr.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return TF(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Wn(sr,sr.current),r)break;return null;case 22:case 23:return e.lanes=0,EF(n,e,t)}return Hl(n,e,t)}var CF,cM,RF,BF;CF=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};cM=function(){};RF=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Mf(Oa.current);var s=null;switch(t){case"input":i=Pb(n,i),r=Pb(n,r),s=[];break;case"select":i=fr({},i,{value:void 0}),r=fr({},r,{value:void 0}),s=[];break;case"textarea":i=Nb(n,i),r=Nb(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=EA)}Ub(t,r);var o;t=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(b0.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(b0.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Jn("scroll",n),s||a===l||(s=[])):(s=s||[]).push(c,l))}t&&(s=s||[]).push("style",t);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};BF=function(n,e,t,r){t!==r&&(e.flags|=4)};function _g(n,e){if(!er)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Mi(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function n6(n,e,t){var r=e.pendingProps;switch(UC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mi(e),null;case 1:return ws(e.type)&&SA(),Mi(e),null;case 3:return r=e.stateNode,mm(),Yn(_s),Yn(Fi),XC(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(ux(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Qo!==null&&(vM(Qo),Qo=null))),cM(n,e),Mi(e),null;case 5:WC(e);var i=Mf(F0.current);if(t=e.type,n!==null&&e.stateNode!=null)RF(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(lt(166));return Mi(e),null}if(n=Mf(Oa.current),ux(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[Ia]=e,r[D0]=s,n=(e.mode&1)!==0,t){case"dialog":Jn("cancel",r),Jn("close",r);break;case"iframe":case"object":case"embed":Jn("load",r);break;case"video":case"audio":for(i=0;i<qg.length;i++)Jn(qg[i],r);break;case"source":Jn("error",r);break;case"img":case"image":case"link":Jn("error",r),Jn("load",r);break;case"details":Jn("toggle",r);break;case"input":BP(r,s),Jn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Jn("invalid",r);break;case"textarea":IP(r,s),Jn("invalid",r)}Ub(t,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&cx(r.textContent,a,n),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&cx(r.textContent,a,n),i=["children",""+a]):b0.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Jn("scroll",r)}switch(t){case"input":tx(r),PP(r,s,!0);break;case"textarea":tx(r),LP(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=EA)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=iU(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Ia]=e,n[D0]=r,CF(n,e,!1,!1),e.stateNode=n;e:{switch(o=Fb(t,r),t){case"dialog":Jn("cancel",n),Jn("close",n),i=r;break;case"iframe":case"object":case"embed":Jn("load",n),i=r;break;case"video":case"audio":for(i=0;i<qg.length;i++)Jn(qg[i],n);i=r;break;case"source":Jn("error",n),i=r;break;case"img":case"image":case"link":Jn("error",n),Jn("load",n),i=r;break;case"details":Jn("toggle",n),i=r;break;case"input":BP(n,r),i=Pb(n,r),Jn("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=fr({},r,{value:void 0}),Jn("invalid",n);break;case"textarea":IP(n,r),i=Nb(n,r),Jn("invalid",n);break;default:i=r}Ub(t,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?aU(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&sU(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&M0(n,l):typeof l=="number"&&M0(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(b0.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Jn("scroll",n):l!=null&&_C(n,s,l,o))}switch(t){case"input":tx(n),PP(n,r,!1);break;case"textarea":tx(n),LP(n);break;case"option":r.value!=null&&n.setAttribute("value",""+hu(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?sp(n,!!r.multiple,s,!1):r.defaultValue!=null&&sp(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=EA)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Mi(e),null;case 6:if(n&&e.stateNode!=null)BF(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(lt(166));if(t=Mf(F0.current),Mf(Oa.current),ux(e)){if(r=e.stateNode,t=e.memoizedProps,r[Ia]=e,(s=r.nodeValue!==t)&&(n=Xs,n!==null))switch(n.tag){case 3:cx(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&cx(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Ia]=e,e.stateNode=r}return Mi(e),null;case 13:if(Yn(sr),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(er&&Ws!==null&&e.mode&1&&!(e.flags&128))QU(),dm(),e.flags|=98560,s=!1;else if(s=ux(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(lt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(lt(317));s[Ia]=e}else dm(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Mi(e),s=!1}else Qo!==null&&(vM(Qo),Qo=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||sr.current&1?Wr===0&&(Wr=3):r2())),e.updateQueue!==null&&(e.flags|=4),Mi(e),null);case 4:return mm(),cM(n,e),n===null&&L0(e.stateNode.containerInfo),Mi(e),null;case 10:return GC(e.type._context),Mi(e),null;case 17:return ws(e.type)&&SA(),Mi(e),null;case 19:if(Yn(sr),s=e.memoizedState,s===null)return Mi(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)_g(s,!1);else{if(Wr!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=PA(n),o!==null){for(e.flags|=128,_g(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Wn(sr,sr.current&1|2),e.child}n=n.sibling}s.tail!==null&&Mr()>vm&&(e.flags|=128,r=!0,_g(s,!1),e.lanes=4194304)}else{if(!r)if(n=PA(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),_g(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!er)return Mi(e),null}else 2*Mr()-s.renderingStartTime>vm&&t!==1073741824&&(e.flags|=128,r=!0,_g(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Mr(),e.sibling=null,t=sr.current,Wn(sr,r?t&1|2:t&1),e):(Mi(e),null);case 22:case 23:return n2(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Vs&1073741824&&(Mi(e),e.subtreeFlags&6&&(e.flags|=8192)):Mi(e),null;case 24:return null;case 25:return null}throw Error(lt(156,e.tag))}function r6(n,e){switch(UC(e),e.tag){case 1:return ws(e.type)&&SA(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return mm(),Yn(_s),Yn(Fi),XC(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return WC(e),null;case 13:if(Yn(sr),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(lt(340));dm()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Yn(sr),null;case 4:return mm(),null;case 10:return GC(e.type._context),null;case 22:case 23:return n2(),null;case 24:return null;default:return null}}var dx=!1,Li=!1,i6=typeof WeakSet=="function"?WeakSet:Set,bt=null;function Wd(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){vr(n,e,r)}else t.current=null}function uM(n,e,t){try{t()}catch(r){vr(n,e,r)}}var wI=!1;function s6(n,e){if(Kb=AA,n=DU(),NC(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,c=0,u=0,f=n,d=null;t:for(;;){for(var m;f!==t||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(m=f.firstChild)!==null;)d=f,f=m;for(;;){if(f===n)break t;if(d===t&&++c===i&&(a=o),d===s&&++u===r&&(l=o),(m=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=m}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Qb={focusedElem:n,selectionRange:t},AA=!1,bt=e;bt!==null;)if(e=bt,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,bt=n;else for(;bt!==null;){e=bt;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var y=g.memoizedProps,x=g.memoizedState,v=e.stateNode,A=v.getSnapshotBeforeUpdate(e.elementType===e.type?y:Uo(e.type,y),x);v.__reactInternalSnapshotBeforeUpdate=A}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(lt(163))}}catch(S){vr(e,e.return,S)}if(n=e.sibling,n!==null){n.return=e.return,bt=n;break}bt=e.return}return g=wI,wI=!1,g}function h0(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&uM(e,t,s)}i=i.next}while(i!==r)}}function b_(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function fM(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function PF(n){var e=n.alternate;e!==null&&(n.alternate=null,PF(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Ia],delete e[D0],delete e[Zb],delete e[z8],delete e[H8])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function IF(n){return n.tag===5||n.tag===3||n.tag===4}function EI(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||IF(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function hM(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=EA));else if(r!==4&&(n=n.child,n!==null))for(hM(n,e,t),n=n.sibling;n!==null;)hM(n,e,t),n=n.sibling}function dM(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(dM(n,e,t),n=n.sibling;n!==null;)dM(n,e,t),n=n.sibling}var fi=null,Jo=!1;function oc(n,e,t){for(t=t.child;t!==null;)LF(n,e,t),t=t.sibling}function LF(n,e,t){if(Fa&&typeof Fa.onCommitFiberUnmount=="function")try{Fa.onCommitFiberUnmount(v_,t)}catch{}switch(t.tag){case 5:Li||Wd(t,e);case 6:var r=fi,i=Jo;fi=null,oc(n,e,t),fi=r,Jo=i,fi!==null&&(Jo?(n=fi,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):fi.removeChild(t.stateNode));break;case 18:fi!==null&&(Jo?(n=fi,t=t.stateNode,n.nodeType===8?zE(n.parentNode,t):n.nodeType===1&&zE(n,t),B0(n)):zE(fi,t.stateNode));break;case 4:r=fi,i=Jo,fi=t.stateNode.containerInfo,Jo=!0,oc(n,e,t),fi=r,Jo=i;break;case 0:case 11:case 14:case 15:if(!Li&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&uM(t,e,o),i=i.next}while(i!==r)}oc(n,e,t);break;case 1:if(!Li&&(Wd(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){vr(t,e,a)}oc(n,e,t);break;case 21:oc(n,e,t);break;case 22:t.mode&1?(Li=(r=Li)||t.memoizedState!==null,oc(n,e,t),Li=r):oc(n,e,t);break;default:oc(n,e,t)}}function SI(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new i6),e.forEach(function(r){var i=p6.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function Bo(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:fi=a.stateNode,Jo=!1;break e;case 3:fi=a.stateNode.containerInfo,Jo=!0;break e;case 4:fi=a.stateNode.containerInfo,Jo=!0;break e}a=a.return}if(fi===null)throw Error(lt(160));LF(s,o,i),fi=null,Jo=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){vr(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)NF(e,n),e=e.sibling}function NF(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Bo(e,n),xa(n),r&4){try{h0(3,n,n.return),b_(3,n)}catch(y){vr(n,n.return,y)}try{h0(5,n,n.return)}catch(y){vr(n,n.return,y)}}break;case 1:Bo(e,n),xa(n),r&512&&t!==null&&Wd(t,t.return);break;case 5:if(Bo(e,n),xa(n),r&512&&t!==null&&Wd(t,t.return),n.flags&32){var i=n.stateNode;try{M0(i,"")}catch(y){vr(n,n.return,y)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&nU(i,s),Fb(a,o);var c=Fb(a,s);for(o=0;o<l.length;o+=2){var u=l[o],f=l[o+1];u==="style"?aU(i,f):u==="dangerouslySetInnerHTML"?sU(i,f):u==="children"?M0(i,f):_C(i,u,f,c)}switch(a){case"input":Ib(i,s);break;case"textarea":rU(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?sp(i,!!s.multiple,m,!1):d!==!!s.multiple&&(s.defaultValue!=null?sp(i,!!s.multiple,s.defaultValue,!0):sp(i,!!s.multiple,s.multiple?[]:"",!1))}i[D0]=s}catch(y){vr(n,n.return,y)}}break;case 6:if(Bo(e,n),xa(n),r&4){if(n.stateNode===null)throw Error(lt(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(y){vr(n,n.return,y)}}break;case 3:if(Bo(e,n),xa(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{B0(e.containerInfo)}catch(y){vr(n,n.return,y)}break;case 4:Bo(e,n),xa(n);break;case 13:Bo(e,n),xa(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(e2=Mr())),r&4&&SI(n);break;case 22:if(u=t!==null&&t.memoizedState!==null,n.mode&1?(Li=(c=Li)||u,Bo(e,n),Li=c):Bo(e,n),xa(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!u&&n.mode&1)for(bt=n,u=n.child;u!==null;){for(f=bt=u;bt!==null;){switch(d=bt,m=d.child,d.tag){case 0:case 11:case 14:case 15:h0(4,d,d.return);break;case 1:Wd(d,d.return);var g=d.stateNode;if(typeof g.componentWillUnmount=="function"){r=d,t=d.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(y){vr(r,t,y)}}break;case 5:Wd(d,d.return);break;case 22:if(d.memoizedState!==null){MI(f);continue}}m!==null?(m.return=d,bt=m):MI(f)}u=u.sibling}e:for(u=null,f=n;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=oU("display",o))}catch(y){vr(n,n.return,y)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(y){vr(n,n.return,y)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Bo(e,n),xa(n),r&4&&SI(n);break;case 21:break;default:Bo(e,n),xa(n)}}function xa(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(IF(t)){var r=t;break e}t=t.return}throw Error(lt(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(M0(i,""),r.flags&=-33);var s=EI(n);dM(n,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=EI(n);hM(n,a,o);break;default:throw Error(lt(161))}}catch(l){vr(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function o6(n,e,t){bt=n,DF(n)}function DF(n,e,t){for(var r=(n.mode&1)!==0;bt!==null;){var i=bt,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||dx;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Li;a=dx;var c=Li;if(dx=o,(Li=l)&&!c)for(bt=i;bt!==null;)o=bt,l=o.child,o.tag===22&&o.memoizedState!==null?TI(i):l!==null?(l.return=o,bt=l):TI(i);for(;s!==null;)bt=s,DF(s),s=s.sibling;bt=i,dx=a,Li=c}bI(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,bt=s):bI(n)}}function bI(n){for(;bt!==null;){var e=bt;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Li||b_(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Li)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Uo(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&cI(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}cI(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&B0(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(lt(163))}Li||e.flags&512&&fM(e)}catch(d){vr(e,e.return,d)}}if(e===n){bt=null;break}if(t=e.sibling,t!==null){t.return=e.return,bt=t;break}bt=e.return}}function MI(n){for(;bt!==null;){var e=bt;if(e===n){bt=null;break}var t=e.sibling;if(t!==null){t.return=e.return,bt=t;break}bt=e.return}}function TI(n){for(;bt!==null;){var e=bt;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{b_(4,e)}catch(l){vr(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){vr(e,i,l)}}var s=e.return;try{fM(e)}catch(l){vr(e,s,l)}break;case 5:var o=e.return;try{fM(e)}catch(l){vr(e,o,l)}}}catch(l){vr(e,e.return,l)}if(e===n){bt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,bt=a;break}bt=e.return}}var a6=Math.ceil,NA=Ql.ReactCurrentDispatcher,qC=Ql.ReactCurrentOwner,wo=Ql.ReactCurrentBatchConfig,En=0,ii=null,Dr=null,mi=0,Vs=0,Xd=bu(0),Wr=0,z0=null,yh=0,M_=0,$C=0,d0=null,gs=null,e2=0,vm=1/0,ll=null,DA=!1,pM=null,nu=null,px=!1,jc=null,UA=0,p0=0,mM=null,z1=-1,H1=0;function rs(){return En&6?Mr():z1!==-1?z1:z1=Mr()}function ru(n){return n.mode&1?En&2&&mi!==0?mi&-mi:W8.transition!==null?(H1===0&&(H1=xU()),H1):(n=In,n!==0||(n=window.event,n=n===void 0?16:MU(n.type)),n):1}function ta(n,e,t,r){if(50<p0)throw p0=0,mM=null,Error(lt(185));Ov(n,t,r),(!(En&2)||n!==ii)&&(n===ii&&(!(En&2)&&(M_|=t),Wr===4&&Cc(n,mi)),Es(n,r),t===1&&En===0&&!(e.mode&1)&&(vm=Mr()+500,w_&&Mu()))}function Es(n,e){var t=n.callbackNode;W5(n,e);var r=xA(n,n===ii?mi:0);if(r===0)t!==null&&UP(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&UP(t),e===1)n.tag===0?V8(CI.bind(null,n)):XU(CI.bind(null,n)),k8(function(){!(En&6)&&Mu()}),t=null;else{switch(AU(r)){case 1:t=MC;break;case 4:t=vU;break;case 16:t=yA;break;case 536870912:t=yU;break;default:t=yA}t=VF(t,UF.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function UF(n,e){if(z1=-1,H1=0,En&6)throw Error(lt(327));var t=n.callbackNode;if(up()&&n.callbackNode!==t)return null;var r=xA(n,n===ii?mi:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=FA(n,r);else{e=r;var i=En;En|=2;var s=OF();(ii!==n||mi!==e)&&(ll=null,vm=Mr()+500,oh(n,e));do try{u6();break}catch(a){FF(n,a)}while(1);kC(),NA.current=s,En=i,Dr!==null?e=0:(ii=null,mi=0,e=Wr)}if(e!==0){if(e===2&&(i=Hb(n),i!==0&&(r=i,e=gM(n,i))),e===1)throw t=z0,oh(n,0),Cc(n,r),Es(n,Mr()),t;if(e===6)Cc(n,r);else{if(i=n.current.alternate,!(r&30)&&!l6(i)&&(e=FA(n,r),e===2&&(s=Hb(n),s!==0&&(r=s,e=gM(n,s))),e===1))throw t=z0,oh(n,0),Cc(n,r),Es(n,Mr()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(lt(345));case 2:ff(n,gs,ll);break;case 3:if(Cc(n,r),(r&130023424)===r&&(e=e2+500-Mr(),10<e)){if(xA(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){rs(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=Yb(ff.bind(null,n,gs,ll),e);break}ff(n,gs,ll);break;case 4:if(Cc(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var o=31-ea(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Mr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*a6(r/1960))-r,10<r){n.timeoutHandle=Yb(ff.bind(null,n,gs,ll),r);break}ff(n,gs,ll);break;case 5:ff(n,gs,ll);break;default:throw Error(lt(329))}}}return Es(n,Mr()),n.callbackNode===t?UF.bind(null,n):null}function gM(n,e){var t=d0;return n.current.memoizedState.isDehydrated&&(oh(n,e).flags|=256),n=FA(n,e),n!==2&&(e=gs,gs=t,e!==null&&vM(e)),n}function vM(n){gs===null?gs=n:gs.push.apply(gs,n)}function l6(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!ia(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Cc(n,e){for(e&=~$C,e&=~M_,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-ea(e),r=1<<t;n[t]=-1,e&=~r}}function CI(n){if(En&6)throw Error(lt(327));up();var e=xA(n,0);if(!(e&1))return Es(n,Mr()),null;var t=FA(n,e);if(n.tag!==0&&t===2){var r=Hb(n);r!==0&&(e=r,t=gM(n,r))}if(t===1)throw t=z0,oh(n,0),Cc(n,e),Es(n,Mr()),t;if(t===6)throw Error(lt(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,ff(n,gs,ll),Es(n,Mr()),null}function t2(n,e){var t=En;En|=1;try{return n(e)}finally{En=t,En===0&&(vm=Mr()+500,w_&&Mu())}}function xh(n){jc!==null&&jc.tag===0&&!(En&6)&&up();var e=En;En|=1;var t=wo.transition,r=In;try{if(wo.transition=null,In=1,n)return n()}finally{In=r,wo.transition=t,En=e,!(En&6)&&Mu()}}function n2(){Vs=Xd.current,Yn(Xd)}function oh(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,O8(t)),Dr!==null)for(t=Dr.return;t!==null;){var r=t;switch(UC(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&SA();break;case 3:mm(),Yn(_s),Yn(Fi),XC();break;case 5:WC(r);break;case 4:mm();break;case 13:Yn(sr);break;case 19:Yn(sr);break;case 10:GC(r.type._context);break;case 22:case 23:n2()}t=t.return}if(ii=n,Dr=n=iu(n.current,null),mi=Vs=e,Wr=0,z0=null,$C=M_=yh=0,gs=d0=null,bf!==null){for(e=0;e<bf.length;e++)if(t=bf[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}t.pending=r}bf=null}return n}function FF(n,e){do{var t=Dr;try{if(kC(),O1.current=LA,IA){for(var r=cr.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}IA=!1}if(vh=0,ti=Vr=cr=null,f0=!1,O0=0,qC.current=null,t===null||t.return===null){Wr=1,z0=e,Dr=null;break}e:{var s=n,o=t.return,a=t,l=e;if(e=mi,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=mI(o);if(m!==null){m.flags&=-257,gI(m,o,a,s,e),m.mode&1&&pI(s,c,e),e=m,l=c;var g=e.updateQueue;if(g===null){var y=new Set;y.add(l),e.updateQueue=y}else g.add(l);break e}else{if(!(e&1)){pI(s,c,e),r2();break e}l=Error(lt(426))}}else if(er&&a.mode&1){var x=mI(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),gI(x,o,a,s,e),FC(gm(l,a));break e}}s=l=gm(l,a),Wr!==4&&(Wr=2),d0===null?d0=[s]:d0.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var v=AF(s,l,e);lI(s,v);break e;case 1:a=l;var A=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof A.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(nu===null||!nu.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var S=_F(s,a,e);lI(s,S);break e}}s=s.return}while(s!==null)}GF(t)}catch(M){e=M,Dr===t&&t!==null&&(Dr=t=t.return);continue}break}while(1)}function OF(){var n=NA.current;return NA.current=LA,n===null?LA:n}function r2(){(Wr===0||Wr===3||Wr===2)&&(Wr=4),ii===null||!(yh&268435455)&&!(M_&268435455)||Cc(ii,mi)}function FA(n,e){var t=En;En|=2;var r=OF();(ii!==n||mi!==e)&&(ll=null,oh(n,e));do try{c6();break}catch(i){FF(n,i)}while(1);if(kC(),En=t,NA.current=r,Dr!==null)throw Error(lt(261));return ii=null,mi=0,Wr}function c6(){for(;Dr!==null;)kF(Dr)}function u6(){for(;Dr!==null&&!D5();)kF(Dr)}function kF(n){var e=HF(n.alternate,n,Vs);n.memoizedProps=n.pendingProps,e===null?GF(n):Dr=e,qC.current=null}function GF(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=r6(t,e),t!==null){t.flags&=32767,Dr=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Wr=6,Dr=null;return}}else if(t=n6(t,e,Vs),t!==null){Dr=t;return}if(e=e.sibling,e!==null){Dr=e;return}Dr=e=n}while(e!==null);Wr===0&&(Wr=5)}function ff(n,e,t){var r=In,i=wo.transition;try{wo.transition=null,In=1,f6(n,e,t,r)}finally{wo.transition=i,In=r}return null}function f6(n,e,t,r){do up();while(jc!==null);if(En&6)throw Error(lt(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(lt(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(X5(n,s),n===ii&&(Dr=ii=null,mi=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||px||(px=!0,VF(yA,function(){return up(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=wo.transition,wo.transition=null;var o=In;In=1;var a=En;En|=4,qC.current=null,s6(n,t),NF(t,n),P8(Qb),AA=!!Kb,Qb=Kb=null,n.current=t,o6(t),U5(),En=a,In=o,wo.transition=s}else n.current=t;if(px&&(px=!1,jc=n,UA=i),s=n.pendingLanes,s===0&&(nu=null),k5(t.stateNode),Es(n,Mr()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(DA)throw DA=!1,n=pM,pM=null,n;return UA&1&&n.tag!==0&&up(),s=n.pendingLanes,s&1?n===mM?p0++:(p0=0,mM=n):p0=0,Mu(),null}function up(){if(jc!==null){var n=AU(UA),e=wo.transition,t=In;try{if(wo.transition=null,In=16>n?16:n,jc===null)var r=!1;else{if(n=jc,jc=null,UA=0,En&6)throw Error(lt(331));var i=En;for(En|=4,bt=n.current;bt!==null;){var s=bt,o=s.child;if(bt.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(bt=c;bt!==null;){var u=bt;switch(u.tag){case 0:case 11:case 15:h0(8,u,s)}var f=u.child;if(f!==null)f.return=u,bt=f;else for(;bt!==null;){u=bt;var d=u.sibling,m=u.return;if(PF(u),u===c){bt=null;break}if(d!==null){d.return=m,bt=d;break}bt=m}}}var g=s.alternate;if(g!==null){var y=g.child;if(y!==null){g.child=null;do{var x=y.sibling;y.sibling=null,y=x}while(y!==null)}}bt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,bt=o;else e:for(;bt!==null;){if(s=bt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:h0(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,bt=v;break e}bt=s.return}}var A=n.current;for(bt=A;bt!==null;){o=bt;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,bt=w;else e:for(o=A;bt!==null;){if(a=bt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:b_(9,a)}}catch(M){vr(a,a.return,M)}if(a===o){bt=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,bt=S;break e}bt=a.return}}if(En=i,Mu(),Fa&&typeof Fa.onPostCommitFiberRoot=="function")try{Fa.onPostCommitFiberRoot(v_,n)}catch{}r=!0}return r}finally{In=t,wo.transition=e}}return!1}function RI(n,e,t){e=gm(t,e),e=AF(n,e,1),n=tu(n,e,1),e=rs(),n!==null&&(Ov(n,1,e),Es(n,e))}function vr(n,e,t){if(n.tag===3)RI(n,n,t);else for(;e!==null;){if(e.tag===3){RI(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(nu===null||!nu.has(r))){n=gm(t,n),n=_F(e,n,1),e=tu(e,n,1),n=rs(),e!==null&&(Ov(e,1,n),Es(e,n));break}}e=e.return}}function h6(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=rs(),n.pingedLanes|=n.suspendedLanes&t,ii===n&&(mi&t)===t&&(Wr===4||Wr===3&&(mi&130023424)===mi&&500>Mr()-e2?oh(n,0):$C|=t),Es(n,e)}function zF(n,e){e===0&&(n.mode&1?(e=ix,ix<<=1,!(ix&130023424)&&(ix=4194304)):e=1);var t=rs();n=zl(n,e),n!==null&&(Ov(n,e,t),Es(n,t))}function d6(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),zF(n,t)}function p6(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(lt(314))}r!==null&&r.delete(e),zF(n,t)}var HF;HF=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||_s.current)As=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return As=!1,t6(n,e,t);As=!!(n.flags&131072)}else As=!1,er&&e.flags&1048576&&JU(e,TA,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;G1(n,e),n=e.pendingProps;var i=hm(e,Fi.current);cp(e,t),i=KC(null,e,r,n,i,t);var s=QC();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ws(r)?(s=!0,bA(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,HC(e),i.updater=S_,e.stateNode=i,i._reactInternals=e,rM(e,r,n,t),e=oM(null,e,r,!0,s,t)):(e.tag=0,er&&s&&DC(e),Yi(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(G1(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=g6(r),n=Uo(r,n),i){case 0:e=sM(null,e,r,n,t);break e;case 1:e=xI(null,e,r,n,t);break e;case 11:e=vI(null,e,r,n,t);break e;case 14:e=yI(null,e,r,Uo(r.type,n),t);break e}throw Error(lt(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Uo(r,i),sM(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Uo(r,i),xI(n,e,r,i,t);case 3:e:{if(bF(e),n===null)throw Error(lt(387));r=e.pendingProps,s=e.memoizedState,i=s.element,qU(n,e),BA(e,r,null,t);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=gm(Error(lt(423)),e),e=AI(n,e,r,t,i);break e}else if(r!==i){i=gm(Error(lt(424)),e),e=AI(n,e,r,t,i);break e}else for(Ws=eu(e.stateNode.containerInfo.firstChild),Xs=e,er=!0,Qo=null,t=YU(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(dm(),r===i){e=Hl(n,e,t);break e}Yi(n,e,r,t)}e=e.child}return e;case 5:return $U(e),n===null&&eM(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,o=i.children,jb(r,i)?o=null:s!==null&&jb(r,s)&&(e.flags|=32),SF(n,e),Yi(n,e,o,t),e.child;case 6:return n===null&&eM(e),null;case 13:return MF(n,e,t);case 4:return VC(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=pm(e,null,r,t):Yi(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Uo(r,i),vI(n,e,r,i,t);case 7:return Yi(n,e,e.pendingProps,t),e.child;case 8:return Yi(n,e,e.pendingProps.children,t),e.child;case 12:return Yi(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Wn(CA,r._currentValue),r._currentValue=o,s!==null)if(ia(s.value,o)){if(s.children===i.children&&!_s.current){e=Hl(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Ll(-1,t&-t),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),tM(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(lt(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),tM(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Yi(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,cp(e,t),i=Eo(i),r=r(i),e.flags|=1,Yi(n,e,r,t),e.child;case 14:return r=e.type,i=Uo(r,e.pendingProps),i=Uo(r.type,i),yI(n,e,r,i,t);case 15:return wF(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Uo(r,i),G1(n,e),e.tag=1,ws(r)?(n=!0,bA(e)):n=!1,cp(e,t),xF(e,r,i),rM(e,r,i,t),oM(null,e,r,!0,n,t);case 19:return TF(n,e,t);case 22:return EF(n,e,t)}throw Error(lt(156,e.tag))};function VF(n,e){return gU(n,e)}function m6(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _o(n,e,t,r){return new m6(n,e,t,r)}function i2(n){return n=n.prototype,!(!n||!n.isReactComponent)}function g6(n){if(typeof n=="function")return i2(n)?1:0;if(n!=null){if(n=n.$$typeof,n===EC)return 11;if(n===SC)return 14}return 2}function iu(n,e){var t=n.alternate;return t===null?(t=_o(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function V1(n,e,t,r,i,s){var o=2;if(r=n,typeof n=="function")i2(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Dd:return ah(t.children,i,s,e);case wC:o=8,i|=8;break;case Tb:return n=_o(12,t,e,i|2),n.elementType=Tb,n.lanes=s,n;case Cb:return n=_o(13,t,e,i),n.elementType=Cb,n.lanes=s,n;case Rb:return n=_o(19,t,e,i),n.elementType=Rb,n.lanes=s,n;case $D:return T_(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case ZD:o=10;break e;case qD:o=9;break e;case EC:o=11;break e;case SC:o=14;break e;case Ec:o=16,r=null;break e}throw Error(lt(130,n==null?n:typeof n,""))}return e=_o(o,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function ah(n,e,t,r){return n=_o(7,n,r,e),n.lanes=t,n}function T_(n,e,t,r){return n=_o(22,n,r,e),n.elementType=$D,n.lanes=t,n.stateNode={isHidden:!1},n}function jE(n,e,t){return n=_o(6,n,null,e),n.lanes=t,n}function YE(n,e,t){return e=_o(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function v6(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=BE(0),this.expirationTimes=BE(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=BE(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function s2(n,e,t,r,i,s,o,a,l){return n=new v6(n,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=_o(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},HC(s),n}function y6(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Nd,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function WF(n){if(!n)return du;n=n._reactInternals;e:{if(Rh(n)!==n||n.tag!==1)throw Error(lt(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ws(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(lt(171))}if(n.tag===1){var t=n.type;if(ws(t))return WU(n,t,e)}return e}function XF(n,e,t,r,i,s,o,a,l){return n=s2(t,r,!0,n,i,s,o,a,l),n.context=WF(null),t=n.current,r=rs(),i=ru(t),s=Ll(r,i),s.callback=e??null,tu(t,s,i),n.current.lanes=i,Ov(n,i,r),Es(n,r),n}function C_(n,e,t,r){var i=e.current,s=rs(),o=ru(i);return t=WF(t),e.context===null?e.context=t:e.pendingContext=t,e=Ll(s,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=tu(i,e,o),n!==null&&(ta(n,i,o,s),F1(n,i,o)),o}function OA(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function BI(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function o2(n,e){BI(n,e),(n=n.alternate)&&BI(n,e)}function x6(){return null}var JF=typeof reportError=="function"?reportError:function(n){console.error(n)};function a2(n){this._internalRoot=n}R_.prototype.render=a2.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(lt(409));C_(n,e,null,null)};R_.prototype.unmount=a2.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;xh(function(){C_(null,n,null,null)}),e[Gl]=null}};function R_(n){this._internalRoot=n}R_.prototype.unstable_scheduleHydration=function(n){if(n){var e=EU();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Tc.length&&e!==0&&e<Tc[t].priority;t++);Tc.splice(t,0,n),t===0&&bU(n)}};function l2(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function B_(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function PI(){}function A6(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=OA(o);s.call(c)}}var o=XF(e,r,n,0,null,!1,!1,"",PI);return n._reactRootContainer=o,n[Gl]=o.current,L0(n.nodeType===8?n.parentNode:n),xh(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=OA(l);a.call(c)}}var l=s2(n,0,!1,null,null,!1,!1,"",PI);return n._reactRootContainer=l,n[Gl]=l.current,L0(n.nodeType===8?n.parentNode:n),xh(function(){C_(e,l,t,r)}),l}function P_(n,e,t,r,i){var s=t._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=OA(o);a.call(l)}}C_(e,o,n,i)}else o=A6(t,e,n,i,r);return OA(o)}_U=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Zg(e.pendingLanes);t!==0&&(TC(e,t|1),Es(e,Mr()),!(En&6)&&(vm=Mr()+500,Mu()))}break;case 13:xh(function(){var r=zl(n,1);if(r!==null){var i=rs();ta(r,n,1,i)}}),o2(n,1)}};CC=function(n){if(n.tag===13){var e=zl(n,134217728);if(e!==null){var t=rs();ta(e,n,134217728,t)}o2(n,134217728)}};wU=function(n){if(n.tag===13){var e=ru(n),t=zl(n,e);if(t!==null){var r=rs();ta(t,n,e,r)}o2(n,e)}};EU=function(){return In};SU=function(n,e){var t=In;try{return In=n,e()}finally{In=t}};kb=function(n,e,t){switch(e){case"input":if(Ib(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=__(r);if(!i)throw Error(lt(90));tU(r),Ib(r,i)}}}break;case"textarea":rU(n,t);break;case"select":e=t.value,e!=null&&sp(n,!!t.multiple,e,!1)}};uU=t2;fU=xh;var _6={usingClientEntryPoint:!1,Events:[Gv,kd,__,lU,cU,t2]},wg={findFiberByHostInstance:Sf,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},w6={bundleType:wg.bundleType,version:wg.version,rendererPackageName:wg.rendererPackageName,rendererConfig:wg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ql.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=pU(n),n===null?null:n.stateNode},findFiberByHostInstance:wg.findFiberByHostInstance||x6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mx.isDisabled&&mx.supportsFiber)try{v_=mx.inject(w6),Fa=mx}catch{}}Qs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_6;Qs.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!l2(e))throw Error(lt(200));return y6(n,e,null,t)};Qs.createRoot=function(n,e){if(!l2(n))throw Error(lt(299));var t=!1,r="",i=JF;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=s2(n,1,!1,null,null,t,!1,r,i),n[Gl]=e.current,L0(n.nodeType===8?n.parentNode:n),new a2(e)};Qs.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(lt(188)):(n=Object.keys(n).join(","),Error(lt(268,n)));return n=pU(e),n=n===null?null:n.stateNode,n};Qs.flushSync=function(n){return xh(n)};Qs.hydrate=function(n,e,t){if(!B_(e))throw Error(lt(200));return P_(null,n,e,!0,t)};Qs.hydrateRoot=function(n,e,t){if(!l2(n))throw Error(lt(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",o=JF;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=XF(e,null,n,1,t??null,i,!1,s,o),n[Gl]=e.current,L0(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new R_(e)};Qs.render=function(n,e,t){if(!B_(e))throw Error(lt(200));return P_(null,n,e,!1,t)};Qs.unmountComponentAtNode=function(n){if(!B_(n))throw Error(lt(40));return n._reactRootContainer?(xh(function(){P_(null,null,n,!1,function(){n._reactRootContainer=null,n[Gl]=null})}),!0):!1};Qs.unstable_batchedUpdates=t2;Qs.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!B_(t))throw Error(lt(200));if(n==null||n._reactInternals===void 0)throw Error(lt(38));return P_(n,e,t,!1,r)};Qs.version="18.3.1-next-f1338f8080-20240426";function KF(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(KF)}catch(n){console.error(n)}}KF(),KD.exports=Qs;var QF=KD.exports,II=QF;bb.createRoot=II.createRoot,bb.hydrateRoot=II.hydrateRoot;/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Bh="160",hf={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},df={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},jF=0,yM=1,YF=2,E6=3,ZF=0,I_=1,m0=2,Fo=3,sa=0,Xr=1,di=2,S6=2,gi=0,lh=1,xM=2,AM=3,_M=4,qF=5,Rc=100,$F=101,eO=102,wM=103,EM=104,tO=200,nO=201,rO=202,iO=203,kA=204,GA=205,sO=206,oO=207,aO=208,lO=209,cO=210,uO=211,fO=212,hO=213,dO=214,pO=0,c2=1,mO=2,H0=3,gO=4,vO=5,yO=6,xO=7,Hv=0,AO=1,_O=2,na=0,wO=1,EO=2,SO=3,u2=4,bO=5,MO=6,SM="attached",TO="detached",pu=300,za=301,mu=302,ym=303,V0=304,Um=306,gu=1e3,Qn=1001,xm=1002,Vn=1003,W0=1004,b6=1004,fp=1005,M6=1005,un=1006,L_=1007,T6=1007,Ha=1008,bM=1008,Gr=1009,f2=1010,h2=1011,N_=1012,D_=1013,qo=1014,Cr=1015,Jr=1016,d2=1017,p2=1018,Nl=1020,CO=1021,Ur=1023,RO=1024,BO=1025,su=1026,vu=1027,m2=1028,g2=1029,PO=1030,v2=1031,y2=1033,W1=33776,X1=33777,J1=33778,K1=33779,MM=35840,TM=35841,CM=35842,RM=35843,x2=36196,BM=37492,PM=37496,IM=37808,LM=37809,NM=37810,DM=37811,UM=37812,FM=37813,OM=37814,kM=37815,GM=37816,zM=37817,HM=37818,VM=37819,WM=37820,XM=37821,Q1=36492,JM=36494,KM=36495,IO=36283,QM=36284,jM=36285,YM=36286,A2=2200,LO=2201,NO=2202,Am=2300,Ah=2301,j1=2302,Tf=2400,Cf=2401,X0=2402,U_=2500,_2=2501,DO=0,w2=1,zA=2,E2=3e3,ou=3001,Tu=3200,S2=3201,Cu=0,UO=1,qi="",mn="srgb",is="srgb-linear",F_="display-p3",Vv="display-p3-linear",J0="linear",Hn="srgb",K0="rec709",Q0="p3",C6=0,pf=7680,R6=7681,B6=7682,P6=7683,I6=34055,L6=34056,N6=5386,D6=512,U6=513,F6=514,O6=515,k6=516,G6=517,z6=518,ZM=519,FO=512,OO=513,kO=514,b2=515,GO=516,zO=517,HO=518,VO=519,j0=35044,qM=35048,H6=35040,V6=35045,W6=35049,X6=35041,J6=35046,K6=35050,Q6=35042,j6="100",$M="300 es",HA=1035,$o=2e3,_m=2001;let bo=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}};const Ti=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let LI=1234567;const ch=Math.PI/180,wm=180/Math.PI;function Js(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Ti[n&255]+Ti[n>>8&255]+Ti[n>>16&255]+Ti[n>>24&255]+"-"+Ti[e&255]+Ti[e>>8&255]+"-"+Ti[e>>16&15|64]+Ti[e>>24&255]+"-"+Ti[t&63|128]+Ti[t>>8&255]+"-"+Ti[t>>16&255]+Ti[t>>24&255]+Ti[r&255]+Ti[r>>8&255]+Ti[r>>16&255]+Ti[r>>24&255]).toLowerCase()}function yr(n,e,t){return Math.max(e,Math.min(t,n))}function M2(n,e){return(n%e+e)%e}function Y6(n,e,t,r,i){return r+(n-e)*(i-r)/(t-e)}function Z6(n,e,t){return n!==e?(t-n)/(e-n):0}function g0(n,e,t){return(1-t)*n+t*e}function q6(n,e,t,r){return g0(n,e,1-Math.exp(-t*r))}function $6(n,e=1){return e-Math.abs(M2(n,e*2)-e)}function e9(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function t9(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function n9(n,e){return n+Math.floor(Math.random()*(e-n+1))}function r9(n,e){return n+Math.random()*(e-n)}function i9(n){return n*(.5-Math.random())}function s9(n){n!==void 0&&(LI=n);let e=LI+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function o9(n){return n*ch}function a9(n){return n*wm}function eT(n){return(n&n-1)===0&&n!==0}function l9(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function VA(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function c9(n,e,t,r,i){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+r)/2),u=o((e+r)/2),f=s((e-r)/2),d=o((e-r)/2),m=s((r-e)/2),g=o((r-e)/2);switch(i){case"XYX":n.set(a*u,l*f,l*d,a*c);break;case"YZY":n.set(l*d,a*u,l*f,a*c);break;case"ZXZ":n.set(l*f,l*d,a*u,a*c);break;case"XZX":n.set(a*u,l*g,l*m,a*c);break;case"YXY":n.set(l*m,a*u,l*g,a*c);break;case"ZYZ":n.set(l*g,l*m,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function xs(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function nn(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const Jd={DEG2RAD:ch,RAD2DEG:wm,generateUUID:Js,clamp:yr,euclideanModulo:M2,mapLinear:Y6,inverseLerp:Z6,lerp:g0,damp:q6,pingpong:$6,smoothstep:e9,smootherstep:t9,randInt:n9,randFloat:r9,randFloatSpread:i9,seededRandom:s9,degToRad:o9,radToDeg:a9,isPowerOfTwo:eT,ceilPowerOfTwo:l9,floorPowerOfTwo:VA,setQuaternionFromProperEuler:c9,normalize:nn,denormalize:xs};class Ge{constructor(e=0,t=0){Ge.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(yr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*r-o*i+e.x,this.y=s*i+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class tn{constructor(e,t,r,i,s,o,a,l,c){tn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,o,a,l,c)}set(e,t,r,i,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=i,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=r,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[3],l=r[6],c=r[1],u=r[4],f=r[7],d=r[2],m=r[5],g=r[8],y=i[0],x=i[3],v=i[6],A=i[1],w=i[4],S=i[7],M=i[2],b=i[5],R=i[8];return s[0]=o*y+a*A+l*M,s[3]=o*x+a*w+l*b,s[6]=o*v+a*S+l*R,s[1]=c*y+u*A+f*M,s[4]=c*x+u*w+f*b,s[7]=c*v+u*S+f*R,s[2]=d*y+m*A+g*M,s[5]=d*x+m*w+g*b,s[8]=d*v+m*S+g*R,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-r*s*u+r*a*l+i*s*c-i*o*l}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],f=u*o-a*c,d=a*l-u*s,m=c*s-o*l,g=t*f+r*d+i*m;if(g===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/g;return e[0]=f*y,e[1]=(i*c-u*r)*y,e[2]=(a*r-i*o)*y,e[3]=d*y,e[4]=(u*t-i*l)*y,e[5]=(i*s-a*t)*y,e[6]=m*y,e[7]=(r*l-c*t)*y,e[8]=(o*t-r*s)*y,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(r*l,r*c,-r*(l*o+c*a)+o+e,-i*c,i*l,-i*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(ZE.makeScale(e,t)),this}rotate(e){return this.premultiply(ZE.makeRotation(-e)),this}translate(e,t){return this.premultiply(ZE.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const ZE=new tn;function WO(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const u9={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Kd(n,e){return new u9[n](e)}function Y0(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function XO(){const n=Y0("canvas");return n.style.display="block",n}const NI={};function v0(n){n in NI||(NI[n]=!0,console.warn(n))}const DI=new tn().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),UI=new tn().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),gx={[is]:{transfer:J0,primaries:K0,toReference:n=>n,fromReference:n=>n},[mn]:{transfer:Hn,primaries:K0,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[Vv]:{transfer:J0,primaries:Q0,toReference:n=>n.applyMatrix3(UI),fromReference:n=>n.applyMatrix3(DI)},[F_]:{transfer:Hn,primaries:Q0,toReference:n=>n.convertSRGBToLinear().applyMatrix3(UI),fromReference:n=>n.applyMatrix3(DI).convertLinearToSRGB()}},f9=new Set([is,Vv]),Pn={enabled:!0,_workingColorSpace:is,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!f9.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const r=gx[e].toReference,i=gx[t].fromReference;return i(r(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return gx[n].primaries},getTransfer:function(n){return n===qi?J0:gx[n].transfer}};function hp(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function qE(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let ed;class T2{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{ed===void 0&&(ed=Y0("canvas")),ed.width=e.width,ed.height=e.height;const r=ed.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=ed}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Y0("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let o=0;o<s.length;o++)s[o]=hp(s[o]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(hp(t[r]/255)*255):t[r]=hp(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let h9=0;class Rf{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:h9++}),this.uuid=Js(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let o=0,a=i.length;o<a;o++)i[o].isDataTexture?s.push($E(i[o].image)):s.push($E(i[o]))}else s=$E(i);r.url=s}return t||(e.images[this.uuid]=r),r}}function $E(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?T2.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let d9=0;class Sn extends bo{constructor(e=Sn.DEFAULT_IMAGE,t=Sn.DEFAULT_MAPPING,r=Qn,i=Qn,s=un,o=Ha,a=Ur,l=Gr,c=Sn.DEFAULT_ANISOTROPY,u=qi){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:d9++}),this.uuid=Js(),this.name="",this.source=new Rf(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Ge(0,0),this.repeat=new Ge(1,1),this.center=new Ge(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new tn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof u=="string"?this.colorSpace=u:(v0("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=u===ou?mn:qi),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==pu)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case gu:e.x=e.x-Math.floor(e.x);break;case Qn:e.x=e.x<0?0:1;break;case xm:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case gu:e.y=e.y-Math.floor(e.y);break;case Qn:e.y=e.y<0?0:1;break;case xm:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return v0("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===mn?ou:E2}set encoding(e){v0("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===ou?mn:qi}}Sn.DEFAULT_IMAGE=null;Sn.DEFAULT_MAPPING=pu;Sn.DEFAULT_ANISOTROPY=1;class wn{constructor(e=0,t=0,r=0,i=1){wn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*i+o[12]*s,this.y=o[1]*t+o[5]*r+o[9]*i+o[13]*s,this.z=o[2]*t+o[6]*r+o[10]*i+o[14]*s,this.w=o[3]*t+o[7]*r+o[11]*i+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const l=e.elements,c=l[0],u=l[4],f=l[8],d=l[1],m=l[5],g=l[9],y=l[2],x=l[6],v=l[10];if(Math.abs(u-d)<.01&&Math.abs(f-y)<.01&&Math.abs(g-x)<.01){if(Math.abs(u+d)<.1&&Math.abs(f+y)<.1&&Math.abs(g+x)<.1&&Math.abs(c+m+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const w=(c+1)/2,S=(m+1)/2,M=(v+1)/2,b=(u+d)/4,R=(f+y)/4,P=(g+x)/4;return w>S&&w>M?w<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(w),i=b/r,s=R/r):S>M?S<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(S),r=b/i,s=P/i):M<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(M),r=R/s,i=P/s),this.set(r,i,s,t),this}let A=Math.sqrt((x-g)*(x-g)+(f-y)*(f-y)+(d-u)*(d-u));return Math.abs(A)<.001&&(A=1),this.x=(x-g)/A,this.y=(f-y)/A,this.z=(d-u)/A,this.w=Math.acos((c+m+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class JO extends bo{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new wn(0,0,e,t),this.scissorTest=!1,this.viewport=new wn(0,0,e,t);const i={width:e,height:t,depth:1};r.encoding!==void 0&&(v0("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===ou?mn:qi),r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:un,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},r),this.texture=new Sn(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps,this.texture.internalFormat=r.internalFormat,this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Rf(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class hr extends JO{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class O_ extends Sn{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Vn,this.minFilter=Vn,this.wrapR=Qn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class p9 extends hr{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new O_(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class C2 extends Sn{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Vn,this.minFilter=Vn,this.wrapR=Qn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class m9 extends hr{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new C2(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class g9 extends hr{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<r;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,s=this.texture.length;i<s;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class Rr{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,o,a){let l=r[i+0],c=r[i+1],u=r[i+2],f=r[i+3];const d=s[o+0],m=s[o+1],g=s[o+2],y=s[o+3];if(a===0){e[t+0]=l,e[t+1]=c,e[t+2]=u,e[t+3]=f;return}if(a===1){e[t+0]=d,e[t+1]=m,e[t+2]=g,e[t+3]=y;return}if(f!==y||l!==d||c!==m||u!==g){let x=1-a;const v=l*d+c*m+u*g+f*y,A=v>=0?1:-1,w=1-v*v;if(w>Number.EPSILON){const M=Math.sqrt(w),b=Math.atan2(M,v*A);x=Math.sin(x*b)/M,a=Math.sin(a*b)/M}const S=a*A;if(l=l*x+d*S,c=c*x+m*S,u=u*x+g*S,f=f*x+y*S,x===1-a){const M=1/Math.sqrt(l*l+c*c+u*u+f*f);l*=M,c*=M,u*=M,f*=M}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=f}static multiplyQuaternionsFlat(e,t,r,i,s,o){const a=r[i],l=r[i+1],c=r[i+2],u=r[i+3],f=s[o],d=s[o+1],m=s[o+2],g=s[o+3];return e[t]=a*g+u*f+l*m-c*d,e[t+1]=l*g+u*d+c*f-a*m,e[t+2]=c*g+u*m+a*d-l*f,e[t+3]=u*g-a*f-l*d-c*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,i=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(r/2),u=a(i/2),f=a(s/2),d=l(r/2),m=l(i/2),g=l(s/2);switch(o){case"XYZ":this._x=d*u*f+c*m*g,this._y=c*m*f-d*u*g,this._z=c*u*g+d*m*f,this._w=c*u*f-d*m*g;break;case"YXZ":this._x=d*u*f+c*m*g,this._y=c*m*f-d*u*g,this._z=c*u*g-d*m*f,this._w=c*u*f+d*m*g;break;case"ZXY":this._x=d*u*f-c*m*g,this._y=c*m*f+d*u*g,this._z=c*u*g+d*m*f,this._w=c*u*f-d*m*g;break;case"ZYX":this._x=d*u*f-c*m*g,this._y=c*m*f+d*u*g,this._z=c*u*g-d*m*f,this._w=c*u*f+d*m*g;break;case"YZX":this._x=d*u*f+c*m*g,this._y=c*m*f+d*u*g,this._z=c*u*g-d*m*f,this._w=c*u*f-d*m*g;break;case"XZY":this._x=d*u*f-c*m*g,this._y=c*m*f-d*u*g,this._z=c*u*g+d*m*f,this._w=c*u*f+d*m*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],f=t[10],d=r+a+f;if(d>0){const m=.5/Math.sqrt(d+1);this._w=.25/m,this._x=(u-l)*m,this._y=(s-c)*m,this._z=(o-i)*m}else if(r>a&&r>f){const m=2*Math.sqrt(1+r-a-f);this._w=(u-l)/m,this._x=.25*m,this._y=(i+o)/m,this._z=(s+c)/m}else if(a>f){const m=2*Math.sqrt(1+a-r-f);this._w=(s-c)/m,this._x=(i+o)/m,this._y=.25*m,this._z=(l+u)/m}else{const m=2*Math.sqrt(1+f-r-a);this._w=(o-i)/m,this._x=(s+c)/m,this._y=(l+u)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(yr(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=r*u+o*a+i*c-s*l,this._y=i*u+o*l+s*a-r*c,this._z=s*u+o*c+r*l-i*a,this._w=o*u-r*a-i*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,o=this._w;let a=o*e._w+r*e._x+i*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=r,this._y=i,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-t;return this._w=m*o+t*this._w,this._x=m*r+t*this._x,this._y=m*i+t*this._y,this._z=m*s+t*this._z,this.normalize(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),f=Math.sin((1-t)*u)/c,d=Math.sin(t*u)/c;return this._w=o*f+this._w*d,this._x=r*f+this._x*d,this._y=i*f+this._y*d,this._z=s*f+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(s),r*Math.cos(s),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Y{constructor(e=0,t=0,r=0){Y.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(FI.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(FI.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,o=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*o,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*o,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*o,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=2*(o*i-a*r),u=2*(a*t-s*i),f=2*(s*r-o*t);return this.x=t+l*c+o*f-a*u,this.y=r+l*u+a*c-s*f,this.z=i+l*f+s*u-o*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=i*l-s*a,this.y=s*o-r*l,this.z=r*a-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return eS.copy(this).projectOnVector(e),this.sub(eS)}reflect(e){return this.sub(eS.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(yr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const eS=new Y,FI=new Rr;class Br{constructor(e=new Y(1/0,1/0,1/0),t=new Y(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(Po.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(Po.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Po.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Po):Po.fromBufferAttribute(s,o),Po.applyMatrix4(e.matrixWorld),this.expandByPoint(Po);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),vx.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),vx.copy(r.boundingBox)),vx.applyMatrix4(e.matrixWorld),this.union(vx)}const i=e.children;for(let s=0,o=i.length;s<o;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Po),Po.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Eg),yx.subVectors(this.max,Eg),td.subVectors(e.a,Eg),nd.subVectors(e.b,Eg),rd.subVectors(e.c,Eg),ac.subVectors(nd,td),lc.subVectors(rd,nd),Ku.subVectors(td,rd);let t=[0,-ac.z,ac.y,0,-lc.z,lc.y,0,-Ku.z,Ku.y,ac.z,0,-ac.x,lc.z,0,-lc.x,Ku.z,0,-Ku.x,-ac.y,ac.x,0,-lc.y,lc.x,0,-Ku.y,Ku.x,0];return!tS(t,td,nd,rd,yx)||(t=[1,0,0,0,1,0,0,0,1],!tS(t,td,nd,rd,yx))?!1:(xx.crossVectors(ac,lc),t=[xx.x,xx.y,xx.z],tS(t,td,nd,rd,yx))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Po).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Po).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(tl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),tl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),tl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),tl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),tl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),tl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),tl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),tl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(tl),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const tl=[new Y,new Y,new Y,new Y,new Y,new Y,new Y,new Y],Po=new Y,vx=new Br,td=new Y,nd=new Y,rd=new Y,ac=new Y,lc=new Y,Ku=new Y,Eg=new Y,yx=new Y,xx=new Y,Qu=new Y;function tS(n,e,t,r,i){for(let s=0,o=n.length-3;s<=o;s+=3){Qu.fromArray(n,s);const a=i.x*Math.abs(Qu.x)+i.y*Math.abs(Qu.y)+i.z*Math.abs(Qu.z),l=e.dot(Qu),c=t.dot(Qu),u=r.dot(Qu);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const v9=new Br,Sg=new Y,nS=new Y;class si{constructor(e=new Y,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):v9.setFromPoints(e).getCenter(r);let i=0;for(let s=0,o=e.length;s<o;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Sg.subVectors(e,this.center);const t=Sg.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(Sg,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(nS.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Sg.copy(e.center).add(nS)),this.expandByPoint(Sg.copy(e.center).sub(nS))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const nl=new Y,rS=new Y,Ax=new Y,cc=new Y,iS=new Y,_x=new Y,sS=new Y;class Ph{constructor(e=new Y,t=new Y(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,nl)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=nl.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(nl.copy(this.origin).addScaledVector(this.direction,t),nl.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){rS.copy(e).add(t).multiplyScalar(.5),Ax.copy(t).sub(e).normalize(),cc.copy(this.origin).sub(rS);const s=e.distanceTo(t)*.5,o=-this.direction.dot(Ax),a=cc.dot(this.direction),l=-cc.dot(Ax),c=cc.lengthSq(),u=Math.abs(1-o*o);let f,d,m,g;if(u>0)if(f=o*l-a,d=o*a-l,g=s*u,f>=0)if(d>=-g)if(d<=g){const y=1/u;f*=y,d*=y,m=f*(f+o*d+2*a)+d*(o*f+d+2*l)+c}else d=s,f=Math.max(0,-(o*d+a)),m=-f*f+d*(d+2*l)+c;else d=-s,f=Math.max(0,-(o*d+a)),m=-f*f+d*(d+2*l)+c;else d<=-g?(f=Math.max(0,-(-o*s+a)),d=f>0?-s:Math.min(Math.max(-s,-l),s),m=-f*f+d*(d+2*l)+c):d<=g?(f=0,d=Math.min(Math.max(-s,-l),s),m=d*(d+2*l)+c):(f=Math.max(0,-(o*s+a)),d=f>0?s:Math.min(Math.max(-s,-l),s),m=-f*f+d*(d+2*l)+c);else d=o>0?-s:s,f=Math.max(0,-(o*d+a)),m=-f*f+d*(d+2*l)+c;return r&&r.copy(this.origin).addScaledVector(this.direction,f),i&&i.copy(rS).addScaledVector(Ax,d),m}intersectSphere(e,t){nl.subVectors(e.center,this.origin);const r=nl.dot(this.direction),i=nl.dot(nl)-r*r,s=e.radius*e.radius;if(i>s)return null;const o=Math.sqrt(s-i),a=r-o,l=r+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,f=1/this.direction.z,d=this.origin;return c>=0?(r=(e.min.x-d.x)*c,i=(e.max.x-d.x)*c):(r=(e.max.x-d.x)*c,i=(e.min.x-d.x)*c),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),r>o||s>i||((s>r||isNaN(r))&&(r=s),(o<i||isNaN(i))&&(i=o),f>=0?(a=(e.min.z-d.z)*f,l=(e.max.z-d.z)*f):(a=(e.max.z-d.z)*f,l=(e.min.z-d.z)*f),r>l||a>i)||((a>r||r!==r)&&(r=a),(l<i||i!==i)&&(i=l),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,nl)!==null}intersectTriangle(e,t,r,i,s){iS.subVectors(t,e),_x.subVectors(r,e),sS.crossVectors(iS,_x);let o=this.direction.dot(sS),a;if(o>0){if(i)return null;a=1}else if(o<0)a=-1,o=-o;else return null;cc.subVectors(this.origin,e);const l=a*this.direction.dot(_x.crossVectors(cc,_x));if(l<0)return null;const c=a*this.direction.dot(iS.cross(cc));if(c<0||l+c>o)return null;const u=-a*cc.dot(sS);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Bt{constructor(e,t,r,i,s,o,a,l,c,u,f,d,m,g,y,x){Bt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,o,a,l,c,u,f,d,m,g,y,x)}set(e,t,r,i,s,o,a,l,c,u,f,d,m,g,y,x){const v=this.elements;return v[0]=e,v[4]=t,v[8]=r,v[12]=i,v[1]=s,v[5]=o,v[9]=a,v[13]=l,v[2]=c,v[6]=u,v[10]=f,v[14]=d,v[3]=m,v[7]=g,v[11]=y,v[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Bt().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/id.setFromMatrixColumn(e,0).length(),s=1/id.setFromMatrixColumn(e,1).length(),o=1/id.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,o=Math.cos(r),a=Math.sin(r),l=Math.cos(i),c=Math.sin(i),u=Math.cos(s),f=Math.sin(s);if(e.order==="XYZ"){const d=o*u,m=o*f,g=a*u,y=a*f;t[0]=l*u,t[4]=-l*f,t[8]=c,t[1]=m+g*c,t[5]=d-y*c,t[9]=-a*l,t[2]=y-d*c,t[6]=g+m*c,t[10]=o*l}else if(e.order==="YXZ"){const d=l*u,m=l*f,g=c*u,y=c*f;t[0]=d+y*a,t[4]=g*a-m,t[8]=o*c,t[1]=o*f,t[5]=o*u,t[9]=-a,t[2]=m*a-g,t[6]=y+d*a,t[10]=o*l}else if(e.order==="ZXY"){const d=l*u,m=l*f,g=c*u,y=c*f;t[0]=d-y*a,t[4]=-o*f,t[8]=g+m*a,t[1]=m+g*a,t[5]=o*u,t[9]=y-d*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const d=o*u,m=o*f,g=a*u,y=a*f;t[0]=l*u,t[4]=g*c-m,t[8]=d*c+y,t[1]=l*f,t[5]=y*c+d,t[9]=m*c-g,t[2]=-c,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const d=o*l,m=o*c,g=a*l,y=a*c;t[0]=l*u,t[4]=y-d*f,t[8]=g*f+m,t[1]=f,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=m*f+g,t[10]=d-y*f}else if(e.order==="XZY"){const d=o*l,m=o*c,g=a*l,y=a*c;t[0]=l*u,t[4]=-f,t[8]=c*u,t[1]=d*f+y,t[5]=o*u,t[9]=m*f-g,t[2]=g*f-m,t[6]=a*u,t[10]=y*f+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(y9,e,x9)}lookAt(e,t,r){const i=this.elements;return Ds.subVectors(e,t),Ds.lengthSq()===0&&(Ds.z=1),Ds.normalize(),uc.crossVectors(r,Ds),uc.lengthSq()===0&&(Math.abs(r.z)===1?Ds.x+=1e-4:Ds.z+=1e-4,Ds.normalize(),uc.crossVectors(r,Ds)),uc.normalize(),wx.crossVectors(Ds,uc),i[0]=uc.x,i[4]=wx.x,i[8]=Ds.x,i[1]=uc.y,i[5]=wx.y,i[9]=Ds.y,i[2]=uc.z,i[6]=wx.z,i[10]=Ds.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],a=r[4],l=r[8],c=r[12],u=r[1],f=r[5],d=r[9],m=r[13],g=r[2],y=r[6],x=r[10],v=r[14],A=r[3],w=r[7],S=r[11],M=r[15],b=i[0],R=i[4],P=i[8],C=i[12],B=i[1],H=i[5],k=i[9],$=i[13],U=i[2],z=i[6],O=i[10],ie=i[14],X=i[3],K=i[7],W=i[11],V=i[15];return s[0]=o*b+a*B+l*U+c*X,s[4]=o*R+a*H+l*z+c*K,s[8]=o*P+a*k+l*O+c*W,s[12]=o*C+a*$+l*ie+c*V,s[1]=u*b+f*B+d*U+m*X,s[5]=u*R+f*H+d*z+m*K,s[9]=u*P+f*k+d*O+m*W,s[13]=u*C+f*$+d*ie+m*V,s[2]=g*b+y*B+x*U+v*X,s[6]=g*R+y*H+x*z+v*K,s[10]=g*P+y*k+x*O+v*W,s[14]=g*C+y*$+x*ie+v*V,s[3]=A*b+w*B+S*U+M*X,s[7]=A*R+w*H+S*z+M*K,s[11]=A*P+w*k+S*O+M*W,s[15]=A*C+w*$+S*ie+M*V,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],f=e[6],d=e[10],m=e[14],g=e[3],y=e[7],x=e[11],v=e[15];return g*(+s*l*f-i*c*f-s*a*d+r*c*d+i*a*m-r*l*m)+y*(+t*l*m-t*c*d+s*o*d-i*o*m+i*c*u-s*l*u)+x*(+t*c*f-t*a*m-s*o*f+r*o*m+s*a*u-r*c*u)+v*(-i*a*u-t*l*f+t*a*d+i*o*f-r*o*d+r*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],f=e[9],d=e[10],m=e[11],g=e[12],y=e[13],x=e[14],v=e[15],A=f*x*c-y*d*c+y*l*m-a*x*m-f*l*v+a*d*v,w=g*d*c-u*x*c-g*l*m+o*x*m+u*l*v-o*d*v,S=u*y*c-g*f*c+g*a*m-o*y*m-u*a*v+o*f*v,M=g*f*l-u*y*l-g*a*d+o*y*d+u*a*x-o*f*x,b=t*A+r*w+i*S+s*M;if(b===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const R=1/b;return e[0]=A*R,e[1]=(y*d*s-f*x*s-y*i*m+r*x*m+f*i*v-r*d*v)*R,e[2]=(a*x*s-y*l*s+y*i*c-r*x*c-a*i*v+r*l*v)*R,e[3]=(f*l*s-a*d*s-f*i*c+r*d*c+a*i*m-r*l*m)*R,e[4]=w*R,e[5]=(u*x*s-g*d*s+g*i*m-t*x*m-u*i*v+t*d*v)*R,e[6]=(g*l*s-o*x*s-g*i*c+t*x*c+o*i*v-t*l*v)*R,e[7]=(o*d*s-u*l*s+u*i*c-t*d*c-o*i*m+t*l*m)*R,e[8]=S*R,e[9]=(g*f*s-u*y*s-g*r*m+t*y*m+u*r*v-t*f*v)*R,e[10]=(o*y*s-g*a*s+g*r*c-t*y*c-o*r*v+t*a*v)*R,e[11]=(u*a*s-o*f*s-u*r*c+t*f*c+o*r*m-t*a*m)*R,e[12]=M*R,e[13]=(u*y*i-g*f*i+g*r*d-t*y*d-u*r*x+t*f*x)*R,e[14]=(g*a*i-o*y*i-g*r*l+t*y*l+o*r*x-t*a*x)*R,e[15]=(o*f*i-u*a*i+u*r*l-t*f*l-o*r*d+t*a*d)*R,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+r,c*a-i*l,c*l+i*a,0,c*a+i*l,u*a+r,u*l-i*o,0,c*l-i*a,u*l+i*o,s*l*l+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,o){return this.set(1,r,s,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,f=a+a,d=s*c,m=s*u,g=s*f,y=o*u,x=o*f,v=a*f,A=l*c,w=l*u,S=l*f,M=r.x,b=r.y,R=r.z;return i[0]=(1-(y+v))*M,i[1]=(m+S)*M,i[2]=(g-w)*M,i[3]=0,i[4]=(m-S)*b,i[5]=(1-(d+v))*b,i[6]=(x+A)*b,i[7]=0,i[8]=(g+w)*R,i[9]=(x-A)*R,i[10]=(1-(d+y))*R,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let s=id.set(i[0],i[1],i[2]).length();const o=id.set(i[4],i[5],i[6]).length(),a=id.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],Io.copy(this);const c=1/s,u=1/o,f=1/a;return Io.elements[0]*=c,Io.elements[1]*=c,Io.elements[2]*=c,Io.elements[4]*=u,Io.elements[5]*=u,Io.elements[6]*=u,Io.elements[8]*=f,Io.elements[9]*=f,Io.elements[10]*=f,t.setFromRotationMatrix(Io),r.x=s,r.y=o,r.z=a,this}makePerspective(e,t,r,i,s,o,a=$o){const l=this.elements,c=2*s/(t-e),u=2*s/(r-i),f=(t+e)/(t-e),d=(r+i)/(r-i);let m,g;if(a===$o)m=-(o+s)/(o-s),g=-2*o*s/(o-s);else if(a===_m)m=-o/(o-s),g=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=c,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=u,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=g,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,r,i,s,o,a=$o){const l=this.elements,c=1/(t-e),u=1/(r-i),f=1/(o-s),d=(t+e)*c,m=(r+i)*u;let g,y;if(a===$o)g=(o+s)*f,y=-2*f;else if(a===_m)g=s*f,y=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=y,l[14]=-g,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const id=new Y,Io=new Bt,y9=new Y(0,0,0),x9=new Y(1,1,1),uc=new Y,wx=new Y,Ds=new Y,OI=new Bt,kI=new Rr;class Wv{constructor(e=0,t=0,r=0,i=Wv.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],o=i[4],a=i[8],l=i[1],c=i[5],u=i[9],f=i[2],d=i[6],m=i[10];switch(t){case"XYZ":this._y=Math.asin(yr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,m),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-yr(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-f,s),this._z=0);break;case"ZXY":this._x=Math.asin(yr(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-f,m),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-yr(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(d,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(yr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-f,s)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-yr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-u,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return OI.makeRotationFromQuaternion(e),this.setFromRotationMatrix(OI,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return kI.setFromEuler(this),this.setFromQuaternion(kI,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Wv.DEFAULT_ORDER="XYZ";class uh{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let A9=0;const GI=new Y,sd=new Rr,rl=new Bt,Ex=new Y,bg=new Y,_9=new Y,w9=new Rr,zI=new Y(1,0,0),HI=new Y(0,1,0),VI=new Y(0,0,1),E9={type:"added"},S9={type:"removed"};class gn extends bo{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:A9++}),this.uuid=Js(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=gn.DEFAULT_UP.clone();const e=new Y,t=new Wv,r=new Rr,i=new Y(1,1,1);function s(){r.setFromEuler(t,!1)}function o(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Bt},normalMatrix:{value:new tn}}),this.matrix=new Bt,this.matrixWorld=new Bt,this.matrixAutoUpdate=gn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=gn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new uh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return sd.setFromAxisAngle(e,t),this.quaternion.multiply(sd),this}rotateOnWorldAxis(e,t){return sd.setFromAxisAngle(e,t),this.quaternion.premultiply(sd),this}rotateX(e){return this.rotateOnAxis(zI,e)}rotateY(e){return this.rotateOnAxis(HI,e)}rotateZ(e){return this.rotateOnAxis(VI,e)}translateOnAxis(e,t){return GI.copy(e).applyQuaternion(this.quaternion),this.position.add(GI.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(zI,e)}translateY(e){return this.translateOnAxis(HI,e)}translateZ(e){return this.translateOnAxis(VI,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(rl.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?Ex.copy(e):Ex.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),bg.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?rl.lookAt(bg,Ex,this.up):rl.lookAt(Ex,bg,this.up),this.quaternion.setFromRotationMatrix(rl),i&&(rl.extractRotation(i.matrixWorld),sd.setFromRotationMatrix(rl),this.quaternion.premultiply(sd.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(E9)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(S9)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),rl.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),rl.multiply(e.parent.matrixWorld)),e.applyMatrix4(rl),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const o=this.children[r].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bg,e,_9),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bg,w9,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++){const s=t[r];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++){const a=i[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),i.maxGeometryCount=this._maxGeometryCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const f=l[c];s(e.shapes,f)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));i.material=a}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];i.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),f=o(e.shapes),d=o(e.skeletons),m=o(e.animations),g=o(e.nodes);a.length>0&&(r.geometries=a),l.length>0&&(r.materials=l),c.length>0&&(r.textures=c),u.length>0&&(r.images=u),f.length>0&&(r.shapes=f),d.length>0&&(r.skeletons=d),m.length>0&&(r.animations=m),g.length>0&&(r.nodes=g)}return r.object=i,r;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}gn.DEFAULT_UP=new Y(0,1,0);gn.DEFAULT_MATRIX_AUTO_UPDATE=!0;gn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Lo=new Y,il=new Y,oS=new Y,sl=new Y,od=new Y,ad=new Y,WI=new Y,aS=new Y,lS=new Y,cS=new Y;let Sx=!1;class vs{constructor(e=new Y,t=new Y,r=new Y){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),Lo.subVectors(e,t),i.cross(Lo);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){Lo.subVectors(i,t),il.subVectors(r,t),oS.subVectors(e,t);const o=Lo.dot(Lo),a=Lo.dot(il),l=Lo.dot(oS),c=il.dot(il),u=il.dot(oS),f=o*c-a*a;if(f===0)return s.set(0,0,0),null;const d=1/f,m=(c*l-a*u)*d,g=(o*u-a*l)*d;return s.set(1-m-g,g,m)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,sl)===null?!1:sl.x>=0&&sl.y>=0&&sl.x+sl.y<=1}static getUV(e,t,r,i,s,o,a,l){return Sx===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Sx=!0),this.getInterpolation(e,t,r,i,s,o,a,l)}static getInterpolation(e,t,r,i,s,o,a,l){return this.getBarycoord(e,t,r,i,sl)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,sl.x),l.addScaledVector(o,sl.y),l.addScaledVector(a,sl.z),l)}static isFrontFacing(e,t,r,i){return Lo.subVectors(r,t),il.subVectors(e,t),Lo.cross(il).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Lo.subVectors(this.c,this.b),il.subVectors(this.a,this.b),Lo.cross(il).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return vs.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return vs.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,s){return Sx===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Sx=!0),vs.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}getInterpolation(e,t,r,i,s){return vs.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return vs.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return vs.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let o,a;od.subVectors(i,r),ad.subVectors(s,r),aS.subVectors(e,r);const l=od.dot(aS),c=ad.dot(aS);if(l<=0&&c<=0)return t.copy(r);lS.subVectors(e,i);const u=od.dot(lS),f=ad.dot(lS);if(u>=0&&f<=u)return t.copy(i);const d=l*f-u*c;if(d<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(r).addScaledVector(od,o);cS.subVectors(e,s);const m=od.dot(cS),g=ad.dot(cS);if(g>=0&&m<=g)return t.copy(s);const y=m*c-l*g;if(y<=0&&c>=0&&g<=0)return a=c/(c-g),t.copy(r).addScaledVector(ad,a);const x=u*g-m*f;if(x<=0&&f-u>=0&&m-g>=0)return WI.subVectors(s,i),a=(f-u)/(f-u+(m-g)),t.copy(i).addScaledVector(WI,a);const v=1/(x+y+d);return o=y*v,a=d*v,t.copy(r).addScaledVector(od,o).addScaledVector(ad,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const KO={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},fc={h:0,s:0,l:0},bx={h:0,s:0,l:0};function uS(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class ht{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=mn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Pn.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=Pn.workingColorSpace){return this.r=e,this.g=t,this.b=r,Pn.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=Pn.workingColorSpace){if(e=M2(e,1),t=yr(t,0,1),r=yr(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,o=2*r-s;this.r=uS(o,s,e+1/3),this.g=uS(o,s,e),this.b=uS(o,s,e-1/3)}return Pn.toWorkingColorSpace(this,i),this}setStyle(e,t=mn){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=i[1],a=i[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=mn){const r=KO[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=hp(e.r),this.g=hp(e.g),this.b=hp(e.b),this}copyLinearToSRGB(e){return this.r=qE(e.r),this.g=qE(e.g),this.b=qE(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=mn){return Pn.fromWorkingColorSpace(Ci.copy(this),e),Math.round(yr(Ci.r*255,0,255))*65536+Math.round(yr(Ci.g*255,0,255))*256+Math.round(yr(Ci.b*255,0,255))}getHexString(e=mn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Pn.workingColorSpace){Pn.fromWorkingColorSpace(Ci.copy(this),t);const r=Ci.r,i=Ci.g,s=Ci.b,o=Math.max(r,i,s),a=Math.min(r,i,s);let l,c;const u=(a+o)/2;if(a===o)l=0,c=0;else{const f=o-a;switch(c=u<=.5?f/(o+a):f/(2-o-a),o){case r:l=(i-s)/f+(i<s?6:0);break;case i:l=(s-r)/f+2;break;case s:l=(r-i)/f+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=Pn.workingColorSpace){return Pn.fromWorkingColorSpace(Ci.copy(this),t),e.r=Ci.r,e.g=Ci.g,e.b=Ci.b,e}getStyle(e=mn){Pn.fromWorkingColorSpace(Ci.copy(this),e);const t=Ci.r,r=Ci.g,i=Ci.b;return e!==mn?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,t,r){return this.getHSL(fc),this.setHSL(fc.h+e,fc.s+t,fc.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(fc),e.getHSL(bx);const r=g0(fc.h,bx.h,t),i=g0(fc.s,bx.s,t),s=g0(fc.l,bx.l,t);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*r+s[6]*i,this.g=s[1]*t+s[4]*r+s[7]*i,this.b=s[2]*t+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Ci=new ht;ht.NAMES=KO;let b9=0;class ur extends bo{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:b9++}),this.uuid=Js(),this.name="",this.type="Material",this.blending=lh,this.side=sa,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=kA,this.blendDst=GA,this.blendEquation=Rc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new ht(0,0,0),this.blendAlpha=0,this.depthFunc=H0,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ZM,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=pf,this.stencilZFail=pf,this.stencilZPass=pf,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==lh&&(r.blending=this.blending),this.side!==sa&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==kA&&(r.blendSrc=this.blendSrc),this.blendDst!==GA&&(r.blendDst=this.blendDst),this.blendEquation!==Rc&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==H0&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==ZM&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==pf&&(r.stencilFail=this.stencilFail),this.stencilZFail!==pf&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==pf&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=i(e.textures),o=i(e.images);s.length>0&&(r.textures=s),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Ni extends ur{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ht(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Hv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Tl=M9();function M9(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(r[l]=0,r[l|256]=32768,i[l]=24,i[l|256]=24):c<-14?(r[l]=1024>>-c-14,r[l|256]=1024>>-c-14|32768,i[l]=-c-1,i[l|256]=-c-1):c<=15?(r[l]=c+15<<10,r[l|256]=c+15<<10|32768,i[l]=13,i[l|256]=13):c<128?(r[l]=31744,r[l|256]=64512,i[l]=24,i[l|256]=24):(r[l]=31744,r[l|256]=64512,i[l]=13,i[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;!(c&8388608);)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:o,offsetTable:a}}function hs(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=yr(n,-65504,65504),Tl.floatView[0]=n;const e=Tl.uint32View[0],t=e>>23&511;return Tl.baseTable[t]+((e&8388607)>>Tl.shiftTable[t])}function $g(n){const e=n>>10;return Tl.uint32View[0]=Tl.mantissaTable[Tl.offsetTable[e]+(n&1023)]+Tl.exponentTable[e],Tl.floatView[0]}const Bf={toHalfFloat:hs,fromHalfFloat:$g},Nr=new Y,Mx=new Ge;class vn{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=j0,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Cr,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)Mx.fromBufferAttribute(this,t),Mx.applyMatrix3(e),this.setXY(t,Mx.x,Mx.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Nr.fromBufferAttribute(this,t),Nr.applyMatrix3(e),this.setXYZ(t,Nr.x,Nr.y,Nr.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Nr.fromBufferAttribute(this,t),Nr.applyMatrix4(e),this.setXYZ(t,Nr.x,Nr.y,Nr.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Nr.fromBufferAttribute(this,t),Nr.applyNormalMatrix(e),this.setXYZ(t,Nr.x,Nr.y,Nr.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Nr.fromBufferAttribute(this,t),Nr.transformDirection(e),this.setXYZ(t,Nr.x,Nr.y,Nr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=xs(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=nn(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=xs(t,this.array)),t}setX(e,t){return this.normalized&&(t=nn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=xs(t,this.array)),t}setY(e,t){return this.normalized&&(t=nn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=xs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=nn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=xs(t,this.array)),t}setW(e,t){return this.normalized&&(t=nn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=nn(t,this.array),r=nn(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=nn(t,this.array),r=nn(r,this.array),i=nn(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=nn(t,this.array),r=nn(r,this.array),i=nn(i,this.array),s=nn(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==j0&&(e.usage=this.usage),e}}class T9 extends vn{constructor(e,t,r){super(new Int8Array(e),t,r)}}class C9 extends vn{constructor(e,t,r){super(new Uint8Array(e),t,r)}}class R9 extends vn{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}}class B9 extends vn{constructor(e,t,r){super(new Int16Array(e),t,r)}}class R2 extends vn{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class P9 extends vn{constructor(e,t,r){super(new Int32Array(e),t,r)}}class B2 extends vn{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class I9 extends vn{constructor(e,t,r){super(new Uint16Array(e),t,r),this.isFloat16BufferAttribute=!0}getX(e){let t=$g(this.array[e*this.itemSize]);return this.normalized&&(t=xs(t,this.array)),t}setX(e,t){return this.normalized&&(t=nn(t,this.array)),this.array[e*this.itemSize]=hs(t),this}getY(e){let t=$g(this.array[e*this.itemSize+1]);return this.normalized&&(t=xs(t,this.array)),t}setY(e,t){return this.normalized&&(t=nn(t,this.array)),this.array[e*this.itemSize+1]=hs(t),this}getZ(e){let t=$g(this.array[e*this.itemSize+2]);return this.normalized&&(t=xs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=nn(t,this.array)),this.array[e*this.itemSize+2]=hs(t),this}getW(e){let t=$g(this.array[e*this.itemSize+3]);return this.normalized&&(t=xs(t,this.array)),t}setW(e,t){return this.normalized&&(t=nn(t,this.array)),this.array[e*this.itemSize+3]=hs(t),this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=nn(t,this.array),r=nn(r,this.array)),this.array[e+0]=hs(t),this.array[e+1]=hs(r),this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=nn(t,this.array),r=nn(r,this.array),i=nn(i,this.array)),this.array[e+0]=hs(t),this.array[e+1]=hs(r),this.array[e+2]=hs(i),this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=nn(t,this.array),r=nn(r,this.array),i=nn(i,this.array),s=nn(s,this.array)),this.array[e+0]=hs(t),this.array[e+1]=hs(r),this.array[e+2]=hs(i),this.array[e+3]=hs(s),this}}class Rt extends vn{constructor(e,t,r){super(new Float32Array(e),t,r)}}class L9 extends vn{constructor(e,t,r){super(new Float64Array(e),t,r)}}let N9=0;const io=new Bt,fS=new gn,ld=new Y,Us=new Br,Mg=new Br,$r=new Y;class jt extends bo{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:N9++}),this.uuid=Js(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(WO(e)?B2:R2)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new tn().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return io.makeRotationFromQuaternion(e),this.applyMatrix4(io),this}rotateX(e){return io.makeRotationX(e),this.applyMatrix4(io),this}rotateY(e){return io.makeRotationY(e),this.applyMatrix4(io),this}rotateZ(e){return io.makeRotationZ(e),this.applyMatrix4(io),this}translate(e,t,r){return io.makeTranslation(e,t,r),this.applyMatrix4(io),this}scale(e,t,r){return io.makeScale(e,t,r),this.applyMatrix4(io),this}lookAt(e){return fS.lookAt(e),fS.updateMatrix(),this.applyMatrix4(fS.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ld).negate(),this.translate(ld.x,ld.y,ld.z),this}setFromPoints(e){const t=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Rt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Br);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Y(-1/0,-1/0,-1/0),new Y(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];Us.setFromBufferAttribute(s),this.morphTargetsRelative?($r.addVectors(this.boundingBox.min,Us.min),this.boundingBox.expandByPoint($r),$r.addVectors(this.boundingBox.max,Us.max),this.boundingBox.expandByPoint($r)):(this.boundingBox.expandByPoint(Us.min),this.boundingBox.expandByPoint(Us.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new si);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Y,1/0);return}if(e){const r=this.boundingSphere.center;if(Us.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];Mg.setFromBufferAttribute(a),this.morphTargetsRelative?($r.addVectors(Us.min,Mg.min),Us.expandByPoint($r),$r.addVectors(Us.max,Mg.max),Us.expandByPoint($r)):(Us.expandByPoint(Mg.min),Us.expandByPoint(Mg.max))}Us.getCenter(r);let i=0;for(let s=0,o=e.count;s<o;s++)$r.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared($r));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)$r.fromBufferAttribute(a,c),l&&(ld.fromBufferAttribute(e,c),$r.add(ld)),i=Math.max(i,r.distanceToSquared($r))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,i=t.position.array,s=t.normal.array,o=t.uv.array,a=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new vn(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let B=0;B<a;B++)c[B]=new Y,u[B]=new Y;const f=new Y,d=new Y,m=new Y,g=new Ge,y=new Ge,x=new Ge,v=new Y,A=new Y;function w(B,H,k){f.fromArray(i,B*3),d.fromArray(i,H*3),m.fromArray(i,k*3),g.fromArray(o,B*2),y.fromArray(o,H*2),x.fromArray(o,k*2),d.sub(f),m.sub(f),y.sub(g),x.sub(g);const $=1/(y.x*x.y-x.x*y.y);isFinite($)&&(v.copy(d).multiplyScalar(x.y).addScaledVector(m,-y.y).multiplyScalar($),A.copy(m).multiplyScalar(y.x).addScaledVector(d,-x.x).multiplyScalar($),c[B].add(v),c[H].add(v),c[k].add(v),u[B].add(A),u[H].add(A),u[k].add(A))}let S=this.groups;S.length===0&&(S=[{start:0,count:r.length}]);for(let B=0,H=S.length;B<H;++B){const k=S[B],$=k.start,U=k.count;for(let z=$,O=$+U;z<O;z+=3)w(r[z+0],r[z+1],r[z+2])}const M=new Y,b=new Y,R=new Y,P=new Y;function C(B){R.fromArray(s,B*3),P.copy(R);const H=c[B];M.copy(H),M.sub(R.multiplyScalar(R.dot(H))).normalize(),b.crossVectors(P,H);const $=b.dot(u[B])<0?-1:1;l[B*4]=M.x,l[B*4+1]=M.y,l[B*4+2]=M.z,l[B*4+3]=$}for(let B=0,H=S.length;B<H;++B){const k=S[B],$=k.start,U=k.count;for(let z=$,O=$+U;z<O;z+=3)C(r[z+0]),C(r[z+1]),C(r[z+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new vn(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let d=0,m=r.count;d<m;d++)r.setXYZ(d,0,0,0);const i=new Y,s=new Y,o=new Y,a=new Y,l=new Y,c=new Y,u=new Y,f=new Y;if(e)for(let d=0,m=e.count;d<m;d+=3){const g=e.getX(d+0),y=e.getX(d+1),x=e.getX(d+2);i.fromBufferAttribute(t,g),s.fromBufferAttribute(t,y),o.fromBufferAttribute(t,x),u.subVectors(o,s),f.subVectors(i,s),u.cross(f),a.fromBufferAttribute(r,g),l.fromBufferAttribute(r,y),c.fromBufferAttribute(r,x),a.add(u),l.add(u),c.add(u),r.setXYZ(g,a.x,a.y,a.z),r.setXYZ(y,l.x,l.y,l.z),r.setXYZ(x,c.x,c.y,c.z)}else for(let d=0,m=t.count;d<m;d+=3)i.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),u.subVectors(o,s),f.subVectors(i,s),u.cross(f),r.setXYZ(d+0,u.x,u.y,u.z),r.setXYZ(d+1,u.x,u.y,u.z),r.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)$r.fromBufferAttribute(e,t),$r.normalize(),e.setXYZ(t,$r.x,$r.y,$r.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,f=a.normalized,d=new c.constructor(l.length*u);let m=0,g=0;for(let y=0,x=l.length;y<x;y++){a.isInterleavedBufferAttribute?m=l[y]*a.data.stride+a.offset:m=l[y]*u;for(let v=0;v<u;v++)d[g++]=c[m++]}return new vn(d,u,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new jt,r=this.index.array,i=this.attributes;for(const a in i){const l=i[a],c=e(l,r);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,f=c.length;u<f;u++){const d=c[u],m=e(d,r);l.push(m)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const l in r){const c=r[l];e.data.attributes[l]=c.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let f=0,d=c.length;f<d;f++){const m=c[f];u.push(m.toJSON(e.data))}u.length>0&&(i[l]=u,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const i=e.attributes;for(const c in i){const u=i[c];this.setAttribute(c,u.clone(t))}const s=e.morphAttributes;for(const c in s){const u=[],f=s[c];for(let d=0,m=f.length;d<m;d++)u.push(f[d].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const f=o[c];this.addGroup(f.start,f.count,f.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const XI=new Bt,ju=new Ph,Tx=new si,JI=new Y,cd=new Y,ud=new Y,fd=new Y,hS=new Y,Cx=new Y,Rx=new Ge,Bx=new Ge,Px=new Ge,KI=new Y,QI=new Y,jI=new Y,Ix=new Y,Lx=new Y;class On extends gn{constructor(e=new jt,t=new Ni){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,o=r.morphTargetsRelative;t.fromBufferAttribute(i,e);const a=this.morphTargetInfluences;if(s&&a){Cx.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=a[l],f=s[l];u!==0&&(hS.fromBufferAttribute(f,e),o?Cx.addScaledVector(hS,u):Cx.addScaledVector(hS.sub(t),u))}t.add(Cx)}return t}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),Tx.copy(r.boundingSphere),Tx.applyMatrix4(s),ju.copy(e.ray).recast(e.near),!(Tx.containsPoint(ju.origin)===!1&&(ju.intersectSphere(Tx,JI)===null||ju.origin.distanceToSquared(JI)>(e.far-e.near)**2))&&(XI.copy(s).invert(),ju.copy(e.ray).applyMatrix4(XI),!(r.boundingBox!==null&&ju.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,ju)))}_computeIntersections(e,t,r){let i;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,f=s.attributes.normal,d=s.groups,m=s.drawRange;if(a!==null)if(Array.isArray(o))for(let g=0,y=d.length;g<y;g++){const x=d[g],v=o[x.materialIndex],A=Math.max(x.start,m.start),w=Math.min(a.count,Math.min(x.start+x.count,m.start+m.count));for(let S=A,M=w;S<M;S+=3){const b=a.getX(S),R=a.getX(S+1),P=a.getX(S+2);i=Nx(this,v,e,r,c,u,f,b,R,P),i&&(i.faceIndex=Math.floor(S/3),i.face.materialIndex=x.materialIndex,t.push(i))}}else{const g=Math.max(0,m.start),y=Math.min(a.count,m.start+m.count);for(let x=g,v=y;x<v;x+=3){const A=a.getX(x),w=a.getX(x+1),S=a.getX(x+2);i=Nx(this,o,e,r,c,u,f,A,w,S),i&&(i.faceIndex=Math.floor(x/3),t.push(i))}}else if(l!==void 0)if(Array.isArray(o))for(let g=0,y=d.length;g<y;g++){const x=d[g],v=o[x.materialIndex],A=Math.max(x.start,m.start),w=Math.min(l.count,Math.min(x.start+x.count,m.start+m.count));for(let S=A,M=w;S<M;S+=3){const b=S,R=S+1,P=S+2;i=Nx(this,v,e,r,c,u,f,b,R,P),i&&(i.faceIndex=Math.floor(S/3),i.face.materialIndex=x.materialIndex,t.push(i))}}else{const g=Math.max(0,m.start),y=Math.min(l.count,m.start+m.count);for(let x=g,v=y;x<v;x+=3){const A=x,w=x+1,S=x+2;i=Nx(this,o,e,r,c,u,f,A,w,S),i&&(i.faceIndex=Math.floor(x/3),t.push(i))}}}}function D9(n,e,t,r,i,s,o,a){let l;if(e.side===Xr?l=r.intersectTriangle(o,s,i,!0,a):l=r.intersectTriangle(i,s,o,e.side===sa,a),l===null)return null;Lx.copy(a),Lx.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(Lx);return c<t.near||c>t.far?null:{distance:c,point:Lx.clone(),object:n}}function Nx(n,e,t,r,i,s,o,a,l,c){n.getVertexPosition(a,cd),n.getVertexPosition(l,ud),n.getVertexPosition(c,fd);const u=D9(n,e,t,r,cd,ud,fd,Ix);if(u){i&&(Rx.fromBufferAttribute(i,a),Bx.fromBufferAttribute(i,l),Px.fromBufferAttribute(i,c),u.uv=vs.getInterpolation(Ix,cd,ud,fd,Rx,Bx,Px,new Ge)),s&&(Rx.fromBufferAttribute(s,a),Bx.fromBufferAttribute(s,l),Px.fromBufferAttribute(s,c),u.uv1=vs.getInterpolation(Ix,cd,ud,fd,Rx,Bx,Px,new Ge),u.uv2=u.uv1),o&&(KI.fromBufferAttribute(o,a),QI.fromBufferAttribute(o,l),jI.fromBufferAttribute(o,c),u.normal=vs.getInterpolation(Ix,cd,ud,fd,KI,QI,jI,new Y),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const f={a,b:l,c,normal:new Y,materialIndex:0};vs.getNormal(cd,ud,fd,f.normal),u.face=f}return u}class Ih extends jt{constructor(e=1,t=1,r=1,i=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:o};const a=this;i=Math.floor(i),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],f=[];let d=0,m=0;g("z","y","x",-1,-1,r,t,e,o,s,0),g("z","y","x",1,-1,r,t,-e,o,s,1),g("x","z","y",1,1,e,r,t,i,o,2),g("x","z","y",1,-1,e,r,-t,i,o,3),g("x","y","z",1,-1,e,t,r,i,s,4),g("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(l),this.setAttribute("position",new Rt(c,3)),this.setAttribute("normal",new Rt(u,3)),this.setAttribute("uv",new Rt(f,2));function g(y,x,v,A,w,S,M,b,R,P,C){const B=S/R,H=M/P,k=S/2,$=M/2,U=b/2,z=R+1,O=P+1;let ie=0,X=0;const K=new Y;for(let W=0;W<O;W++){const V=W*H-$;for(let Q=0;Q<z;Q++){const q=Q*B-k;K[y]=q*A,K[x]=V*w,K[v]=U,c.push(K.x,K.y,K.z),K[y]=0,K[x]=0,K[v]=b>0?1:-1,u.push(K.x,K.y,K.z),f.push(Q/R),f.push(1-W/P),ie+=1}}for(let W=0;W<P;W++)for(let V=0;V<R;V++){const Q=d+V+z*W,q=d+V+z*(W+1),ne=d+(V+1)+z*(W+1),fe=d+(V+1)+z*W;l.push(Q,q,fe),l.push(q,ne,fe),X+=6}a.addGroup(m,X,C),m+=X,d+=ie}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ih(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Em(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function Ji(n){const e={};for(let t=0;t<n.length;t++){const r=Em(n[t]);for(const i in r)e[i]=r[i]}return e}function U9(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function QO(n){return n.getRenderTarget()===null?n.outputColorSpace:Pn.workingColorSpace}const P2={clone:Em,merge:Ji};var F9=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,O9=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Pr extends ur{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=F9,this.fragmentShader=O9,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Em(e.uniforms),this.uniformsGroups=U9(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?t.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[i]={type:"m4",value:o.toArray()}:t.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class Xv extends gn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Bt,this.projectionMatrix=new Bt,this.projectionMatrixInverse=new Bt,this.coordinateSystem=$o}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class or extends Xv{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=wm*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(ch*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return wm*2*Math.atan(Math.tan(ch*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(ch*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*i/l,t-=o.offsetY*r/c,i*=o.width/l,r*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const hd=-90,dd=1;class jO extends gn{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new or(hd,dd,e,t);i.layers=this.layers,this.add(i);const s=new or(hd,dd,e,t);s.layers=this.layers,this.add(s);const o=new or(hd,dd,e,t);o.layers=this.layers,this.add(o);const a=new or(hd,dd,e,t);a.layers=this.layers,this.add(a);const l=new or(hd,dd,e,t);l.layers=this.layers,this.add(l);const c=new or(hd,dd,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,i,s,o,a,l]=t;for(const c of t)this.remove(c);if(e===$o)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===_m)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,c,u]=this.children,f=e.getRenderTarget(),d=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),g=e.xr.enabled;e.xr.enabled=!1;const y=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(t,s),e.setRenderTarget(r,1,i),e.render(t,o),e.setRenderTarget(r,2,i),e.render(t,a),e.setRenderTarget(r,3,i),e.render(t,l),e.setRenderTarget(r,4,i),e.render(t,c),r.texture.generateMipmaps=y,e.setRenderTarget(r,5,i),e.render(t,u),e.setRenderTarget(f,d,m),e.xr.enabled=g,r.texture.needsPMREMUpdate=!0}}class Jv extends Sn{constructor(e,t,r,i,s,o,a,l,c,u){e=e!==void 0?e:[],t=t!==void 0?t:za,super(e,t,r,i,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class I2 extends hr{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];t.encoding!==void 0&&(v0("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===ou?mn:qi),this.texture=new Jv(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:un}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new Ih(5,5,5),s=new Pr({name:"CubemapFromEquirect",uniforms:Em(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Xr,blending:gi});s.uniforms.tEquirect.value=t;const o=new On(i,s),a=t.minFilter;return t.minFilter===Ha&&(t.minFilter=un),new jO(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,r,i){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,r,i);e.setRenderTarget(s)}}const dS=new Y,k9=new Y,G9=new tn;class dl{constructor(e=new Y(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=dS.subVectors(r,t).cross(k9.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(dS),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||G9.getNormalMatrix(e),i=this.coplanarPoint(dS).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Yu=new si,Dx=new Y;class Kv{constructor(e=new dl,t=new dl,r=new dl,i=new dl,s=new dl,o=new dl){this.planes=[e,t,r,i,s,o]}set(e,t,r,i,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(i),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=$o){const r=this.planes,i=e.elements,s=i[0],o=i[1],a=i[2],l=i[3],c=i[4],u=i[5],f=i[6],d=i[7],m=i[8],g=i[9],y=i[10],x=i[11],v=i[12],A=i[13],w=i[14],S=i[15];if(r[0].setComponents(l-s,d-c,x-m,S-v).normalize(),r[1].setComponents(l+s,d+c,x+m,S+v).normalize(),r[2].setComponents(l+o,d+u,x+g,S+A).normalize(),r[3].setComponents(l-o,d-u,x-g,S-A).normalize(),r[4].setComponents(l-a,d-f,x-y,S-w).normalize(),t===$o)r[5].setComponents(l+a,d+f,x+y,S+w).normalize();else if(t===_m)r[5].setComponents(a,f,y,w).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Yu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Yu.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Yu)}intersectsSprite(e){return Yu.center.set(0,0,0),Yu.radius=.7071067811865476,Yu.applyMatrix4(e.matrixWorld),this.intersectsSphere(Yu)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(Dx.x=i.normal.x>0?e.max.x:e.min.x,Dx.y=i.normal.y>0?e.max.y:e.min.y,Dx.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Dx)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function YO(){let n=null,e=!1,t=null,r=null;function i(s,o){t(s,o),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function z9(n,e){const t=e.isWebGL2,r=new WeakMap;function i(c,u){const f=c.array,d=c.usage,m=f.byteLength,g=n.createBuffer();n.bindBuffer(u,g),n.bufferData(u,f,d),c.onUploadCallback();let y;if(f instanceof Float32Array)y=n.FLOAT;else if(f instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(t)y=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else y=n.UNSIGNED_SHORT;else if(f instanceof Int16Array)y=n.SHORT;else if(f instanceof Uint32Array)y=n.UNSIGNED_INT;else if(f instanceof Int32Array)y=n.INT;else if(f instanceof Int8Array)y=n.BYTE;else if(f instanceof Uint8Array)y=n.UNSIGNED_BYTE;else if(f instanceof Uint8ClampedArray)y=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+f);return{buffer:g,type:y,bytesPerElement:f.BYTES_PER_ELEMENT,version:c.version,size:m}}function s(c,u,f){const d=u.array,m=u._updateRange,g=u.updateRanges;if(n.bindBuffer(f,c),m.count===-1&&g.length===0&&n.bufferSubData(f,0,d),g.length!==0){for(let y=0,x=g.length;y<x;y++){const v=g[y];t?n.bufferSubData(f,v.start*d.BYTES_PER_ELEMENT,d,v.start,v.count):n.bufferSubData(f,v.start*d.BYTES_PER_ELEMENT,d.subarray(v.start,v.start+v.count))}u.clearUpdateRanges()}m.count!==-1&&(t?n.bufferSubData(f,m.offset*d.BYTES_PER_ELEMENT,d,m.offset,m.count):n.bufferSubData(f,m.offset*d.BYTES_PER_ELEMENT,d.subarray(m.offset,m.offset+m.count)),m.count=-1),u.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),r.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=r.get(c);u&&(n.deleteBuffer(u.buffer),r.delete(c))}function l(c,u){if(c.isGLBufferAttribute){const d=r.get(c);(!d||d.version<c.version)&&r.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const f=r.get(c);if(f===void 0)r.set(c,i(c,u));else if(f.version<c.version){if(f.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(f.buffer,c,u),f.version=c.version}}return{get:o,remove:a,update:l}}class Wa extends jt{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,o=t/2,a=Math.floor(r),l=Math.floor(i),c=a+1,u=l+1,f=e/a,d=t/l,m=[],g=[],y=[],x=[];for(let v=0;v<u;v++){const A=v*d-o;for(let w=0;w<c;w++){const S=w*f-s;g.push(S,-A,0),y.push(0,0,1),x.push(w/a),x.push(1-v/l)}}for(let v=0;v<l;v++)for(let A=0;A<a;A++){const w=A+c*v,S=A+c*(v+1),M=A+1+c*(v+1),b=A+1+c*v;m.push(w,S,b),m.push(S,M,b)}this.setIndex(m),this.setAttribute("position",new Rt(g,3)),this.setAttribute("normal",new Rt(y,3)),this.setAttribute("uv",new Rt(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Wa(e.width,e.height,e.widthSegments,e.heightSegments)}}var H9=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,V9=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,W9=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,X9=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,J9=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,K9=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Q9=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,j9=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Y9=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Z9=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,q9=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,$9=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,eV=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,tV=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,nV=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,rV=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,iV=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,sV=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,oV=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,aV=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,lV=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,cV=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,uV=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,fV=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,hV=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,dV=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,pV=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,mV=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,gV=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,vV=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,yV="gl_FragColor = linearToOutputTexel( gl_FragColor );",xV=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,AV=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,_V=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,wV=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,EV=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,SV=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,bV=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,MV=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,TV=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,CV=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,RV=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,BV=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,PV=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,IV=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,LV=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,NV=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,DV=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,UV=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,FV=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,OV=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,kV=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,GV=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,zV=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,HV=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,VV=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,WV=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,XV=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,JV=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,KV=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,QV=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,jV=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,YV=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,ZV=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,qV=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,$V=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,eW=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,tW=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,nW=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,rW=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,iW=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,sW=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,oW=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,aW=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,lW=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,cW=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,uW=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,fW=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,hW=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,dW=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,pW=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,mW=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,gW=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,vW=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,yW=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,xW=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,AW=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,_W=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,wW=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,EW=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,SW=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,bW=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,MW=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,TW=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,CW=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,RW=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,BW=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,PW=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,IW=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,LW=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,NW=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color *= toneMappingExposure;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,DW=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,UW=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,FW=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,OW=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,kW=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,GW=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const zW=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,HW=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,VW=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,WW=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,XW=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,JW=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,KW=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,QW=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,jW=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,YW=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,ZW=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,qW=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,$W=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,e7=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,t7=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,n7=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,r7=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,i7=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,s7=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,o7=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,a7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,l7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,c7=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,u7=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,f7=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,h7=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,d7=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,p7=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,m7=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,g7=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,v7=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,y7=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,x7=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,A7=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Jt={alphahash_fragment:H9,alphahash_pars_fragment:V9,alphamap_fragment:W9,alphamap_pars_fragment:X9,alphatest_fragment:J9,alphatest_pars_fragment:K9,aomap_fragment:Q9,aomap_pars_fragment:j9,batching_pars_vertex:Y9,batching_vertex:Z9,begin_vertex:q9,beginnormal_vertex:$9,bsdfs:eV,iridescence_fragment:tV,bumpmap_pars_fragment:nV,clipping_planes_fragment:rV,clipping_planes_pars_fragment:iV,clipping_planes_pars_vertex:sV,clipping_planes_vertex:oV,color_fragment:aV,color_pars_fragment:lV,color_pars_vertex:cV,color_vertex:uV,common:fV,cube_uv_reflection_fragment:hV,defaultnormal_vertex:dV,displacementmap_pars_vertex:pV,displacementmap_vertex:mV,emissivemap_fragment:gV,emissivemap_pars_fragment:vV,colorspace_fragment:yV,colorspace_pars_fragment:xV,envmap_fragment:AV,envmap_common_pars_fragment:_V,envmap_pars_fragment:wV,envmap_pars_vertex:EV,envmap_physical_pars_fragment:DV,envmap_vertex:SV,fog_vertex:bV,fog_pars_vertex:MV,fog_fragment:TV,fog_pars_fragment:CV,gradientmap_pars_fragment:RV,lightmap_fragment:BV,lightmap_pars_fragment:PV,lights_lambert_fragment:IV,lights_lambert_pars_fragment:LV,lights_pars_begin:NV,lights_toon_fragment:UV,lights_toon_pars_fragment:FV,lights_phong_fragment:OV,lights_phong_pars_fragment:kV,lights_physical_fragment:GV,lights_physical_pars_fragment:zV,lights_fragment_begin:HV,lights_fragment_maps:VV,lights_fragment_end:WV,logdepthbuf_fragment:XV,logdepthbuf_pars_fragment:JV,logdepthbuf_pars_vertex:KV,logdepthbuf_vertex:QV,map_fragment:jV,map_pars_fragment:YV,map_particle_fragment:ZV,map_particle_pars_fragment:qV,metalnessmap_fragment:$V,metalnessmap_pars_fragment:eW,morphcolor_vertex:tW,morphnormal_vertex:nW,morphtarget_pars_vertex:rW,morphtarget_vertex:iW,normal_fragment_begin:sW,normal_fragment_maps:oW,normal_pars_fragment:aW,normal_pars_vertex:lW,normal_vertex:cW,normalmap_pars_fragment:uW,clearcoat_normal_fragment_begin:fW,clearcoat_normal_fragment_maps:hW,clearcoat_pars_fragment:dW,iridescence_pars_fragment:pW,opaque_fragment:mW,packing:gW,premultiplied_alpha_fragment:vW,project_vertex:yW,dithering_fragment:xW,dithering_pars_fragment:AW,roughnessmap_fragment:_W,roughnessmap_pars_fragment:wW,shadowmap_pars_fragment:EW,shadowmap_pars_vertex:SW,shadowmap_vertex:bW,shadowmask_pars_fragment:MW,skinbase_vertex:TW,skinning_pars_vertex:CW,skinning_vertex:RW,skinnormal_vertex:BW,specularmap_fragment:PW,specularmap_pars_fragment:IW,tonemapping_fragment:LW,tonemapping_pars_fragment:NW,transmission_fragment:DW,transmission_pars_fragment:UW,uv_pars_fragment:FW,uv_pars_vertex:OW,uv_vertex:kW,worldpos_vertex:GW,background_vert:zW,background_frag:HW,backgroundCube_vert:VW,backgroundCube_frag:WW,cube_vert:XW,cube_frag:JW,depth_vert:KW,depth_frag:QW,distanceRGBA_vert:jW,distanceRGBA_frag:YW,equirect_vert:ZW,equirect_frag:qW,linedashed_vert:$W,linedashed_frag:e7,meshbasic_vert:t7,meshbasic_frag:n7,meshlambert_vert:r7,meshlambert_frag:i7,meshmatcap_vert:s7,meshmatcap_frag:o7,meshnormal_vert:a7,meshnormal_frag:l7,meshphong_vert:c7,meshphong_frag:u7,meshphysical_vert:f7,meshphysical_frag:h7,meshtoon_vert:d7,meshtoon_frag:p7,points_vert:m7,points_frag:g7,shadow_vert:v7,shadow_frag:y7,sprite_vert:x7,sprite_frag:A7},pt={common:{diffuse:{value:new ht(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new tn},alphaMap:{value:null},alphaMapTransform:{value:new tn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new tn}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new tn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new tn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new tn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new tn},normalScale:{value:new Ge(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new tn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new tn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new tn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new tn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ht(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ht(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new tn},alphaTest:{value:0},uvTransform:{value:new tn}},sprite:{diffuse:{value:new ht(16777215)},opacity:{value:1},center:{value:new Ge(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new tn},alphaMap:{value:null},alphaMapTransform:{value:new tn},alphaTest:{value:0}}},jo={basic:{uniforms:Ji([pt.common,pt.specularmap,pt.envmap,pt.aomap,pt.lightmap,pt.fog]),vertexShader:Jt.meshbasic_vert,fragmentShader:Jt.meshbasic_frag},lambert:{uniforms:Ji([pt.common,pt.specularmap,pt.envmap,pt.aomap,pt.lightmap,pt.emissivemap,pt.bumpmap,pt.normalmap,pt.displacementmap,pt.fog,pt.lights,{emissive:{value:new ht(0)}}]),vertexShader:Jt.meshlambert_vert,fragmentShader:Jt.meshlambert_frag},phong:{uniforms:Ji([pt.common,pt.specularmap,pt.envmap,pt.aomap,pt.lightmap,pt.emissivemap,pt.bumpmap,pt.normalmap,pt.displacementmap,pt.fog,pt.lights,{emissive:{value:new ht(0)},specular:{value:new ht(1118481)},shininess:{value:30}}]),vertexShader:Jt.meshphong_vert,fragmentShader:Jt.meshphong_frag},standard:{uniforms:Ji([pt.common,pt.envmap,pt.aomap,pt.lightmap,pt.emissivemap,pt.bumpmap,pt.normalmap,pt.displacementmap,pt.roughnessmap,pt.metalnessmap,pt.fog,pt.lights,{emissive:{value:new ht(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Jt.meshphysical_vert,fragmentShader:Jt.meshphysical_frag},toon:{uniforms:Ji([pt.common,pt.aomap,pt.lightmap,pt.emissivemap,pt.bumpmap,pt.normalmap,pt.displacementmap,pt.gradientmap,pt.fog,pt.lights,{emissive:{value:new ht(0)}}]),vertexShader:Jt.meshtoon_vert,fragmentShader:Jt.meshtoon_frag},matcap:{uniforms:Ji([pt.common,pt.bumpmap,pt.normalmap,pt.displacementmap,pt.fog,{matcap:{value:null}}]),vertexShader:Jt.meshmatcap_vert,fragmentShader:Jt.meshmatcap_frag},points:{uniforms:Ji([pt.points,pt.fog]),vertexShader:Jt.points_vert,fragmentShader:Jt.points_frag},dashed:{uniforms:Ji([pt.common,pt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Jt.linedashed_vert,fragmentShader:Jt.linedashed_frag},depth:{uniforms:Ji([pt.common,pt.displacementmap]),vertexShader:Jt.depth_vert,fragmentShader:Jt.depth_frag},normal:{uniforms:Ji([pt.common,pt.bumpmap,pt.normalmap,pt.displacementmap,{opacity:{value:1}}]),vertexShader:Jt.meshnormal_vert,fragmentShader:Jt.meshnormal_frag},sprite:{uniforms:Ji([pt.sprite,pt.fog]),vertexShader:Jt.sprite_vert,fragmentShader:Jt.sprite_frag},background:{uniforms:{uvTransform:{value:new tn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Jt.background_vert,fragmentShader:Jt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Jt.backgroundCube_vert,fragmentShader:Jt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Jt.cube_vert,fragmentShader:Jt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Jt.equirect_vert,fragmentShader:Jt.equirect_frag},distanceRGBA:{uniforms:Ji([pt.common,pt.displacementmap,{referencePosition:{value:new Y},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Jt.distanceRGBA_vert,fragmentShader:Jt.distanceRGBA_frag},shadow:{uniforms:Ji([pt.lights,pt.fog,{color:{value:new ht(0)},opacity:{value:1}}]),vertexShader:Jt.shadow_vert,fragmentShader:Jt.shadow_frag}};jo.physical={uniforms:Ji([jo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new tn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new tn},clearcoatNormalScale:{value:new Ge(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new tn},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new tn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new tn},sheen:{value:0},sheenColor:{value:new ht(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new tn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new tn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new tn},transmissionSamplerSize:{value:new Ge},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new tn},attenuationDistance:{value:0},attenuationColor:{value:new ht(0)},specularColor:{value:new ht(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new tn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new tn},anisotropyVector:{value:new Ge},anisotropyMap:{value:null},anisotropyMapTransform:{value:new tn}}]),vertexShader:Jt.meshphysical_vert,fragmentShader:Jt.meshphysical_frag};const Ux={r:0,b:0,g:0};function _7(n,e,t,r,i,s,o){const a=new ht(0);let l=s===!0?0:1,c,u,f=null,d=0,m=null;function g(x,v){let A=!1,w=v.isScene===!0?v.background:null;w&&w.isTexture&&(w=(v.backgroundBlurriness>0?t:e).get(w)),w===null?y(a,l):w&&w.isColor&&(y(w,1),A=!0);const S=n.xr.getEnvironmentBlendMode();S==="additive"?r.buffers.color.setClear(0,0,0,1,o):S==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,o),(n.autoClear||A)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),w&&(w.isCubeTexture||w.mapping===Um)?(u===void 0&&(u=new On(new Ih(1,1,1),new Pr({name:"BackgroundCubeMaterial",uniforms:Em(jo.backgroundCube.uniforms),vertexShader:jo.backgroundCube.vertexShader,fragmentShader:jo.backgroundCube.fragmentShader,side:Xr,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(M,b,R){this.matrixWorld.copyPosition(R.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),u.material.uniforms.envMap.value=w,u.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=v.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,u.material.toneMapped=Pn.getTransfer(w.colorSpace)!==Hn,(f!==w||d!==w.version||m!==n.toneMapping)&&(u.material.needsUpdate=!0,f=w,d=w.version,m=n.toneMapping),u.layers.enableAll(),x.unshift(u,u.geometry,u.material,0,0,null)):w&&w.isTexture&&(c===void 0&&(c=new On(new Wa(2,2),new Pr({name:"BackgroundMaterial",uniforms:Em(jo.background.uniforms),vertexShader:jo.background.vertexShader,fragmentShader:jo.background.fragmentShader,side:sa,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(c)),c.material.uniforms.t2D.value=w,c.material.uniforms.backgroundIntensity.value=v.backgroundIntensity,c.material.toneMapped=Pn.getTransfer(w.colorSpace)!==Hn,w.matrixAutoUpdate===!0&&w.updateMatrix(),c.material.uniforms.uvTransform.value.copy(w.matrix),(f!==w||d!==w.version||m!==n.toneMapping)&&(c.material.needsUpdate=!0,f=w,d=w.version,m=n.toneMapping),c.layers.enableAll(),x.unshift(c,c.geometry,c.material,0,0,null))}function y(x,v){x.getRGB(Ux,QO(n)),r.buffers.color.setClear(Ux.r,Ux.g,Ux.b,v,o)}return{getClearColor:function(){return a},setClearColor:function(x,v=1){a.set(x),l=v,y(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(x){l=x,y(a,l)},render:g}}function w7(n,e,t,r){const i=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),o=r.isWebGL2||s!==null,a={},l=x(null);let c=l,u=!1;function f(U,z,O,ie,X){let K=!1;if(o){const W=y(ie,O,z);c!==W&&(c=W,m(c.object)),K=v(U,ie,O,X),K&&A(U,ie,O,X)}else{const W=z.wireframe===!0;(c.geometry!==ie.id||c.program!==O.id||c.wireframe!==W)&&(c.geometry=ie.id,c.program=O.id,c.wireframe=W,K=!0)}X!==null&&t.update(X,n.ELEMENT_ARRAY_BUFFER),(K||u)&&(u=!1,P(U,z,O,ie),X!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(X).buffer))}function d(){return r.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function m(U){return r.isWebGL2?n.bindVertexArray(U):s.bindVertexArrayOES(U)}function g(U){return r.isWebGL2?n.deleteVertexArray(U):s.deleteVertexArrayOES(U)}function y(U,z,O){const ie=O.wireframe===!0;let X=a[U.id];X===void 0&&(X={},a[U.id]=X);let K=X[z.id];K===void 0&&(K={},X[z.id]=K);let W=K[ie];return W===void 0&&(W=x(d()),K[ie]=W),W}function x(U){const z=[],O=[],ie=[];for(let X=0;X<i;X++)z[X]=0,O[X]=0,ie[X]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:z,enabledAttributes:O,attributeDivisors:ie,object:U,attributes:{},index:null}}function v(U,z,O,ie){const X=c.attributes,K=z.attributes;let W=0;const V=O.getAttributes();for(const Q in V)if(V[Q].location>=0){const ne=X[Q];let fe=K[Q];if(fe===void 0&&(Q==="instanceMatrix"&&U.instanceMatrix&&(fe=U.instanceMatrix),Q==="instanceColor"&&U.instanceColor&&(fe=U.instanceColor)),ne===void 0||ne.attribute!==fe||fe&&ne.data!==fe.data)return!0;W++}return c.attributesNum!==W||c.index!==ie}function A(U,z,O,ie){const X={},K=z.attributes;let W=0;const V=O.getAttributes();for(const Q in V)if(V[Q].location>=0){let ne=K[Q];ne===void 0&&(Q==="instanceMatrix"&&U.instanceMatrix&&(ne=U.instanceMatrix),Q==="instanceColor"&&U.instanceColor&&(ne=U.instanceColor));const fe={};fe.attribute=ne,ne&&ne.data&&(fe.data=ne.data),X[Q]=fe,W++}c.attributes=X,c.attributesNum=W,c.index=ie}function w(){const U=c.newAttributes;for(let z=0,O=U.length;z<O;z++)U[z]=0}function S(U){M(U,0)}function M(U,z){const O=c.newAttributes,ie=c.enabledAttributes,X=c.attributeDivisors;O[U]=1,ie[U]===0&&(n.enableVertexAttribArray(U),ie[U]=1),X[U]!==z&&((r.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](U,z),X[U]=z)}function b(){const U=c.newAttributes,z=c.enabledAttributes;for(let O=0,ie=z.length;O<ie;O++)z[O]!==U[O]&&(n.disableVertexAttribArray(O),z[O]=0)}function R(U,z,O,ie,X,K,W){W===!0?n.vertexAttribIPointer(U,z,O,X,K):n.vertexAttribPointer(U,z,O,ie,X,K)}function P(U,z,O,ie){if(r.isWebGL2===!1&&(U.isInstancedMesh||ie.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;w();const X=ie.attributes,K=O.getAttributes(),W=z.defaultAttributeValues;for(const V in K){const Q=K[V];if(Q.location>=0){let q=X[V];if(q===void 0&&(V==="instanceMatrix"&&U.instanceMatrix&&(q=U.instanceMatrix),V==="instanceColor"&&U.instanceColor&&(q=U.instanceColor)),q!==void 0){const ne=q.normalized,fe=q.itemSize,pe=t.get(q);if(pe===void 0)continue;const ge=pe.buffer,Ce=pe.type,Je=pe.bytesPerElement,Xe=r.isWebGL2===!0&&(Ce===n.INT||Ce===n.UNSIGNED_INT||q.gpuType===D_);if(q.isInterleavedBufferAttribute){const Fe=q.data,j=Fe.stride,Te=q.offset;if(Fe.isInstancedInterleavedBuffer){for(let be=0;be<Q.locationSize;be++)M(Q.location+be,Fe.meshPerAttribute);U.isInstancedMesh!==!0&&ie._maxInstanceCount===void 0&&(ie._maxInstanceCount=Fe.meshPerAttribute*Fe.count)}else for(let be=0;be<Q.locationSize;be++)S(Q.location+be);n.bindBuffer(n.ARRAY_BUFFER,ge);for(let be=0;be<Q.locationSize;be++)R(Q.location+be,fe/Q.locationSize,Ce,ne,j*Je,(Te+fe/Q.locationSize*be)*Je,Xe)}else{if(q.isInstancedBufferAttribute){for(let Fe=0;Fe<Q.locationSize;Fe++)M(Q.location+Fe,q.meshPerAttribute);U.isInstancedMesh!==!0&&ie._maxInstanceCount===void 0&&(ie._maxInstanceCount=q.meshPerAttribute*q.count)}else for(let Fe=0;Fe<Q.locationSize;Fe++)S(Q.location+Fe);n.bindBuffer(n.ARRAY_BUFFER,ge);for(let Fe=0;Fe<Q.locationSize;Fe++)R(Q.location+Fe,fe/Q.locationSize,Ce,ne,fe*Je,fe/Q.locationSize*Fe*Je,Xe)}}else if(W!==void 0){const ne=W[V];if(ne!==void 0)switch(ne.length){case 2:n.vertexAttrib2fv(Q.location,ne);break;case 3:n.vertexAttrib3fv(Q.location,ne);break;case 4:n.vertexAttrib4fv(Q.location,ne);break;default:n.vertexAttrib1fv(Q.location,ne)}}}}b()}function C(){k();for(const U in a){const z=a[U];for(const O in z){const ie=z[O];for(const X in ie)g(ie[X].object),delete ie[X];delete z[O]}delete a[U]}}function B(U){if(a[U.id]===void 0)return;const z=a[U.id];for(const O in z){const ie=z[O];for(const X in ie)g(ie[X].object),delete ie[X];delete z[O]}delete a[U.id]}function H(U){for(const z in a){const O=a[z];if(O[U.id]===void 0)continue;const ie=O[U.id];for(const X in ie)g(ie[X].object),delete ie[X];delete O[U.id]}}function k(){$(),u=!0,c!==l&&(c=l,m(c.object))}function $(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:f,reset:k,resetDefaultState:$,dispose:C,releaseStatesOfGeometry:B,releaseStatesOfProgram:H,initAttributes:w,enableAttribute:S,disableUnusedAttributes:b}}function E7(n,e,t,r){const i=r.isWebGL2;let s;function o(u){s=u}function a(u,f){n.drawArrays(s,u,f),t.update(f,s,1)}function l(u,f,d){if(d===0)return;let m,g;if(i)m=n,g="drawArraysInstanced";else if(m=e.get("ANGLE_instanced_arrays"),g="drawArraysInstancedANGLE",m===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[g](s,u,f,d),t.update(f,s,d)}function c(u,f,d){if(d===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let g=0;g<d;g++)this.render(u[g],f[g]);else{m.multiDrawArraysWEBGL(s,u,0,f,0,d);let g=0;for(let y=0;y<d;y++)g+=f[y];t.update(g,s,1)}}this.setMode=o,this.render=a,this.renderInstances=l,this.renderMultiDraw=c}function S7(n,e,t){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const R=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(R.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(R){if(R==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";R="mediump"}return R==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let a=t.precision!==void 0?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=t.logarithmicDepthBuffer===!0,f=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),d=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=n.getParameter(n.MAX_TEXTURE_SIZE),g=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),y=n.getParameter(n.MAX_VERTEX_ATTRIBS),x=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),v=n.getParameter(n.MAX_VARYING_VECTORS),A=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),w=d>0,S=o||e.has("OES_texture_float"),M=w&&S,b=o?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:i,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:f,maxVertexTextures:d,maxTextureSize:m,maxCubemapSize:g,maxAttributes:y,maxVertexUniforms:x,maxVaryings:v,maxFragmentUniforms:A,vertexTextures:w,floatFragmentTextures:S,floatVertexTextures:M,maxSamples:b}}function b7(n){const e=this;let t=null,r=0,i=!1,s=!1;const o=new dl,a=new tn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,d){const m=f.length!==0||d||r!==0||i;return i=d,r=f.length,m},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(f,d){t=u(f,d,0)},this.setState=function(f,d,m){const g=f.clippingPlanes,y=f.clipIntersection,x=f.clipShadows,v=n.get(f);if(!i||g===null||g.length===0||s&&!x)s?u(null):c();else{const A=s?0:r,w=A*4;let S=v.clippingState||null;l.value=S,S=u(g,d,w,m);for(let M=0;M!==w;++M)S[M]=t[M];v.clippingState=S,this.numIntersection=y?this.numPlanes:0,this.numPlanes+=A}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(f,d,m,g){const y=f!==null?f.length:0;let x=null;if(y!==0){if(x=l.value,g!==!0||x===null){const v=m+y*4,A=d.matrixWorldInverse;a.getNormalMatrix(A),(x===null||x.length<v)&&(x=new Float32Array(v));for(let w=0,S=m;w!==y;++w,S+=4)o.copy(f[w]).applyMatrix4(A,a),o.normal.toArray(x,S),x[S+3]=o.constant}l.value=x,l.needsUpdate=!0}return e.numPlanes=y,e.numIntersection=0,x}}function M7(n){let e=new WeakMap;function t(o,a){return a===ym?o.mapping=za:a===V0&&(o.mapping=mu),o}function r(o){if(o&&o.isTexture){const a=o.mapping;if(a===ym||a===V0)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new I2(l.height/2);return c.fromEquirectangularTexture(n,o),e.set(o,c),o.addEventListener("dispose",i),t(c.texture,o.mapping)}else return null}}return o}function i(o){const a=o.target;a.removeEventListener("dispose",i);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}class ra extends Xv{constructor(e=-1,t=1,r=1,i=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,o=r+e,a=i+t,l=i-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Qd=4,YI=[.125,.215,.35,.446,.526,.582],yf=20,pS=new ra,ZI=new ht;let mS=null,gS=0,vS=0;const mf=(1+Math.sqrt(5))/2,pd=1/mf,qI=[new Y(1,1,1),new Y(-1,1,1),new Y(1,1,-1),new Y(-1,1,-1),new Y(0,mf,pd),new Y(0,mf,-pd),new Y(pd,0,mf),new Y(-pd,0,mf),new Y(mf,pd,0),new Y(-mf,pd,0)];class tT{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){mS=this._renderer.getRenderTarget(),gS=this._renderer.getActiveCubeFace(),vS=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,r,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=tL(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=eL(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(mS,gS,vS),e.scissorTest=!1,Fx(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===za||e.mapping===mu?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),mS=this._renderer.getRenderTarget(),gS=this._renderer.getActiveCubeFace(),vS=this._renderer.getActiveMipmapLevel();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:un,minFilter:un,generateMipmaps:!1,type:Jr,format:Ur,colorSpace:is,depthBuffer:!1},i=$I(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=$I(e,t,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=T7(s)),this._blurMaterial=C7(s,e,t)}return i}_compileMaterial(e){const t=new On(this._lodPlanes[0],e);this._renderer.compile(t,pS)}_sceneToCubeUV(e,t,r,i){const a=new or(90,1,t,r),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,f=u.autoClear,d=u.toneMapping;u.getClearColor(ZI),u.toneMapping=na,u.autoClear=!1;const m=new Ni({name:"PMREM.Background",side:Xr,depthWrite:!1,depthTest:!1}),g=new On(new Ih,m);let y=!1;const x=e.background;x?x.isColor&&(m.color.copy(x),e.background=null,y=!0):(m.color.copy(ZI),y=!0);for(let v=0;v<6;v++){const A=v%3;A===0?(a.up.set(0,l[v],0),a.lookAt(c[v],0,0)):A===1?(a.up.set(0,0,l[v]),a.lookAt(0,c[v],0)):(a.up.set(0,l[v],0),a.lookAt(0,0,c[v]));const w=this._cubeSize;Fx(i,A*w,v>2?w:0,w,w),u.setRenderTarget(i),y&&u.render(g,a),u.render(e,a)}g.geometry.dispose(),g.material.dispose(),u.toneMapping=d,u.autoClear=f,e.background=x}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===za||e.mapping===mu;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=tL()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=eL());const s=i?this._cubemapMaterial:this._equirectMaterial,o=new On(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;Fx(t,0,0,3*l,2*l),r.setRenderTarget(t),r.render(o,pS)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const s=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),o=qI[(i-1)%qI.length];this._blur(e,i-1,i,s,o)}t.autoClear=r}_blur(e,t,r,i,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,r,i,"latitudinal",s),this._halfBlur(o,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,f=new On(this._lodPlanes[i],c),d=c.uniforms,m=this._sizeLods[r]-1,g=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*yf-1),y=s/g,x=isFinite(s)?1+Math.floor(u*y):yf;x>yf&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${yf}`);const v=[];let A=0;for(let R=0;R<yf;++R){const P=R/y,C=Math.exp(-P*P/2);v.push(C),R===0?A+=C:R<x&&(A+=2*C)}for(let R=0;R<v.length;R++)v[R]=v[R]/A;d.envMap.value=e.texture,d.samples.value=x,d.weights.value=v,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);const{_lodMax:w}=this;d.dTheta.value=g,d.mipInt.value=w-r;const S=this._sizeLods[i],M=3*S*(i>w-Qd?i-w+Qd:0),b=4*(this._cubeSize-S);Fx(t,M,b,3*S,2*S),l.setRenderTarget(t),l.render(f,pS)}}function T7(n){const e=[],t=[],r=[];let i=n;const s=n-Qd+1+YI.length;for(let o=0;o<s;o++){const a=Math.pow(2,i);t.push(a);let l=1/a;o>n-Qd?l=YI[o-n+Qd-1]:o===0&&(l=0),r.push(l);const c=1/(a-2),u=-c,f=1+c,d=[u,u,f,u,f,f,u,u,f,f,u,f],m=6,g=6,y=3,x=2,v=1,A=new Float32Array(y*g*m),w=new Float32Array(x*g*m),S=new Float32Array(v*g*m);for(let b=0;b<m;b++){const R=b%3*2/3-1,P=b>2?0:-1,C=[R,P,0,R+2/3,P,0,R+2/3,P+1,0,R,P,0,R+2/3,P+1,0,R,P+1,0];A.set(C,y*g*b),w.set(d,x*g*b);const B=[b,b,b,b,b,b];S.set(B,v*g*b)}const M=new jt;M.setAttribute("position",new vn(A,y)),M.setAttribute("uv",new vn(w,x)),M.setAttribute("faceIndex",new vn(S,v)),e.push(M),i>Qd&&i--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function $I(n,e,t){const r=new hr(n,e,t);return r.texture.mapping=Um,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function Fx(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function C7(n,e,t){const r=new Float32Array(yf),i=new Y(0,1,0);return new Pr({name:"SphericalGaussianBlur",defines:{n:yf,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:L2(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:gi,depthTest:!1,depthWrite:!1})}function eL(){return new Pr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:L2(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:gi,depthTest:!1,depthWrite:!1})}function tL(){return new Pr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:L2(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:gi,depthTest:!1,depthWrite:!1})}function L2(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function R7(n){let e=new WeakMap,t=null;function r(a){if(a&&a.isTexture){const l=a.mapping,c=l===ym||l===V0,u=l===za||l===mu;if(c||u)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let f=e.get(a);return t===null&&(t=new tT(n)),f=c?t.fromEquirectangular(a,f):t.fromCubemap(a,f),e.set(a,f),f.texture}else{if(e.has(a))return e.get(a).texture;{const f=a.image;if(c&&f&&f.height>0||u&&f&&i(f)){t===null&&(t=new tT(n));const d=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function i(a){let l=0;const c=6;for(let u=0;u<c;u++)a[u]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:o}}function B7(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=n.getExtension(r)}return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){const i=t(r);return i===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function P7(n,e,t,r){const i={},s=new WeakMap;function o(f){const d=f.target;d.index!==null&&e.remove(d.index);for(const g in d.attributes)e.remove(d.attributes[g]);for(const g in d.morphAttributes){const y=d.morphAttributes[g];for(let x=0,v=y.length;x<v;x++)e.remove(y[x])}d.removeEventListener("dispose",o),delete i[d.id];const m=s.get(d);m&&(e.remove(m),s.delete(d)),r.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}function a(f,d){return i[d.id]===!0||(d.addEventListener("dispose",o),i[d.id]=!0,t.memory.geometries++),d}function l(f){const d=f.attributes;for(const g in d)e.update(d[g],n.ARRAY_BUFFER);const m=f.morphAttributes;for(const g in m){const y=m[g];for(let x=0,v=y.length;x<v;x++)e.update(y[x],n.ARRAY_BUFFER)}}function c(f){const d=[],m=f.index,g=f.attributes.position;let y=0;if(m!==null){const A=m.array;y=m.version;for(let w=0,S=A.length;w<S;w+=3){const M=A[w+0],b=A[w+1],R=A[w+2];d.push(M,b,b,R,R,M)}}else if(g!==void 0){const A=g.array;y=g.version;for(let w=0,S=A.length/3-1;w<S;w+=3){const M=w+0,b=w+1,R=w+2;d.push(M,b,b,R,R,M)}}else return;const x=new(WO(d)?B2:R2)(d,1);x.version=y;const v=s.get(f);v&&e.remove(v),s.set(f,x)}function u(f){const d=s.get(f);if(d){const m=f.index;m!==null&&d.version<m.version&&c(f)}else c(f);return s.get(f)}return{get:a,update:l,getWireframeAttribute:u}}function I7(n,e,t,r){const i=r.isWebGL2;let s;function o(m){s=m}let a,l;function c(m){a=m.type,l=m.bytesPerElement}function u(m,g){n.drawElements(s,g,a,m*l),t.update(g,s,1)}function f(m,g,y){if(y===0)return;let x,v;if(i)x=n,v="drawElementsInstanced";else if(x=e.get("ANGLE_instanced_arrays"),v="drawElementsInstancedANGLE",x===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}x[v](s,g,a,m*l,y),t.update(g,s,y)}function d(m,g,y){if(y===0)return;const x=e.get("WEBGL_multi_draw");if(x===null)for(let v=0;v<y;v++)this.render(m[v]/l,g[v]);else{x.multiDrawElementsWEBGL(s,g,0,a,m,0,y);let v=0;for(let A=0;A<y;A++)v+=g[A];t.update(v,s,1)}}this.setMode=o,this.setIndex=c,this.render=u,this.renderInstances=f,this.renderMultiDraw=d}function L7(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function N7(n,e){return n[0]-e[0]}function D7(n,e){return Math.abs(e[1])-Math.abs(n[1])}function U7(n,e,t){const r={},i=new Float32Array(8),s=new WeakMap,o=new wn,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,u,f){const d=c.morphTargetInfluences;if(e.isWebGL2===!0){const g=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,y=g!==void 0?g.length:0;let x=s.get(u);if(x===void 0||x.count!==y){let z=function(){$.dispose(),s.delete(u),u.removeEventListener("dispose",z)};var m=z;x!==void 0&&x.texture.dispose();const w=u.morphAttributes.position!==void 0,S=u.morphAttributes.normal!==void 0,M=u.morphAttributes.color!==void 0,b=u.morphAttributes.position||[],R=u.morphAttributes.normal||[],P=u.morphAttributes.color||[];let C=0;w===!0&&(C=1),S===!0&&(C=2),M===!0&&(C=3);let B=u.attributes.position.count*C,H=1;B>e.maxTextureSize&&(H=Math.ceil(B/e.maxTextureSize),B=e.maxTextureSize);const k=new Float32Array(B*H*4*y),$=new O_(k,B,H,y);$.type=Cr,$.needsUpdate=!0;const U=C*4;for(let O=0;O<y;O++){const ie=b[O],X=R[O],K=P[O],W=B*H*4*O;for(let V=0;V<ie.count;V++){const Q=V*U;w===!0&&(o.fromBufferAttribute(ie,V),k[W+Q+0]=o.x,k[W+Q+1]=o.y,k[W+Q+2]=o.z,k[W+Q+3]=0),S===!0&&(o.fromBufferAttribute(X,V),k[W+Q+4]=o.x,k[W+Q+5]=o.y,k[W+Q+6]=o.z,k[W+Q+7]=0),M===!0&&(o.fromBufferAttribute(K,V),k[W+Q+8]=o.x,k[W+Q+9]=o.y,k[W+Q+10]=o.z,k[W+Q+11]=K.itemSize===4?o.w:1)}}x={count:y,texture:$,size:new Ge(B,H)},s.set(u,x),u.addEventListener("dispose",z)}let v=0;for(let w=0;w<d.length;w++)v+=d[w];const A=u.morphTargetsRelative?1:1-v;f.getUniforms().setValue(n,"morphTargetBaseInfluence",A),f.getUniforms().setValue(n,"morphTargetInfluences",d),f.getUniforms().setValue(n,"morphTargetsTexture",x.texture,t),f.getUniforms().setValue(n,"morphTargetsTextureSize",x.size)}else{const g=d===void 0?0:d.length;let y=r[u.id];if(y===void 0||y.length!==g){y=[];for(let S=0;S<g;S++)y[S]=[S,0];r[u.id]=y}for(let S=0;S<g;S++){const M=y[S];M[0]=S,M[1]=d[S]}y.sort(D7);for(let S=0;S<8;S++)S<g&&y[S][1]?(a[S][0]=y[S][0],a[S][1]=y[S][1]):(a[S][0]=Number.MAX_SAFE_INTEGER,a[S][1]=0);a.sort(N7);const x=u.morphAttributes.position,v=u.morphAttributes.normal;let A=0;for(let S=0;S<8;S++){const M=a[S],b=M[0],R=M[1];b!==Number.MAX_SAFE_INTEGER&&R?(x&&u.getAttribute("morphTarget"+S)!==x[b]&&u.setAttribute("morphTarget"+S,x[b]),v&&u.getAttribute("morphNormal"+S)!==v[b]&&u.setAttribute("morphNormal"+S,v[b]),i[S]=R,A+=R):(x&&u.hasAttribute("morphTarget"+S)===!0&&u.deleteAttribute("morphTarget"+S),v&&u.hasAttribute("morphNormal"+S)===!0&&u.deleteAttribute("morphNormal"+S),i[S]=0)}const w=u.morphTargetsRelative?1:1-A;f.getUniforms().setValue(n,"morphTargetBaseInfluence",w),f.getUniforms().setValue(n,"morphTargetInfluences",i)}}return{update:l}}function F7(n,e,t,r){let i=new WeakMap;function s(l){const c=r.render.frame,u=l.geometry,f=e.get(l,u);if(i.get(f)!==c&&(e.update(f),i.set(f,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),i.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),i.set(l,c))),l.isSkinnedMesh){const d=l.skeleton;i.get(d)!==c&&(d.update(),i.set(d,c))}return f}function o(){i=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:o}}class k_ extends Sn{constructor(e,t,r,i,s,o,a,l,c,u){if(u=u!==void 0?u:su,u!==su&&u!==vu)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&u===su&&(r=qo),r===void 0&&u===vu&&(r=Nl),super(null,i,s,o,a,l,u,r,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Vn,this.minFilter=l!==void 0?l:Vn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const ZO=new Sn,qO=new k_(1,1);qO.compareFunction=b2;const $O=new O_,ek=new C2,tk=new Jv,nL=[],rL=[],iL=new Float32Array(16),sL=new Float32Array(9),oL=new Float32Array(4);function Fm(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=nL[i];if(s===void 0&&(s=new Float32Array(i),nL[i]=s),e!==0){r.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Kr(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function Qr(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function G_(n,e){let t=rL[e];t===void 0&&(t=new Int32Array(e),rL[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function O7(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function k7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Kr(t,e))return;n.uniform2fv(this.addr,e),Qr(t,e)}}function G7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Kr(t,e))return;n.uniform3fv(this.addr,e),Qr(t,e)}}function z7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Kr(t,e))return;n.uniform4fv(this.addr,e),Qr(t,e)}}function H7(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Kr(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Qr(t,e)}else{if(Kr(t,r))return;oL.set(r),n.uniformMatrix2fv(this.addr,!1,oL),Qr(t,r)}}function V7(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Kr(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Qr(t,e)}else{if(Kr(t,r))return;sL.set(r),n.uniformMatrix3fv(this.addr,!1,sL),Qr(t,r)}}function W7(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Kr(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Qr(t,e)}else{if(Kr(t,r))return;iL.set(r),n.uniformMatrix4fv(this.addr,!1,iL),Qr(t,r)}}function X7(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function J7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Kr(t,e))return;n.uniform2iv(this.addr,e),Qr(t,e)}}function K7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Kr(t,e))return;n.uniform3iv(this.addr,e),Qr(t,e)}}function Q7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Kr(t,e))return;n.uniform4iv(this.addr,e),Qr(t,e)}}function j7(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function Y7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Kr(t,e))return;n.uniform2uiv(this.addr,e),Qr(t,e)}}function Z7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Kr(t,e))return;n.uniform3uiv(this.addr,e),Qr(t,e)}}function q7(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Kr(t,e))return;n.uniform4uiv(this.addr,e),Qr(t,e)}}function $7(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i);const s=this.type===n.SAMPLER_2D_SHADOW?qO:ZO;t.setTexture2D(e||s,i)}function eX(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||ek,i)}function tX(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||tk,i)}function nX(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||$O,i)}function rX(n){switch(n){case 5126:return O7;case 35664:return k7;case 35665:return G7;case 35666:return z7;case 35674:return H7;case 35675:return V7;case 35676:return W7;case 5124:case 35670:return X7;case 35667:case 35671:return J7;case 35668:case 35672:return K7;case 35669:case 35673:return Q7;case 5125:return j7;case 36294:return Y7;case 36295:return Z7;case 36296:return q7;case 35678:case 36198:case 36298:case 36306:case 35682:return $7;case 35679:case 36299:case 36307:return eX;case 35680:case 36300:case 36308:case 36293:return tX;case 36289:case 36303:case 36311:case 36292:return nX}}function iX(n,e){n.uniform1fv(this.addr,e)}function sX(n,e){const t=Fm(e,this.size,2);n.uniform2fv(this.addr,t)}function oX(n,e){const t=Fm(e,this.size,3);n.uniform3fv(this.addr,t)}function aX(n,e){const t=Fm(e,this.size,4);n.uniform4fv(this.addr,t)}function lX(n,e){const t=Fm(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function cX(n,e){const t=Fm(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function uX(n,e){const t=Fm(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function fX(n,e){n.uniform1iv(this.addr,e)}function hX(n,e){n.uniform2iv(this.addr,e)}function dX(n,e){n.uniform3iv(this.addr,e)}function pX(n,e){n.uniform4iv(this.addr,e)}function mX(n,e){n.uniform1uiv(this.addr,e)}function gX(n,e){n.uniform2uiv(this.addr,e)}function vX(n,e){n.uniform3uiv(this.addr,e)}function yX(n,e){n.uniform4uiv(this.addr,e)}function xX(n,e,t){const r=this.cache,i=e.length,s=G_(t,i);Kr(r,s)||(n.uniform1iv(this.addr,s),Qr(r,s));for(let o=0;o!==i;++o)t.setTexture2D(e[o]||ZO,s[o])}function AX(n,e,t){const r=this.cache,i=e.length,s=G_(t,i);Kr(r,s)||(n.uniform1iv(this.addr,s),Qr(r,s));for(let o=0;o!==i;++o)t.setTexture3D(e[o]||ek,s[o])}function _X(n,e,t){const r=this.cache,i=e.length,s=G_(t,i);Kr(r,s)||(n.uniform1iv(this.addr,s),Qr(r,s));for(let o=0;o!==i;++o)t.setTextureCube(e[o]||tk,s[o])}function wX(n,e,t){const r=this.cache,i=e.length,s=G_(t,i);Kr(r,s)||(n.uniform1iv(this.addr,s),Qr(r,s));for(let o=0;o!==i;++o)t.setTexture2DArray(e[o]||$O,s[o])}function EX(n){switch(n){case 5126:return iX;case 35664:return sX;case 35665:return oX;case 35666:return aX;case 35674:return lX;case 35675:return cX;case 35676:return uX;case 5124:case 35670:return fX;case 35667:case 35671:return hX;case 35668:case 35672:return dX;case 35669:case 35673:return pX;case 5125:return mX;case 36294:return gX;case 36295:return vX;case 36296:return yX;case 35678:case 36198:case 36298:case 36306:case 35682:return xX;case 35679:case 36299:case 36307:return AX;case 35680:case 36300:case 36308:case 36293:return _X;case 36289:case 36303:case 36311:case 36292:return wX}}class SX{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=rX(t.type)}}class bX{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=EX(t.type)}}class MX{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,o=i.length;s!==o;++s){const a=i[s];a.setValue(e,t[a.id],r)}}}const yS=/(\w+)(\])?(\[|\.)?/g;function aL(n,e){n.seq.push(e),n.map[e.id]=e}function TX(n,e,t){const r=n.name,i=r.length;for(yS.lastIndex=0;;){const s=yS.exec(r),o=yS.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===i){aL(t,c===void 0?new SX(a,n,e):new bX(a,n,e));break}else{let f=t.map[a];f===void 0&&(f=new MX(a),aL(t,f)),t=f}}}class Y1{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const s=e.getActiveUniform(t,i),o=e.getUniformLocation(t,s.name);TX(s,o,this)}}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=r[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const o=e[i];o.id in t&&r.push(o)}return r}}function lL(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const CX=37297;let RX=0;function BX(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=i;o<s;o++){const a=o+1;r.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return r.join(`
`)}function PX(n){const e=Pn.getPrimaries(Pn.workingColorSpace),t=Pn.getPrimaries(n);let r;switch(e===t?r="":e===Q0&&t===K0?r="LinearDisplayP3ToLinearSRGB":e===K0&&t===Q0&&(r="LinearSRGBToLinearDisplayP3"),n){case is:case Vv:return[r,"LinearTransferOETF"];case mn:case F_:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[r,"LinearTransferOETF"]}}function cL(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),i=n.getShaderInfoLog(e).trim();if(r&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+BX(n.getShaderSource(e),o)}else return i}function IX(n,e){const t=PX(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function LX(n,e){let t;switch(e){case wO:t="Linear";break;case EO:t="Reinhard";break;case SO:t="OptimizedCineon";break;case u2:t="ACESFilmic";break;case MO:t="AgX";break;case bO:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function NX(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(jd).join(`
`)}function DX(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":""].filter(jd).join(`
`)}function UX(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function FX(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function jd(n){return n!==""}function uL(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function fL(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const OX=/^[ \t]*#include +<([\w\d./]+)>/gm;function nT(n){return n.replace(OX,GX)}const kX=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function GX(n,e){let t=Jt[e];if(t===void 0){const r=kX.get(e);if(r!==void 0)t=Jt[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return nT(t)}const zX=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function hL(n){return n.replace(zX,HX)}function HX(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function dL(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function VX(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===I_?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===m0?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Fo&&(e="SHADOWMAP_TYPE_VSM"),e}function WX(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case za:case mu:e="ENVMAP_TYPE_CUBE";break;case Um:e="ENVMAP_TYPE_CUBE_UV";break}return e}function XX(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case mu:e="ENVMAP_MODE_REFRACTION";break}return e}function JX(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Hv:e="ENVMAP_BLENDING_MULTIPLY";break;case AO:e="ENVMAP_BLENDING_MIX";break;case _O:e="ENVMAP_BLENDING_ADD";break}return e}function KX(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function QX(n,e,t,r){const i=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=VX(t),c=WX(t),u=XX(t),f=JX(t),d=KX(t),m=t.isWebGL2?"":NX(t),g=DX(t),y=UX(s),x=i.createProgram();let v,A,w=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(v=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y].filter(jd).join(`
`),v.length>0&&(v+=`
`),A=[m,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y].filter(jd).join(`
`),A.length>0&&(A+=`
`)):(v=[dL(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(jd).join(`
`),A=[m,dL(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,y,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+f:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==na?"#define TONE_MAPPING":"",t.toneMapping!==na?Jt.tonemapping_pars_fragment:"",t.toneMapping!==na?LX("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Jt.colorspace_pars_fragment,IX("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(jd).join(`
`)),o=nT(o),o=uL(o,t),o=fL(o,t),a=nT(a),a=uL(a,t),a=fL(a,t),o=hL(o),a=hL(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,v=[g,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,A=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===$M?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===$M?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+A);const S=w+v+o,M=w+A+a,b=lL(i,i.VERTEX_SHADER,S),R=lL(i,i.FRAGMENT_SHADER,M);i.attachShader(x,b),i.attachShader(x,R),t.index0AttributeName!==void 0?i.bindAttribLocation(x,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(x,0,"position"),i.linkProgram(x);function P(k){if(n.debug.checkShaderErrors){const $=i.getProgramInfoLog(x).trim(),U=i.getShaderInfoLog(b).trim(),z=i.getShaderInfoLog(R).trim();let O=!0,ie=!0;if(i.getProgramParameter(x,i.LINK_STATUS)===!1)if(O=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(i,x,b,R);else{const X=cL(i,b,"vertex"),K=cL(i,R,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(x,i.VALIDATE_STATUS)+`

Program Info Log: `+$+`
`+X+`
`+K)}else $!==""?console.warn("THREE.WebGLProgram: Program Info Log:",$):(U===""||z==="")&&(ie=!1);ie&&(k.diagnostics={runnable:O,programLog:$,vertexShader:{log:U,prefix:v},fragmentShader:{log:z,prefix:A}})}i.deleteShader(b),i.deleteShader(R),C=new Y1(i,x),B=FX(i,x)}let C;this.getUniforms=function(){return C===void 0&&P(this),C};let B;this.getAttributes=function(){return B===void 0&&P(this),B};let H=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return H===!1&&(H=i.getProgramParameter(x,CX)),H},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(x),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=RX++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=b,this.fragmentShader=R,this}let jX=0;class YX{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new ZX(e),t.set(e,r)),r}}class ZX{constructor(e){this.id=jX++,this.code=e,this.usedTimes=0}}function qX(n,e,t,r,i,s,o){const a=new uh,l=new YX,c=[],u=i.isWebGL2,f=i.logarithmicDepthBuffer,d=i.vertexTextures;let m=i.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function y(C){return C===0?"uv":`uv${C}`}function x(C,B,H,k,$){const U=k.fog,z=$.geometry,O=C.isMeshStandardMaterial?k.environment:null,ie=(C.isMeshStandardMaterial?t:e).get(C.envMap||O),X=ie&&ie.mapping===Um?ie.image.height:null,K=g[C.type];C.precision!==null&&(m=i.getMaxPrecision(C.precision),m!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",m,"instead."));const W=z.morphAttributes.position||z.morphAttributes.normal||z.morphAttributes.color,V=W!==void 0?W.length:0;let Q=0;z.morphAttributes.position!==void 0&&(Q=1),z.morphAttributes.normal!==void 0&&(Q=2),z.morphAttributes.color!==void 0&&(Q=3);let q,ne,fe,pe;if(K){const qt=jo[K];q=qt.vertexShader,ne=qt.fragmentShader}else q=C.vertexShader,ne=C.fragmentShader,l.update(C),fe=l.getVertexShaderID(C),pe=l.getFragmentShaderID(C);const ge=n.getRenderTarget(),Ce=$.isInstancedMesh===!0,Je=$.isBatchedMesh===!0,Xe=!!C.map,Fe=!!C.matcap,j=!!ie,Te=!!C.aoMap,be=!!C.lightMap,Ue=!!C.bumpMap,we=!!C.normalMap,et=!!C.displacementMap,Re=!!C.emissiveMap,J=!!C.metalnessMap,F=!!C.roughnessMap,G=C.anisotropy>0,de=C.clearcoat>0,le=C.iridescence>0,ye=C.sheen>0,Le=C.transmission>0,Ve=G&&!!C.anisotropyMap,Oe=de&&!!C.clearcoatMap,ze=de&&!!C.clearcoatNormalMap,Ye=de&&!!C.clearcoatRoughnessMap,Ie=le&&!!C.iridescenceMap,gt=le&&!!C.iridescenceThicknessMap,yt=ye&&!!C.sheenColorMap,ot=ye&&!!C.sheenRoughnessMap,Ze=!!C.specularMap,Ke=!!C.specularColorMap,ae=!!C.specularIntensityMap,De=Le&&!!C.transmissionMap,rt=Le&&!!C.thicknessMap,it=!!C.gradientMap,ve=!!C.alphaMap,ce=C.alphaTest>0,at=!!C.alphaHash,$e=!!C.extensions,ct=!!z.attributes.uv1,ft=!!z.attributes.uv2,Tt=!!z.attributes.uv3;let mt=na;return C.toneMapped&&(ge===null||ge.isXRRenderTarget===!0)&&(mt=n.toneMapping),{isWebGL2:u,shaderID:K,shaderType:C.type,shaderName:C.name,vertexShader:q,fragmentShader:ne,defines:C.defines,customVertexShaderID:fe,customFragmentShaderID:pe,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:m,batching:Je,instancing:Ce,instancingColor:Ce&&$.instanceColor!==null,supportsVertexTextures:d,outputColorSpace:ge===null?n.outputColorSpace:ge.isXRRenderTarget===!0?ge.texture.colorSpace:is,map:Xe,matcap:Fe,envMap:j,envMapMode:j&&ie.mapping,envMapCubeUVHeight:X,aoMap:Te,lightMap:be,bumpMap:Ue,normalMap:we,displacementMap:d&&et,emissiveMap:Re,normalMapObjectSpace:we&&C.normalMapType===UO,normalMapTangentSpace:we&&C.normalMapType===Cu,metalnessMap:J,roughnessMap:F,anisotropy:G,anisotropyMap:Ve,clearcoat:de,clearcoatMap:Oe,clearcoatNormalMap:ze,clearcoatRoughnessMap:Ye,iridescence:le,iridescenceMap:Ie,iridescenceThicknessMap:gt,sheen:ye,sheenColorMap:yt,sheenRoughnessMap:ot,specularMap:Ze,specularColorMap:Ke,specularIntensityMap:ae,transmission:Le,transmissionMap:De,thicknessMap:rt,gradientMap:it,opaque:C.transparent===!1&&C.blending===lh,alphaMap:ve,alphaTest:ce,alphaHash:at,combine:C.combine,mapUv:Xe&&y(C.map.channel),aoMapUv:Te&&y(C.aoMap.channel),lightMapUv:be&&y(C.lightMap.channel),bumpMapUv:Ue&&y(C.bumpMap.channel),normalMapUv:we&&y(C.normalMap.channel),displacementMapUv:et&&y(C.displacementMap.channel),emissiveMapUv:Re&&y(C.emissiveMap.channel),metalnessMapUv:J&&y(C.metalnessMap.channel),roughnessMapUv:F&&y(C.roughnessMap.channel),anisotropyMapUv:Ve&&y(C.anisotropyMap.channel),clearcoatMapUv:Oe&&y(C.clearcoatMap.channel),clearcoatNormalMapUv:ze&&y(C.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ye&&y(C.clearcoatRoughnessMap.channel),iridescenceMapUv:Ie&&y(C.iridescenceMap.channel),iridescenceThicknessMapUv:gt&&y(C.iridescenceThicknessMap.channel),sheenColorMapUv:yt&&y(C.sheenColorMap.channel),sheenRoughnessMapUv:ot&&y(C.sheenRoughnessMap.channel),specularMapUv:Ze&&y(C.specularMap.channel),specularColorMapUv:Ke&&y(C.specularColorMap.channel),specularIntensityMapUv:ae&&y(C.specularIntensityMap.channel),transmissionMapUv:De&&y(C.transmissionMap.channel),thicknessMapUv:rt&&y(C.thicknessMap.channel),alphaMapUv:ve&&y(C.alphaMap.channel),vertexTangents:!!z.attributes.tangent&&(we||G),vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!z.attributes.color&&z.attributes.color.itemSize===4,vertexUv1s:ct,vertexUv2s:ft,vertexUv3s:Tt,pointsUvs:$.isPoints===!0&&!!z.attributes.uv&&(Xe||ve),fog:!!U,useFog:C.fog===!0,fogExp2:U&&U.isFogExp2,flatShading:C.flatShading===!0,sizeAttenuation:C.sizeAttenuation===!0,logarithmicDepthBuffer:f,skinning:$.isSkinnedMesh===!0,morphTargets:z.morphAttributes.position!==void 0,morphNormals:z.morphAttributes.normal!==void 0,morphColors:z.morphAttributes.color!==void 0,morphTargetsCount:V,morphTextureStride:Q,numDirLights:B.directional.length,numPointLights:B.point.length,numSpotLights:B.spot.length,numSpotLightMaps:B.spotLightMap.length,numRectAreaLights:B.rectArea.length,numHemiLights:B.hemi.length,numDirLightShadows:B.directionalShadowMap.length,numPointLightShadows:B.pointShadowMap.length,numSpotLightShadows:B.spotShadowMap.length,numSpotLightShadowsWithMaps:B.numSpotLightShadowsWithMaps,numLightProbes:B.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:n.shadowMap.enabled&&H.length>0,shadowMapType:n.shadowMap.type,toneMapping:mt,useLegacyLights:n._useLegacyLights,decodeVideoTexture:Xe&&C.map.isVideoTexture===!0&&Pn.getTransfer(C.map.colorSpace)===Hn,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===di,flipSided:C.side===Xr,useDepthPacking:C.depthPacking>=0,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionDerivatives:$e&&C.extensions.derivatives===!0,extensionFragDepth:$e&&C.extensions.fragDepth===!0,extensionDrawBuffers:$e&&C.extensions.drawBuffers===!0,extensionShaderTextureLOD:$e&&C.extensions.shaderTextureLOD===!0,extensionClipCullDistance:$e&&C.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),rendererExtensionFragDepth:u||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||r.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:C.customProgramCacheKey()}}function v(C){const B=[];if(C.shaderID?B.push(C.shaderID):(B.push(C.customVertexShaderID),B.push(C.customFragmentShaderID)),C.defines!==void 0)for(const H in C.defines)B.push(H),B.push(C.defines[H]);return C.isRawShaderMaterial===!1&&(A(B,C),w(B,C),B.push(n.outputColorSpace)),B.push(C.customProgramCacheKey),B.join()}function A(C,B){C.push(B.precision),C.push(B.outputColorSpace),C.push(B.envMapMode),C.push(B.envMapCubeUVHeight),C.push(B.mapUv),C.push(B.alphaMapUv),C.push(B.lightMapUv),C.push(B.aoMapUv),C.push(B.bumpMapUv),C.push(B.normalMapUv),C.push(B.displacementMapUv),C.push(B.emissiveMapUv),C.push(B.metalnessMapUv),C.push(B.roughnessMapUv),C.push(B.anisotropyMapUv),C.push(B.clearcoatMapUv),C.push(B.clearcoatNormalMapUv),C.push(B.clearcoatRoughnessMapUv),C.push(B.iridescenceMapUv),C.push(B.iridescenceThicknessMapUv),C.push(B.sheenColorMapUv),C.push(B.sheenRoughnessMapUv),C.push(B.specularMapUv),C.push(B.specularColorMapUv),C.push(B.specularIntensityMapUv),C.push(B.transmissionMapUv),C.push(B.thicknessMapUv),C.push(B.combine),C.push(B.fogExp2),C.push(B.sizeAttenuation),C.push(B.morphTargetsCount),C.push(B.morphAttributeCount),C.push(B.numDirLights),C.push(B.numPointLights),C.push(B.numSpotLights),C.push(B.numSpotLightMaps),C.push(B.numHemiLights),C.push(B.numRectAreaLights),C.push(B.numDirLightShadows),C.push(B.numPointLightShadows),C.push(B.numSpotLightShadows),C.push(B.numSpotLightShadowsWithMaps),C.push(B.numLightProbes),C.push(B.shadowMapType),C.push(B.toneMapping),C.push(B.numClippingPlanes),C.push(B.numClipIntersection),C.push(B.depthPacking)}function w(C,B){a.disableAll(),B.isWebGL2&&a.enable(0),B.supportsVertexTextures&&a.enable(1),B.instancing&&a.enable(2),B.instancingColor&&a.enable(3),B.matcap&&a.enable(4),B.envMap&&a.enable(5),B.normalMapObjectSpace&&a.enable(6),B.normalMapTangentSpace&&a.enable(7),B.clearcoat&&a.enable(8),B.iridescence&&a.enable(9),B.alphaTest&&a.enable(10),B.vertexColors&&a.enable(11),B.vertexAlphas&&a.enable(12),B.vertexUv1s&&a.enable(13),B.vertexUv2s&&a.enable(14),B.vertexUv3s&&a.enable(15),B.vertexTangents&&a.enable(16),B.anisotropy&&a.enable(17),B.alphaHash&&a.enable(18),B.batching&&a.enable(19),C.push(a.mask),a.disableAll(),B.fog&&a.enable(0),B.useFog&&a.enable(1),B.flatShading&&a.enable(2),B.logarithmicDepthBuffer&&a.enable(3),B.skinning&&a.enable(4),B.morphTargets&&a.enable(5),B.morphNormals&&a.enable(6),B.morphColors&&a.enable(7),B.premultipliedAlpha&&a.enable(8),B.shadowMapEnabled&&a.enable(9),B.useLegacyLights&&a.enable(10),B.doubleSided&&a.enable(11),B.flipSided&&a.enable(12),B.useDepthPacking&&a.enable(13),B.dithering&&a.enable(14),B.transmission&&a.enable(15),B.sheen&&a.enable(16),B.opaque&&a.enable(17),B.pointsUvs&&a.enable(18),B.decodeVideoTexture&&a.enable(19),C.push(a.mask)}function S(C){const B=g[C.type];let H;if(B){const k=jo[B];H=P2.clone(k.uniforms)}else H=C.uniforms;return H}function M(C,B){let H;for(let k=0,$=c.length;k<$;k++){const U=c[k];if(U.cacheKey===B){H=U,++H.usedTimes;break}}return H===void 0&&(H=new QX(n,B,C,s),c.push(H)),H}function b(C){if(--C.usedTimes===0){const B=c.indexOf(C);c[B]=c[c.length-1],c.pop(),C.destroy()}}function R(C){l.remove(C)}function P(){l.dispose()}return{getParameters:x,getProgramCacheKey:v,getUniforms:S,acquireProgram:M,releaseProgram:b,releaseShaderCache:R,programs:c,dispose:P}}function $X(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function r(s,o,a){n.get(s)[o]=a}function i(){n=new WeakMap}return{get:e,remove:t,update:r,dispose:i}}function eJ(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function pL(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function mL(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function o(f,d,m,g,y,x){let v=n[e];return v===void 0?(v={id:f.id,object:f,geometry:d,material:m,groupOrder:g,renderOrder:f.renderOrder,z:y,group:x},n[e]=v):(v.id=f.id,v.object=f,v.geometry=d,v.material=m,v.groupOrder=g,v.renderOrder=f.renderOrder,v.z=y,v.group=x),e++,v}function a(f,d,m,g,y,x){const v=o(f,d,m,g,y,x);m.transmission>0?r.push(v):m.transparent===!0?i.push(v):t.push(v)}function l(f,d,m,g,y,x){const v=o(f,d,m,g,y,x);m.transmission>0?r.unshift(v):m.transparent===!0?i.unshift(v):t.unshift(v)}function c(f,d){t.length>1&&t.sort(f||eJ),r.length>1&&r.sort(d||pL),i.length>1&&i.sort(d||pL)}function u(){for(let f=e,d=n.length;f<d;f++){const m=n[f];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:a,unshift:l,finish:u,sort:c}}function tJ(){let n=new WeakMap;function e(r,i){const s=n.get(r);let o;return s===void 0?(o=new mL,n.set(r,[o])):i>=s.length?(o=new mL,s.push(o)):o=s[i],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function nJ(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Y,color:new ht};break;case"SpotLight":t={position:new Y,direction:new Y,color:new ht,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Y,color:new ht,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Y,skyColor:new ht,groundColor:new ht};break;case"RectAreaLight":t={color:new ht,position:new Y,halfWidth:new Y,halfHeight:new Y};break}return n[e.id]=t,t}}}function rJ(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ge};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ge};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ge,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let iJ=0;function sJ(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function oJ(n,e){const t=new nJ,r=rJ(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)i.probe.push(new Y);const s=new Y,o=new Bt,a=new Bt;function l(u,f){let d=0,m=0,g=0;for(let k=0;k<9;k++)i.probe[k].set(0,0,0);let y=0,x=0,v=0,A=0,w=0,S=0,M=0,b=0,R=0,P=0,C=0;u.sort(sJ);const B=f===!0?Math.PI:1;for(let k=0,$=u.length;k<$;k++){const U=u[k],z=U.color,O=U.intensity,ie=U.distance,X=U.shadow&&U.shadow.map?U.shadow.map.texture:null;if(U.isAmbientLight)d+=z.r*O*B,m+=z.g*O*B,g+=z.b*O*B;else if(U.isLightProbe){for(let K=0;K<9;K++)i.probe[K].addScaledVector(U.sh.coefficients[K],O);C++}else if(U.isDirectionalLight){const K=t.get(U);if(K.color.copy(U.color).multiplyScalar(U.intensity*B),U.castShadow){const W=U.shadow,V=r.get(U);V.shadowBias=W.bias,V.shadowNormalBias=W.normalBias,V.shadowRadius=W.radius,V.shadowMapSize=W.mapSize,i.directionalShadow[y]=V,i.directionalShadowMap[y]=X,i.directionalShadowMatrix[y]=U.shadow.matrix,S++}i.directional[y]=K,y++}else if(U.isSpotLight){const K=t.get(U);K.position.setFromMatrixPosition(U.matrixWorld),K.color.copy(z).multiplyScalar(O*B),K.distance=ie,K.coneCos=Math.cos(U.angle),K.penumbraCos=Math.cos(U.angle*(1-U.penumbra)),K.decay=U.decay,i.spot[v]=K;const W=U.shadow;if(U.map&&(i.spotLightMap[R]=U.map,R++,W.updateMatrices(U),U.castShadow&&P++),i.spotLightMatrix[v]=W.matrix,U.castShadow){const V=r.get(U);V.shadowBias=W.bias,V.shadowNormalBias=W.normalBias,V.shadowRadius=W.radius,V.shadowMapSize=W.mapSize,i.spotShadow[v]=V,i.spotShadowMap[v]=X,b++}v++}else if(U.isRectAreaLight){const K=t.get(U);K.color.copy(z).multiplyScalar(O),K.halfWidth.set(U.width*.5,0,0),K.halfHeight.set(0,U.height*.5,0),i.rectArea[A]=K,A++}else if(U.isPointLight){const K=t.get(U);if(K.color.copy(U.color).multiplyScalar(U.intensity*B),K.distance=U.distance,K.decay=U.decay,U.castShadow){const W=U.shadow,V=r.get(U);V.shadowBias=W.bias,V.shadowNormalBias=W.normalBias,V.shadowRadius=W.radius,V.shadowMapSize=W.mapSize,V.shadowCameraNear=W.camera.near,V.shadowCameraFar=W.camera.far,i.pointShadow[x]=V,i.pointShadowMap[x]=X,i.pointShadowMatrix[x]=U.shadow.matrix,M++}i.point[x]=K,x++}else if(U.isHemisphereLight){const K=t.get(U);K.skyColor.copy(U.color).multiplyScalar(O*B),K.groundColor.copy(U.groundColor).multiplyScalar(O*B),i.hemi[w]=K,w++}}A>0&&(e.isWebGL2?n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=pt.LTC_FLOAT_1,i.rectAreaLTC2=pt.LTC_FLOAT_2):(i.rectAreaLTC1=pt.LTC_HALF_1,i.rectAreaLTC2=pt.LTC_HALF_2):n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=pt.LTC_FLOAT_1,i.rectAreaLTC2=pt.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=pt.LTC_HALF_1,i.rectAreaLTC2=pt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=d,i.ambient[1]=m,i.ambient[2]=g;const H=i.hash;(H.directionalLength!==y||H.pointLength!==x||H.spotLength!==v||H.rectAreaLength!==A||H.hemiLength!==w||H.numDirectionalShadows!==S||H.numPointShadows!==M||H.numSpotShadows!==b||H.numSpotMaps!==R||H.numLightProbes!==C)&&(i.directional.length=y,i.spot.length=v,i.rectArea.length=A,i.point.length=x,i.hemi.length=w,i.directionalShadow.length=S,i.directionalShadowMap.length=S,i.pointShadow.length=M,i.pointShadowMap.length=M,i.spotShadow.length=b,i.spotShadowMap.length=b,i.directionalShadowMatrix.length=S,i.pointShadowMatrix.length=M,i.spotLightMatrix.length=b+R-P,i.spotLightMap.length=R,i.numSpotLightShadowsWithMaps=P,i.numLightProbes=C,H.directionalLength=y,H.pointLength=x,H.spotLength=v,H.rectAreaLength=A,H.hemiLength=w,H.numDirectionalShadows=S,H.numPointShadows=M,H.numSpotShadows=b,H.numSpotMaps=R,H.numLightProbes=C,i.version=iJ++)}function c(u,f){let d=0,m=0,g=0,y=0,x=0;const v=f.matrixWorldInverse;for(let A=0,w=u.length;A<w;A++){const S=u[A];if(S.isDirectionalLight){const M=i.directional[d];M.direction.setFromMatrixPosition(S.matrixWorld),s.setFromMatrixPosition(S.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(v),d++}else if(S.isSpotLight){const M=i.spot[g];M.position.setFromMatrixPosition(S.matrixWorld),M.position.applyMatrix4(v),M.direction.setFromMatrixPosition(S.matrixWorld),s.setFromMatrixPosition(S.target.matrixWorld),M.direction.sub(s),M.direction.transformDirection(v),g++}else if(S.isRectAreaLight){const M=i.rectArea[y];M.position.setFromMatrixPosition(S.matrixWorld),M.position.applyMatrix4(v),a.identity(),o.copy(S.matrixWorld),o.premultiply(v),a.extractRotation(o),M.halfWidth.set(S.width*.5,0,0),M.halfHeight.set(0,S.height*.5,0),M.halfWidth.applyMatrix4(a),M.halfHeight.applyMatrix4(a),y++}else if(S.isPointLight){const M=i.point[m];M.position.setFromMatrixPosition(S.matrixWorld),M.position.applyMatrix4(v),m++}else if(S.isHemisphereLight){const M=i.hemi[x];M.direction.setFromMatrixPosition(S.matrixWorld),M.direction.transformDirection(v),x++}}}return{setup:l,setupView:c,state:i}}function gL(n,e){const t=new oJ(n,e),r=[],i=[];function s(){r.length=0,i.length=0}function o(f){r.push(f)}function a(f){i.push(f)}function l(f){t.setup(r,f)}function c(f){t.setupView(r,f)}return{init:s,state:{lightsArray:r,shadowsArray:i,lights:t},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function aJ(n,e){let t=new WeakMap;function r(s,o=0){const a=t.get(s);let l;return a===void 0?(l=new gL(n,e),t.set(s,[l])):o>=a.length?(l=new gL(n,e),a.push(l)):l=a[o],l}function i(){t=new WeakMap}return{get:r,dispose:i}}class z_ extends ur{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Tu,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class H_ extends ur{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const lJ=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,cJ=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function uJ(n,e,t){let r=new Kv;const i=new Ge,s=new Ge,o=new wn,a=new z_({depthPacking:S2}),l=new H_,c={},u=t.maxTextureSize,f={[sa]:Xr,[Xr]:sa,[di]:di},d=new Pr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ge},radius:{value:4}},vertexShader:lJ,fragmentShader:cJ}),m=d.clone();m.defines.HORIZONTAL_PASS=1;const g=new jt;g.setAttribute("position",new vn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const y=new On(g,d),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=I_;let v=this.type;this.render=function(b,R,P){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||b.length===0)return;const C=n.getRenderTarget(),B=n.getActiveCubeFace(),H=n.getActiveMipmapLevel(),k=n.state;k.setBlending(gi),k.buffers.color.setClear(1,1,1,1),k.buffers.depth.setTest(!0),k.setScissorTest(!1);const $=v!==Fo&&this.type===Fo,U=v===Fo&&this.type!==Fo;for(let z=0,O=b.length;z<O;z++){const ie=b[z],X=ie.shadow;if(X===void 0){console.warn("THREE.WebGLShadowMap:",ie,"has no shadow.");continue}if(X.autoUpdate===!1&&X.needsUpdate===!1)continue;i.copy(X.mapSize);const K=X.getFrameExtents();if(i.multiply(K),s.copy(X.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(s.x=Math.floor(u/K.x),i.x=s.x*K.x,X.mapSize.x=s.x),i.y>u&&(s.y=Math.floor(u/K.y),i.y=s.y*K.y,X.mapSize.y=s.y)),X.map===null||$===!0||U===!0){const V=this.type!==Fo?{minFilter:Vn,magFilter:Vn}:{};X.map!==null&&X.map.dispose(),X.map=new hr(i.x,i.y,V),X.map.texture.name=ie.name+".shadowMap",X.camera.updateProjectionMatrix()}n.setRenderTarget(X.map),n.clear();const W=X.getViewportCount();for(let V=0;V<W;V++){const Q=X.getViewport(V);o.set(s.x*Q.x,s.y*Q.y,s.x*Q.z,s.y*Q.w),k.viewport(o),X.updateMatrices(ie,V),r=X.getFrustum(),S(R,P,X.camera,ie,this.type)}X.isPointLightShadow!==!0&&this.type===Fo&&A(X,P),X.needsUpdate=!1}v=this.type,x.needsUpdate=!1,n.setRenderTarget(C,B,H)};function A(b,R){const P=e.update(y);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,m.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,m.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new hr(i.x,i.y)),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,n.setRenderTarget(b.mapPass),n.clear(),n.renderBufferDirect(R,null,P,d,y,null),m.uniforms.shadow_pass.value=b.mapPass.texture,m.uniforms.resolution.value=b.mapSize,m.uniforms.radius.value=b.radius,n.setRenderTarget(b.map),n.clear(),n.renderBufferDirect(R,null,P,m,y,null)}function w(b,R,P,C){let B=null;const H=P.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(H!==void 0)B=H;else if(B=P.isPointLight===!0?l:a,n.localClippingEnabled&&R.clipShadows===!0&&Array.isArray(R.clippingPlanes)&&R.clippingPlanes.length!==0||R.displacementMap&&R.displacementScale!==0||R.alphaMap&&R.alphaTest>0||R.map&&R.alphaTest>0){const k=B.uuid,$=R.uuid;let U=c[k];U===void 0&&(U={},c[k]=U);let z=U[$];z===void 0&&(z=B.clone(),U[$]=z,R.addEventListener("dispose",M)),B=z}if(B.visible=R.visible,B.wireframe=R.wireframe,C===Fo?B.side=R.shadowSide!==null?R.shadowSide:R.side:B.side=R.shadowSide!==null?R.shadowSide:f[R.side],B.alphaMap=R.alphaMap,B.alphaTest=R.alphaTest,B.map=R.map,B.clipShadows=R.clipShadows,B.clippingPlanes=R.clippingPlanes,B.clipIntersection=R.clipIntersection,B.displacementMap=R.displacementMap,B.displacementScale=R.displacementScale,B.displacementBias=R.displacementBias,B.wireframeLinewidth=R.wireframeLinewidth,B.linewidth=R.linewidth,P.isPointLight===!0&&B.isMeshDistanceMaterial===!0){const k=n.properties.get(B);k.light=P}return B}function S(b,R,P,C,B){if(b.visible===!1)return;if(b.layers.test(R.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&B===Fo)&&(!b.frustumCulled||r.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,b.matrixWorld);const $=e.update(b),U=b.material;if(Array.isArray(U)){const z=$.groups;for(let O=0,ie=z.length;O<ie;O++){const X=z[O],K=U[X.materialIndex];if(K&&K.visible){const W=w(b,K,C,B);b.onBeforeShadow(n,b,R,P,$,W,X),n.renderBufferDirect(P,null,$,W,b,X),b.onAfterShadow(n,b,R,P,$,W,X)}}}else if(U.visible){const z=w(b,U,C,B);b.onBeforeShadow(n,b,R,P,$,z,null),n.renderBufferDirect(P,null,$,z,b,null),b.onAfterShadow(n,b,R,P,$,z,null)}}const k=b.children;for(let $=0,U=k.length;$<U;$++)S(k[$],R,P,C,B)}function M(b){b.target.removeEventListener("dispose",M);for(const P in c){const C=c[P],B=b.target.uuid;B in C&&(C[B].dispose(),delete C[B])}}}function fJ(n,e,t){const r=t.isWebGL2;function i(){let ce=!1;const at=new wn;let $e=null;const ct=new wn(0,0,0,0);return{setMask:function(ft){$e!==ft&&!ce&&(n.colorMask(ft,ft,ft,ft),$e=ft)},setLocked:function(ft){ce=ft},setClear:function(ft,Tt,mt,Dt,qt){qt===!0&&(ft*=Dt,Tt*=Dt,mt*=Dt),at.set(ft,Tt,mt,Dt),ct.equals(at)===!1&&(n.clearColor(ft,Tt,mt,Dt),ct.copy(at))},reset:function(){ce=!1,$e=null,ct.set(-1,0,0,0)}}}function s(){let ce=!1,at=null,$e=null,ct=null;return{setTest:function(ft){ft?Je(n.DEPTH_TEST):Xe(n.DEPTH_TEST)},setMask:function(ft){at!==ft&&!ce&&(n.depthMask(ft),at=ft)},setFunc:function(ft){if($e!==ft){switch(ft){case pO:n.depthFunc(n.NEVER);break;case c2:n.depthFunc(n.ALWAYS);break;case mO:n.depthFunc(n.LESS);break;case H0:n.depthFunc(n.LEQUAL);break;case gO:n.depthFunc(n.EQUAL);break;case vO:n.depthFunc(n.GEQUAL);break;case yO:n.depthFunc(n.GREATER);break;case xO:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}$e=ft}},setLocked:function(ft){ce=ft},setClear:function(ft){ct!==ft&&(n.clearDepth(ft),ct=ft)},reset:function(){ce=!1,at=null,$e=null,ct=null}}}function o(){let ce=!1,at=null,$e=null,ct=null,ft=null,Tt=null,mt=null,Dt=null,qt=null;return{setTest:function(Ft){ce||(Ft?Je(n.STENCIL_TEST):Xe(n.STENCIL_TEST))},setMask:function(Ft){at!==Ft&&!ce&&(n.stencilMask(Ft),at=Ft)},setFunc:function(Ft,ln,zn){($e!==Ft||ct!==ln||ft!==zn)&&(n.stencilFunc(Ft,ln,zn),$e=Ft,ct=ln,ft=zn)},setOp:function(Ft,ln,zn){(Tt!==Ft||mt!==ln||Dt!==zn)&&(n.stencilOp(Ft,ln,zn),Tt=Ft,mt=ln,Dt=zn)},setLocked:function(Ft){ce=Ft},setClear:function(Ft){qt!==Ft&&(n.clearStencil(Ft),qt=Ft)},reset:function(){ce=!1,at=null,$e=null,ct=null,ft=null,Tt=null,mt=null,Dt=null,qt=null}}}const a=new i,l=new s,c=new o,u=new WeakMap,f=new WeakMap;let d={},m={},g=new WeakMap,y=[],x=null,v=!1,A=null,w=null,S=null,M=null,b=null,R=null,P=null,C=new ht(0,0,0),B=0,H=!1,k=null,$=null,U=null,z=null,O=null;const ie=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let X=!1,K=0;const W=n.getParameter(n.VERSION);W.indexOf("WebGL")!==-1?(K=parseFloat(/^WebGL (\d)/.exec(W)[1]),X=K>=1):W.indexOf("OpenGL ES")!==-1&&(K=parseFloat(/^OpenGL ES (\d)/.exec(W)[1]),X=K>=2);let V=null,Q={};const q=n.getParameter(n.SCISSOR_BOX),ne=n.getParameter(n.VIEWPORT),fe=new wn().fromArray(q),pe=new wn().fromArray(ne);function ge(ce,at,$e,ct){const ft=new Uint8Array(4),Tt=n.createTexture();n.bindTexture(ce,Tt),n.texParameteri(ce,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(ce,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let mt=0;mt<$e;mt++)r&&(ce===n.TEXTURE_3D||ce===n.TEXTURE_2D_ARRAY)?n.texImage3D(at,0,n.RGBA,1,1,ct,0,n.RGBA,n.UNSIGNED_BYTE,ft):n.texImage2D(at+mt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,ft);return Tt}const Ce={};Ce[n.TEXTURE_2D]=ge(n.TEXTURE_2D,n.TEXTURE_2D,1),Ce[n.TEXTURE_CUBE_MAP]=ge(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(Ce[n.TEXTURE_2D_ARRAY]=ge(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ce[n.TEXTURE_3D]=ge(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),Je(n.DEPTH_TEST),l.setFunc(H0),Re(!1),J(yM),Je(n.CULL_FACE),we(gi);function Je(ce){d[ce]!==!0&&(n.enable(ce),d[ce]=!0)}function Xe(ce){d[ce]!==!1&&(n.disable(ce),d[ce]=!1)}function Fe(ce,at){return m[ce]!==at?(n.bindFramebuffer(ce,at),m[ce]=at,r&&(ce===n.DRAW_FRAMEBUFFER&&(m[n.FRAMEBUFFER]=at),ce===n.FRAMEBUFFER&&(m[n.DRAW_FRAMEBUFFER]=at)),!0):!1}function j(ce,at){let $e=y,ct=!1;if(ce)if($e=g.get(at),$e===void 0&&($e=[],g.set(at,$e)),ce.isWebGLMultipleRenderTargets){const ft=ce.texture;if($e.length!==ft.length||$e[0]!==n.COLOR_ATTACHMENT0){for(let Tt=0,mt=ft.length;Tt<mt;Tt++)$e[Tt]=n.COLOR_ATTACHMENT0+Tt;$e.length=ft.length,ct=!0}}else $e[0]!==n.COLOR_ATTACHMENT0&&($e[0]=n.COLOR_ATTACHMENT0,ct=!0);else $e[0]!==n.BACK&&($e[0]=n.BACK,ct=!0);ct&&(t.isWebGL2?n.drawBuffers($e):e.get("WEBGL_draw_buffers").drawBuffersWEBGL($e))}function Te(ce){return x!==ce?(n.useProgram(ce),x=ce,!0):!1}const be={[Rc]:n.FUNC_ADD,[$F]:n.FUNC_SUBTRACT,[eO]:n.FUNC_REVERSE_SUBTRACT};if(r)be[wM]=n.MIN,be[EM]=n.MAX;else{const ce=e.get("EXT_blend_minmax");ce!==null&&(be[wM]=ce.MIN_EXT,be[EM]=ce.MAX_EXT)}const Ue={[tO]:n.ZERO,[nO]:n.ONE,[rO]:n.SRC_COLOR,[kA]:n.SRC_ALPHA,[cO]:n.SRC_ALPHA_SATURATE,[aO]:n.DST_COLOR,[sO]:n.DST_ALPHA,[iO]:n.ONE_MINUS_SRC_COLOR,[GA]:n.ONE_MINUS_SRC_ALPHA,[lO]:n.ONE_MINUS_DST_COLOR,[oO]:n.ONE_MINUS_DST_ALPHA,[uO]:n.CONSTANT_COLOR,[fO]:n.ONE_MINUS_CONSTANT_COLOR,[hO]:n.CONSTANT_ALPHA,[dO]:n.ONE_MINUS_CONSTANT_ALPHA};function we(ce,at,$e,ct,ft,Tt,mt,Dt,qt,Ft){if(ce===gi){v===!0&&(Xe(n.BLEND),v=!1);return}if(v===!1&&(Je(n.BLEND),v=!0),ce!==qF){if(ce!==A||Ft!==H){if((w!==Rc||b!==Rc)&&(n.blendEquation(n.FUNC_ADD),w=Rc,b=Rc),Ft)switch(ce){case lh:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case xM:n.blendFunc(n.ONE,n.ONE);break;case AM:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case _M:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce);break}else switch(ce){case lh:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case xM:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case AM:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case _M:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce);break}S=null,M=null,R=null,P=null,C.set(0,0,0),B=0,A=ce,H=Ft}return}ft=ft||at,Tt=Tt||$e,mt=mt||ct,(at!==w||ft!==b)&&(n.blendEquationSeparate(be[at],be[ft]),w=at,b=ft),($e!==S||ct!==M||Tt!==R||mt!==P)&&(n.blendFuncSeparate(Ue[$e],Ue[ct],Ue[Tt],Ue[mt]),S=$e,M=ct,R=Tt,P=mt),(Dt.equals(C)===!1||qt!==B)&&(n.blendColor(Dt.r,Dt.g,Dt.b,qt),C.copy(Dt),B=qt),A=ce,H=!1}function et(ce,at){ce.side===di?Xe(n.CULL_FACE):Je(n.CULL_FACE);let $e=ce.side===Xr;at&&($e=!$e),Re($e),ce.blending===lh&&ce.transparent===!1?we(gi):we(ce.blending,ce.blendEquation,ce.blendSrc,ce.blendDst,ce.blendEquationAlpha,ce.blendSrcAlpha,ce.blendDstAlpha,ce.blendColor,ce.blendAlpha,ce.premultipliedAlpha),l.setFunc(ce.depthFunc),l.setTest(ce.depthTest),l.setMask(ce.depthWrite),a.setMask(ce.colorWrite);const ct=ce.stencilWrite;c.setTest(ct),ct&&(c.setMask(ce.stencilWriteMask),c.setFunc(ce.stencilFunc,ce.stencilRef,ce.stencilFuncMask),c.setOp(ce.stencilFail,ce.stencilZFail,ce.stencilZPass)),G(ce.polygonOffset,ce.polygonOffsetFactor,ce.polygonOffsetUnits),ce.alphaToCoverage===!0?Je(n.SAMPLE_ALPHA_TO_COVERAGE):Xe(n.SAMPLE_ALPHA_TO_COVERAGE)}function Re(ce){k!==ce&&(ce?n.frontFace(n.CW):n.frontFace(n.CCW),k=ce)}function J(ce){ce!==jF?(Je(n.CULL_FACE),ce!==$&&(ce===yM?n.cullFace(n.BACK):ce===YF?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Xe(n.CULL_FACE),$=ce}function F(ce){ce!==U&&(X&&n.lineWidth(ce),U=ce)}function G(ce,at,$e){ce?(Je(n.POLYGON_OFFSET_FILL),(z!==at||O!==$e)&&(n.polygonOffset(at,$e),z=at,O=$e)):Xe(n.POLYGON_OFFSET_FILL)}function de(ce){ce?Je(n.SCISSOR_TEST):Xe(n.SCISSOR_TEST)}function le(ce){ce===void 0&&(ce=n.TEXTURE0+ie-1),V!==ce&&(n.activeTexture(ce),V=ce)}function ye(ce,at,$e){$e===void 0&&(V===null?$e=n.TEXTURE0+ie-1:$e=V);let ct=Q[$e];ct===void 0&&(ct={type:void 0,texture:void 0},Q[$e]=ct),(ct.type!==ce||ct.texture!==at)&&(V!==$e&&(n.activeTexture($e),V=$e),n.bindTexture(ce,at||Ce[ce]),ct.type=ce,ct.texture=at)}function Le(){const ce=Q[V];ce!==void 0&&ce.type!==void 0&&(n.bindTexture(ce.type,null),ce.type=void 0,ce.texture=void 0)}function Ve(){try{n.compressedTexImage2D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function Oe(){try{n.compressedTexImage3D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function ze(){try{n.texSubImage2D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function Ye(){try{n.texSubImage3D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function Ie(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function gt(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function yt(){try{n.texStorage2D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function ot(){try{n.texStorage3D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function Ze(){try{n.texImage2D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function Ke(){try{n.texImage3D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}function ae(ce){fe.equals(ce)===!1&&(n.scissor(ce.x,ce.y,ce.z,ce.w),fe.copy(ce))}function De(ce){pe.equals(ce)===!1&&(n.viewport(ce.x,ce.y,ce.z,ce.w),pe.copy(ce))}function rt(ce,at){let $e=f.get(at);$e===void 0&&($e=new WeakMap,f.set(at,$e));let ct=$e.get(ce);ct===void 0&&(ct=n.getUniformBlockIndex(at,ce.name),$e.set(ce,ct))}function it(ce,at){const ct=f.get(at).get(ce);u.get(at)!==ct&&(n.uniformBlockBinding(at,ct,ce.__bindingPointIndex),u.set(at,ct))}function ve(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),r===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),d={},V=null,Q={},m={},g=new WeakMap,y=[],x=null,v=!1,A=null,w=null,S=null,M=null,b=null,R=null,P=null,C=new ht(0,0,0),B=0,H=!1,k=null,$=null,U=null,z=null,O=null,fe.set(0,0,n.canvas.width,n.canvas.height),pe.set(0,0,n.canvas.width,n.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:Je,disable:Xe,bindFramebuffer:Fe,drawBuffers:j,useProgram:Te,setBlending:we,setMaterial:et,setFlipSided:Re,setCullFace:J,setLineWidth:F,setPolygonOffset:G,setScissorTest:de,activeTexture:le,bindTexture:ye,unbindTexture:Le,compressedTexImage2D:Ve,compressedTexImage3D:Oe,texImage2D:Ze,texImage3D:Ke,updateUBOMapping:rt,uniformBlockBinding:it,texStorage2D:yt,texStorage3D:ot,texSubImage2D:ze,texSubImage3D:Ye,compressedTexSubImage2D:Ie,compressedTexSubImage3D:gt,scissor:ae,viewport:De,reset:ve}}function hJ(n,e,t,r,i,s,o){const a=i.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new WeakMap;let f;const d=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function g(J,F){return m?new OffscreenCanvas(J,F):Y0("canvas")}function y(J,F,G,de){let le=1;if((J.width>de||J.height>de)&&(le=de/Math.max(J.width,J.height)),le<1||F===!0)if(typeof HTMLImageElement<"u"&&J instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&J instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&J instanceof ImageBitmap){const ye=F?VA:Math.floor,Le=ye(le*J.width),Ve=ye(le*J.height);f===void 0&&(f=g(Le,Ve));const Oe=G?g(Le,Ve):f;return Oe.width=Le,Oe.height=Ve,Oe.getContext("2d").drawImage(J,0,0,Le,Ve),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+J.width+"x"+J.height+") to ("+Le+"x"+Ve+")."),Oe}else return"data"in J&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+J.width+"x"+J.height+")."),J;return J}function x(J){return eT(J.width)&&eT(J.height)}function v(J){return a?!1:J.wrapS!==Qn||J.wrapT!==Qn||J.minFilter!==Vn&&J.minFilter!==un}function A(J,F){return J.generateMipmaps&&F&&J.minFilter!==Vn&&J.minFilter!==un}function w(J){n.generateMipmap(J)}function S(J,F,G,de,le=!1){if(a===!1)return F;if(J!==null){if(n[J]!==void 0)return n[J];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+J+"'")}let ye=F;if(F===n.RED&&(G===n.FLOAT&&(ye=n.R32F),G===n.HALF_FLOAT&&(ye=n.R16F),G===n.UNSIGNED_BYTE&&(ye=n.R8)),F===n.RED_INTEGER&&(G===n.UNSIGNED_BYTE&&(ye=n.R8UI),G===n.UNSIGNED_SHORT&&(ye=n.R16UI),G===n.UNSIGNED_INT&&(ye=n.R32UI),G===n.BYTE&&(ye=n.R8I),G===n.SHORT&&(ye=n.R16I),G===n.INT&&(ye=n.R32I)),F===n.RG&&(G===n.FLOAT&&(ye=n.RG32F),G===n.HALF_FLOAT&&(ye=n.RG16F),G===n.UNSIGNED_BYTE&&(ye=n.RG8)),F===n.RGBA){const Le=le?J0:Pn.getTransfer(de);G===n.FLOAT&&(ye=n.RGBA32F),G===n.HALF_FLOAT&&(ye=n.RGBA16F),G===n.UNSIGNED_BYTE&&(ye=Le===Hn?n.SRGB8_ALPHA8:n.RGBA8),G===n.UNSIGNED_SHORT_4_4_4_4&&(ye=n.RGBA4),G===n.UNSIGNED_SHORT_5_5_5_1&&(ye=n.RGB5_A1)}return(ye===n.R16F||ye===n.R32F||ye===n.RG16F||ye===n.RG32F||ye===n.RGBA16F||ye===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ye}function M(J,F,G){return A(J,G)===!0||J.isFramebufferTexture&&J.minFilter!==Vn&&J.minFilter!==un?Math.log2(Math.max(F.width,F.height))+1:J.mipmaps!==void 0&&J.mipmaps.length>0?J.mipmaps.length:J.isCompressedTexture&&Array.isArray(J.image)?F.mipmaps.length:1}function b(J){return J===Vn||J===W0||J===fp?n.NEAREST:n.LINEAR}function R(J){const F=J.target;F.removeEventListener("dispose",R),C(F),F.isVideoTexture&&u.delete(F)}function P(J){const F=J.target;F.removeEventListener("dispose",P),H(F)}function C(J){const F=r.get(J);if(F.__webglInit===void 0)return;const G=J.source,de=d.get(G);if(de){const le=de[F.__cacheKey];le.usedTimes--,le.usedTimes===0&&B(J),Object.keys(de).length===0&&d.delete(G)}r.remove(J)}function B(J){const F=r.get(J);n.deleteTexture(F.__webglTexture);const G=J.source,de=d.get(G);delete de[F.__cacheKey],o.memory.textures--}function H(J){const F=J.texture,G=r.get(J),de=r.get(F);if(de.__webglTexture!==void 0&&(n.deleteTexture(de.__webglTexture),o.memory.textures--),J.depthTexture&&J.depthTexture.dispose(),J.isWebGLCubeRenderTarget)for(let le=0;le<6;le++){if(Array.isArray(G.__webglFramebuffer[le]))for(let ye=0;ye<G.__webglFramebuffer[le].length;ye++)n.deleteFramebuffer(G.__webglFramebuffer[le][ye]);else n.deleteFramebuffer(G.__webglFramebuffer[le]);G.__webglDepthbuffer&&n.deleteRenderbuffer(G.__webglDepthbuffer[le])}else{if(Array.isArray(G.__webglFramebuffer))for(let le=0;le<G.__webglFramebuffer.length;le++)n.deleteFramebuffer(G.__webglFramebuffer[le]);else n.deleteFramebuffer(G.__webglFramebuffer);if(G.__webglDepthbuffer&&n.deleteRenderbuffer(G.__webglDepthbuffer),G.__webglMultisampledFramebuffer&&n.deleteFramebuffer(G.__webglMultisampledFramebuffer),G.__webglColorRenderbuffer)for(let le=0;le<G.__webglColorRenderbuffer.length;le++)G.__webglColorRenderbuffer[le]&&n.deleteRenderbuffer(G.__webglColorRenderbuffer[le]);G.__webglDepthRenderbuffer&&n.deleteRenderbuffer(G.__webglDepthRenderbuffer)}if(J.isWebGLMultipleRenderTargets)for(let le=0,ye=F.length;le<ye;le++){const Le=r.get(F[le]);Le.__webglTexture&&(n.deleteTexture(Le.__webglTexture),o.memory.textures--),r.remove(F[le])}r.remove(F),r.remove(J)}let k=0;function $(){k=0}function U(){const J=k;return J>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+J+" texture units while this GPU supports only "+i.maxTextures),k+=1,J}function z(J){const F=[];return F.push(J.wrapS),F.push(J.wrapT),F.push(J.wrapR||0),F.push(J.magFilter),F.push(J.minFilter),F.push(J.anisotropy),F.push(J.internalFormat),F.push(J.format),F.push(J.type),F.push(J.generateMipmaps),F.push(J.premultiplyAlpha),F.push(J.flipY),F.push(J.unpackAlignment),F.push(J.colorSpace),F.join()}function O(J,F){const G=r.get(J);if(J.isVideoTexture&&et(J),J.isRenderTargetTexture===!1&&J.version>0&&G.__version!==J.version){const de=J.image;if(de===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(de.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{fe(G,J,F);return}}t.bindTexture(n.TEXTURE_2D,G.__webglTexture,n.TEXTURE0+F)}function ie(J,F){const G=r.get(J);if(J.version>0&&G.__version!==J.version){fe(G,J,F);return}t.bindTexture(n.TEXTURE_2D_ARRAY,G.__webglTexture,n.TEXTURE0+F)}function X(J,F){const G=r.get(J);if(J.version>0&&G.__version!==J.version){fe(G,J,F);return}t.bindTexture(n.TEXTURE_3D,G.__webglTexture,n.TEXTURE0+F)}function K(J,F){const G=r.get(J);if(J.version>0&&G.__version!==J.version){pe(G,J,F);return}t.bindTexture(n.TEXTURE_CUBE_MAP,G.__webglTexture,n.TEXTURE0+F)}const W={[gu]:n.REPEAT,[Qn]:n.CLAMP_TO_EDGE,[xm]:n.MIRRORED_REPEAT},V={[Vn]:n.NEAREST,[W0]:n.NEAREST_MIPMAP_NEAREST,[fp]:n.NEAREST_MIPMAP_LINEAR,[un]:n.LINEAR,[L_]:n.LINEAR_MIPMAP_NEAREST,[Ha]:n.LINEAR_MIPMAP_LINEAR},Q={[FO]:n.NEVER,[VO]:n.ALWAYS,[OO]:n.LESS,[b2]:n.LEQUAL,[kO]:n.EQUAL,[HO]:n.GEQUAL,[GO]:n.GREATER,[zO]:n.NOTEQUAL};function q(J,F,G){if(G?(n.texParameteri(J,n.TEXTURE_WRAP_S,W[F.wrapS]),n.texParameteri(J,n.TEXTURE_WRAP_T,W[F.wrapT]),(J===n.TEXTURE_3D||J===n.TEXTURE_2D_ARRAY)&&n.texParameteri(J,n.TEXTURE_WRAP_R,W[F.wrapR]),n.texParameteri(J,n.TEXTURE_MAG_FILTER,V[F.magFilter]),n.texParameteri(J,n.TEXTURE_MIN_FILTER,V[F.minFilter])):(n.texParameteri(J,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(J,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(J===n.TEXTURE_3D||J===n.TEXTURE_2D_ARRAY)&&n.texParameteri(J,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(F.wrapS!==Qn||F.wrapT!==Qn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(J,n.TEXTURE_MAG_FILTER,b(F.magFilter)),n.texParameteri(J,n.TEXTURE_MIN_FILTER,b(F.minFilter)),F.minFilter!==Vn&&F.minFilter!==un&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),F.compareFunction&&(n.texParameteri(J,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(J,n.TEXTURE_COMPARE_FUNC,Q[F.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const de=e.get("EXT_texture_filter_anisotropic");if(F.magFilter===Vn||F.minFilter!==fp&&F.minFilter!==Ha||F.type===Cr&&e.has("OES_texture_float_linear")===!1||a===!1&&F.type===Jr&&e.has("OES_texture_half_float_linear")===!1)return;(F.anisotropy>1||r.get(F).__currentAnisotropy)&&(n.texParameterf(J,de.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(F.anisotropy,i.getMaxAnisotropy())),r.get(F).__currentAnisotropy=F.anisotropy)}}function ne(J,F){let G=!1;J.__webglInit===void 0&&(J.__webglInit=!0,F.addEventListener("dispose",R));const de=F.source;let le=d.get(de);le===void 0&&(le={},d.set(de,le));const ye=z(F);if(ye!==J.__cacheKey){le[ye]===void 0&&(le[ye]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,G=!0),le[ye].usedTimes++;const Le=le[J.__cacheKey];Le!==void 0&&(le[J.__cacheKey].usedTimes--,Le.usedTimes===0&&B(F)),J.__cacheKey=ye,J.__webglTexture=le[ye].texture}return G}function fe(J,F,G){let de=n.TEXTURE_2D;(F.isDataArrayTexture||F.isCompressedArrayTexture)&&(de=n.TEXTURE_2D_ARRAY),F.isData3DTexture&&(de=n.TEXTURE_3D);const le=ne(J,F),ye=F.source;t.bindTexture(de,J.__webglTexture,n.TEXTURE0+G);const Le=r.get(ye);if(ye.version!==Le.__version||le===!0){t.activeTexture(n.TEXTURE0+G);const Ve=Pn.getPrimaries(Pn.workingColorSpace),Oe=F.colorSpace===qi?null:Pn.getPrimaries(F.colorSpace),ze=F.colorSpace===qi||Ve===Oe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,F.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,F.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,ze);const Ye=v(F)&&x(F.image)===!1;let Ie=y(F.image,Ye,!1,i.maxTextureSize);Ie=Re(F,Ie);const gt=x(Ie)||a,yt=s.convert(F.format,F.colorSpace);let ot=s.convert(F.type),Ze=S(F.internalFormat,yt,ot,F.colorSpace,F.isVideoTexture);q(de,F,gt);let Ke;const ae=F.mipmaps,De=a&&F.isVideoTexture!==!0&&Ze!==x2,rt=Le.__version===void 0||le===!0,it=M(F,Ie,gt);if(F.isDepthTexture)Ze=n.DEPTH_COMPONENT,a?F.type===Cr?Ze=n.DEPTH_COMPONENT32F:F.type===qo?Ze=n.DEPTH_COMPONENT24:F.type===Nl?Ze=n.DEPTH24_STENCIL8:Ze=n.DEPTH_COMPONENT16:F.type===Cr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),F.format===su&&Ze===n.DEPTH_COMPONENT&&F.type!==N_&&F.type!==qo&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),F.type=qo,ot=s.convert(F.type)),F.format===vu&&Ze===n.DEPTH_COMPONENT&&(Ze=n.DEPTH_STENCIL,F.type!==Nl&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),F.type=Nl,ot=s.convert(F.type))),rt&&(De?t.texStorage2D(n.TEXTURE_2D,1,Ze,Ie.width,Ie.height):t.texImage2D(n.TEXTURE_2D,0,Ze,Ie.width,Ie.height,0,yt,ot,null));else if(F.isDataTexture)if(ae.length>0&&gt){De&&rt&&t.texStorage2D(n.TEXTURE_2D,it,Ze,ae[0].width,ae[0].height);for(let ve=0,ce=ae.length;ve<ce;ve++)Ke=ae[ve],De?t.texSubImage2D(n.TEXTURE_2D,ve,0,0,Ke.width,Ke.height,yt,ot,Ke.data):t.texImage2D(n.TEXTURE_2D,ve,Ze,Ke.width,Ke.height,0,yt,ot,Ke.data);F.generateMipmaps=!1}else De?(rt&&t.texStorage2D(n.TEXTURE_2D,it,Ze,Ie.width,Ie.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ie.width,Ie.height,yt,ot,Ie.data)):t.texImage2D(n.TEXTURE_2D,0,Ze,Ie.width,Ie.height,0,yt,ot,Ie.data);else if(F.isCompressedTexture)if(F.isCompressedArrayTexture){De&&rt&&t.texStorage3D(n.TEXTURE_2D_ARRAY,it,Ze,ae[0].width,ae[0].height,Ie.depth);for(let ve=0,ce=ae.length;ve<ce;ve++)Ke=ae[ve],F.format!==Ur?yt!==null?De?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,ve,0,0,0,Ke.width,Ke.height,Ie.depth,yt,Ke.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,ve,Ze,Ke.width,Ke.height,Ie.depth,0,Ke.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):De?t.texSubImage3D(n.TEXTURE_2D_ARRAY,ve,0,0,0,Ke.width,Ke.height,Ie.depth,yt,ot,Ke.data):t.texImage3D(n.TEXTURE_2D_ARRAY,ve,Ze,Ke.width,Ke.height,Ie.depth,0,yt,ot,Ke.data)}else{De&&rt&&t.texStorage2D(n.TEXTURE_2D,it,Ze,ae[0].width,ae[0].height);for(let ve=0,ce=ae.length;ve<ce;ve++)Ke=ae[ve],F.format!==Ur?yt!==null?De?t.compressedTexSubImage2D(n.TEXTURE_2D,ve,0,0,Ke.width,Ke.height,yt,Ke.data):t.compressedTexImage2D(n.TEXTURE_2D,ve,Ze,Ke.width,Ke.height,0,Ke.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):De?t.texSubImage2D(n.TEXTURE_2D,ve,0,0,Ke.width,Ke.height,yt,ot,Ke.data):t.texImage2D(n.TEXTURE_2D,ve,Ze,Ke.width,Ke.height,0,yt,ot,Ke.data)}else if(F.isDataArrayTexture)De?(rt&&t.texStorage3D(n.TEXTURE_2D_ARRAY,it,Ze,Ie.width,Ie.height,Ie.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Ie.width,Ie.height,Ie.depth,yt,ot,Ie.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,Ze,Ie.width,Ie.height,Ie.depth,0,yt,ot,Ie.data);else if(F.isData3DTexture)De?(rt&&t.texStorage3D(n.TEXTURE_3D,it,Ze,Ie.width,Ie.height,Ie.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Ie.width,Ie.height,Ie.depth,yt,ot,Ie.data)):t.texImage3D(n.TEXTURE_3D,0,Ze,Ie.width,Ie.height,Ie.depth,0,yt,ot,Ie.data);else if(F.isFramebufferTexture){if(rt)if(De)t.texStorage2D(n.TEXTURE_2D,it,Ze,Ie.width,Ie.height);else{let ve=Ie.width,ce=Ie.height;for(let at=0;at<it;at++)t.texImage2D(n.TEXTURE_2D,at,Ze,ve,ce,0,yt,ot,null),ve>>=1,ce>>=1}}else if(ae.length>0&&gt){De&&rt&&t.texStorage2D(n.TEXTURE_2D,it,Ze,ae[0].width,ae[0].height);for(let ve=0,ce=ae.length;ve<ce;ve++)Ke=ae[ve],De?t.texSubImage2D(n.TEXTURE_2D,ve,0,0,yt,ot,Ke):t.texImage2D(n.TEXTURE_2D,ve,Ze,yt,ot,Ke);F.generateMipmaps=!1}else De?(rt&&t.texStorage2D(n.TEXTURE_2D,it,Ze,Ie.width,Ie.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,yt,ot,Ie)):t.texImage2D(n.TEXTURE_2D,0,Ze,yt,ot,Ie);A(F,gt)&&w(de),Le.__version=ye.version,F.onUpdate&&F.onUpdate(F)}J.__version=F.version}function pe(J,F,G){if(F.image.length!==6)return;const de=ne(J,F),le=F.source;t.bindTexture(n.TEXTURE_CUBE_MAP,J.__webglTexture,n.TEXTURE0+G);const ye=r.get(le);if(le.version!==ye.__version||de===!0){t.activeTexture(n.TEXTURE0+G);const Le=Pn.getPrimaries(Pn.workingColorSpace),Ve=F.colorSpace===qi?null:Pn.getPrimaries(F.colorSpace),Oe=F.colorSpace===qi||Le===Ve?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,F.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,F.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Oe);const ze=F.isCompressedTexture||F.image[0].isCompressedTexture,Ye=F.image[0]&&F.image[0].isDataTexture,Ie=[];for(let ve=0;ve<6;ve++)!ze&&!Ye?Ie[ve]=y(F.image[ve],!1,!0,i.maxCubemapSize):Ie[ve]=Ye?F.image[ve].image:F.image[ve],Ie[ve]=Re(F,Ie[ve]);const gt=Ie[0],yt=x(gt)||a,ot=s.convert(F.format,F.colorSpace),Ze=s.convert(F.type),Ke=S(F.internalFormat,ot,Ze,F.colorSpace),ae=a&&F.isVideoTexture!==!0,De=ye.__version===void 0||de===!0;let rt=M(F,gt,yt);q(n.TEXTURE_CUBE_MAP,F,yt);let it;if(ze){ae&&De&&t.texStorage2D(n.TEXTURE_CUBE_MAP,rt,Ke,gt.width,gt.height);for(let ve=0;ve<6;ve++){it=Ie[ve].mipmaps;for(let ce=0;ce<it.length;ce++){const at=it[ce];F.format!==Ur?ot!==null?ae?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ve,ce,0,0,at.width,at.height,ot,at.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ve,ce,Ke,at.width,at.height,0,at.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ae?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ve,ce,0,0,at.width,at.height,ot,Ze,at.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ve,ce,Ke,at.width,at.height,0,ot,Ze,at.data)}}}else{it=F.mipmaps,ae&&De&&(it.length>0&&rt++,t.texStorage2D(n.TEXTURE_CUBE_MAP,rt,Ke,Ie[0].width,Ie[0].height));for(let ve=0;ve<6;ve++)if(Ye){ae?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ve,0,0,0,Ie[ve].width,Ie[ve].height,ot,Ze,Ie[ve].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ve,0,Ke,Ie[ve].width,Ie[ve].height,0,ot,Ze,Ie[ve].data);for(let ce=0;ce<it.length;ce++){const $e=it[ce].image[ve].image;ae?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ve,ce+1,0,0,$e.width,$e.height,ot,Ze,$e.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ve,ce+1,Ke,$e.width,$e.height,0,ot,Ze,$e.data)}}else{ae?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ve,0,0,0,ot,Ze,Ie[ve]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ve,0,Ke,ot,Ze,Ie[ve]);for(let ce=0;ce<it.length;ce++){const at=it[ce];ae?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ve,ce+1,0,0,ot,Ze,at.image[ve]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ve,ce+1,Ke,ot,Ze,at.image[ve])}}}A(F,yt)&&w(n.TEXTURE_CUBE_MAP),ye.__version=le.version,F.onUpdate&&F.onUpdate(F)}J.__version=F.version}function ge(J,F,G,de,le,ye){const Le=s.convert(G.format,G.colorSpace),Ve=s.convert(G.type),Oe=S(G.internalFormat,Le,Ve,G.colorSpace);if(!r.get(F).__hasExternalTextures){const Ye=Math.max(1,F.width>>ye),Ie=Math.max(1,F.height>>ye);le===n.TEXTURE_3D||le===n.TEXTURE_2D_ARRAY?t.texImage3D(le,ye,Oe,Ye,Ie,F.depth,0,Le,Ve,null):t.texImage2D(le,ye,Oe,Ye,Ie,0,Le,Ve,null)}t.bindFramebuffer(n.FRAMEBUFFER,J),we(F)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,de,le,r.get(G).__webglTexture,0,Ue(F)):(le===n.TEXTURE_2D||le>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&le<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,de,le,r.get(G).__webglTexture,ye),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Ce(J,F,G){if(n.bindRenderbuffer(n.RENDERBUFFER,J),F.depthBuffer&&!F.stencilBuffer){let de=a===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(G||we(F)){const le=F.depthTexture;le&&le.isDepthTexture&&(le.type===Cr?de=n.DEPTH_COMPONENT32F:le.type===qo&&(de=n.DEPTH_COMPONENT24));const ye=Ue(F);we(F)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ye,de,F.width,F.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,ye,de,F.width,F.height)}else n.renderbufferStorage(n.RENDERBUFFER,de,F.width,F.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,J)}else if(F.depthBuffer&&F.stencilBuffer){const de=Ue(F);G&&we(F)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,de,n.DEPTH24_STENCIL8,F.width,F.height):we(F)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,de,n.DEPTH24_STENCIL8,F.width,F.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,F.width,F.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,J)}else{const de=F.isWebGLMultipleRenderTargets===!0?F.texture:[F.texture];for(let le=0;le<de.length;le++){const ye=de[le],Le=s.convert(ye.format,ye.colorSpace),Ve=s.convert(ye.type),Oe=S(ye.internalFormat,Le,Ve,ye.colorSpace),ze=Ue(F);G&&we(F)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,ze,Oe,F.width,F.height):we(F)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ze,Oe,F.width,F.height):n.renderbufferStorage(n.RENDERBUFFER,Oe,F.width,F.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Je(J,F){if(F&&F.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,J),!(F.depthTexture&&F.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(F.depthTexture).__webglTexture||F.depthTexture.image.width!==F.width||F.depthTexture.image.height!==F.height)&&(F.depthTexture.image.width=F.width,F.depthTexture.image.height=F.height,F.depthTexture.needsUpdate=!0),O(F.depthTexture,0);const de=r.get(F.depthTexture).__webglTexture,le=Ue(F);if(F.depthTexture.format===su)we(F)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,de,0,le):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,de,0);else if(F.depthTexture.format===vu)we(F)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,de,0,le):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,de,0);else throw new Error("Unknown depthTexture format")}function Xe(J){const F=r.get(J),G=J.isWebGLCubeRenderTarget===!0;if(J.depthTexture&&!F.__autoAllocateDepthBuffer){if(G)throw new Error("target.depthTexture not supported in Cube render targets");Je(F.__webglFramebuffer,J)}else if(G){F.__webglDepthbuffer=[];for(let de=0;de<6;de++)t.bindFramebuffer(n.FRAMEBUFFER,F.__webglFramebuffer[de]),F.__webglDepthbuffer[de]=n.createRenderbuffer(),Ce(F.__webglDepthbuffer[de],J,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,F.__webglFramebuffer),F.__webglDepthbuffer=n.createRenderbuffer(),Ce(F.__webglDepthbuffer,J,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Fe(J,F,G){const de=r.get(J);F!==void 0&&ge(de.__webglFramebuffer,J,J.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),G!==void 0&&Xe(J)}function j(J){const F=J.texture,G=r.get(J),de=r.get(F);J.addEventListener("dispose",P),J.isWebGLMultipleRenderTargets!==!0&&(de.__webglTexture===void 0&&(de.__webglTexture=n.createTexture()),de.__version=F.version,o.memory.textures++);const le=J.isWebGLCubeRenderTarget===!0,ye=J.isWebGLMultipleRenderTargets===!0,Le=x(J)||a;if(le){G.__webglFramebuffer=[];for(let Ve=0;Ve<6;Ve++)if(a&&F.mipmaps&&F.mipmaps.length>0){G.__webglFramebuffer[Ve]=[];for(let Oe=0;Oe<F.mipmaps.length;Oe++)G.__webglFramebuffer[Ve][Oe]=n.createFramebuffer()}else G.__webglFramebuffer[Ve]=n.createFramebuffer()}else{if(a&&F.mipmaps&&F.mipmaps.length>0){G.__webglFramebuffer=[];for(let Ve=0;Ve<F.mipmaps.length;Ve++)G.__webglFramebuffer[Ve]=n.createFramebuffer()}else G.__webglFramebuffer=n.createFramebuffer();if(ye)if(i.drawBuffers){const Ve=J.texture;for(let Oe=0,ze=Ve.length;Oe<ze;Oe++){const Ye=r.get(Ve[Oe]);Ye.__webglTexture===void 0&&(Ye.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&J.samples>0&&we(J)===!1){const Ve=ye?F:[F];G.__webglMultisampledFramebuffer=n.createFramebuffer(),G.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,G.__webglMultisampledFramebuffer);for(let Oe=0;Oe<Ve.length;Oe++){const ze=Ve[Oe];G.__webglColorRenderbuffer[Oe]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,G.__webglColorRenderbuffer[Oe]);const Ye=s.convert(ze.format,ze.colorSpace),Ie=s.convert(ze.type),gt=S(ze.internalFormat,Ye,Ie,ze.colorSpace,J.isXRRenderTarget===!0),yt=Ue(J);n.renderbufferStorageMultisample(n.RENDERBUFFER,yt,gt,J.width,J.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Oe,n.RENDERBUFFER,G.__webglColorRenderbuffer[Oe])}n.bindRenderbuffer(n.RENDERBUFFER,null),J.depthBuffer&&(G.__webglDepthRenderbuffer=n.createRenderbuffer(),Ce(G.__webglDepthRenderbuffer,J,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(le){t.bindTexture(n.TEXTURE_CUBE_MAP,de.__webglTexture),q(n.TEXTURE_CUBE_MAP,F,Le);for(let Ve=0;Ve<6;Ve++)if(a&&F.mipmaps&&F.mipmaps.length>0)for(let Oe=0;Oe<F.mipmaps.length;Oe++)ge(G.__webglFramebuffer[Ve][Oe],J,F,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,Oe);else ge(G.__webglFramebuffer[Ve],J,F,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,0);A(F,Le)&&w(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(ye){const Ve=J.texture;for(let Oe=0,ze=Ve.length;Oe<ze;Oe++){const Ye=Ve[Oe],Ie=r.get(Ye);t.bindTexture(n.TEXTURE_2D,Ie.__webglTexture),q(n.TEXTURE_2D,Ye,Le),ge(G.__webglFramebuffer,J,Ye,n.COLOR_ATTACHMENT0+Oe,n.TEXTURE_2D,0),A(Ye,Le)&&w(n.TEXTURE_2D)}t.unbindTexture()}else{let Ve=n.TEXTURE_2D;if((J.isWebGL3DRenderTarget||J.isWebGLArrayRenderTarget)&&(a?Ve=J.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ve,de.__webglTexture),q(Ve,F,Le),a&&F.mipmaps&&F.mipmaps.length>0)for(let Oe=0;Oe<F.mipmaps.length;Oe++)ge(G.__webglFramebuffer[Oe],J,F,n.COLOR_ATTACHMENT0,Ve,Oe);else ge(G.__webglFramebuffer,J,F,n.COLOR_ATTACHMENT0,Ve,0);A(F,Le)&&w(Ve),t.unbindTexture()}J.depthBuffer&&Xe(J)}function Te(J){const F=x(J)||a,G=J.isWebGLMultipleRenderTargets===!0?J.texture:[J.texture];for(let de=0,le=G.length;de<le;de++){const ye=G[de];if(A(ye,F)){const Le=J.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ve=r.get(ye).__webglTexture;t.bindTexture(Le,Ve),w(Le),t.unbindTexture()}}}function be(J){if(a&&J.samples>0&&we(J)===!1){const F=J.isWebGLMultipleRenderTargets?J.texture:[J.texture],G=J.width,de=J.height;let le=n.COLOR_BUFFER_BIT;const ye=[],Le=J.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ve=r.get(J),Oe=J.isWebGLMultipleRenderTargets===!0;if(Oe)for(let ze=0;ze<F.length;ze++)t.bindFramebuffer(n.FRAMEBUFFER,Ve.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ze,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Ve.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+ze,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Ve.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ve.__webglFramebuffer);for(let ze=0;ze<F.length;ze++){ye.push(n.COLOR_ATTACHMENT0+ze),J.depthBuffer&&ye.push(Le);const Ye=Ve.__ignoreDepthValues!==void 0?Ve.__ignoreDepthValues:!1;if(Ye===!1&&(J.depthBuffer&&(le|=n.DEPTH_BUFFER_BIT),J.stencilBuffer&&(le|=n.STENCIL_BUFFER_BIT)),Oe&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ve.__webglColorRenderbuffer[ze]),Ye===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Le]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Le])),Oe){const Ie=r.get(F[ze]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Ie,0)}n.blitFramebuffer(0,0,G,de,0,0,G,de,le,n.NEAREST),c&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,ye)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Oe)for(let ze=0;ze<F.length;ze++){t.bindFramebuffer(n.FRAMEBUFFER,Ve.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ze,n.RENDERBUFFER,Ve.__webglColorRenderbuffer[ze]);const Ye=r.get(F[ze]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Ve.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+ze,n.TEXTURE_2D,Ye,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ve.__webglMultisampledFramebuffer)}}function Ue(J){return Math.min(i.maxSamples,J.samples)}function we(J){const F=r.get(J);return a&&J.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&F.__useRenderToTexture!==!1}function et(J){const F=o.render.frame;u.get(J)!==F&&(u.set(J,F),J.update())}function Re(J,F){const G=J.colorSpace,de=J.format,le=J.type;return J.isCompressedTexture===!0||J.isVideoTexture===!0||J.format===HA||G!==is&&G!==qi&&(Pn.getTransfer(G)===Hn?a===!1?e.has("EXT_sRGB")===!0&&de===Ur?(J.format=HA,J.minFilter=un,J.generateMipmaps=!1):F=T2.sRGBToLinear(F):(de!==Ur||le!==Gr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",G)),F}this.allocateTextureUnit=U,this.resetTextureUnits=$,this.setTexture2D=O,this.setTexture2DArray=ie,this.setTexture3D=X,this.setTextureCube=K,this.rebindTextures=Fe,this.setupRenderTarget=j,this.updateRenderTargetMipmap=Te,this.updateMultisampleRenderTarget=be,this.setupDepthRenderbuffer=Xe,this.setupFrameBufferTexture=ge,this.useMultisampledRTT=we}function nk(n,e,t){const r=t.isWebGL2;function i(s,o=qi){let a;const l=Pn.getTransfer(o);if(s===Gr)return n.UNSIGNED_BYTE;if(s===d2)return n.UNSIGNED_SHORT_4_4_4_4;if(s===p2)return n.UNSIGNED_SHORT_5_5_5_1;if(s===f2)return n.BYTE;if(s===h2)return n.SHORT;if(s===N_)return n.UNSIGNED_SHORT;if(s===D_)return n.INT;if(s===qo)return n.UNSIGNED_INT;if(s===Cr)return n.FLOAT;if(s===Jr)return r?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===CO)return n.ALPHA;if(s===Ur)return n.RGBA;if(s===RO)return n.LUMINANCE;if(s===BO)return n.LUMINANCE_ALPHA;if(s===su)return n.DEPTH_COMPONENT;if(s===vu)return n.DEPTH_STENCIL;if(s===HA)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===m2)return n.RED;if(s===g2)return n.RED_INTEGER;if(s===PO)return n.RG;if(s===v2)return n.RG_INTEGER;if(s===y2)return n.RGBA_INTEGER;if(s===W1||s===X1||s===J1||s===K1)if(l===Hn)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===W1)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===X1)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===J1)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===K1)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===W1)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===X1)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===J1)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===K1)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===MM||s===TM||s===CM||s===RM)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===MM)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===TM)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===CM)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===RM)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===x2)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===BM||s===PM)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===BM)return l===Hn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===PM)return l===Hn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===IM||s===LM||s===NM||s===DM||s===UM||s===FM||s===OM||s===kM||s===GM||s===zM||s===HM||s===VM||s===WM||s===XM)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===IM)return l===Hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===LM)return l===Hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===NM)return l===Hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===DM)return l===Hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===UM)return l===Hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===FM)return l===Hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===OM)return l===Hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===kM)return l===Hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===GM)return l===Hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===zM)return l===Hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===HM)return l===Hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===VM)return l===Hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===WM)return l===Hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===XM)return l===Hn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===Q1||s===JM||s===KM)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===Q1)return l===Hn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===JM)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===KM)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===IO||s===QM||s===jM||s===YM)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===Q1)return a.COMPRESSED_RED_RGTC1_EXT;if(s===QM)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===jM)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===YM)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Nl?r?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:i}}class rk extends or{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Da extends gn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const dJ={type:"move"};class xS{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Da,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Da,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Y,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Y),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Da,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Y,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Y),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const y of e.hand.values()){const x=t.getJointPose(y,r),v=this._getHandJoint(c,y);x!==null&&(v.matrix.fromArray(x.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=x.radius),v.visible=x!==null}const u=c.joints["index-finger-tip"],f=c.joints["thumb-tip"],d=u.position.distanceTo(f.position),m=.02,g=.005;c.inputState.pinching&&d>m+g?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=m-g&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(dJ)))}return a!==null&&(a.visible=i!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new Da;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class pJ extends bo{constructor(e,t){super();const r=this;let i=null,s=1,o=null,a="local-floor",l=1,c=null,u=null,f=null,d=null,m=null,g=null;const y=t.getContextAttributes();let x=null,v=null;const A=[],w=[],S=new Ge;let M=null;const b=new or;b.layers.enable(1),b.viewport=new wn;const R=new or;R.layers.enable(2),R.viewport=new wn;const P=[b,R],C=new rk;C.layers.enable(1),C.layers.enable(2);let B=null,H=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(q){let ne=A[q];return ne===void 0&&(ne=new xS,A[q]=ne),ne.getTargetRaySpace()},this.getControllerGrip=function(q){let ne=A[q];return ne===void 0&&(ne=new xS,A[q]=ne),ne.getGripSpace()},this.getHand=function(q){let ne=A[q];return ne===void 0&&(ne=new xS,A[q]=ne),ne.getHandSpace()};function k(q){const ne=w.indexOf(q.inputSource);if(ne===-1)return;const fe=A[ne];fe!==void 0&&(fe.update(q.inputSource,q.frame,c||o),fe.dispatchEvent({type:q.type,data:q.inputSource}))}function $(){i.removeEventListener("select",k),i.removeEventListener("selectstart",k),i.removeEventListener("selectend",k),i.removeEventListener("squeeze",k),i.removeEventListener("squeezestart",k),i.removeEventListener("squeezeend",k),i.removeEventListener("end",$),i.removeEventListener("inputsourceschange",U);for(let q=0;q<A.length;q++){const ne=w[q];ne!==null&&(w[q]=null,A[q].disconnect(ne))}B=null,H=null,e.setRenderTarget(x),m=null,d=null,f=null,i=null,v=null,Q.stop(),r.isPresenting=!1,e.setPixelRatio(M),e.setSize(S.width,S.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(q){s=q,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(q){a=q,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(q){c=q},this.getBaseLayer=function(){return d!==null?d:m},this.getBinding=function(){return f},this.getFrame=function(){return g},this.getSession=function(){return i},this.setSession=async function(q){if(i=q,i!==null){if(x=e.getRenderTarget(),i.addEventListener("select",k),i.addEventListener("selectstart",k),i.addEventListener("selectend",k),i.addEventListener("squeeze",k),i.addEventListener("squeezestart",k),i.addEventListener("squeezeend",k),i.addEventListener("end",$),i.addEventListener("inputsourceschange",U),y.xrCompatible!==!0&&await t.makeXRCompatible(),M=e.getPixelRatio(),e.getSize(S),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const ne={antialias:i.renderState.layers===void 0?y.antialias:!0,alpha:!0,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:s};m=new XRWebGLLayer(i,t,ne),i.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),v=new hr(m.framebufferWidth,m.framebufferHeight,{format:Ur,type:Gr,colorSpace:e.outputColorSpace,stencilBuffer:y.stencil})}else{let ne=null,fe=null,pe=null;y.depth&&(pe=y.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ne=y.stencil?vu:su,fe=y.stencil?Nl:qo);const ge={colorFormat:t.RGBA8,depthFormat:pe,scaleFactor:s};f=new XRWebGLBinding(i,t),d=f.createProjectionLayer(ge),i.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),v=new hr(d.textureWidth,d.textureHeight,{format:Ur,type:Gr,depthTexture:new k_(d.textureWidth,d.textureHeight,fe,void 0,void 0,void 0,void 0,void 0,void 0,ne),stencilBuffer:y.stencil,colorSpace:e.outputColorSpace,samples:y.antialias?4:0});const Ce=e.properties.get(v);Ce.__ignoreDepthValues=d.ignoreDepthValues}v.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await i.requestReferenceSpace(a),Q.setContext(i),Q.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode};function U(q){for(let ne=0;ne<q.removed.length;ne++){const fe=q.removed[ne],pe=w.indexOf(fe);pe>=0&&(w[pe]=null,A[pe].disconnect(fe))}for(let ne=0;ne<q.added.length;ne++){const fe=q.added[ne];let pe=w.indexOf(fe);if(pe===-1){for(let Ce=0;Ce<A.length;Ce++)if(Ce>=w.length){w.push(fe),pe=Ce;break}else if(w[Ce]===null){w[Ce]=fe,pe=Ce;break}if(pe===-1)break}const ge=A[pe];ge&&ge.connect(fe)}}const z=new Y,O=new Y;function ie(q,ne,fe){z.setFromMatrixPosition(ne.matrixWorld),O.setFromMatrixPosition(fe.matrixWorld);const pe=z.distanceTo(O),ge=ne.projectionMatrix.elements,Ce=fe.projectionMatrix.elements,Je=ge[14]/(ge[10]-1),Xe=ge[14]/(ge[10]+1),Fe=(ge[9]+1)/ge[5],j=(ge[9]-1)/ge[5],Te=(ge[8]-1)/ge[0],be=(Ce[8]+1)/Ce[0],Ue=Je*Te,we=Je*be,et=pe/(-Te+be),Re=et*-Te;ne.matrixWorld.decompose(q.position,q.quaternion,q.scale),q.translateX(Re),q.translateZ(et),q.matrixWorld.compose(q.position,q.quaternion,q.scale),q.matrixWorldInverse.copy(q.matrixWorld).invert();const J=Je+et,F=Xe+et,G=Ue-Re,de=we+(pe-Re),le=Fe*Xe/F*J,ye=j*Xe/F*J;q.projectionMatrix.makePerspective(G,de,le,ye,J,F),q.projectionMatrixInverse.copy(q.projectionMatrix).invert()}function X(q,ne){ne===null?q.matrixWorld.copy(q.matrix):q.matrixWorld.multiplyMatrices(ne.matrixWorld,q.matrix),q.matrixWorldInverse.copy(q.matrixWorld).invert()}this.updateCamera=function(q){if(i===null)return;C.near=R.near=b.near=q.near,C.far=R.far=b.far=q.far,(B!==C.near||H!==C.far)&&(i.updateRenderState({depthNear:C.near,depthFar:C.far}),B=C.near,H=C.far);const ne=q.parent,fe=C.cameras;X(C,ne);for(let pe=0;pe<fe.length;pe++)X(fe[pe],ne);fe.length===2?ie(C,b,R):C.projectionMatrix.copy(b.projectionMatrix),K(q,C,ne)};function K(q,ne,fe){fe===null?q.matrix.copy(ne.matrixWorld):(q.matrix.copy(fe.matrixWorld),q.matrix.invert(),q.matrix.multiply(ne.matrixWorld)),q.matrix.decompose(q.position,q.quaternion,q.scale),q.updateMatrixWorld(!0),q.projectionMatrix.copy(ne.projectionMatrix),q.projectionMatrixInverse.copy(ne.projectionMatrixInverse),q.isPerspectiveCamera&&(q.fov=wm*2*Math.atan(1/q.projectionMatrix.elements[5]),q.zoom=1)}this.getCamera=function(){return C},this.getFoveation=function(){if(!(d===null&&m===null))return l},this.setFoveation=function(q){l=q,d!==null&&(d.fixedFoveation=q),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=q)};let W=null;function V(q,ne){if(u=ne.getViewerPose(c||o),g=ne,u!==null){const fe=u.views;m!==null&&(e.setRenderTargetFramebuffer(v,m.framebuffer),e.setRenderTarget(v));let pe=!1;fe.length!==C.cameras.length&&(C.cameras.length=0,pe=!0);for(let ge=0;ge<fe.length;ge++){const Ce=fe[ge];let Je=null;if(m!==null)Je=m.getViewport(Ce);else{const Fe=f.getViewSubImage(d,Ce);Je=Fe.viewport,ge===0&&(e.setRenderTargetTextures(v,Fe.colorTexture,d.ignoreDepthValues?void 0:Fe.depthStencilTexture),e.setRenderTarget(v))}let Xe=P[ge];Xe===void 0&&(Xe=new or,Xe.layers.enable(ge),Xe.viewport=new wn,P[ge]=Xe),Xe.matrix.fromArray(Ce.transform.matrix),Xe.matrix.decompose(Xe.position,Xe.quaternion,Xe.scale),Xe.projectionMatrix.fromArray(Ce.projectionMatrix),Xe.projectionMatrixInverse.copy(Xe.projectionMatrix).invert(),Xe.viewport.set(Je.x,Je.y,Je.width,Je.height),ge===0&&(C.matrix.copy(Xe.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale)),pe===!0&&C.cameras.push(Xe)}}for(let fe=0;fe<A.length;fe++){const pe=w[fe],ge=A[fe];pe!==null&&ge!==void 0&&ge.update(pe,ne,c||o)}W&&W(q,ne),ne.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:ne}),g=null}const Q=new YO;Q.setAnimationLoop(V),this.setAnimationLoop=function(q){W=q},this.dispose=function(){}}}function mJ(n,e){function t(x,v){x.matrixAutoUpdate===!0&&x.updateMatrix(),v.value.copy(x.matrix)}function r(x,v){v.color.getRGB(x.fogColor.value,QO(n)),v.isFog?(x.fogNear.value=v.near,x.fogFar.value=v.far):v.isFogExp2&&(x.fogDensity.value=v.density)}function i(x,v,A,w,S){v.isMeshBasicMaterial||v.isMeshLambertMaterial?s(x,v):v.isMeshToonMaterial?(s(x,v),f(x,v)):v.isMeshPhongMaterial?(s(x,v),u(x,v)):v.isMeshStandardMaterial?(s(x,v),d(x,v),v.isMeshPhysicalMaterial&&m(x,v,S)):v.isMeshMatcapMaterial?(s(x,v),g(x,v)):v.isMeshDepthMaterial?s(x,v):v.isMeshDistanceMaterial?(s(x,v),y(x,v)):v.isMeshNormalMaterial?s(x,v):v.isLineBasicMaterial?(o(x,v),v.isLineDashedMaterial&&a(x,v)):v.isPointsMaterial?l(x,v,A,w):v.isSpriteMaterial?c(x,v):v.isShadowMaterial?(x.color.value.copy(v.color),x.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function s(x,v){x.opacity.value=v.opacity,v.color&&x.diffuse.value.copy(v.color),v.emissive&&x.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(x.map.value=v.map,t(v.map,x.mapTransform)),v.alphaMap&&(x.alphaMap.value=v.alphaMap,t(v.alphaMap,x.alphaMapTransform)),v.bumpMap&&(x.bumpMap.value=v.bumpMap,t(v.bumpMap,x.bumpMapTransform),x.bumpScale.value=v.bumpScale,v.side===Xr&&(x.bumpScale.value*=-1)),v.normalMap&&(x.normalMap.value=v.normalMap,t(v.normalMap,x.normalMapTransform),x.normalScale.value.copy(v.normalScale),v.side===Xr&&x.normalScale.value.negate()),v.displacementMap&&(x.displacementMap.value=v.displacementMap,t(v.displacementMap,x.displacementMapTransform),x.displacementScale.value=v.displacementScale,x.displacementBias.value=v.displacementBias),v.emissiveMap&&(x.emissiveMap.value=v.emissiveMap,t(v.emissiveMap,x.emissiveMapTransform)),v.specularMap&&(x.specularMap.value=v.specularMap,t(v.specularMap,x.specularMapTransform)),v.alphaTest>0&&(x.alphaTest.value=v.alphaTest);const A=e.get(v).envMap;if(A&&(x.envMap.value=A,x.flipEnvMap.value=A.isCubeTexture&&A.isRenderTargetTexture===!1?-1:1,x.reflectivity.value=v.reflectivity,x.ior.value=v.ior,x.refractionRatio.value=v.refractionRatio),v.lightMap){x.lightMap.value=v.lightMap;const w=n._useLegacyLights===!0?Math.PI:1;x.lightMapIntensity.value=v.lightMapIntensity*w,t(v.lightMap,x.lightMapTransform)}v.aoMap&&(x.aoMap.value=v.aoMap,x.aoMapIntensity.value=v.aoMapIntensity,t(v.aoMap,x.aoMapTransform))}function o(x,v){x.diffuse.value.copy(v.color),x.opacity.value=v.opacity,v.map&&(x.map.value=v.map,t(v.map,x.mapTransform))}function a(x,v){x.dashSize.value=v.dashSize,x.totalSize.value=v.dashSize+v.gapSize,x.scale.value=v.scale}function l(x,v,A,w){x.diffuse.value.copy(v.color),x.opacity.value=v.opacity,x.size.value=v.size*A,x.scale.value=w*.5,v.map&&(x.map.value=v.map,t(v.map,x.uvTransform)),v.alphaMap&&(x.alphaMap.value=v.alphaMap,t(v.alphaMap,x.alphaMapTransform)),v.alphaTest>0&&(x.alphaTest.value=v.alphaTest)}function c(x,v){x.diffuse.value.copy(v.color),x.opacity.value=v.opacity,x.rotation.value=v.rotation,v.map&&(x.map.value=v.map,t(v.map,x.mapTransform)),v.alphaMap&&(x.alphaMap.value=v.alphaMap,t(v.alphaMap,x.alphaMapTransform)),v.alphaTest>0&&(x.alphaTest.value=v.alphaTest)}function u(x,v){x.specular.value.copy(v.specular),x.shininess.value=Math.max(v.shininess,1e-4)}function f(x,v){v.gradientMap&&(x.gradientMap.value=v.gradientMap)}function d(x,v){x.metalness.value=v.metalness,v.metalnessMap&&(x.metalnessMap.value=v.metalnessMap,t(v.metalnessMap,x.metalnessMapTransform)),x.roughness.value=v.roughness,v.roughnessMap&&(x.roughnessMap.value=v.roughnessMap,t(v.roughnessMap,x.roughnessMapTransform)),e.get(v).envMap&&(x.envMapIntensity.value=v.envMapIntensity)}function m(x,v,A){x.ior.value=v.ior,v.sheen>0&&(x.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),x.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(x.sheenColorMap.value=v.sheenColorMap,t(v.sheenColorMap,x.sheenColorMapTransform)),v.sheenRoughnessMap&&(x.sheenRoughnessMap.value=v.sheenRoughnessMap,t(v.sheenRoughnessMap,x.sheenRoughnessMapTransform))),v.clearcoat>0&&(x.clearcoat.value=v.clearcoat,x.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(x.clearcoatMap.value=v.clearcoatMap,t(v.clearcoatMap,x.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(x.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,t(v.clearcoatRoughnessMap,x.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(x.clearcoatNormalMap.value=v.clearcoatNormalMap,t(v.clearcoatNormalMap,x.clearcoatNormalMapTransform),x.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===Xr&&x.clearcoatNormalScale.value.negate())),v.iridescence>0&&(x.iridescence.value=v.iridescence,x.iridescenceIOR.value=v.iridescenceIOR,x.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],x.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(x.iridescenceMap.value=v.iridescenceMap,t(v.iridescenceMap,x.iridescenceMapTransform)),v.iridescenceThicknessMap&&(x.iridescenceThicknessMap.value=v.iridescenceThicknessMap,t(v.iridescenceThicknessMap,x.iridescenceThicknessMapTransform))),v.transmission>0&&(x.transmission.value=v.transmission,x.transmissionSamplerMap.value=A.texture,x.transmissionSamplerSize.value.set(A.width,A.height),v.transmissionMap&&(x.transmissionMap.value=v.transmissionMap,t(v.transmissionMap,x.transmissionMapTransform)),x.thickness.value=v.thickness,v.thicknessMap&&(x.thicknessMap.value=v.thicknessMap,t(v.thicknessMap,x.thicknessMapTransform)),x.attenuationDistance.value=v.attenuationDistance,x.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(x.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(x.anisotropyMap.value=v.anisotropyMap,t(v.anisotropyMap,x.anisotropyMapTransform))),x.specularIntensity.value=v.specularIntensity,x.specularColor.value.copy(v.specularColor),v.specularColorMap&&(x.specularColorMap.value=v.specularColorMap,t(v.specularColorMap,x.specularColorMapTransform)),v.specularIntensityMap&&(x.specularIntensityMap.value=v.specularIntensityMap,t(v.specularIntensityMap,x.specularIntensityMapTransform))}function g(x,v){v.matcap&&(x.matcap.value=v.matcap)}function y(x,v){const A=e.get(v).light;x.referencePosition.value.setFromMatrixPosition(A.matrixWorld),x.nearDistance.value=A.shadow.camera.near,x.farDistance.value=A.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function gJ(n,e,t,r){let i={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(A,w){const S=w.program;r.uniformBlockBinding(A,S)}function c(A,w){let S=i[A.id];S===void 0&&(g(A),S=u(A),i[A.id]=S,A.addEventListener("dispose",x));const M=w.program;r.updateUBOMapping(A,M);const b=e.render.frame;s[A.id]!==b&&(d(A),s[A.id]=b)}function u(A){const w=f();A.__bindingPointIndex=w;const S=n.createBuffer(),M=A.__size,b=A.usage;return n.bindBuffer(n.UNIFORM_BUFFER,S),n.bufferData(n.UNIFORM_BUFFER,M,b),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,w,S),S}function f(){for(let A=0;A<a;A++)if(o.indexOf(A)===-1)return o.push(A),A;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(A){const w=i[A.id],S=A.uniforms,M=A.__cache;n.bindBuffer(n.UNIFORM_BUFFER,w);for(let b=0,R=S.length;b<R;b++){const P=Array.isArray(S[b])?S[b]:[S[b]];for(let C=0,B=P.length;C<B;C++){const H=P[C];if(m(H,b,C,M)===!0){const k=H.__offset,$=Array.isArray(H.value)?H.value:[H.value];let U=0;for(let z=0;z<$.length;z++){const O=$[z],ie=y(O);typeof O=="number"||typeof O=="boolean"?(H.__data[0]=O,n.bufferSubData(n.UNIFORM_BUFFER,k+U,H.__data)):O.isMatrix3?(H.__data[0]=O.elements[0],H.__data[1]=O.elements[1],H.__data[2]=O.elements[2],H.__data[3]=0,H.__data[4]=O.elements[3],H.__data[5]=O.elements[4],H.__data[6]=O.elements[5],H.__data[7]=0,H.__data[8]=O.elements[6],H.__data[9]=O.elements[7],H.__data[10]=O.elements[8],H.__data[11]=0):(O.toArray(H.__data,U),U+=ie.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,k,H.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function m(A,w,S,M){const b=A.value,R=w+"_"+S;if(M[R]===void 0)return typeof b=="number"||typeof b=="boolean"?M[R]=b:M[R]=b.clone(),!0;{const P=M[R];if(typeof b=="number"||typeof b=="boolean"){if(P!==b)return M[R]=b,!0}else if(P.equals(b)===!1)return P.copy(b),!0}return!1}function g(A){const w=A.uniforms;let S=0;const M=16;for(let R=0,P=w.length;R<P;R++){const C=Array.isArray(w[R])?w[R]:[w[R]];for(let B=0,H=C.length;B<H;B++){const k=C[B],$=Array.isArray(k.value)?k.value:[k.value];for(let U=0,z=$.length;U<z;U++){const O=$[U],ie=y(O),X=S%M;X!==0&&M-X<ie.boundary&&(S+=M-X),k.__data=new Float32Array(ie.storage/Float32Array.BYTES_PER_ELEMENT),k.__offset=S,S+=ie.storage}}}const b=S%M;return b>0&&(S+=M-b),A.__size=S,A.__cache={},this}function y(A){const w={boundary:0,storage:0};return typeof A=="number"||typeof A=="boolean"?(w.boundary=4,w.storage=4):A.isVector2?(w.boundary=8,w.storage=8):A.isVector3||A.isColor?(w.boundary=16,w.storage=12):A.isVector4?(w.boundary=16,w.storage=16):A.isMatrix3?(w.boundary=48,w.storage=48):A.isMatrix4?(w.boundary=64,w.storage=64):A.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",A),w}function x(A){const w=A.target;w.removeEventListener("dispose",x);const S=o.indexOf(w.__bindingPointIndex);o.splice(S,1),n.deleteBuffer(i[w.id]),delete i[w.id],delete s[w.id]}function v(){for(const A in i)n.deleteBuffer(i[A]);o=[],i={},s={}}return{bind:l,update:c,dispose:v}}class V_{constructor(e={}){const{canvas:t=XO(),context:r=null,depth:i=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:f=!1}=e;this.isWebGLRenderer=!0;let d;r!==null?d=r.getContextAttributes().alpha:d=o;const m=new Uint32Array(4),g=new Int32Array(4);let y=null,x=null;const v=[],A=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=mn,this._useLegacyLights=!1,this.toneMapping=na,this.toneMappingExposure=1;const w=this;let S=!1,M=0,b=0,R=null,P=-1,C=null;const B=new wn,H=new wn;let k=null;const $=new ht(0);let U=0,z=t.width,O=t.height,ie=1,X=null,K=null;const W=new wn(0,0,z,O),V=new wn(0,0,z,O);let Q=!1;const q=new Kv;let ne=!1,fe=!1,pe=null;const ge=new Bt,Ce=new Ge,Je=new Y,Xe={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Fe(){return R===null?ie:1}let j=r;function Te(L,ee){for(let re=0;re<L.length;re++){const he=L[re],ue=t.getContext(he,ee);if(ue!==null)return ue}return null}try{const L={alpha:!0,depth:i,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Bh}`),t.addEventListener("webglcontextlost",ve,!1),t.addEventListener("webglcontextrestored",ce,!1),t.addEventListener("webglcontextcreationerror",at,!1),j===null){const ee=["webgl2","webgl","experimental-webgl"];if(w.isWebGL1Renderer===!0&&ee.shift(),j=Te(ee,L),j===null)throw Te(ee)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&j instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),j.getShaderPrecisionFormat===void 0&&(j.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(L){throw console.error("THREE.WebGLRenderer: "+L.message),L}let be,Ue,we,et,Re,J,F,G,de,le,ye,Le,Ve,Oe,ze,Ye,Ie,gt,yt,ot,Ze,Ke,ae,De;function rt(){be=new B7(j),Ue=new S7(j,be,e),be.init(Ue),Ke=new nk(j,be,Ue),we=new fJ(j,be,Ue),et=new L7(j),Re=new $X,J=new hJ(j,be,we,Re,Ue,Ke,et),F=new M7(w),G=new R7(w),de=new z9(j,Ue),ae=new w7(j,be,de,Ue),le=new P7(j,de,et,ae),ye=new F7(j,le,de,et),yt=new U7(j,Ue,J),Ye=new b7(Re),Le=new qX(w,F,G,be,Ue,ae,Ye),Ve=new mJ(w,Re),Oe=new tJ,ze=new aJ(be,Ue),gt=new _7(w,F,G,we,ye,d,l),Ie=new uJ(w,ye,Ue),De=new gJ(j,et,Ue,we),ot=new E7(j,be,et,Ue),Ze=new I7(j,be,et,Ue),et.programs=Le.programs,w.capabilities=Ue,w.extensions=be,w.properties=Re,w.renderLists=Oe,w.shadowMap=Ie,w.state=we,w.info=et}rt();const it=new pJ(w,j);this.xr=it,this.getContext=function(){return j},this.getContextAttributes=function(){return j.getContextAttributes()},this.forceContextLoss=function(){const L=be.get("WEBGL_lose_context");L&&L.loseContext()},this.forceContextRestore=function(){const L=be.get("WEBGL_lose_context");L&&L.restoreContext()},this.getPixelRatio=function(){return ie},this.setPixelRatio=function(L){L!==void 0&&(ie=L,this.setSize(z,O,!1))},this.getSize=function(L){return L.set(z,O)},this.setSize=function(L,ee,re=!0){if(it.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}z=L,O=ee,t.width=Math.floor(L*ie),t.height=Math.floor(ee*ie),re===!0&&(t.style.width=L+"px",t.style.height=ee+"px"),this.setViewport(0,0,L,ee)},this.getDrawingBufferSize=function(L){return L.set(z*ie,O*ie).floor()},this.setDrawingBufferSize=function(L,ee,re){z=L,O=ee,ie=re,t.width=Math.floor(L*re),t.height=Math.floor(ee*re),this.setViewport(0,0,L,ee)},this.getCurrentViewport=function(L){return L.copy(B)},this.getViewport=function(L){return L.copy(W)},this.setViewport=function(L,ee,re,he){L.isVector4?W.set(L.x,L.y,L.z,L.w):W.set(L,ee,re,he),we.viewport(B.copy(W).multiplyScalar(ie).floor())},this.getScissor=function(L){return L.copy(V)},this.setScissor=function(L,ee,re,he){L.isVector4?V.set(L.x,L.y,L.z,L.w):V.set(L,ee,re,he),we.scissor(H.copy(V).multiplyScalar(ie).floor())},this.getScissorTest=function(){return Q},this.setScissorTest=function(L){we.setScissorTest(Q=L)},this.setOpaqueSort=function(L){X=L},this.setTransparentSort=function(L){K=L},this.getClearColor=function(L){return L.copy(gt.getClearColor())},this.setClearColor=function(){gt.setClearColor.apply(gt,arguments)},this.getClearAlpha=function(){return gt.getClearAlpha()},this.setClearAlpha=function(){gt.setClearAlpha.apply(gt,arguments)},this.clear=function(L=!0,ee=!0,re=!0){let he=0;if(L){let ue=!1;if(R!==null){const Pe=R.texture.format;ue=Pe===y2||Pe===v2||Pe===g2}if(ue){const Pe=R.texture.type,ke=Pe===Gr||Pe===qo||Pe===N_||Pe===Nl||Pe===d2||Pe===p2,We=gt.getClearColor(),Ae=gt.getClearAlpha(),vt=We.r,nt=We.g,tt=We.b;ke?(m[0]=vt,m[1]=nt,m[2]=tt,m[3]=Ae,j.clearBufferuiv(j.COLOR,0,m)):(g[0]=vt,g[1]=nt,g[2]=tt,g[3]=Ae,j.clearBufferiv(j.COLOR,0,g))}else he|=j.COLOR_BUFFER_BIT}ee&&(he|=j.DEPTH_BUFFER_BIT),re&&(he|=j.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),j.clear(he)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ve,!1),t.removeEventListener("webglcontextrestored",ce,!1),t.removeEventListener("webglcontextcreationerror",at,!1),Oe.dispose(),ze.dispose(),Re.dispose(),F.dispose(),G.dispose(),ye.dispose(),ae.dispose(),De.dispose(),Le.dispose(),it.dispose(),it.removeEventListener("sessionstart",qt),it.removeEventListener("sessionend",Ft),pe&&(pe.dispose(),pe=null),ln.stop()};function ve(L){L.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),S=!0}function ce(){console.log("THREE.WebGLRenderer: Context Restored."),S=!1;const L=et.autoReset,ee=Ie.enabled,re=Ie.autoUpdate,he=Ie.needsUpdate,ue=Ie.type;rt(),et.autoReset=L,Ie.enabled=ee,Ie.autoUpdate=re,Ie.needsUpdate=he,Ie.type=ue}function at(L){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",L.statusMessage)}function $e(L){const ee=L.target;ee.removeEventListener("dispose",$e),ct(ee)}function ct(L){ft(L),Re.remove(L)}function ft(L){const ee=Re.get(L).programs;ee!==void 0&&(ee.forEach(function(re){Le.releaseProgram(re)}),L.isShaderMaterial&&Le.releaseShaderCache(L))}this.renderBufferDirect=function(L,ee,re,he,ue,Pe){ee===null&&(ee=Xe);const ke=ue.isMesh&&ue.matrixWorld.determinant()<0,We=D(L,ee,re,he,ue);we.setMaterial(he,ke);let Ae=re.index,vt=1;if(he.wireframe===!0){if(Ae=le.getWireframeAttribute(re),Ae===void 0)return;vt=2}const nt=re.drawRange,tt=re.attributes.position;let Et=nt.start*vt,Pt=(nt.start+nt.count)*vt;Pe!==null&&(Et=Math.max(Et,Pe.start*vt),Pt=Math.min(Pt,(Pe.start+Pe.count)*vt)),Ae!==null?(Et=Math.max(Et,0),Pt=Math.min(Pt,Ae.count)):tt!=null&&(Et=Math.max(Et,0),Pt=Math.min(Pt,tt.count));const Lt=Pt-Et;if(Lt<0||Lt===1/0)return;ae.setup(ue,he,We,re,Ae);let Vt,xt=ot;if(Ae!==null&&(Vt=de.get(Ae),xt=Ze,xt.setIndex(Vt)),ue.isMesh)he.wireframe===!0?(we.setLineWidth(he.wireframeLinewidth*Fe()),xt.setMode(j.LINES)):xt.setMode(j.TRIANGLES);else if(ue.isLine){let dt=he.linewidth;dt===void 0&&(dt=1),we.setLineWidth(dt*Fe()),ue.isLineSegments?xt.setMode(j.LINES):ue.isLineLoop?xt.setMode(j.LINE_LOOP):xt.setMode(j.LINE_STRIP)}else ue.isPoints?xt.setMode(j.POINTS):ue.isSprite&&xt.setMode(j.TRIANGLES);if(ue.isBatchedMesh)xt.renderMultiDraw(ue._multiDrawStarts,ue._multiDrawCounts,ue._multiDrawCount);else if(ue.isInstancedMesh)xt.renderInstances(Et,Lt,ue.count);else if(re.isInstancedBufferGeometry){const dt=re._maxInstanceCount!==void 0?re._maxInstanceCount:1/0,Kt=Math.min(re.instanceCount,dt);xt.renderInstances(Et,Lt,Kt)}else xt.render(Et,Lt)};function Tt(L,ee,re){L.transparent===!0&&L.side===di&&L.forceSinglePass===!1?(L.side=Xr,L.needsUpdate=!0,Ot(L,ee,re),L.side=sa,L.needsUpdate=!0,Ot(L,ee,re),L.side=di):Ot(L,ee,re)}this.compile=function(L,ee,re=null){re===null&&(re=L),x=ze.get(re),x.init(),A.push(x),re.traverseVisible(function(ue){ue.isLight&&ue.layers.test(ee.layers)&&(x.pushLight(ue),ue.castShadow&&x.pushShadow(ue))}),L!==re&&L.traverseVisible(function(ue){ue.isLight&&ue.layers.test(ee.layers)&&(x.pushLight(ue),ue.castShadow&&x.pushShadow(ue))}),x.setupLights(w._useLegacyLights);const he=new Set;return L.traverse(function(ue){const Pe=ue.material;if(Pe)if(Array.isArray(Pe))for(let ke=0;ke<Pe.length;ke++){const We=Pe[ke];Tt(We,re,ue),he.add(We)}else Tt(Pe,re,ue),he.add(Pe)}),A.pop(),x=null,he},this.compileAsync=function(L,ee,re=null){const he=this.compile(L,ee,re);return new Promise(ue=>{function Pe(){if(he.forEach(function(ke){Re.get(ke).currentProgram.isReady()&&he.delete(ke)}),he.size===0){ue(L);return}setTimeout(Pe,10)}be.get("KHR_parallel_shader_compile")!==null?Pe():setTimeout(Pe,10)})};let mt=null;function Dt(L){mt&&mt(L)}function qt(){ln.stop()}function Ft(){ln.start()}const ln=new YO;ln.setAnimationLoop(Dt),typeof self<"u"&&ln.setContext(self),this.setAnimationLoop=function(L){mt=L,it.setAnimationLoop(L),L===null?ln.stop():ln.start()},it.addEventListener("sessionstart",qt),it.addEventListener("sessionend",Ft),this.render=function(L,ee){if(ee!==void 0&&ee.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(S===!0)return;L.matrixWorldAutoUpdate===!0&&L.updateMatrixWorld(),ee.parent===null&&ee.matrixWorldAutoUpdate===!0&&ee.updateMatrixWorld(),it.enabled===!0&&it.isPresenting===!0&&(it.cameraAutoUpdate===!0&&it.updateCamera(ee),ee=it.getCamera()),L.isScene===!0&&L.onBeforeRender(w,L,ee,R),x=ze.get(L,A.length),x.init(),A.push(x),ge.multiplyMatrices(ee.projectionMatrix,ee.matrixWorldInverse),q.setFromProjectionMatrix(ge),fe=this.localClippingEnabled,ne=Ye.init(this.clippingPlanes,fe),y=Oe.get(L,v.length),y.init(),v.push(y),zn(L,ee,0,w.sortObjects),y.finish(),w.sortObjects===!0&&y.sort(X,K),this.info.render.frame++,ne===!0&&Ye.beginShadows();const re=x.state.shadowsArray;if(Ie.render(re,L,ee),ne===!0&&Ye.endShadows(),this.info.autoReset===!0&&this.info.reset(),gt.render(y,L),x.setupLights(w._useLegacyLights),ee.isArrayCamera){const he=ee.cameras;for(let ue=0,Pe=he.length;ue<Pe;ue++){const ke=he[ue];zr(y,L,ke,ke.viewport)}}else zr(y,L,ee);R!==null&&(J.updateMultisampleRenderTarget(R),J.updateRenderTargetMipmap(R)),L.isScene===!0&&L.onAfterRender(w,L,ee),ae.resetDefaultState(),P=-1,C=null,A.pop(),A.length>0?x=A[A.length-1]:x=null,v.pop(),v.length>0?y=v[v.length-1]:y=null};function zn(L,ee,re,he){if(L.visible===!1)return;if(L.layers.test(ee.layers)){if(L.isGroup)re=L.renderOrder;else if(L.isLOD)L.autoUpdate===!0&&L.update(ee);else if(L.isLight)x.pushLight(L),L.castShadow&&x.pushShadow(L);else if(L.isSprite){if(!L.frustumCulled||q.intersectsSprite(L)){he&&Je.setFromMatrixPosition(L.matrixWorld).applyMatrix4(ge);const ke=ye.update(L),We=L.material;We.visible&&y.push(L,ke,We,re,Je.z,null)}}else if((L.isMesh||L.isLine||L.isPoints)&&(!L.frustumCulled||q.intersectsObject(L))){const ke=ye.update(L),We=L.material;if(he&&(L.boundingSphere!==void 0?(L.boundingSphere===null&&L.computeBoundingSphere(),Je.copy(L.boundingSphere.center)):(ke.boundingSphere===null&&ke.computeBoundingSphere(),Je.copy(ke.boundingSphere.center)),Je.applyMatrix4(L.matrixWorld).applyMatrix4(ge)),Array.isArray(We)){const Ae=ke.groups;for(let vt=0,nt=Ae.length;vt<nt;vt++){const tt=Ae[vt],Et=We[tt.materialIndex];Et&&Et.visible&&y.push(L,ke,Et,re,Je.z,tt)}}else We.visible&&y.push(L,ke,We,re,Je.z,null)}}const Pe=L.children;for(let ke=0,We=Pe.length;ke<We;ke++)zn(Pe[ke],ee,re,he)}function zr(L,ee,re,he){const ue=L.opaque,Pe=L.transmissive,ke=L.transparent;x.setupLightsView(re),ne===!0&&Ye.setGlobalState(w.clippingPlanes,re),Pe.length>0&&oi(ue,Pe,ee,re),he&&we.viewport(B.copy(he)),ue.length>0&&xr(ue,ee,re),Pe.length>0&&xr(Pe,ee,re),ke.length>0&&xr(ke,ee,re),we.buffers.depth.setTest(!0),we.buffers.depth.setMask(!0),we.buffers.color.setMask(!0),we.setPolygonOffset(!1)}function oi(L,ee,re,he){if((re.isScene===!0?re.overrideMaterial:null)!==null)return;const Pe=Ue.isWebGL2;pe===null&&(pe=new hr(1,1,{generateMipmaps:!0,type:be.has("EXT_color_buffer_half_float")?Jr:Gr,minFilter:Ha,samples:Pe?4:0})),w.getDrawingBufferSize(Ce),Pe?pe.setSize(Ce.x,Ce.y):pe.setSize(VA(Ce.x),VA(Ce.y));const ke=w.getRenderTarget();w.setRenderTarget(pe),w.getClearColor($),U=w.getClearAlpha(),U<1&&w.setClearColor(16777215,.5),w.clear();const We=w.toneMapping;w.toneMapping=na,xr(L,re,he),J.updateMultisampleRenderTarget(pe),J.updateRenderTargetMipmap(pe);let Ae=!1;for(let vt=0,nt=ee.length;vt<nt;vt++){const tt=ee[vt],Et=tt.object,Pt=tt.geometry,Lt=tt.material,Vt=tt.group;if(Lt.side===di&&Et.layers.test(he.layers)){const xt=Lt.side;Lt.side=Xr,Lt.needsUpdate=!0,dr(Et,re,he,Pt,Lt,Vt),Lt.side=xt,Lt.needsUpdate=!0,Ae=!0}}Ae===!0&&(J.updateMultisampleRenderTarget(pe),J.updateRenderTargetMipmap(pe)),w.setRenderTarget(ke),w.setClearColor($,U),w.toneMapping=We}function xr(L,ee,re){const he=ee.isScene===!0?ee.overrideMaterial:null;for(let ue=0,Pe=L.length;ue<Pe;ue++){const ke=L[ue],We=ke.object,Ae=ke.geometry,vt=he===null?ke.material:he,nt=ke.group;We.layers.test(re.layers)&&dr(We,ee,re,Ae,vt,nt)}}function dr(L,ee,re,he,ue,Pe){L.onBeforeRender(w,ee,re,he,ue,Pe),L.modelViewMatrix.multiplyMatrices(re.matrixWorldInverse,L.matrixWorld),L.normalMatrix.getNormalMatrix(L.modelViewMatrix),ue.onBeforeRender(w,ee,re,he,L,Pe),ue.transparent===!0&&ue.side===di&&ue.forceSinglePass===!1?(ue.side=Xr,ue.needsUpdate=!0,w.renderBufferDirect(re,ee,he,ue,L,Pe),ue.side=sa,ue.needsUpdate=!0,w.renderBufferDirect(re,ee,he,ue,L,Pe),ue.side=di):w.renderBufferDirect(re,ee,he,ue,L,Pe),L.onAfterRender(w,ee,re,he,ue,Pe)}function Ot(L,ee,re){ee.isScene!==!0&&(ee=Xe);const he=Re.get(L),ue=x.state.lights,Pe=x.state.shadowsArray,ke=ue.state.version,We=Le.getParameters(L,ue.state,Pe,ee,re),Ae=Le.getProgramCacheKey(We);let vt=he.programs;he.environment=L.isMeshStandardMaterial?ee.environment:null,he.fog=ee.fog,he.envMap=(L.isMeshStandardMaterial?G:F).get(L.envMap||he.environment),vt===void 0&&(L.addEventListener("dispose",$e),vt=new Map,he.programs=vt);let nt=vt.get(Ae);if(nt!==void 0){if(he.currentProgram===nt&&he.lightsStateVersion===ke)return as(L,We),nt}else We.uniforms=Le.getUniforms(L),L.onBuild(re,We,w),L.onBeforeCompile(We,w),nt=Le.acquireProgram(We,Ae),vt.set(Ae,nt),he.uniforms=We.uniforms;const tt=he.uniforms;return(!L.isShaderMaterial&&!L.isRawShaderMaterial||L.clipping===!0)&&(tt.clippingPlanes=Ye.uniform),as(L,We),he.needsLights=me(L),he.lightsStateVersion=ke,he.needsLights&&(tt.ambientLightColor.value=ue.state.ambient,tt.lightProbe.value=ue.state.probe,tt.directionalLights.value=ue.state.directional,tt.directionalLightShadows.value=ue.state.directionalShadow,tt.spotLights.value=ue.state.spot,tt.spotLightShadows.value=ue.state.spotShadow,tt.rectAreaLights.value=ue.state.rectArea,tt.ltc_1.value=ue.state.rectAreaLTC1,tt.ltc_2.value=ue.state.rectAreaLTC2,tt.pointLights.value=ue.state.point,tt.pointLightShadows.value=ue.state.pointShadow,tt.hemisphereLights.value=ue.state.hemi,tt.directionalShadowMap.value=ue.state.directionalShadowMap,tt.directionalShadowMatrix.value=ue.state.directionalShadowMatrix,tt.spotShadowMap.value=ue.state.spotShadowMap,tt.spotLightMatrix.value=ue.state.spotLightMatrix,tt.spotLightMap.value=ue.state.spotLightMap,tt.pointShadowMap.value=ue.state.pointShadowMap,tt.pointShadowMatrix.value=ue.state.pointShadowMatrix),he.currentProgram=nt,he.uniformsList=null,nt}function nr(L){if(L.uniformsList===null){const ee=L.currentProgram.getUniforms();L.uniformsList=Y1.seqWithValue(ee.seq,L.uniforms)}return L.uniformsList}function as(L,ee){const re=Re.get(L);re.outputColorSpace=ee.outputColorSpace,re.batching=ee.batching,re.instancing=ee.instancing,re.instancingColor=ee.instancingColor,re.skinning=ee.skinning,re.morphTargets=ee.morphTargets,re.morphNormals=ee.morphNormals,re.morphColors=ee.morphColors,re.morphTargetsCount=ee.morphTargetsCount,re.numClippingPlanes=ee.numClippingPlanes,re.numIntersection=ee.numClipIntersection,re.vertexAlphas=ee.vertexAlphas,re.vertexTangents=ee.vertexTangents,re.toneMapping=ee.toneMapping}function D(L,ee,re,he,ue){ee.isScene!==!0&&(ee=Xe),J.resetTextureUnits();const Pe=ee.fog,ke=he.isMeshStandardMaterial?ee.environment:null,We=R===null?w.outputColorSpace:R.isXRRenderTarget===!0?R.texture.colorSpace:is,Ae=(he.isMeshStandardMaterial?G:F).get(he.envMap||ke),vt=he.vertexColors===!0&&!!re.attributes.color&&re.attributes.color.itemSize===4,nt=!!re.attributes.tangent&&(!!he.normalMap||he.anisotropy>0),tt=!!re.morphAttributes.position,Et=!!re.morphAttributes.normal,Pt=!!re.morphAttributes.color;let Lt=na;he.toneMapped&&(R===null||R.isXRRenderTarget===!0)&&(Lt=w.toneMapping);const Vt=re.morphAttributes.position||re.morphAttributes.normal||re.morphAttributes.color,xt=Vt!==void 0?Vt.length:0,dt=Re.get(he),Kt=x.state.lights;if(ne===!0&&(fe===!0||L!==C)){const Xt=L===C&&he.id===P;Ye.setState(he,L,Xt)}let Ut=!1;he.version===dt.__version?(dt.needsLights&&dt.lightsStateVersion!==Kt.state.version||dt.outputColorSpace!==We||ue.isBatchedMesh&&dt.batching===!1||!ue.isBatchedMesh&&dt.batching===!0||ue.isInstancedMesh&&dt.instancing===!1||!ue.isInstancedMesh&&dt.instancing===!0||ue.isSkinnedMesh&&dt.skinning===!1||!ue.isSkinnedMesh&&dt.skinning===!0||ue.isInstancedMesh&&dt.instancingColor===!0&&ue.instanceColor===null||ue.isInstancedMesh&&dt.instancingColor===!1&&ue.instanceColor!==null||dt.envMap!==Ae||he.fog===!0&&dt.fog!==Pe||dt.numClippingPlanes!==void 0&&(dt.numClippingPlanes!==Ye.numPlanes||dt.numIntersection!==Ye.numIntersection)||dt.vertexAlphas!==vt||dt.vertexTangents!==nt||dt.morphTargets!==tt||dt.morphNormals!==Et||dt.morphColors!==Pt||dt.toneMapping!==Lt||Ue.isWebGL2===!0&&dt.morphTargetsCount!==xt)&&(Ut=!0):(Ut=!0,dt.__version=he.version);let kt=dt.currentProgram;Ut===!0&&(kt=Ot(he,ee,ue));let bn=!1,Ln=!1,Nn=!1;const en=kt.getUniforms(),$t=dt.uniforms;if(we.useProgram(kt.program)&&(bn=!0,Ln=!0,Nn=!0),he.id!==P&&(P=he.id,Ln=!0),bn||C!==L){en.setValue(j,"projectionMatrix",L.projectionMatrix),en.setValue(j,"viewMatrix",L.matrixWorldInverse);const Xt=en.map.cameraPosition;Xt!==void 0&&Xt.setValue(j,Je.setFromMatrixPosition(L.matrixWorld)),Ue.logarithmicDepthBuffer&&en.setValue(j,"logDepthBufFC",2/(Math.log(L.far+1)/Math.LN2)),(he.isMeshPhongMaterial||he.isMeshToonMaterial||he.isMeshLambertMaterial||he.isMeshBasicMaterial||he.isMeshStandardMaterial||he.isShaderMaterial)&&en.setValue(j,"isOrthographic",L.isOrthographicCamera===!0),C!==L&&(C=L,Ln=!0,Nn=!0)}if(ue.isSkinnedMesh){en.setOptional(j,ue,"bindMatrix"),en.setOptional(j,ue,"bindMatrixInverse");const Xt=ue.skeleton;Xt&&(Ue.floatVertexTextures?(Xt.boneTexture===null&&Xt.computeBoneTexture(),en.setValue(j,"boneTexture",Xt.boneTexture,J)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}ue.isBatchedMesh&&(en.setOptional(j,ue,"batchingTexture"),en.setValue(j,"batchingTexture",ue._matricesTexture,J));const kn=re.morphAttributes;if((kn.position!==void 0||kn.normal!==void 0||kn.color!==void 0&&Ue.isWebGL2===!0)&&yt.update(ue,re,kt),(Ln||dt.receiveShadow!==ue.receiveShadow)&&(dt.receiveShadow=ue.receiveShadow,en.setValue(j,"receiveShadow",ue.receiveShadow)),he.isMeshGouraudMaterial&&he.envMap!==null&&($t.envMap.value=Ae,$t.flipEnvMap.value=Ae.isCubeTexture&&Ae.isRenderTargetTexture===!1?-1:1),Ln&&(en.setValue(j,"toneMappingExposure",w.toneMappingExposure),dt.needsLights&&Z($t,Nn),Pe&&he.fog===!0&&Ve.refreshFogUniforms($t,Pe),Ve.refreshMaterialUniforms($t,he,ie,O,pe),Y1.upload(j,nr(dt),$t,J)),he.isShaderMaterial&&he.uniformsNeedUpdate===!0&&(Y1.upload(j,nr(dt),$t,J),he.uniformsNeedUpdate=!1),he.isSpriteMaterial&&en.setValue(j,"center",ue.center),en.setValue(j,"modelViewMatrix",ue.modelViewMatrix),en.setValue(j,"normalMatrix",ue.normalMatrix),en.setValue(j,"modelMatrix",ue.matrixWorld),he.isShaderMaterial||he.isRawShaderMaterial){const Xt=he.uniformsGroups;for(let Wt=0,Dn=Xt.length;Wt<Dn;Wt++)if(Ue.isWebGL2){const ai=Xt[Wt];De.update(ai,kt),De.bind(ai,kt)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return kt}function Z(L,ee){L.ambientLightColor.needsUpdate=ee,L.lightProbe.needsUpdate=ee,L.directionalLights.needsUpdate=ee,L.directionalLightShadows.needsUpdate=ee,L.pointLights.needsUpdate=ee,L.pointLightShadows.needsUpdate=ee,L.spotLights.needsUpdate=ee,L.spotLightShadows.needsUpdate=ee,L.rectAreaLights.needsUpdate=ee,L.hemisphereLights.needsUpdate=ee}function me(L){return L.isMeshLambertMaterial||L.isMeshToonMaterial||L.isMeshPhongMaterial||L.isMeshStandardMaterial||L.isShadowMaterial||L.isShaderMaterial&&L.lights===!0}this.getActiveCubeFace=function(){return M},this.getActiveMipmapLevel=function(){return b},this.getRenderTarget=function(){return R},this.setRenderTargetTextures=function(L,ee,re){Re.get(L.texture).__webglTexture=ee,Re.get(L.depthTexture).__webglTexture=re;const he=Re.get(L);he.__hasExternalTextures=!0,he.__hasExternalTextures&&(he.__autoAllocateDepthBuffer=re===void 0,he.__autoAllocateDepthBuffer||be.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),he.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(L,ee){const re=Re.get(L);re.__webglFramebuffer=ee,re.__useDefaultFramebuffer=ee===void 0},this.setRenderTarget=function(L,ee=0,re=0){R=L,M=ee,b=re;let he=!0,ue=null,Pe=!1,ke=!1;if(L){const Ae=Re.get(L);Ae.__useDefaultFramebuffer!==void 0?(we.bindFramebuffer(j.FRAMEBUFFER,null),he=!1):Ae.__webglFramebuffer===void 0?J.setupRenderTarget(L):Ae.__hasExternalTextures&&J.rebindTextures(L,Re.get(L.texture).__webglTexture,Re.get(L.depthTexture).__webglTexture);const vt=L.texture;(vt.isData3DTexture||vt.isDataArrayTexture||vt.isCompressedArrayTexture)&&(ke=!0);const nt=Re.get(L).__webglFramebuffer;L.isWebGLCubeRenderTarget?(Array.isArray(nt[ee])?ue=nt[ee][re]:ue=nt[ee],Pe=!0):Ue.isWebGL2&&L.samples>0&&J.useMultisampledRTT(L)===!1?ue=Re.get(L).__webglMultisampledFramebuffer:Array.isArray(nt)?ue=nt[re]:ue=nt,B.copy(L.viewport),H.copy(L.scissor),k=L.scissorTest}else B.copy(W).multiplyScalar(ie).floor(),H.copy(V).multiplyScalar(ie).floor(),k=Q;if(we.bindFramebuffer(j.FRAMEBUFFER,ue)&&Ue.drawBuffers&&he&&we.drawBuffers(L,ue),we.viewport(B),we.scissor(H),we.setScissorTest(k),Pe){const Ae=Re.get(L.texture);j.framebufferTexture2D(j.FRAMEBUFFER,j.COLOR_ATTACHMENT0,j.TEXTURE_CUBE_MAP_POSITIVE_X+ee,Ae.__webglTexture,re)}else if(ke){const Ae=Re.get(L.texture),vt=ee||0;j.framebufferTextureLayer(j.FRAMEBUFFER,j.COLOR_ATTACHMENT0,Ae.__webglTexture,re||0,vt)}P=-1},this.readRenderTargetPixels=function(L,ee,re,he,ue,Pe,ke){if(!(L&&L.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let We=Re.get(L).__webglFramebuffer;if(L.isWebGLCubeRenderTarget&&ke!==void 0&&(We=We[ke]),We){we.bindFramebuffer(j.FRAMEBUFFER,We);try{const Ae=L.texture,vt=Ae.format,nt=Ae.type;if(vt!==Ur&&Ke.convert(vt)!==j.getParameter(j.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const tt=nt===Jr&&(be.has("EXT_color_buffer_half_float")||Ue.isWebGL2&&be.has("EXT_color_buffer_float"));if(nt!==Gr&&Ke.convert(nt)!==j.getParameter(j.IMPLEMENTATION_COLOR_READ_TYPE)&&!(nt===Cr&&(Ue.isWebGL2||be.has("OES_texture_float")||be.has("WEBGL_color_buffer_float")))&&!tt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ee>=0&&ee<=L.width-he&&re>=0&&re<=L.height-ue&&j.readPixels(ee,re,he,ue,Ke.convert(vt),Ke.convert(nt),Pe)}finally{const Ae=R!==null?Re.get(R).__webglFramebuffer:null;we.bindFramebuffer(j.FRAMEBUFFER,Ae)}}},this.copyFramebufferToTexture=function(L,ee,re=0){const he=Math.pow(2,-re),ue=Math.floor(ee.image.width*he),Pe=Math.floor(ee.image.height*he);J.setTexture2D(ee,0),j.copyTexSubImage2D(j.TEXTURE_2D,re,0,0,L.x,L.y,ue,Pe),we.unbindTexture()},this.copyTextureToTexture=function(L,ee,re,he=0){const ue=ee.image.width,Pe=ee.image.height,ke=Ke.convert(re.format),We=Ke.convert(re.type);J.setTexture2D(re,0),j.pixelStorei(j.UNPACK_FLIP_Y_WEBGL,re.flipY),j.pixelStorei(j.UNPACK_PREMULTIPLY_ALPHA_WEBGL,re.premultiplyAlpha),j.pixelStorei(j.UNPACK_ALIGNMENT,re.unpackAlignment),ee.isDataTexture?j.texSubImage2D(j.TEXTURE_2D,he,L.x,L.y,ue,Pe,ke,We,ee.image.data):ee.isCompressedTexture?j.compressedTexSubImage2D(j.TEXTURE_2D,he,L.x,L.y,ee.mipmaps[0].width,ee.mipmaps[0].height,ke,ee.mipmaps[0].data):j.texSubImage2D(j.TEXTURE_2D,he,L.x,L.y,ke,We,ee.image),he===0&&re.generateMipmaps&&j.generateMipmap(j.TEXTURE_2D),we.unbindTexture()},this.copyTextureToTexture3D=function(L,ee,re,he,ue=0){if(w.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Pe=L.max.x-L.min.x+1,ke=L.max.y-L.min.y+1,We=L.max.z-L.min.z+1,Ae=Ke.convert(he.format),vt=Ke.convert(he.type);let nt;if(he.isData3DTexture)J.setTexture3D(he,0),nt=j.TEXTURE_3D;else if(he.isDataArrayTexture||he.isCompressedArrayTexture)J.setTexture2DArray(he,0),nt=j.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}j.pixelStorei(j.UNPACK_FLIP_Y_WEBGL,he.flipY),j.pixelStorei(j.UNPACK_PREMULTIPLY_ALPHA_WEBGL,he.premultiplyAlpha),j.pixelStorei(j.UNPACK_ALIGNMENT,he.unpackAlignment);const tt=j.getParameter(j.UNPACK_ROW_LENGTH),Et=j.getParameter(j.UNPACK_IMAGE_HEIGHT),Pt=j.getParameter(j.UNPACK_SKIP_PIXELS),Lt=j.getParameter(j.UNPACK_SKIP_ROWS),Vt=j.getParameter(j.UNPACK_SKIP_IMAGES),xt=re.isCompressedTexture?re.mipmaps[ue]:re.image;j.pixelStorei(j.UNPACK_ROW_LENGTH,xt.width),j.pixelStorei(j.UNPACK_IMAGE_HEIGHT,xt.height),j.pixelStorei(j.UNPACK_SKIP_PIXELS,L.min.x),j.pixelStorei(j.UNPACK_SKIP_ROWS,L.min.y),j.pixelStorei(j.UNPACK_SKIP_IMAGES,L.min.z),re.isDataTexture||re.isData3DTexture?j.texSubImage3D(nt,ue,ee.x,ee.y,ee.z,Pe,ke,We,Ae,vt,xt.data):re.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),j.compressedTexSubImage3D(nt,ue,ee.x,ee.y,ee.z,Pe,ke,We,Ae,xt.data)):j.texSubImage3D(nt,ue,ee.x,ee.y,ee.z,Pe,ke,We,Ae,vt,xt),j.pixelStorei(j.UNPACK_ROW_LENGTH,tt),j.pixelStorei(j.UNPACK_IMAGE_HEIGHT,Et),j.pixelStorei(j.UNPACK_SKIP_PIXELS,Pt),j.pixelStorei(j.UNPACK_SKIP_ROWS,Lt),j.pixelStorei(j.UNPACK_SKIP_IMAGES,Vt),ue===0&&he.generateMipmaps&&j.generateMipmap(nt),we.unbindTexture()},this.initTexture=function(L){L.isCubeTexture?J.setTextureCube(L,0):L.isData3DTexture?J.setTexture3D(L,0):L.isDataArrayTexture||L.isCompressedArrayTexture?J.setTexture2DArray(L,0):J.setTexture2D(L,0),we.unbindTexture()},this.resetState=function(){M=0,b=0,R=null,we.reset(),ae.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return $o}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===F_?"display-p3":"srgb",t.unpackColorSpace=Pn.workingColorSpace===Vv?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===mn?ou:E2}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===ou?mn:is}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class ik extends V_{}ik.prototype.isWebGL1Renderer=!0;class W_{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new ht(e),this.density=t}clone(){return new W_(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class X_{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new ht(e),this.near=t,this.far=r}clone(){return new X_(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class yu extends gn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class Qv{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=j0,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Js()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Js()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Js()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Xi=new Y;class xu{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Xi.fromBufferAttribute(this,t),Xi.applyMatrix4(e),this.setXYZ(t,Xi.x,Xi.y,Xi.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Xi.fromBufferAttribute(this,t),Xi.applyNormalMatrix(e),this.setXYZ(t,Xi.x,Xi.y,Xi.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Xi.fromBufferAttribute(this,t),Xi.transformDirection(e),this.setXYZ(t,Xi.x,Xi.y,Xi.z);return this}setX(e,t){return this.normalized&&(t=nn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=nn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=nn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=nn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=xs(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=xs(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=xs(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=xs(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=nn(t,this.array),r=nn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=nn(t,this.array),r=nn(r,this.array),i=nn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=nn(t,this.array),r=nn(r,this.array),i=nn(i,this.array),s=nn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new vn(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new xu(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class N2 extends ur{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new ht(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let md;const Tg=new Y,gd=new Y,vd=new Y,yd=new Ge,Cg=new Ge,sk=new Bt,Ox=new Y,Rg=new Y,kx=new Y,vL=new Ge,AS=new Ge,yL=new Ge;class ok extends gn{constructor(e=new N2){if(super(),this.isSprite=!0,this.type="Sprite",md===void 0){md=new jt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new Qv(t,5);md.setIndex([0,1,2,0,2,3]),md.setAttribute("position",new xu(r,3,0,!1)),md.setAttribute("uv",new xu(r,2,3,!1))}this.geometry=md,this.material=e,this.center=new Ge(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),gd.setFromMatrixScale(this.matrixWorld),sk.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),vd.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&gd.multiplyScalar(-vd.z);const r=this.material.rotation;let i,s;r!==0&&(s=Math.cos(r),i=Math.sin(r));const o=this.center;Gx(Ox.set(-.5,-.5,0),vd,o,gd,i,s),Gx(Rg.set(.5,-.5,0),vd,o,gd,i,s),Gx(kx.set(.5,.5,0),vd,o,gd,i,s),vL.set(0,0),AS.set(1,0),yL.set(1,1);let a=e.ray.intersectTriangle(Ox,Rg,kx,!1,Tg);if(a===null&&(Gx(Rg.set(-.5,.5,0),vd,o,gd,i,s),AS.set(0,1),a=e.ray.intersectTriangle(Ox,kx,Rg,!1,Tg),a===null))return;const l=e.ray.origin.distanceTo(Tg);l<e.near||l>e.far||t.push({distance:l,point:Tg.clone(),uv:vs.getInterpolation(Tg,Ox,Rg,kx,vL,AS,yL,new Ge),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Gx(n,e,t,r,i,s){yd.subVectors(n,t).addScalar(.5).multiply(r),i!==void 0?(Cg.x=s*yd.x-i*yd.y,Cg.y=i*yd.x+s*yd.y):Cg.copy(yd),n.copy(e),n.x+=Cg.x,n.y+=Cg.y,n.applyMatrix4(sk)}const zx=new Y,xL=new Y;class ak extends gn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let r=0,i=t.length;r<i;r++){const s=t[r];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,r=0){t=Math.abs(t);const i=this.levels;let s;for(s=0;s<i.length&&!(t<i[s].distance);s++);return i.splice(s,0,{distance:t,hysteresis:r,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let r,i;for(r=1,i=t.length;r<i;r++){let s=t[r].distance;if(t[r].object.visible&&(s-=s*t[r].hysteresis),e<s)break}return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){zx.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(zx);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){zx.setFromMatrixPosition(e.matrixWorld),xL.setFromMatrixPosition(this.matrixWorld);const r=zx.distanceTo(xL)/e.zoom;t[0].object.visible=!0;let i,s;for(i=1,s=t.length;i<s;i++){let o=t[i].distance;if(t[i].object.visible&&(o-=o*t[i].hysteresis),r>=o)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let i=0,s=r.length;i<s;i++){const o=r[i];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const AL=new Y,_L=new wn,wL=new wn,vJ=new Y,EL=new Bt,Hx=new Y,_S=new si,SL=new Bt,wS=new Ph;class D2 extends On{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=SM,this.bindMatrix=new Bt,this.bindMatrixInverse=new Bt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Br),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,Hx),this.boundingBox.expandByPoint(Hx)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new si),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,Hx),this.boundingSphere.expandByPoint(Hx)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.material,i=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_S.copy(this.boundingSphere),_S.applyMatrix4(i),e.ray.intersectsSphere(_S)!==!1&&(SL.copy(i).invert(),wS.copy(e.ray).applyMatrix4(SL),!(this.boundingBox!==null&&wS.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,wS)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new wn,t=this.geometry.attributes.skinWeight;for(let r=0,i=t.count;r<i;r++){e.fromBufferAttribute(t,r);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===SM?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===TO?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const r=this.skeleton,i=this.geometry;_L.fromBufferAttribute(i.attributes.skinIndex,e),wL.fromBufferAttribute(i.attributes.skinWeight,e),AL.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=wL.getComponent(s);if(o!==0){const a=_L.getComponent(s);EL.multiplyMatrices(r.bones[a].matrixWorld,r.boneInverses[a]),t.addScaledVector(vJ.copy(AL).applyMatrix4(EL),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class J_ extends gn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class au extends Sn{constructor(e=null,t=1,r=1,i,s,o,a,l,c=Vn,u=Vn,f,d){super(null,o,a,l,c,u,i,s,f,d),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const bL=new Bt,yJ=new Bt;class jv{constructor(e=[],t=[]){this.uuid=Js(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new Bt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new Bt;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:yJ;bL.multiplyMatrices(a,t[s]),bL.toArray(r,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new jv(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new au(t,e,e,Ur,Cr);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){const s=e.bones[r];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new J_),this.bones.push(o),this.boneInverses.push(new Bt().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const o=t[i];e.bones.push(o.uuid);const a=r[i];e.boneInverses.push(a.toArray())}return e}}class Au extends vn{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const xd=new Bt,ML=new Bt,Vx=[],TL=new Br,xJ=new Bt,Bg=new On,Pg=new si;class U2 extends On{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Au(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<r;i++)this.setMatrixAt(i,xJ)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Br),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,xd),TL.copy(e.boundingBox).applyMatrix4(xd),this.boundingBox.union(TL)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new si),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,xd),Pg.copy(e.boundingSphere).applyMatrix4(xd),this.boundingSphere.union(Pg)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const r=this.matrixWorld,i=this.count;if(Bg.geometry=this.geometry,Bg.material=this.material,Bg.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Pg.copy(this.boundingSphere),Pg.applyMatrix4(r),e.ray.intersectsSphere(Pg)!==!1))for(let s=0;s<i;s++){this.getMatrixAt(s,xd),ML.multiplyMatrices(r,xd),Bg.matrixWorld=ML,Bg.raycast(e,Vx);for(let o=0,a=Vx.length;o<a;o++){const l=Vx[o];l.instanceId=s,l.object=this,t.push(l)}Vx.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Au(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}function AJ(n,e){return n.z-e.z}function _J(n,e){return e.z-n.z}class wJ{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){const r=this.pool,i=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1});const s=r[this.index];i.push(s),this.index++,s.start=e.start,s.count=e.count,s.z=t}reset(){this.list.length=0,this.index=0}}const Ad="batchId",hc=new Bt,CL=new Bt,EJ=new Bt,RL=new Bt,ES=new Kv,Wx=new Br,Zu=new si,Ig=new Y,SS=new wJ,Ri=new On,Xx=[];function SJ(n,e,t=0){const r=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const i=n.count;for(let s=0;s<i;s++)for(let o=0;o<r;o++)e.setComponent(s+t,o,n.getComponent(s,o))}else e.array.set(n.array,t*r);e.needsUpdate=!0}class lk extends On{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t,r=t*2,i){super(new jt,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=r,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),r=new au(t,e,e,Ur,Cr);this._matricesTexture=r}_initializeGeometry(e){const t=this.geometry,r=this._maxVertexCount,i=this._maxGeometryCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const a in e.attributes){const l=e.getAttribute(a),{array:c,itemSize:u,normalized:f}=l,d=new c.constructor(r*u),m=new l.constructor(d,u,f);m.setUsage(l.usage),t.setAttribute(a,m)}if(e.getIndex()!==null){const a=r>65536?new Uint32Array(s):new Uint16Array(s);t.setIndex(new vn(a,1))}const o=i>65536?new Uint32Array(r):new Uint16Array(r);t.setAttribute(Ad,new vn(o,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(Ad))throw new Error(`BatchedMesh: Geometry cannot use attribute "${Ad}"`);const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const r in t.attributes){if(r===Ad)continue;if(!e.hasAttribute(r))throw new Error(`BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);const i=e.getAttribute(r),s=t.getAttribute(r);if(i.itemSize!==s.itemSize||i.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Br);const e=this._geometryCount,t=this.boundingBox,r=this._active;t.makeEmpty();for(let i=0;i<e;i++)r[i]!==!1&&(this.getMatrixAt(i,hc),this.getBoundingBoxAt(i,Wx).applyMatrix4(hc),t.union(Wx))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new si);const e=this._geometryCount,t=this.boundingSphere,r=this._active;t.makeEmpty();for(let i=0;i<e;i++)r[i]!==!1&&(this.getMatrixAt(i,hc),this.getBoundingSphereAt(i,Zu).applyMatrix4(hc),t.union(Zu))}addGeometry(e,t=-1,r=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const i={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const o=this._reservedRanges,a=this._drawRanges,l=this._bounds;this._geometryCount!==0&&(s=o[o.length-1]),t===-1?i.vertexCount=e.getAttribute("position").count:i.vertexCount=t,s===null?i.vertexStart=0:i.vertexStart=s.vertexStart+s.vertexCount;const c=e.getIndex(),u=c!==null;if(u&&(r===-1?i.indexCount=c.count:i.indexCount=r,s===null?i.indexStart=0:i.indexStart=s.indexStart+s.indexCount),i.indexStart!==-1&&i.indexStart+i.indexCount>this._maxIndexCount||i.vertexStart+i.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const f=this._visibility,d=this._active,m=this._matricesTexture,g=this._matricesTexture.image.data;f.push(!0),d.push(!0);const y=this._geometryCount;this._geometryCount++,EJ.toArray(g,y*16),m.needsUpdate=!0,o.push(i),a.push({start:u?i.indexStart:i.vertexStart,count:-1}),l.push({boxInitialized:!1,box:new Br,sphereInitialized:!1,sphere:new si});const x=this.geometry.getAttribute(Ad);for(let v=0;v<i.vertexCount;v++)x.setX(i.vertexStart+v,y);return x.needsUpdate=!0,this.setGeometryAt(y,e),y}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const r=this.geometry,i=r.getIndex()!==null,s=r.getIndex(),o=t.getIndex(),a=this._reservedRanges[e];if(i&&o.count>a.indexCount||t.attributes.position.count>a.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const l=a.vertexStart,c=a.vertexCount;for(const m in r.attributes){if(m===Ad)continue;const g=t.getAttribute(m),y=r.getAttribute(m);SJ(g,y,l);const x=g.itemSize;for(let v=g.count,A=c;v<A;v++){const w=l+v;for(let S=0;S<x;S++)y.setComponent(w,S,0)}y.needsUpdate=!0}if(i){const m=a.indexStart;for(let g=0;g<o.count;g++)s.setX(m+g,l+o.getX(g));for(let g=o.count,y=a.indexCount;g<y;g++)s.setX(m+g,l);s.needsUpdate=!0}const u=this._bounds[e];t.boundingBox!==null?(u.box.copy(t.boundingBox),u.boxInitialized=!0):u.boxInitialized=!1,t.boundingSphere!==null?(u.sphere.copy(t.boundingSphere),u.sphereInitialized=!0):u.sphereInitialized=!1;const f=this._drawRanges[e],d=t.getAttribute("position");return f.count=i?o.count:d.count,this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._active;return e>=t.length||t[e]===!1?this:(t[e]=!1,this._visibilityChanged=!0,this)}getBoundingBoxAt(e,t){if(this._active[e]===!1)return this;const i=this._bounds[e],s=i.box,o=this.geometry;if(i.boxInitialized===!1){s.makeEmpty();const a=o.index,l=o.attributes.position,c=this._drawRanges[e];for(let u=c.start,f=c.start+c.count;u<f;u++){let d=u;a&&(d=a.getX(d)),s.expandByPoint(Ig.fromBufferAttribute(l,d))}i.boxInitialized=!0}return t.copy(s),t}getBoundingSphereAt(e,t){if(this._active[e]===!1)return this;const i=this._bounds[e],s=i.sphere,o=this.geometry;if(i.sphereInitialized===!1){s.makeEmpty(),this.getBoundingBoxAt(e,Wx),Wx.getCenter(s.center);const a=o.index,l=o.attributes.position,c=this._drawRanges[e];let u=0;for(let f=c.start,d=c.start+c.count;f<d;f++){let m=f;a&&(m=a.getX(m)),Ig.fromBufferAttribute(l,m),u=Math.max(u,s.center.distanceToSquared(Ig))}s.radius=Math.sqrt(u),i.sphereInitialized=!0}return t.copy(s),t}setMatrixAt(e,t){const r=this._active,i=this._matricesTexture,s=this._matricesTexture.image.data,o=this._geometryCount;return e>=o||r[e]===!1?this:(t.toArray(s,e*16),i.needsUpdate=!0,this)}getMatrixAt(e,t){const r=this._active,i=this._matricesTexture.image.data,s=this._geometryCount;return e>=s||r[e]===!1?null:t.fromArray(i,e*16)}setVisibleAt(e,t){const r=this._visibility,i=this._active,s=this._geometryCount;return e>=s||i[e]===!1||r[e]===t?this:(r[e]=t,this._visibilityChanged=!0,this)}getVisibleAt(e){const t=this._visibility,r=this._active,i=this._geometryCount;return e>=i||r[e]===!1?!1:t[e]}raycast(e,t){const r=this._visibility,i=this._active,s=this._drawRanges,o=this._geometryCount,a=this.matrixWorld,l=this.geometry;Ri.material=this.material,Ri.geometry.index=l.index,Ri.geometry.attributes=l.attributes,Ri.geometry.boundingBox===null&&(Ri.geometry.boundingBox=new Br),Ri.geometry.boundingSphere===null&&(Ri.geometry.boundingSphere=new si);for(let c=0;c<o;c++){if(!r[c]||!i[c])continue;const u=s[c];Ri.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(c,Ri.matrixWorld).premultiply(a),this.getBoundingBoxAt(c,Ri.geometry.boundingBox),this.getBoundingSphereAt(c,Ri.geometry.boundingSphere),Ri.raycast(e,Xx);for(let f=0,d=Xx.length;f<d;f++){const m=Xx[f];m.object=this,m.batchId=c,t.push(m)}Xx.length=0}Ri.material=null,Ri.geometry.index=null,Ri.geometry.attributes={},Ri.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,r,i,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=i.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._visibility,c=this._multiDrawStarts,u=this._multiDrawCounts,f=this._drawRanges,d=this.perObjectFrustumCulled;d&&(RL.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),ES.setFromProjectionMatrix(RL,e.isWebGPURenderer?_m:$o));let m=0;if(this.sortObjects){CL.copy(this.matrixWorld).invert(),Ig.setFromMatrixPosition(r.matrixWorld).applyMatrix4(CL);for(let x=0,v=l.length;x<v;x++)if(l[x]){this.getMatrixAt(x,hc),this.getBoundingSphereAt(x,Zu).applyMatrix4(hc);let A=!1;if(d&&(A=!ES.intersectsSphere(Zu)),!A){const w=Ig.distanceTo(Zu.center);SS.push(f[x],w)}}const g=SS.list,y=this.customSort;y===null?g.sort(s.transparent?_J:AJ):y.call(this,g,r);for(let x=0,v=g.length;x<v;x++){const A=g[x];c[m]=A.start*a,u[m]=A.count,m++}SS.reset()}else for(let g=0,y=l.length;g<y;g++)if(l[g]){let x=!1;if(d&&(this.getMatrixAt(g,hc),this.getBoundingSphereAt(g,Zu).applyMatrix4(hc),x=!ES.intersectsSphere(Zu)),!x){const v=f[g];c[m]=v.start*a,u[m]=v.count,m++}}this._multiDrawCount=m,this._visibilityChanged=!1}onBeforeShadow(e,t,r,i,s,o){this.onBeforeRender(e,null,i,s,o)}}class Oi extends ur{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ht(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const BL=new Y,PL=new Y,IL=new Bt,bS=new Ph,Jx=new si;class Vl extends gn{constructor(e=new jt,t=new Oi){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let i=1,s=t.count;i<s;i++)BL.fromBufferAttribute(t,i-1),PL.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=BL.distanceTo(PL);e.setAttribute("lineDistance",new Rt(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),Jx.copy(r.boundingSphere),Jx.applyMatrix4(i),Jx.radius+=s,e.ray.intersectsSphere(Jx)===!1)return;IL.copy(i).invert(),bS.copy(e.ray).applyMatrix4(IL);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new Y,u=new Y,f=new Y,d=new Y,m=this.isLineSegments?2:1,g=r.index,x=r.attributes.position;if(g!==null){const v=Math.max(0,o.start),A=Math.min(g.count,o.start+o.count);for(let w=v,S=A-1;w<S;w+=m){const M=g.getX(w),b=g.getX(w+1);if(c.fromBufferAttribute(x,M),u.fromBufferAttribute(x,b),bS.distanceSqToSegment(c,u,d,f)>l)continue;d.applyMatrix4(this.matrixWorld);const P=e.ray.origin.distanceTo(d);P<e.near||P>e.far||t.push({distance:P,point:f.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}else{const v=Math.max(0,o.start),A=Math.min(x.count,o.start+o.count);for(let w=v,S=A-1;w<S;w+=m){if(c.fromBufferAttribute(x,w),u.fromBufferAttribute(x,w+1),bS.distanceSqToSegment(c,u,d,f)>l)continue;d.applyMatrix4(this.matrixWorld);const b=e.ray.origin.distanceTo(d);b<e.near||b>e.far||t.push({distance:b,point:f.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const LL=new Y,NL=new Y;class la extends Vl{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let i=0,s=t.count;i<s;i+=2)LL.fromBufferAttribute(t,i),NL.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+LL.distanceTo(NL);e.setAttribute("lineDistance",new Rt(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class F2 extends Vl{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class K_ extends ur{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new ht(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const DL=new Bt,rT=new Ph,Kx=new si,Qx=new Y;class O2 extends gn{constructor(e=new jt,t=new K_){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),Kx.copy(r.boundingSphere),Kx.applyMatrix4(i),Kx.radius+=s,e.ray.intersectsSphere(Kx)===!1)return;DL.copy(i).invert(),rT.copy(e.ray).applyMatrix4(DL);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=r.index,f=r.attributes.position;if(c!==null){const d=Math.max(0,o.start),m=Math.min(c.count,o.start+o.count);for(let g=d,y=m;g<y;g++){const x=c.getX(g);Qx.fromBufferAttribute(f,x),UL(Qx,x,l,i,e,t,this)}}else{const d=Math.max(0,o.start),m=Math.min(f.count,o.start+o.count);for(let g=d,y=m;g<y;g++)Qx.fromBufferAttribute(f,g),UL(Qx,g,l,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const a=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function UL(n,e,t,r,i,s,o){const a=rT.distanceSqToPoint(n);if(a<t){const l=new Y;rT.closestPointToPoint(n,l),l.applyMatrix4(r);const c=i.ray.origin.distanceTo(l);if(c<i.near||c>i.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class bJ extends Sn{constructor(e,t,r,i,s,o,a,l,c){super(e,t,r,i,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:un,this.magFilter=s!==void 0?s:un,this.generateMipmaps=!1;const u=this;function f(){u.needsUpdate=!0,e.requestVideoFrameCallback(f)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(f)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class MJ extends Sn{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Vn,this.minFilter=Vn,this.generateMipmaps=!1,this.needsUpdate=!0}}class Q_ extends Sn{constructor(e,t,r,i,s,o,a,l,c,u,f,d){super(null,o,a,l,c,u,i,s,f,d),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class TJ extends Q_{constructor(e,t,r,i,s,o){super(e,t,r,s,o),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=Qn}}class CJ extends Q_{constructor(e,t,r){super(void 0,e[0].width,e[0].height,t,r,za),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class RJ extends Sn{constructor(e,t,r,i,s,o,a,l,c){super(e,t,r,i,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class ca{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,i=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)r=this.getPoint(o/e),s+=r.distanceTo(i),t.push(s),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const r=this.getLengths();let i=0;const s=r.length;let o;t?o=t:o=e*r[s-1];let a=0,l=s-1,c;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),c=r[i]-o,c<0)a=i+1;else if(c>0)l=i-1;else{l=i;break}if(i=l,r[i]===o)return i/(s-1);const u=r[i],d=r[i+1]-u,m=(o-u)/d;return(i+m)/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const o=this.getPoint(i),a=this.getPoint(s),l=t||(o.isVector2?new Ge:new Y);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){const r=new Y,i=[],s=[],o=[],a=new Y,l=new Bt;for(let m=0;m<=e;m++){const g=m/e;i[m]=this.getTangentAt(g,new Y)}s[0]=new Y,o[0]=new Y;let c=Number.MAX_VALUE;const u=Math.abs(i[0].x),f=Math.abs(i[0].y),d=Math.abs(i[0].z);u<=c&&(c=u,r.set(1,0,0)),f<=c&&(c=f,r.set(0,1,0)),d<=c&&r.set(0,0,1),a.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],a),o[0].crossVectors(i[0],s[0]);for(let m=1;m<=e;m++){if(s[m]=s[m-1].clone(),o[m]=o[m-1].clone(),a.crossVectors(i[m-1],i[m]),a.length()>Number.EPSILON){a.normalize();const g=Math.acos(yr(i[m-1].dot(i[m]),-1,1));s[m].applyMatrix4(l.makeRotationAxis(a,g))}o[m].crossVectors(i[m],s[m])}if(t===!0){let m=Math.acos(yr(s[0].dot(s[e]),-1,1));m/=e,i[0].dot(a.crossVectors(s[0],s[e]))>0&&(m=-m);for(let g=1;g<=e;g++)s[g].applyMatrix4(l.makeRotationAxis(i[g],m*g)),o[g].crossVectors(i[g],s[g])}return{tangents:i,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class j_ extends ca{constructor(e=0,t=0,r=1,i=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t){const r=t||new Ge,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(o?s=0:s=i),this.aClockwise===!0&&!o&&(s===i?s=-i:s=s-i);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const u=Math.cos(this.aRotation),f=Math.sin(this.aRotation),d=l-this.aX,m=c-this.aY;l=d*u-m*f+this.aX,c=d*f+m*u+this.aY}return r.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class ck extends j_{constructor(e,t,r,i,s,o){super(e,t,r,r,i,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function k2(){let n=0,e=0,t=0,r=0;function i(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,r=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){i(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,f){let d=(o-s)/c-(a-s)/(c+u)+(a-o)/u,m=(a-o)/u-(l-o)/(u+f)+(l-a)/f;d*=u,m*=u,i(o,a,d,m)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+r*a}}}const jx=new Y,MS=new k2,TS=new k2,CS=new k2;class uk extends ca{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new Y){const r=t,i=this.points,s=i.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,u;this.closed||a>0?c=i[(a-1)%s]:(jx.subVectors(i[0],i[1]).add(i[0]),c=jx);const f=i[a%s],d=i[(a+1)%s];if(this.closed||a+2<s?u=i[(a+2)%s]:(jx.subVectors(i[s-1],i[s-2]).add(i[s-1]),u=jx),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let g=Math.pow(c.distanceToSquared(f),m),y=Math.pow(f.distanceToSquared(d),m),x=Math.pow(d.distanceToSquared(u),m);y<1e-4&&(y=1),g<1e-4&&(g=y),x<1e-4&&(x=y),MS.initNonuniformCatmullRom(c.x,f.x,d.x,u.x,g,y,x),TS.initNonuniformCatmullRom(c.y,f.y,d.y,u.y,g,y,x),CS.initNonuniformCatmullRom(c.z,f.z,d.z,u.z,g,y,x)}else this.curveType==="catmullrom"&&(MS.initCatmullRom(c.x,f.x,d.x,u.x,this.tension),TS.initCatmullRom(c.y,f.y,d.y,u.y,this.tension),CS.initCatmullRom(c.z,f.z,d.z,u.z,this.tension));return r.set(MS.calc(l),TS.calc(l),CS.calc(l)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new Y().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function FL(n,e,t,r,i){const s=(r-e)*.5,o=(i-t)*.5,a=n*n,l=n*a;return(2*t-2*r+s+o)*l+(-3*t+3*r-2*s-o)*a+s*n+t}function BJ(n,e){const t=1-n;return t*t*e}function PJ(n,e){return 2*(1-n)*n*e}function IJ(n,e){return n*n*e}function y0(n,e,t,r){return BJ(n,e)+PJ(n,t)+IJ(n,r)}function LJ(n,e){const t=1-n;return t*t*t*e}function NJ(n,e){const t=1-n;return 3*t*t*n*e}function DJ(n,e){return 3*(1-n)*n*n*e}function UJ(n,e){return n*n*n*e}function x0(n,e,t,r,i){return LJ(n,e)+NJ(n,t)+DJ(n,r)+UJ(n,i)}class G2 extends ca{constructor(e=new Ge,t=new Ge,r=new Ge,i=new Ge){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new Ge){const r=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(x0(e,i.x,s.x,o.x,a.x),x0(e,i.y,s.y,o.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class fk extends ca{constructor(e=new Y,t=new Y,r=new Y,i=new Y){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new Y){const r=t,i=this.v0,s=this.v1,o=this.v2,a=this.v3;return r.set(x0(e,i.x,s.x,o.x,a.x),x0(e,i.y,s.y,o.y,a.y),x0(e,i.z,s.z,o.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class z2 extends ca{constructor(e=new Ge,t=new Ge){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Ge){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ge){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class hk extends ca{constructor(e=new Y,t=new Y){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Y){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Y){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class H2 extends ca{constructor(e=new Ge,t=new Ge,r=new Ge){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Ge){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(y0(e,i.x,s.x,o.x),y0(e,i.y,s.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class V2 extends ca{constructor(e=new Y,t=new Y,r=new Y){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Y){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(y0(e,i.x,s.x,o.x),y0(e,i.y,s.y,o.y),y0(e,i.z,s.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class W2 extends ca{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Ge){const r=t,i=this.points,s=(i.length-1)*e,o=Math.floor(s),a=s-o,l=i[o===0?o:o-1],c=i[o],u=i[o>i.length-2?i.length-1:o+1],f=i[o>i.length-3?i.length-1:o+2];return r.set(FL(a,l.x,c.x,u.x,f.x),FL(a,l.y,c.y,u.y,f.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new Ge().fromArray(i))}return this}}var WA=Object.freeze({__proto__:null,ArcCurve:ck,CatmullRomCurve3:uk,CubicBezierCurve:G2,CubicBezierCurve3:fk,EllipseCurve:j_,LineCurve:z2,LineCurve3:hk,QuadraticBezierCurve:H2,QuadraticBezierCurve3:V2,SplineCurve:W2});class dk extends ca{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new WA[r](t,e))}return this}getPoint(e,t){const r=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const o=i[s]-r,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const o=s[i],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){const u=l[c];r&&r.equals(u)||(t.push(u),r=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(new WA[i.type]().fromJSON(i))}return this}}class Z0 extends dk{constructor(e){super(),this.type="Path",this.currentPoint=new Ge,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new z2(this.currentPoint.clone(),new Ge(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){const s=new H2(this.currentPoint.clone(),new Ge(e,t),new Ge(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,s,o){const a=new G2(this.currentPoint.clone(),new Ge(e,t),new Ge(r,i),new Ge(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new W2(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,r,i,s,o),this}absarc(e,t,r,i,s,o){return this.absellipse(e,t,r,r,i,s,o),this}ellipse(e,t,r,i,s,o,a,l){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,t+u,r,i,s,o,a,l),this}absellipse(e,t,r,i,s,o,a,l){const c=new j_(e,t,r,i,s,o,a,l);if(this.curves.length>0){const f=c.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Yv extends jt{constructor(e=[new Ge(0,-.5),new Ge(.5,0),new Ge(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=yr(i,0,Math.PI*2);const s=[],o=[],a=[],l=[],c=[],u=1/t,f=new Y,d=new Ge,m=new Y,g=new Y,y=new Y;let x=0,v=0;for(let A=0;A<=e.length-1;A++)switch(A){case 0:x=e[A+1].x-e[A].x,v=e[A+1].y-e[A].y,m.x=v*1,m.y=-x,m.z=v*0,y.copy(m),m.normalize(),l.push(m.x,m.y,m.z);break;case e.length-1:l.push(y.x,y.y,y.z);break;default:x=e[A+1].x-e[A].x,v=e[A+1].y-e[A].y,m.x=v*1,m.y=-x,m.z=v*0,g.copy(m),m.x+=y.x,m.y+=y.y,m.z+=y.z,m.normalize(),l.push(m.x,m.y,m.z),y.copy(g)}for(let A=0;A<=t;A++){const w=r+A*u*i,S=Math.sin(w),M=Math.cos(w);for(let b=0;b<=e.length-1;b++){f.x=e[b].x*S,f.y=e[b].y,f.z=e[b].x*M,o.push(f.x,f.y,f.z),d.x=A/t,d.y=b/(e.length-1),a.push(d.x,d.y);const R=l[3*b+0]*S,P=l[3*b+1],C=l[3*b+0]*M;c.push(R,P,C)}}for(let A=0;A<t;A++)for(let w=0;w<e.length-1;w++){const S=w+A*e.length,M=S,b=S+e.length,R=S+e.length+1,P=S+1;s.push(M,b,P),s.push(R,P,b)}this.setIndex(s),this.setAttribute("position",new Rt(o,3)),this.setAttribute("uv",new Rt(a,2)),this.setAttribute("normal",new Rt(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Yv(e.points,e.segments,e.phiStart,e.phiLength)}}class Y_ extends Yv{constructor(e=1,t=1,r=4,i=8){const s=new Z0;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(r),i),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:r,radialSegments:i}}static fromJSON(e){return new Y_(e.radius,e.length,e.capSegments,e.radialSegments)}}class Z_ extends jt{constructor(e=1,t=32,r=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i},t=Math.max(3,t);const s=[],o=[],a=[],l=[],c=new Y,u=new Ge;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let f=0,d=3;f<=t;f++,d+=3){const m=r+f/t*i;c.x=e*Math.cos(m),c.y=e*Math.sin(m),o.push(c.x,c.y,c.z),a.push(0,0,1),u.x=(o[d]/e+1)/2,u.y=(o[d+1]/e+1)/2,l.push(u.x,u.y)}for(let f=1;f<=t;f++)s.push(f,f+1,0);this.setIndex(s),this.setAttribute("position",new Rt(o,3)),this.setAttribute("normal",new Rt(a,3)),this.setAttribute("uv",new Rt(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Z_(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Om extends jt{constructor(e=1,t=1,r=1,i=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;i=Math.floor(i),s=Math.floor(s);const u=[],f=[],d=[],m=[];let g=0;const y=[],x=r/2;let v=0;A(),o===!1&&(e>0&&w(!0),t>0&&w(!1)),this.setIndex(u),this.setAttribute("position",new Rt(f,3)),this.setAttribute("normal",new Rt(d,3)),this.setAttribute("uv",new Rt(m,2));function A(){const S=new Y,M=new Y;let b=0;const R=(t-e)/r;for(let P=0;P<=s;P++){const C=[],B=P/s,H=B*(t-e)+e;for(let k=0;k<=i;k++){const $=k/i,U=$*l+a,z=Math.sin(U),O=Math.cos(U);M.x=H*z,M.y=-B*r+x,M.z=H*O,f.push(M.x,M.y,M.z),S.set(z,R,O).normalize(),d.push(S.x,S.y,S.z),m.push($,1-B),C.push(g++)}y.push(C)}for(let P=0;P<i;P++)for(let C=0;C<s;C++){const B=y[C][P],H=y[C+1][P],k=y[C+1][P+1],$=y[C][P+1];u.push(B,H,$),u.push(H,k,$),b+=6}c.addGroup(v,b,0),v+=b}function w(S){const M=g,b=new Ge,R=new Y;let P=0;const C=S===!0?e:t,B=S===!0?1:-1;for(let k=1;k<=i;k++)f.push(0,x*B,0),d.push(0,B,0),m.push(.5,.5),g++;const H=g;for(let k=0;k<=i;k++){const U=k/i*l+a,z=Math.cos(U),O=Math.sin(U);R.x=C*O,R.y=x*B,R.z=C*z,f.push(R.x,R.y,R.z),d.push(0,B,0),b.x=z*.5+.5,b.y=O*.5*B+.5,m.push(b.x,b.y),g++}for(let k=0;k<i;k++){const $=M+k,U=H+k;S===!0?u.push(U,U+1,$):u.push(U+1,U,$),P+=3}c.addGroup(v,P,S===!0?1:2),v+=P}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Om(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class q_ extends Om{constructor(e=1,t=1,r=32,i=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,r,i,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new q_(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Ru extends jt{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};const s=[],o=[];a(i),c(r),u(),this.setAttribute("position",new Rt(s,3)),this.setAttribute("normal",new Rt(s.slice(),3)),this.setAttribute("uv",new Rt(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(A){const w=new Y,S=new Y,M=new Y;for(let b=0;b<t.length;b+=3)m(t[b+0],w),m(t[b+1],S),m(t[b+2],M),l(w,S,M,A)}function l(A,w,S,M){const b=M+1,R=[];for(let P=0;P<=b;P++){R[P]=[];const C=A.clone().lerp(S,P/b),B=w.clone().lerp(S,P/b),H=b-P;for(let k=0;k<=H;k++)k===0&&P===b?R[P][k]=C:R[P][k]=C.clone().lerp(B,k/H)}for(let P=0;P<b;P++)for(let C=0;C<2*(b-P)-1;C++){const B=Math.floor(C/2);C%2===0?(d(R[P][B+1]),d(R[P+1][B]),d(R[P][B])):(d(R[P][B+1]),d(R[P+1][B+1]),d(R[P+1][B]))}}function c(A){const w=new Y;for(let S=0;S<s.length;S+=3)w.x=s[S+0],w.y=s[S+1],w.z=s[S+2],w.normalize().multiplyScalar(A),s[S+0]=w.x,s[S+1]=w.y,s[S+2]=w.z}function u(){const A=new Y;for(let w=0;w<s.length;w+=3){A.x=s[w+0],A.y=s[w+1],A.z=s[w+2];const S=x(A)/2/Math.PI+.5,M=v(A)/Math.PI+.5;o.push(S,1-M)}g(),f()}function f(){for(let A=0;A<o.length;A+=6){const w=o[A+0],S=o[A+2],M=o[A+4],b=Math.max(w,S,M),R=Math.min(w,S,M);b>.9&&R<.1&&(w<.2&&(o[A+0]+=1),S<.2&&(o[A+2]+=1),M<.2&&(o[A+4]+=1))}}function d(A){s.push(A.x,A.y,A.z)}function m(A,w){const S=A*3;w.x=e[S+0],w.y=e[S+1],w.z=e[S+2]}function g(){const A=new Y,w=new Y,S=new Y,M=new Y,b=new Ge,R=new Ge,P=new Ge;for(let C=0,B=0;C<s.length;C+=9,B+=6){A.set(s[C+0],s[C+1],s[C+2]),w.set(s[C+3],s[C+4],s[C+5]),S.set(s[C+6],s[C+7],s[C+8]),b.set(o[B+0],o[B+1]),R.set(o[B+2],o[B+3]),P.set(o[B+4],o[B+5]),M.copy(A).add(w).add(S).divideScalar(3);const H=x(M);y(b,B+0,A,H),y(R,B+2,w,H),y(P,B+4,S,H)}}function y(A,w,S,M){M<0&&A.x===1&&(o[w]=A.x-1),S.x===0&&S.z===0&&(o[w]=M/2/Math.PI+.5)}function x(A){return Math.atan2(A.z,-A.x)}function v(A){return Math.atan2(-A.y,Math.sqrt(A.x*A.x+A.z*A.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ru(e.vertices,e.indices,e.radius,e.details)}}class $_ extends Ru{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new $_(e.radius,e.detail)}}const Yx=new Y,Zx=new Y,RS=new Y,qx=new vs;class pk extends jt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),s=Math.cos(ch*t),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],u=["a","b","c"],f=new Array(3),d={},m=[];for(let g=0;g<l;g+=3){o?(c[0]=o.getX(g),c[1]=o.getX(g+1),c[2]=o.getX(g+2)):(c[0]=g,c[1]=g+1,c[2]=g+2);const{a:y,b:x,c:v}=qx;if(y.fromBufferAttribute(a,c[0]),x.fromBufferAttribute(a,c[1]),v.fromBufferAttribute(a,c[2]),qx.getNormal(RS),f[0]=`${Math.round(y.x*i)},${Math.round(y.y*i)},${Math.round(y.z*i)}`,f[1]=`${Math.round(x.x*i)},${Math.round(x.y*i)},${Math.round(x.z*i)}`,f[2]=`${Math.round(v.x*i)},${Math.round(v.y*i)},${Math.round(v.z*i)}`,!(f[0]===f[1]||f[1]===f[2]||f[2]===f[0]))for(let A=0;A<3;A++){const w=(A+1)%3,S=f[A],M=f[w],b=qx[u[A]],R=qx[u[w]],P=`${S}_${M}`,C=`${M}_${S}`;C in d&&d[C]?(RS.dot(d[C].normal)<=s&&(m.push(b.x,b.y,b.z),m.push(R.x,R.y,R.z)),d[C]=null):P in d||(d[P]={index0:c[A],index1:c[w],normal:RS.clone()})}}for(const g in d)if(d[g]){const{index0:y,index1:x}=d[g];Yx.fromBufferAttribute(a,y),Zx.fromBufferAttribute(a,x),m.push(Yx.x,Yx.y,Yx.z),m.push(Zx.x,Zx.y,Zx.z)}this.setAttribute("position",new Rt(m,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class fh extends Z0{constructor(e){super(e),this.uuid=Js(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(new Z0().fromJSON(i))}return this}}const FJ={triangulate:function(n,e,t=2){const r=e&&e.length,i=r?e[0]*t:n.length;let s=mk(n,0,i,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,f,d,m;if(r&&(s=HJ(n,e,s,t)),n.length>80*t){a=c=n[0],l=u=n[1];for(let g=t;g<i;g+=t)f=n[g],d=n[g+1],f<a&&(a=f),d<l&&(l=d),f>c&&(c=f),d>u&&(u=d);m=Math.max(c-a,u-l),m=m!==0?32767/m:0}return q0(s,o,t,a,l,m,0),o}};function mk(n,e,t,r,i){let s,o;if(i===$J(n,e,t,r)>0)for(s=e;s<t;s+=r)o=OL(s,n[s],n[s+1],o);else for(s=t-r;s>=e;s-=r)o=OL(s,n[s],n[s+1],o);return o&&ew(o,o.next)&&(ev(o),o=o.next),o}function _h(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(ew(t,t.next)||lr(t.prev,t,t.next)===0)){if(ev(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function q0(n,e,t,r,i,s,o){if(!n)return;!o&&s&&KJ(n,r,i,s);let a=n,l,c;for(;n.prev!==n.next;){if(l=n.prev,c=n.next,s?kJ(n,r,i,s):OJ(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(c.i/t|0),ev(n),n=c.next,a=c.next;continue}if(n=c,n===a){o?o===1?(n=GJ(_h(n),e,t),q0(n,e,t,r,i,s,2)):o===2&&zJ(n,e,t,r,i,s):q0(_h(n),e,t,r,i,s,1);break}}}function OJ(n){const e=n.prev,t=n,r=n.next;if(lr(e,t,r)>=0)return!1;const i=e.x,s=t.x,o=r.x,a=e.y,l=t.y,c=r.y,u=i<s?i<o?i:o:s<o?s:o,f=a<l?a<c?a:c:l<c?l:c,d=i>s?i>o?i:o:s>o?s:o,m=a>l?a>c?a:c:l>c?l:c;let g=r.next;for(;g!==e;){if(g.x>=u&&g.x<=d&&g.y>=f&&g.y<=m&&Yd(i,a,s,l,o,c,g.x,g.y)&&lr(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function kJ(n,e,t,r){const i=n.prev,s=n,o=n.next;if(lr(i,s,o)>=0)return!1;const a=i.x,l=s.x,c=o.x,u=i.y,f=s.y,d=o.y,m=a<l?a<c?a:c:l<c?l:c,g=u<f?u<d?u:d:f<d?f:d,y=a>l?a>c?a:c:l>c?l:c,x=u>f?u>d?u:d:f>d?f:d,v=iT(m,g,e,t,r),A=iT(y,x,e,t,r);let w=n.prevZ,S=n.nextZ;for(;w&&w.z>=v&&S&&S.z<=A;){if(w.x>=m&&w.x<=y&&w.y>=g&&w.y<=x&&w!==i&&w!==o&&Yd(a,u,l,f,c,d,w.x,w.y)&&lr(w.prev,w,w.next)>=0||(w=w.prevZ,S.x>=m&&S.x<=y&&S.y>=g&&S.y<=x&&S!==i&&S!==o&&Yd(a,u,l,f,c,d,S.x,S.y)&&lr(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;w&&w.z>=v;){if(w.x>=m&&w.x<=y&&w.y>=g&&w.y<=x&&w!==i&&w!==o&&Yd(a,u,l,f,c,d,w.x,w.y)&&lr(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;S&&S.z<=A;){if(S.x>=m&&S.x<=y&&S.y>=g&&S.y<=x&&S!==i&&S!==o&&Yd(a,u,l,f,c,d,S.x,S.y)&&lr(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function GJ(n,e,t){let r=n;do{const i=r.prev,s=r.next.next;!ew(i,s)&&gk(i,r,r.next,s)&&$0(i,s)&&$0(s,i)&&(e.push(i.i/t|0),e.push(r.i/t|0),e.push(s.i/t|0),ev(r),ev(r.next),r=n=s),r=r.next}while(r!==n);return _h(r)}function zJ(n,e,t,r,i,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&YJ(o,a)){let l=vk(o,a);o=_h(o,o.next),l=_h(l,l.next),q0(o,e,t,r,i,s,0),q0(l,e,t,r,i,s,0);return}a=a.next}o=o.next}while(o!==n)}function HJ(n,e,t,r){const i=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:n.length,c=mk(n,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push(jJ(c));for(i.sort(VJ),s=0;s<i.length;s++)t=WJ(i[s],t);return t}function VJ(n,e){return n.x-e.x}function WJ(n,e){const t=XJ(n,e);if(!t)return e;const r=vk(t,n);return _h(r,r.next),_h(t,t.next)}function XJ(n,e){let t=e,r=-1/0,i;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const d=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=s&&d>r&&(r=d,i=t.x<t.next.x?t:t.next,d===s))return i}t=t.next}while(t!==e);if(!i)return null;const a=i,l=i.x,c=i.y;let u=1/0,f;t=i;do s>=t.x&&t.x>=l&&s!==t.x&&Yd(o<c?s:r,o,l,c,o<c?r:s,o,t.x,t.y)&&(f=Math.abs(o-t.y)/(s-t.x),$0(t,n)&&(f<u||f===u&&(t.x>i.x||t.x===i.x&&JJ(i,t)))&&(i=t,u=f)),t=t.next;while(t!==a);return i}function JJ(n,e){return lr(n.prev,n,e.prev)<0&&lr(e.next,n,n.next)<0}function KJ(n,e,t,r){let i=n;do i.z===0&&(i.z=iT(i.x,i.y,e,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,QJ(i)}function QJ(n){let e,t,r,i,s,o,a,l,c=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,r=t,a=0,e=0;e<c&&(a++,r=r.nextZ,!!r);e++);for(l=c;a>0||l>0&&r;)a!==0&&(l===0||!r||t.z<=r.z)?(i=t,t=t.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;t=r}s.nextZ=null,c*=2}while(o>1);return n}function iT(n,e,t,r,i){return n=(n-t)*i|0,e=(e-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function jJ(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Yd(n,e,t,r,i,s,o,a){return(i-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(r-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(i-o)*(r-a)}function YJ(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!ZJ(n,e)&&($0(n,e)&&$0(e,n)&&qJ(n,e)&&(lr(n.prev,n,e.prev)||lr(n,e.prev,e))||ew(n,e)&&lr(n.prev,n,n.next)>0&&lr(e.prev,e,e.next)>0)}function lr(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function ew(n,e){return n.x===e.x&&n.y===e.y}function gk(n,e,t,r){const i=e1(lr(n,e,t)),s=e1(lr(n,e,r)),o=e1(lr(t,r,n)),a=e1(lr(t,r,e));return!!(i!==s&&o!==a||i===0&&$x(n,t,e)||s===0&&$x(n,r,e)||o===0&&$x(t,n,r)||a===0&&$x(t,e,r))}function $x(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function e1(n){return n>0?1:n<0?-1:0}function ZJ(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&gk(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function $0(n,e){return lr(n.prev,n,n.next)<0?lr(n,e,n.next)>=0&&lr(n,n.prev,e)>=0:lr(n,e,n.prev)<0||lr(n,n.next,e)<0}function qJ(n,e){let t=n,r=!1;const i=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function vk(n,e){const t=new sT(n.i,n.x,n.y),r=new sT(e.i,e.x,e.y),i=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=i,i.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function OL(n,e,t,r){const i=new sT(n,e,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function ev(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function sT(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function $J(n,e,t,r){let i=0;for(let s=e,o=t-r;s<t;s+=r)i+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return i}class ka{static area(e){const t=e.length;let r=0;for(let i=t-1,s=0;s<t;i=s++)r+=e[i].x*e[s].y-e[s].x*e[i].y;return r*.5}static isClockWise(e){return ka.area(e)<0}static triangulateShape(e,t){const r=[],i=[],s=[];kL(e),GL(r,e);let o=e.length;t.forEach(kL);for(let l=0;l<t.length;l++)i.push(o),o+=t[l].length,GL(r,t[l]);const a=FJ.triangulate(r,i);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function kL(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function GL(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class tw extends jt{constructor(e=new fh([new Ge(.5,.5),new Ge(-.5,.5),new Ge(-.5,-.5),new Ge(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,i=[],s=[];for(let a=0,l=e.length;a<l;a++){const c=e[a];o(c)}this.setAttribute("position",new Rt(i,3)),this.setAttribute("uv",new Rt(s,2)),this.computeVertexNormals();function o(a){const l=[],c=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1,f=t.depth!==void 0?t.depth:1;let d=t.bevelEnabled!==void 0?t.bevelEnabled:!0,m=t.bevelThickness!==void 0?t.bevelThickness:.2,g=t.bevelSize!==void 0?t.bevelSize:m-.1,y=t.bevelOffset!==void 0?t.bevelOffset:0,x=t.bevelSegments!==void 0?t.bevelSegments:3;const v=t.extrudePath,A=t.UVGenerator!==void 0?t.UVGenerator:eK;let w,S=!1,M,b,R,P;v&&(w=v.getSpacedPoints(u),S=!0,d=!1,M=v.computeFrenetFrames(u,!1),b=new Y,R=new Y,P=new Y),d||(x=0,m=0,g=0,y=0);const C=a.extractPoints(c);let B=C.shape;const H=C.holes;if(!ka.isClockWise(B)){B=B.reverse();for(let j=0,Te=H.length;j<Te;j++){const be=H[j];ka.isClockWise(be)&&(H[j]=be.reverse())}}const $=ka.triangulateShape(B,H),U=B;for(let j=0,Te=H.length;j<Te;j++){const be=H[j];B=B.concat(be)}function z(j,Te,be){return Te||console.error("THREE.ExtrudeGeometry: vec does not exist"),j.clone().addScaledVector(Te,be)}const O=B.length,ie=$.length;function X(j,Te,be){let Ue,we,et;const Re=j.x-Te.x,J=j.y-Te.y,F=be.x-j.x,G=be.y-j.y,de=Re*Re+J*J,le=Re*G-J*F;if(Math.abs(le)>Number.EPSILON){const ye=Math.sqrt(de),Le=Math.sqrt(F*F+G*G),Ve=Te.x-J/ye,Oe=Te.y+Re/ye,ze=be.x-G/Le,Ye=be.y+F/Le,Ie=((ze-Ve)*G-(Ye-Oe)*F)/(Re*G-J*F);Ue=Ve+Re*Ie-j.x,we=Oe+J*Ie-j.y;const gt=Ue*Ue+we*we;if(gt<=2)return new Ge(Ue,we);et=Math.sqrt(gt/2)}else{let ye=!1;Re>Number.EPSILON?F>Number.EPSILON&&(ye=!0):Re<-Number.EPSILON?F<-Number.EPSILON&&(ye=!0):Math.sign(J)===Math.sign(G)&&(ye=!0),ye?(Ue=-J,we=Re,et=Math.sqrt(de)):(Ue=Re,we=J,et=Math.sqrt(de/2))}return new Ge(Ue/et,we/et)}const K=[];for(let j=0,Te=U.length,be=Te-1,Ue=j+1;j<Te;j++,be++,Ue++)be===Te&&(be=0),Ue===Te&&(Ue=0),K[j]=X(U[j],U[be],U[Ue]);const W=[];let V,Q=K.concat();for(let j=0,Te=H.length;j<Te;j++){const be=H[j];V=[];for(let Ue=0,we=be.length,et=we-1,Re=Ue+1;Ue<we;Ue++,et++,Re++)et===we&&(et=0),Re===we&&(Re=0),V[Ue]=X(be[Ue],be[et],be[Re]);W.push(V),Q=Q.concat(V)}for(let j=0;j<x;j++){const Te=j/x,be=m*Math.cos(Te*Math.PI/2),Ue=g*Math.sin(Te*Math.PI/2)+y;for(let we=0,et=U.length;we<et;we++){const Re=z(U[we],K[we],Ue);ge(Re.x,Re.y,-be)}for(let we=0,et=H.length;we<et;we++){const Re=H[we];V=W[we];for(let J=0,F=Re.length;J<F;J++){const G=z(Re[J],V[J],Ue);ge(G.x,G.y,-be)}}}const q=g+y;for(let j=0;j<O;j++){const Te=d?z(B[j],Q[j],q):B[j];S?(R.copy(M.normals[0]).multiplyScalar(Te.x),b.copy(M.binormals[0]).multiplyScalar(Te.y),P.copy(w[0]).add(R).add(b),ge(P.x,P.y,P.z)):ge(Te.x,Te.y,0)}for(let j=1;j<=u;j++)for(let Te=0;Te<O;Te++){const be=d?z(B[Te],Q[Te],q):B[Te];S?(R.copy(M.normals[j]).multiplyScalar(be.x),b.copy(M.binormals[j]).multiplyScalar(be.y),P.copy(w[j]).add(R).add(b),ge(P.x,P.y,P.z)):ge(be.x,be.y,f/u*j)}for(let j=x-1;j>=0;j--){const Te=j/x,be=m*Math.cos(Te*Math.PI/2),Ue=g*Math.sin(Te*Math.PI/2)+y;for(let we=0,et=U.length;we<et;we++){const Re=z(U[we],K[we],Ue);ge(Re.x,Re.y,f+be)}for(let we=0,et=H.length;we<et;we++){const Re=H[we];V=W[we];for(let J=0,F=Re.length;J<F;J++){const G=z(Re[J],V[J],Ue);S?ge(G.x,G.y+w[u-1].y,w[u-1].x+be):ge(G.x,G.y,f+be)}}}ne(),fe();function ne(){const j=i.length/3;if(d){let Te=0,be=O*Te;for(let Ue=0;Ue<ie;Ue++){const we=$[Ue];Ce(we[2]+be,we[1]+be,we[0]+be)}Te=u+x*2,be=O*Te;for(let Ue=0;Ue<ie;Ue++){const we=$[Ue];Ce(we[0]+be,we[1]+be,we[2]+be)}}else{for(let Te=0;Te<ie;Te++){const be=$[Te];Ce(be[2],be[1],be[0])}for(let Te=0;Te<ie;Te++){const be=$[Te];Ce(be[0]+O*u,be[1]+O*u,be[2]+O*u)}}r.addGroup(j,i.length/3-j,0)}function fe(){const j=i.length/3;let Te=0;pe(U,Te),Te+=U.length;for(let be=0,Ue=H.length;be<Ue;be++){const we=H[be];pe(we,Te),Te+=we.length}r.addGroup(j,i.length/3-j,1)}function pe(j,Te){let be=j.length;for(;--be>=0;){const Ue=be;let we=be-1;we<0&&(we=j.length-1);for(let et=0,Re=u+x*2;et<Re;et++){const J=O*et,F=O*(et+1),G=Te+Ue+J,de=Te+we+J,le=Te+we+F,ye=Te+Ue+F;Je(G,de,le,ye)}}}function ge(j,Te,be){l.push(j),l.push(Te),l.push(be)}function Ce(j,Te,be){Xe(j),Xe(Te),Xe(be);const Ue=i.length/3,we=A.generateTopUV(r,i,Ue-3,Ue-2,Ue-1);Fe(we[0]),Fe(we[1]),Fe(we[2])}function Je(j,Te,be,Ue){Xe(j),Xe(Te),Xe(Ue),Xe(Te),Xe(be),Xe(Ue);const we=i.length/3,et=A.generateSideWallUV(r,i,we-6,we-3,we-2,we-1);Fe(et[0]),Fe(et[1]),Fe(et[3]),Fe(et[1]),Fe(et[2]),Fe(et[3])}function Xe(j){i.push(l[j*3+0]),i.push(l[j*3+1]),i.push(l[j*3+2])}function Fe(j){s.push(j.x),s.push(j.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return tK(t,r,e)}static fromJSON(e,t){const r=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];r.push(a)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new WA[i.type]().fromJSON(i)),new tw(r,e.options)}}const eK={generateTopUV:function(n,e,t,r,i){const s=e[t*3],o=e[t*3+1],a=e[r*3],l=e[r*3+1],c=e[i*3],u=e[i*3+1];return[new Ge(s,o),new Ge(a,l),new Ge(c,u)]},generateSideWallUV:function(n,e,t,r,i,s){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],c=e[r*3],u=e[r*3+1],f=e[r*3+2],d=e[i*3],m=e[i*3+1],g=e[i*3+2],y=e[s*3],x=e[s*3+1],v=e[s*3+2];return Math.abs(a-u)<Math.abs(o-c)?[new Ge(o,1-l),new Ge(c,1-f),new Ge(d,1-g),new Ge(y,1-v)]:[new Ge(a,1-l),new Ge(u,1-f),new Ge(m,1-g),new Ge(x,1-v)]}};function tK(n,e,t){if(t.shapes=[],Array.isArray(n))for(let r=0,i=n.length;r<i;r++){const s=n[r];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Zv extends Ru{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Zv(e.radius,e.detail)}}class qv extends Ru{constructor(e=1,t=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new qv(e.radius,e.detail)}}class nw extends jt{constructor(e=.5,t=1,r=32,i=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:i,thetaStart:s,thetaLength:o},r=Math.max(3,r),i=Math.max(1,i);const a=[],l=[],c=[],u=[];let f=e;const d=(t-e)/i,m=new Y,g=new Ge;for(let y=0;y<=i;y++){for(let x=0;x<=r;x++){const v=s+x/r*o;m.x=f*Math.cos(v),m.y=f*Math.sin(v),l.push(m.x,m.y,m.z),c.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,u.push(g.x,g.y)}f+=d}for(let y=0;y<i;y++){const x=y*(r+1);for(let v=0;v<r;v++){const A=v+x,w=A,S=A+r+1,M=A+r+2,b=A+1;a.push(w,S,b),a.push(S,M,b)}}this.setIndex(a),this.setAttribute("position",new Rt(l,3)),this.setAttribute("normal",new Rt(c,3)),this.setAttribute("uv",new Rt(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new nw(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class rw extends jt{constructor(e=new fh([new Ge(0,.5),new Ge(-.5,-.5),new Ge(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],i=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(a,l,u),a+=l,l=0;this.setIndex(r),this.setAttribute("position",new Rt(i,3)),this.setAttribute("normal",new Rt(s,3)),this.setAttribute("uv",new Rt(o,2));function c(u){const f=i.length/3,d=u.extractPoints(t);let m=d.shape;const g=d.holes;ka.isClockWise(m)===!1&&(m=m.reverse());for(let x=0,v=g.length;x<v;x++){const A=g[x];ka.isClockWise(A)===!0&&(g[x]=A.reverse())}const y=ka.triangulateShape(m,g);for(let x=0,v=g.length;x<v;x++){const A=g[x];m=m.concat(A)}for(let x=0,v=m.length;x<v;x++){const A=m[x];i.push(A.x,A.y,0),s.push(0,0,1),o.push(A.x,A.y)}for(let x=0,v=y.length;x<v;x++){const A=y[x],w=A[0]+f,S=A[1]+f,M=A[2]+f;r.push(w,S,M),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return nK(t,e)}static fromJSON(e,t){const r=[];for(let i=0,s=e.shapes.length;i<s;i++){const o=t[e.shapes[i]];r.push(o)}return new rw(r,e.curveSegments)}}function nK(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const i=n[t];e.shapes.push(i.uuid)}else e.shapes.push(n.uuid);return e}class $v extends jt{constructor(e=1,t=32,r=16,i=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const l=Math.min(o+a,Math.PI);let c=0;const u=[],f=new Y,d=new Y,m=[],g=[],y=[],x=[];for(let v=0;v<=r;v++){const A=[],w=v/r;let S=0;v===0&&o===0?S=.5/t:v===r&&l===Math.PI&&(S=-.5/t);for(let M=0;M<=t;M++){const b=M/t;f.x=-e*Math.cos(i+b*s)*Math.sin(o+w*a),f.y=e*Math.cos(o+w*a),f.z=e*Math.sin(i+b*s)*Math.sin(o+w*a),g.push(f.x,f.y,f.z),d.copy(f).normalize(),y.push(d.x,d.y,d.z),x.push(b+S,1-w),A.push(c++)}u.push(A)}for(let v=0;v<r;v++)for(let A=0;A<t;A++){const w=u[v][A+1],S=u[v][A],M=u[v+1][A],b=u[v+1][A+1];(v!==0||o>0)&&m.push(w,S,b),(v!==r-1||l<Math.PI)&&m.push(S,M,b)}this.setIndex(m),this.setAttribute("position",new Rt(g,3)),this.setAttribute("normal",new Rt(y,3)),this.setAttribute("uv",new Rt(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $v(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class iw extends Ru{constructor(e=1,t=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new iw(e.radius,e.detail)}}class sw extends jt{constructor(e=1,t=.4,r=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const o=[],a=[],l=[],c=[],u=new Y,f=new Y,d=new Y;for(let m=0;m<=r;m++)for(let g=0;g<=i;g++){const y=g/i*s,x=m/r*Math.PI*2;f.x=(e+t*Math.cos(x))*Math.cos(y),f.y=(e+t*Math.cos(x))*Math.sin(y),f.z=t*Math.sin(x),a.push(f.x,f.y,f.z),u.x=e*Math.cos(y),u.y=e*Math.sin(y),d.subVectors(f,u).normalize(),l.push(d.x,d.y,d.z),c.push(g/i),c.push(m/r)}for(let m=1;m<=r;m++)for(let g=1;g<=i;g++){const y=(i+1)*m+g-1,x=(i+1)*(m-1)+g-1,v=(i+1)*(m-1)+g,A=(i+1)*m+g;o.push(y,x,A),o.push(x,v,A)}this.setIndex(o),this.setAttribute("position",new Rt(a,3)),this.setAttribute("normal",new Rt(l,3)),this.setAttribute("uv",new Rt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sw(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class ow extends jt{constructor(e=1,t=.4,r=64,i=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:s,q:o},r=Math.floor(r),i=Math.floor(i);const a=[],l=[],c=[],u=[],f=new Y,d=new Y,m=new Y,g=new Y,y=new Y,x=new Y,v=new Y;for(let w=0;w<=r;++w){const S=w/r*s*Math.PI*2;A(S,s,o,e,m),A(S+.01,s,o,e,g),x.subVectors(g,m),v.addVectors(g,m),y.crossVectors(x,v),v.crossVectors(y,x),y.normalize(),v.normalize();for(let M=0;M<=i;++M){const b=M/i*Math.PI*2,R=-t*Math.cos(b),P=t*Math.sin(b);f.x=m.x+(R*v.x+P*y.x),f.y=m.y+(R*v.y+P*y.y),f.z=m.z+(R*v.z+P*y.z),l.push(f.x,f.y,f.z),d.subVectors(f,m).normalize(),c.push(d.x,d.y,d.z),u.push(w/r),u.push(M/i)}}for(let w=1;w<=r;w++)for(let S=1;S<=i;S++){const M=(i+1)*(w-1)+(S-1),b=(i+1)*w+(S-1),R=(i+1)*w+S,P=(i+1)*(w-1)+S;a.push(M,b,P),a.push(b,R,P)}this.setIndex(a),this.setAttribute("position",new Rt(l,3)),this.setAttribute("normal",new Rt(c,3)),this.setAttribute("uv",new Rt(u,2));function A(w,S,M,b,R){const P=Math.cos(w),C=Math.sin(w),B=M/S*w,H=Math.cos(B);R.x=b*(2+H)*.5*P,R.y=b*(2+H)*C*.5,R.z=b*Math.sin(B)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ow(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class aw extends jt{constructor(e=new V2(new Y(-1,-1,0),new Y(-1,1,0),new Y(1,1,0)),t=64,r=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:i,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new Y,l=new Y,c=new Ge;let u=new Y;const f=[],d=[],m=[],g=[];y(),this.setIndex(g),this.setAttribute("position",new Rt(f,3)),this.setAttribute("normal",new Rt(d,3)),this.setAttribute("uv",new Rt(m,2));function y(){for(let w=0;w<t;w++)x(w);x(s===!1?t:0),A(),v()}function x(w){u=e.getPointAt(w/t,u);const S=o.normals[w],M=o.binormals[w];for(let b=0;b<=i;b++){const R=b/i*Math.PI*2,P=Math.sin(R),C=-Math.cos(R);l.x=C*S.x+P*M.x,l.y=C*S.y+P*M.y,l.z=C*S.z+P*M.z,l.normalize(),d.push(l.x,l.y,l.z),a.x=u.x+r*l.x,a.y=u.y+r*l.y,a.z=u.z+r*l.z,f.push(a.x,a.y,a.z)}}function v(){for(let w=1;w<=t;w++)for(let S=1;S<=i;S++){const M=(i+1)*(w-1)+(S-1),b=(i+1)*w+(S-1),R=(i+1)*w+S,P=(i+1)*(w-1)+S;g.push(M,b,P),g.push(b,R,P)}}function A(){for(let w=0;w<=t;w++)for(let S=0;S<=i;S++)c.x=w/t,c.y=S/i,m.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new aw(new WA[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class yk extends jt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],r=new Set,i=new Y,s=new Y;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const f=l[c],d=f.start,m=f.count;for(let g=d,y=d+m;g<y;g+=3)for(let x=0;x<3;x++){const v=a.getX(g+x),A=a.getX(g+(x+1)%3);i.fromBufferAttribute(o,v),s.fromBufferAttribute(o,A),zL(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const u=3*a+c,f=3*a+(c+1)%3;i.fromBufferAttribute(o,u),s.fromBufferAttribute(o,f),zL(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Rt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function zL(n,e,t){const r=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(r)===!0||t.has(i)===!0?!1:(t.add(r),t.add(i),!0)}var HL=Object.freeze({__proto__:null,BoxGeometry:Ih,CapsuleGeometry:Y_,CircleGeometry:Z_,ConeGeometry:q_,CylinderGeometry:Om,DodecahedronGeometry:$_,EdgesGeometry:pk,ExtrudeGeometry:tw,IcosahedronGeometry:Zv,LatheGeometry:Yv,OctahedronGeometry:qv,PlaneGeometry:Wa,PolyhedronGeometry:Ru,RingGeometry:nw,ShapeGeometry:rw,SphereGeometry:$v,TetrahedronGeometry:iw,TorusGeometry:sw,TorusKnotGeometry:ow,TubeGeometry:aw,WireframeGeometry:yk});class xk extends ur{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new ht(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Ak extends Pr{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class ey extends ur{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ht(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cu,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Mo extends ey{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ge(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return yr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ht(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new ht(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ht(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class _k extends ur{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ht(16777215),this.specular=new ht(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cu,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Hv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class wk extends ur{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ht(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cu,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class X2 extends ur{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cu,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class Ek extends ur{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ht(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ht(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cu,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Hv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Sk extends ur{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ht(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Cu,this.normalScale=new Ge(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class bk extends Oi{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Pf(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function Mk(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Tk(n){function e(i,s){return n[i]-n[s]}const t=n.length,r=new Array(t);for(let i=0;i!==t;++i)r[i]=i;return r.sort(e),r}function oT(n,e,t){const r=n.length,i=new n.constructor(r);for(let s=0,o=0;o!==r;++s){const a=t[s]*e;for(let l=0;l!==e;++l)i[o++]=n[a+l]}return i}function J2(n,e,t,r){let i=1,s=n[0];for(;s!==void 0&&s[r]===void 0;)s=n[i++];if(s===void 0)return;let o=s[r];if(o!==void 0)if(Array.isArray(o))do o=s[r],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[i++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[r],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[i++];while(s!==void 0);else do o=s[r],o!==void 0&&(e.push(s.time),t.push(o)),s=n[i++];while(s!==void 0)}function rK(n,e,t,r,i=30){const s=n.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),f=[],d=[];for(let m=0;m<c.times.length;++m){const g=c.times[m]*i;if(!(g<t||g>=r)){f.push(c.times[m]);for(let y=0;y<u;++y)d.push(c.values[m*u+y])}}f.length!==0&&(c.times=Pf(f,c.times.constructor),c.values=Pf(d,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function iK(n,e=0,t=n,r=30){r<=0&&(r=30);const i=t.tracks.length,s=e/r;for(let o=0;o<i;++o){const a=t.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const c=n.tracks.find(function(v){return v.name===a.name&&v.ValueTypeName===l});if(c===void 0)continue;let u=0;const f=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=f/3);let d=0;const m=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=m/3);const g=a.times.length-1;let y;if(s<=a.times[0]){const v=u,A=f-u;y=a.values.slice(v,A)}else if(s>=a.times[g]){const v=g*f+u,A=v+f-u;y=a.values.slice(v,A)}else{const v=a.createInterpolant(),A=u,w=f-u;v.evaluate(s),y=v.resultBuffer.slice(A,w)}l==="quaternion"&&new Rr().fromArray(y).normalize().conjugate().toArray(y);const x=c.times.length;for(let v=0;v<x;++v){const A=v*m+d;if(l==="quaternion")Rr.multiplyQuaternionsFlat(c.values,A,y,0,c.values,A);else{const w=m-d*2;for(let S=0;S<w;++S)c.values[A+S]-=y[S]}}}return n.blendMode=_2,n}const sK={convertArray:Pf,isTypedArray:Mk,getKeyframeOrder:Tk,sortedArray:oT,flattenJSON:J2,subclip:rK,makeClipAdditive:iK};class km{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,i=t[r],s=t[r-1];e:{t:{let o;n:{r:if(!(e<i)){for(let a=r+2;;){if(i===void 0){if(e<s)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(s=i,i=t[++r],e<i)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(r=2,s=a);for(let l=r-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===l)break;if(i=s,s=t[--r-1],e>=s)break t}o=r,r=0;break n}break e}for(;r<o;){const a=r+o>>>1;e<t[a]?o=a:r=a+1}if(i=t[r],s=t[r-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,i)}return this.interpolate_(r,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i;for(let o=0;o!==i;++o)t[o]=r[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Ck extends km{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Tf,endingEnd:Tf}}intervalChanged_(e,t,r){const i=this.parameterPositions;let s=e-2,o=e+1,a=i[s],l=i[o];if(a===void 0)switch(this.getSettings_().endingStart){case Cf:s=e,a=2*t-r;break;case X0:s=i.length-2,a=t+i[s]-i[s+1];break;default:s=e,a=r}if(l===void 0)switch(this.getSettings_().endingEnd){case Cf:o=e,l=2*r-t;break;case X0:o=1,l=r+i[1]-i[0];break;default:o=e-1,l=t}const c=(r-t)*.5,u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-r),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,f=this._offsetNext,d=this._weightPrev,m=this._weightNext,g=(r-t)/(i-t),y=g*g,x=y*g,v=-d*x+2*d*y-d*g,A=(1+d)*x+(-1.5-2*d)*y+(-.5+d)*g+1,w=(-1-m)*x+(1.5+m)*y+.5*g,S=m*x-m*y;for(let M=0;M!==a;++M)s[M]=v*o[u+M]+A*o[c+M]+w*o[l+M]+S*o[f+M];return s}}class K2 extends km{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(r-t)/(i-t),f=1-u;for(let d=0;d!==a;++d)s[d]=o[c+d]*f+o[l+d]*u;return s}}class Rk extends km{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class ua{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Pf(t,this.TimeBufferType),this.values=Pf(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:Pf(e.times,Array),values:Pf(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new Rk(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new K2(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Ck(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Am:t=this.InterpolantFactoryMethodDiscrete;break;case Ah:t=this.InterpolantFactoryMethodLinear;break;case j1:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Am;case this.InterpolantFactoryMethodLinear:return Ah;case this.InterpolantFactoryMethodSmooth:return j1}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){const r=this.times,i=r.length;let s=0,o=i-1;for(;s!==i&&r[s]<e;)++s;for(;o!==-1&&r[o]>t;)--o;if(++o,s!==0||o!==i){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=r.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,s=r.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=r[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(i!==void 0&&Mk(i))for(let a=0,l=i.length;a!==l;++a){const c=i[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),i=this.getInterpolation()===j1,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a],u=e[a+1];if(c!==u&&(a!==1||c!==e[0]))if(i)l=!0;else{const f=a*r,d=f-r,m=f+r;for(let g=0;g!==r;++g){const y=t[f+g];if(y!==t[d+g]||y!==t[m+g]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const f=a*r,d=o*r;for(let m=0;m!==r;++m)t[d+m]=t[f+m]}++o}}if(s>0){e[o]=e[s];for(let a=s*r,l=o*r,c=0;c!==r;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*r)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}ua.prototype.TimeBufferType=Float32Array;ua.prototype.ValueBufferType=Float32Array;ua.prototype.DefaultInterpolation=Ah;class Lh extends ua{}Lh.prototype.ValueTypeName="bool";Lh.prototype.ValueBufferType=Array;Lh.prototype.DefaultInterpolation=Am;Lh.prototype.InterpolantFactoryMethodLinear=void 0;Lh.prototype.InterpolantFactoryMethodSmooth=void 0;class Q2 extends ua{}Q2.prototype.ValueTypeName="color";class wh extends ua{}wh.prototype.ValueTypeName="number";class Bk extends km{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(r-t)/(i-t);let c=e*a;for(let u=c+a;c!==u;c+=4)Rr.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Wl extends ua{InterpolantFactoryMethodLinear(e){return new Bk(this.times,this.values,this.getValueSize(),e)}}Wl.prototype.ValueTypeName="quaternion";Wl.prototype.DefaultInterpolation=Ah;Wl.prototype.InterpolantFactoryMethodSmooth=void 0;class Nh extends ua{}Nh.prototype.ValueTypeName="string";Nh.prototype.ValueBufferType=Array;Nh.prototype.DefaultInterpolation=Am;Nh.prototype.InterpolantFactoryMethodLinear=void 0;Nh.prototype.InterpolantFactoryMethodSmooth=void 0;class _u extends ua{}_u.prototype.ValueTypeName="vector";class Eh{constructor(e,t=-1,r,i=U_){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=Js(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,i=1/(e.fps||1);for(let o=0,a=r.length;o!==a;++o)t.push(aK(r[o]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=r.length;s!==o;++s)t.push(ua.toJSON(r[s]));return i}static CreateFromMorphTargetSequence(e,t,r,i){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=Tk(l);l=oT(l,1,u),c=oT(c,1,u),!i&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new wh(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/r))}return new this(e,-1,o)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const i={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const f=u[1];let d=i[f];d||(i[f]=d=[]),d.push(c)}}const o=[];for(const a in i)o.push(this.CreateFromMorphTargetSequence(a,i[a],t,r));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(f,d,m,g,y){if(m.length!==0){const x=[],v=[];J2(m,x,v,g),x.length!==0&&y.push(new f(d,x,v))}},i=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let f=0;f<c.length;f++){const d=c[f].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const m={};let g;for(g=0;g<d.length;g++)if(d[g].morphTargets)for(let y=0;y<d[g].morphTargets.length;y++)m[d[g].morphTargets[y]]=-1;for(const y in m){const x=[],v=[];for(let A=0;A!==d[g].morphTargets.length;++A){const w=d[g];x.push(w.time),v.push(w.morphTarget===y?1:0)}i.push(new wh(".morphTargetInfluence["+y+"]",x,v))}l=m.length*o}else{const m=".bones["+t[f].name+"]";r(_u,m+".position",d,"pos",i),r(Wl,m+".quaternion",d,"rot",i),r(_u,m+".scale",d,"scl",i)}}return i.length===0?null:new this(s,l,i,a)}resetDuration(){const e=this.tracks;let t=0;for(let r=0,i=e.length;r!==i;++r){const s=this.tracks[r];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function oK(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return wh;case"vector":case"vector2":case"vector3":case"vector4":return _u;case"color":return Q2;case"quaternion":return Wl;case"bool":case"boolean":return Lh;case"string":return Nh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function aK(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=oK(n.type);if(n.times===void 0){const t=[],r=[];J2(n.keys,t,r,"value"),n.times=t,n.values=r}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Pl={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class lw{constructor(e,t,r){const i=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(u){a++,s===!1&&i.onStart!==void 0&&i.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,i.onProgress!==void 0&&i.onProgress(u,o,a),o===a&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(u){i.onError!==void 0&&i.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,f){return c.push(u,f),this},this.removeHandler=function(u){const f=c.indexOf(u);return f!==-1&&c.splice(f,2),this},this.getHandler=function(u){for(let f=0,d=c.length;f<d;f+=2){const m=c[f],g=c[f+1];if(m.global&&(m.lastIndex=0),m.test(u))return g}return null}}}const Zd=new lw;let Ai=class{constructor(e){this.manager=e!==void 0?e:Zd,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(i,s){r.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};Ai.DEFAULT_MATERIAL_NAME="__DEFAULT";const ol={};class lK extends Error{constructor(e,t){super(e),this.response=t}}class vi extends Ai{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Pl.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(ol[e]!==void 0){ol[e].push({onLoad:t,onProgress:r,onError:i});return}ol[e]=[],ol[e].push({onLoad:t,onProgress:r,onError:i});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const u=ol[e],f=c.body.getReader(),d=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),m=d?parseInt(d):0,g=m!==0;let y=0;const x=new ReadableStream({start(v){A();function A(){f.read().then(({done:w,value:S})=>{if(w)v.close();else{y+=S.byteLength;const M=new ProgressEvent("progress",{lengthComputable:g,loaded:y,total:m});for(let b=0,R=u.length;b<R;b++){const P=u[b];P.onProgress&&P.onProgress(M)}v.enqueue(S),A()}})}}});return new Response(x)}else throw new lK(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return c.json();default:if(a===void 0)return c.text();{const f=/charset="?([^;"\s]*)"?/i.exec(a),d=f&&f[1]?f[1].toLowerCase():void 0,m=new TextDecoder(d);return c.arrayBuffer().then(g=>m.decode(g))}}}).then(c=>{Pl.add(e,c);const u=ol[e];delete ol[e];for(let f=0,d=u.length;f<d;f++){const m=u[f];m.onLoad&&m.onLoad(c)}}).catch(c=>{const u=ol[e];if(u===void 0)throw this.manager.itemError(e),c;delete ol[e];for(let f=0,d=u.length;f<d;f++){const m=u[f];m.onError&&m.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class cK extends Ai{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new vi(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t=[];for(let r=0;r<e.length;r++){const i=Eh.parse(e[r]);t.push(i)}return t}}class uK extends Ai{constructor(e){super(e)}load(e,t,r,i){const s=this,o=[],a=new Q_,l=new vi(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(f){l.load(e[f],function(d){const m=s.parse(d,!0);o[f]={width:m.width,height:m.height,format:m.format,mipmaps:m.mipmaps},c+=1,c===6&&(m.mipmapCount===1&&(a.minFilter=un),a.image=o,a.format=m.format,a.needsUpdate=!0,t&&t(a))},r,i)}if(Array.isArray(e))for(let f=0,d=e.length;f<d;++f)u(f);else l.load(e,function(f){const d=s.parse(f,!0);if(d.isCubemap){const m=d.mipmaps.length/d.mipmapCount;for(let g=0;g<m;g++){o[g]={mipmaps:[]};for(let y=0;y<d.mipmapCount;y++)o[g].mipmaps.push(d.mipmaps[g*d.mipmapCount+y]),o[g].format=d.format,o[g].width=d.width,o[g].height=d.height}a.image=o}else a.image.width=d.width,a.image.height=d.height,a.mipmaps=d.mipmaps;d.mipmapCount===1&&(a.minFilter=un),a.format=d.format,a.needsUpdate=!0,t&&t(a)},r,i);return a}}class tv extends Ai{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Pl.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Y0("img");function l(){u(),Pl.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(f){u(),i&&i(f),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class Pk extends Ai{constructor(e){super(e)}load(e,t,r,i){const s=new Jv;s.colorSpace=mn;const o=new tv(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(u){s.images[c]=u,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let c=0;c<e.length;++c)l(c);return s}}class j2 extends Ai{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new au,a=new vi(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){let c;try{c=s.parse(l)}catch(u){if(i!==void 0)i(u);else{console.error(u);return}}c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:Qn,o.wrapT=c.wrapT!==void 0?c.wrapT:Qn,o.magFilter=c.magFilter!==void 0?c.magFilter:un,o.minFilter=c.minFilter!==void 0?c.minFilter:un,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0?o.colorSpace=c.colorSpace:c.encoding!==void 0&&(o.encoding=c.encoding),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=Ha),c.mipmapCount===1&&(o.minFilter=un),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,t&&t(o,c)},r,i),o}}class Ik extends Ai{constructor(e){super(e)}load(e,t,r,i){const s=new Sn,o=new tv(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},r,i),s}}class Bu extends gn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new ht(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class Lk extends Bu{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(gn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new ht(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const BS=new Bt,VL=new Y,WL=new Y;class Y2{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ge(512,512),this.map=null,this.mapPass=null,this.matrix=new Bt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Kv,this._frameExtents=new Ge(1,1),this._viewportCount=1,this._viewports=[new wn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;VL.setFromMatrixPosition(e.matrixWorld),t.position.copy(VL),WL.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(WL),t.updateMatrixWorld(),BS.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(BS),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(BS)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class fK extends Y2{constructor(){super(new or(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=wm*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(r!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=r,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Z2 extends Bu{constructor(e,t,r=0,i=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(gn.DEFAULT_UP),this.updateMatrix(),this.target=new gn,this.distance=r,this.angle=i,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new fK}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const XL=new Bt,Lg=new Y,PS=new Y;class hK extends Y2{constructor(){super(new or(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ge(4,2),this._viewportCount=6,this._viewports=[new wn(2,1,1,1),new wn(0,1,1,1),new wn(3,1,1,1),new wn(1,1,1,1),new wn(3,0,1,1),new wn(1,0,1,1)],this._cubeDirections=[new Y(1,0,0),new Y(-1,0,0),new Y(0,0,1),new Y(0,0,-1),new Y(0,1,0),new Y(0,-1,0)],this._cubeUps=[new Y(0,1,0),new Y(0,1,0),new Y(0,1,0),new Y(0,1,0),new Y(0,0,1),new Y(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,i=this.matrix,s=e.distance||r.far;s!==r.far&&(r.far=s,r.updateProjectionMatrix()),Lg.setFromMatrixPosition(e.matrixWorld),r.position.copy(Lg),PS.copy(r.position),PS.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(PS),r.updateMatrixWorld(),i.makeTranslation(-Lg.x,-Lg.y,-Lg.z),XL.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(XL)}}class q2 extends Bu{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new hK}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class dK extends Y2{constructor(){super(new ra(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class $2 extends Bu{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(gn.DEFAULT_UP),this.updateMatrix(),this.target=new gn,this.shadow=new dK}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Nk extends Bu{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Dk extends Bu{constructor(e,t,r=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class Uk{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Y)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const r=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*i),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*r),t.addScaledVector(o[4],1.092548*(r*i)),t.addScaledVector(o[5],1.092548*(i*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(r*s)),t.addScaledVector(o[8],.546274*(r*r-i*i)),t}getIrradianceAt(e,t){const r=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*i),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*r),t.addScaledVector(o[4],2*.429043*r*i),t.addScaledVector(o[5],2*.429043*i*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*r*s),t.addScaledVector(o[8],.429043*(r*r-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const r=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*r,t[4]=1.092548*r*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*r*s,t[8]=.546274*(r*r-i*i)}}class Fk extends Bu{constructor(e=new Uk,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class cw extends Ai{constructor(e){super(e),this.textures={}}load(e,t,r,i){const s=this,o=new vi(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t=this.textures;function r(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const i=cw.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new ht().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(i.uniforms[s]={},o.type){case"t":i.uniforms[s].value=r(o.value);break;case"c":i.uniforms[s].value=new ht().setHex(o.value);break;case"v2":i.uniforms[s].value=new Ge().fromArray(o.value);break;case"v3":i.uniforms[s].value=new Y().fromArray(o.value);break;case"v4":i.uniforms[s].value=new wn().fromArray(o.value);break;case"m3":i.uniforms[s].value=new tn().fromArray(o.value);break;case"m4":i.uniforms[s].value=new Bt().fromArray(o.value);break;default:i.uniforms[s].value=o.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=r(e.map)),e.matcap!==void 0&&(i.matcap=r(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new Ge().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=r(e.envMap)),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new Ge().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=r(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=r(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=r(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=r(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:xk,SpriteMaterial:N2,RawShaderMaterial:Ak,ShaderMaterial:Pr,PointsMaterial:K_,MeshPhysicalMaterial:Mo,MeshStandardMaterial:ey,MeshPhongMaterial:_k,MeshToonMaterial:wk,MeshNormalMaterial:X2,MeshLambertMaterial:Ek,MeshDepthMaterial:z_,MeshDistanceMaterial:H_,MeshBasicMaterial:Ni,MeshMatcapMaterial:Sk,LineDashedMaterial:bk,LineBasicMaterial:Oi,Material:ur};return new t[e]}}class lu{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let r=0,i=e.length;r<i;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class eR extends jt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Ok extends Ai{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new vi(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t={},r={};function i(m,g){if(t[g]!==void 0)return t[g];const x=m.interleavedBuffers[g],v=s(m,x.buffer),A=Kd(x.type,v),w=new Qv(A,x.stride);return w.uuid=x.uuid,t[g]=w,w}function s(m,g){if(r[g]!==void 0)return r[g];const x=m.arrayBuffers[g],v=new Uint32Array(x).buffer;return r[g]=v,v}const o=e.isInstancedBufferGeometry?new eR:new jt,a=e.data.index;if(a!==void 0){const m=Kd(a.type,a.array);o.setIndex(new vn(m,1))}const l=e.data.attributes;for(const m in l){const g=l[m];let y;if(g.isInterleavedBufferAttribute){const x=i(e.data,g.data);y=new xu(x,g.itemSize,g.offset,g.normalized)}else{const x=Kd(g.type,g.array),v=g.isInstancedBufferAttribute?Au:vn;y=new v(x,g.itemSize,g.normalized)}g.name!==void 0&&(y.name=g.name),g.usage!==void 0&&y.setUsage(g.usage),o.setAttribute(m,y)}const c=e.data.morphAttributes;if(c)for(const m in c){const g=c[m],y=[];for(let x=0,v=g.length;x<v;x++){const A=g[x];let w;if(A.isInterleavedBufferAttribute){const S=i(e.data,A.data);w=new xu(S,A.itemSize,A.offset,A.normalized)}else{const S=Kd(A.type,A.array);w=new vn(S,A.itemSize,A.normalized)}A.name!==void 0&&(w.name=A.name),y.push(w)}o.morphAttributes[m]=y}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const f=e.data.groups||e.data.drawcalls||e.data.offsets;if(f!==void 0)for(let m=0,g=f.length;m!==g;++m){const y=f[m];o.addGroup(y.start,y.count,y.materialIndex)}const d=e.data.boundingSphere;if(d!==void 0){const m=new Y;d.center!==void 0&&m.fromArray(d.center),o.boundingSphere=new si(m,d.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class pK extends Ai{constructor(e){super(e)}load(e,t,r,i){const s=this,o=this.path===""?lu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new vi(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(f){i!==void 0&&i(f),console.error("THREE:ObjectLoader: Can't parse "+e+".",f.message);return}const u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(c,t)},r,i)}async loadAsync(e,t){const r=this,i=this.path===""?lu.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new vi(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(a)}parse(e,t){const r=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),o=this.parseImages(e.images,function(){t!==void 0&&t(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,r),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),t!==void 0){let f=!1;for(const d in o)if(o[d].data instanceof HTMLImageElement){f=!0;break}f===!1&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,i,a,o,t),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),l}parseShapes(e){const t={};if(e!==void 0)for(let r=0,i=e.length;r<i;r++){const s=new fh().fromJSON(e[r]);t[s.uuid]=s}return t}parseSkeletons(e,t){const r={},i={};if(t.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new jv().fromJSON(e[s],i);r[a.uuid]=a}return r}parseGeometries(e,t){const r={};if(e!==void 0){const i=new Ok;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=i.parse(l);break;default:l.type in HL?a=HL[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),r[l.uuid]=a}}return r}parseMaterials(e,t){const r={},i={};if(e!==void 0){const s=new cw;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const l=e[o];r[l.uuid]===void 0&&(r[l.uuid]=s.parse(l)),i[l.uuid]=r[l.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let r=0;r<e.length;r++){const i=e[r],s=Eh.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const r=this,i={};let s;function o(l){return r.manager.itemStart(l),s.load(l,function(){r.manager.itemEnd(l)},void 0,function(){r.manager.itemError(l),r.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:r.resourcePath+c;return o(u)}else return l.data?{data:Kd(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new lw(t);s=new tv(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const f=e[c],d=f.url;if(Array.isArray(d)){const m=[];for(let g=0,y=d.length;g<y;g++){const x=d[g],v=a(x);v!==null&&(v instanceof HTMLImageElement?m.push(v):m.push(new au(v.data,v.width,v.height)))}i[f.uuid]=new Rf(m)}else{const m=a(f.url);i[f.uuid]=new Rf(m)}}}return i}async parseImagesAsync(e){const t=this,r={};let i;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await i.loadAsync(l)}else return o.data?{data:Kd(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){i=new tv(this.manager),i.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.url;if(Array.isArray(c)){const u=[];for(let f=0,d=c.length;f<d;f++){const m=c[f],g=await s(m);g!==null&&(g instanceof HTMLImageElement?u.push(g):u.push(new au(g.data,g.width,g.height)))}r[l.uuid]=new Rf(u)}else{const u=await s(l.url);r[l.uuid]=new Rf(u)}}}return r}parseTextures(e,t){function r(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const i={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=t[a.image],c=l.data;let u;Array.isArray(c)?(u=new Jv,c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new au:u=new Sn,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=a.uuid,a.name!==void 0&&(u.name=a.name),a.mapping!==void 0&&(u.mapping=r(a.mapping,mK)),a.channel!==void 0&&(u.channel=a.channel),a.offset!==void 0&&u.offset.fromArray(a.offset),a.repeat!==void 0&&u.repeat.fromArray(a.repeat),a.center!==void 0&&u.center.fromArray(a.center),a.rotation!==void 0&&(u.rotation=a.rotation),a.wrap!==void 0&&(u.wrapS=r(a.wrap[0],JL),u.wrapT=r(a.wrap[1],JL)),a.format!==void 0&&(u.format=a.format),a.internalFormat!==void 0&&(u.internalFormat=a.internalFormat),a.type!==void 0&&(u.type=a.type),a.colorSpace!==void 0&&(u.colorSpace=a.colorSpace),a.encoding!==void 0&&(u.encoding=a.encoding),a.minFilter!==void 0&&(u.minFilter=r(a.minFilter,KL)),a.magFilter!==void 0&&(u.magFilter=r(a.magFilter,KL)),a.anisotropy!==void 0&&(u.anisotropy=a.anisotropy),a.flipY!==void 0&&(u.flipY=a.flipY),a.generateMipmaps!==void 0&&(u.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(u.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(u.compareFunction=a.compareFunction),a.userData!==void 0&&(u.userData=a.userData),i[a.uuid]=u}return i}parseObject(e,t,r,i,s){let o;function a(d){return t[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),t[d]}function l(d){if(d!==void 0){if(Array.isArray(d)){const m=[];for(let g=0,y=d.length;g<y;g++){const x=d[g];r[x]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",x),m.push(r[x])}return m}return r[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),r[d]}}function c(d){return i[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),i[d]}let u,f;switch(e.type){case"Scene":o=new yu,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new ht(e.background):o.background=c(e.background)),e.environment!==void 0&&(o.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new X_(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new W_(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new or(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new ra(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new Nk(e.color,e.intensity);break;case"DirectionalLight":o=new $2(e.color,e.intensity);break;case"PointLight":o=new q2(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new Dk(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new Z2(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new Lk(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new Fk().fromJSON(e);break;case"SkinnedMesh":u=a(e.geometry),f=l(e.material),o=new D2(u,f),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),f=l(e.material),o=new On(u,f);break;case"InstancedMesh":u=a(e.geometry),f=l(e.material);const d=e.count,m=e.instanceMatrix,g=e.instanceColor;o=new U2(u,f,d),o.instanceMatrix=new Au(new Float32Array(m.array),16),g!==void 0&&(o.instanceColor=new Au(new Float32Array(g.array),g.itemSize));break;case"BatchedMesh":u=a(e.geometry),f=l(e.material),o=new lk(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,f),o.geometry=u,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(y=>{const x=new Br;x.min.fromArray(y.boxMin),x.max.fromArray(y.boxMax);const v=new si;return v.radius=y.sphereRadius,v.center.fromArray(y.sphereCenter),{boxInitialized:y.boxInitialized,box:x,sphereInitialized:y.sphereInitialized,sphere:v}}),o._maxGeometryCount=e.maxGeometryCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=c(e.matricesTexture.uuid);break;case"LOD":o=new ak;break;case"Line":o=new Vl(a(e.geometry),l(e.material));break;case"LineLoop":o=new F2(a(e.geometry),l(e.material));break;case"LineSegments":o=new la(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new O2(a(e.geometry),l(e.material));break;case"Sprite":o=new ok(l(e.material));break;case"Group":o=new Da;break;case"Bone":o=new J_;break;default:o=new gn}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const d=e.children;for(let m=0;m<d.length;m++)o.add(this.parseObject(d[m],t,r,i,s))}if(e.animations!==void 0){const d=e.animations;for(let m=0;m<d.length;m++){const g=d[m];o.animations.push(s[g])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const d=e.levels;for(let m=0;m<d.length;m++){const g=d[m],y=o.getObjectByProperty("uuid",g.object);y!==void 0&&o.addLevel(y,g.distance,g.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const i=t[r.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(i,r.bindMatrix)}})}}const mK={UVMapping:pu,CubeReflectionMapping:za,CubeRefractionMapping:mu,EquirectangularReflectionMapping:ym,EquirectangularRefractionMapping:V0,CubeUVReflectionMapping:Um},JL={RepeatWrapping:gu,ClampToEdgeWrapping:Qn,MirroredRepeatWrapping:xm},KL={NearestFilter:Vn,NearestMipmapNearestFilter:W0,NearestMipmapLinearFilter:fp,LinearFilter:un,LinearMipmapNearestFilter:L_,LinearMipmapLinearFilter:Ha};class kk extends Ai{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Pl.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(c=>{t&&t(c),s.manager.itemEnd(e)}).catch(c=>{i&&i(c)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;const l=fetch(e,a).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){return Pl.add(e,c),t&&t(c),s.manager.itemEnd(e),c}).catch(function(c){i&&i(c),Pl.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});Pl.add(e,l),s.manager.itemStart(e)}}let t1;class tR{static getContext(){return t1===void 0&&(t1=new(window.AudioContext||window.webkitAudioContext)),t1}static setContext(e){t1=e}}class gK extends Ai{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new vi(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const c=l.slice(0);tR.getContext().decodeAudioData(c,function(f){t(f)}).catch(a)}catch(c){a(c)}},r,i);function a(l){i?i(l):console.error(l),s.manager.itemError(e)}}}const QL=new Bt,jL=new Bt,qu=new Bt;class vK{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new or,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new or,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,qu.copy(e.projectionMatrix);const i=t.eyeSep/2,s=i*t.near/t.focus,o=t.near*Math.tan(ch*t.fov*.5)/t.zoom;let a,l;jL.elements[12]=-i,QL.elements[12]=i,a=-o*t.aspect+s,l=o*t.aspect+s,qu.elements[0]=2*t.near/(l-a),qu.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(qu),a=-o*t.aspect-s,l=o*t.aspect-s,qu.elements[0]=2*t.near/(l-a),qu.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(qu)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(jL),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(QL)}}class nR{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=YL(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=YL();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function YL(){return(typeof performance>"u"?Date:performance).now()}const $u=new Y,ZL=new Rr,yK=new Y,ef=new Y;class xK extends gn{constructor(){super(),this.type="AudioListener",this.context=tR.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new nR}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose($u,ZL,yK),ef.set(0,0,-1).applyQuaternion(ZL),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime($u.x,i),t.positionY.linearRampToValueAtTime($u.y,i),t.positionZ.linearRampToValueAtTime($u.z,i),t.forwardX.linearRampToValueAtTime(ef.x,i),t.forwardY.linearRampToValueAtTime(ef.y,i),t.forwardZ.linearRampToValueAtTime(ef.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition($u.x,$u.y,$u.z),t.setOrientation(ef.x,ef.y,ef.z,r.x,r.y,r.z)}}let Gk=class extends gn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}};const tf=new Y,qL=new Rr,AK=new Y,nf=new Y;class _K extends Gk{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(tf,qL,AK),nf.set(0,0,1).applyQuaternion(qL);const t=this.panner;if(t.positionX){const r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(tf.x,r),t.positionY.linearRampToValueAtTime(tf.y,r),t.positionZ.linearRampToValueAtTime(tf.z,r),t.orientationX.linearRampToValueAtTime(nf.x,r),t.orientationY.linearRampToValueAtTime(nf.y,r),t.orientationZ.linearRampToValueAtTime(nf.z,r)}else t.setPosition(tf.x,tf.y,tf.z),t.setOrientation(nf.x,nf.y,nf.z)}}class wK{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}class zk{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,s,o;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,i=this.valueSize,s=e*i+i;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==i;++a)r[s+a]=r[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(r,s,0,a,i)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,i=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(r,i,l,1-s,t)}o>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(r[l]!==r[l+t]){a.setValue(r,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let s=r,o=i;s!==o;++s)t[s]=t[i+s%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,s){if(i>=.5)for(let o=0;o!==s;++o)e[t+o]=e[r+o]}_slerp(e,t,r,i){Rr.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,s){const o=this._workIndex*s;Rr.multiplyQuaternionsFlat(e,o,e,t,e,r),Rr.slerpFlat(e,t,e,t,e,o,i)}_lerp(e,t,r,i,s){const o=1-i;for(let a=0;a!==s;++a){const l=t+a;e[l]=e[l]*o+e[r+a]*i}}_lerpAdditive(e,t,r,i,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[r+o]*i}}}const rR="\\[\\]\\.:\\/",EK=new RegExp("["+rR+"]","g"),iR="[^"+rR+"]",SK="[^"+rR.replace("\\.","")+"]",bK=/((?:WC+[\/:])*)/.source.replace("WC",iR),MK=/(WCOD+)?/.source.replace("WCOD",SK),TK=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",iR),CK=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",iR),RK=new RegExp("^"+bK+MK+TK+CK+"$"),BK=["material","materials","bones","map"];class PK{constructor(e,t,r){const i=r||_n.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}class _n{constructor(e,t,r){this.path=t,this.parsedPath=r||_n.parseTrackName(t),this.node=_n.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new _n.Composite(e,t,r):new _n(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(EK,"")}static parseTrackName(e){const t=RK.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);BK.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){const r=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const l=r(a.children);if(l)return l}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=_n.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let c=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===c){c=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const o=e[i];if(o===void 0){const c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+i+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}_n.Composite=PK;_n.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};_n.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};_n.prototype.GetterByBindingType=[_n.prototype._getValue_direct,_n.prototype._getValue_array,_n.prototype._getValue_arrayElement,_n.prototype._getValue_toArray];_n.prototype.SetterByBindingTypeAndVersioning=[[_n.prototype._setValue_direct,_n.prototype._setValue_direct_setNeedsUpdate,_n.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[_n.prototype._setValue_array,_n.prototype._setValue_array_setNeedsUpdate,_n.prototype._setValue_array_setMatrixWorldNeedsUpdate],[_n.prototype._setValue_arrayElement,_n.prototype._setValue_arrayElement_setNeedsUpdate,_n.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[_n.prototype._setValue_fromArray,_n.prototype._setValue_fromArray_setNeedsUpdate,_n.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class IK{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Js(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,i=arguments.length;r!==i;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,r=this._paths,i=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let u=0,f=arguments.length;u!==f;++u){const d=arguments[u],m=d.uuid;let g=t[m];if(g===void 0){g=l++,t[m]=g,e.push(d);for(let y=0,x=o;y!==x;++y)s[y].push(new _n(d,r[y],i[y]))}else if(g<c){a=e[g];const y=--c,x=e[y];t[x.uuid]=g,e[g]=x,t[m]=y,e[y]=d;for(let v=0,A=o;v!==A;++v){const w=s[v],S=w[y];let M=w[g];w[g]=S,M===void 0&&(M=new _n(d,r[v],i[v])),w[y]=M}}else e[g]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,u=t[c];if(u!==void 0&&u>=s){const f=s++,d=e[f];t[d.uuid]=u,e[u]=d,t[c]=f,e[f]=l;for(let m=0,g=i;m!==g;++m){const y=r[m],x=y[f],v=y[u];y[u]=x,y[f]=v}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const c=arguments[a],u=c.uuid,f=t[u];if(f!==void 0)if(delete t[u],f<s){const d=--s,m=e[d],g=--o,y=e[g];t[m.uuid]=f,e[f]=m,t[y.uuid]=d,e[d]=y,e.pop();for(let x=0,v=i;x!==v;++x){const A=r[x],w=A[d],S=A[g];A[f]=w,A[d]=S,A.pop()}}else{const d=--o,m=e[d];d>0&&(t[m.uuid]=f),e[f]=m,e.pop();for(let g=0,y=i;g!==y;++g){const x=r[g];x[f]=x[d],x.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const r=this._bindingsIndicesByPath;let i=r[e];const s=this._bindings;if(i!==void 0)return s[i];const o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,f=new Array(c);i=s.length,r[e]=i,o.push(e),a.push(t),s.push(f);for(let d=u,m=l.length;d!==m;++d){const g=l[d];f[d]=new _n(g,e,t)}return f}unsubscribe_(e){const t=this._bindingsIndicesByPath,r=t[e];if(r!==void 0){const i=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=e[a];t[c]=r,o[r]=l,o.pop(),s[r]=s[a],s.pop(),i[r]=i[a],i.pop()}}}class Hk{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;const s=t.tracks,o=s.length,a=new Array(o),l={endingStart:Tf,endingEnd:Tf};for(let c=0;c!==o;++c){const u=s[c].createInterpolant(null);a[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LO,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const i=this._clip.duration,s=e._clip.duration,o=s/i,a=i/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const i=this._mixer,s=i.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+r,c[0]=e/o,c[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*r;l<0||r===0?t=0:(this._startTime=null,t=r*l)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case _2:for(let u=0,f=l.length;u!==f;++u)l[u].evaluate(o),c[u].accumulateAdditive(a);break;case U_:default:for(let u=0,f=l.length;u!==f;++u)l[u].evaluate(o),c[u].accumulate(i,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let i=this.time+e,s=this._loopCount;const o=r===NO;if(e===0)return s===-1?i:o&&(s&1)===1?t-i:i;if(r===A2){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=t||i<0){const a=Math.floor(i/t);i-=t*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=i;if(o&&(s&1)===1)return t-i}return i}_setEndings(e,t,r){const i=this._interpolantSettings;r?(i.endingStart=Cf,i.endingEnd=Cf):(e?i.endingStart=this.zeroSlopeAtStart?Cf:Tf:i.endingStart=X0,t?i.endingEnd=this.zeroSlopeAtEnd?Cf:Tf:i.endingEnd=X0)}_scheduleFading(e,t,r){const i=this._mixer,s=i.time;let o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=t,a[1]=s+e,l[1]=r,this}}const LK=new Float32Array(1);class sR extends bo{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,i=e._clip.tracks,s=i.length,o=e._propertyBindings,a=e._interpolants,l=r.uuid,c=this._bindingsByRootAndName;let u=c[l];u===void 0&&(u={},c[l]=u);for(let f=0;f!==s;++f){const d=i[f],m=d.name;let g=u[m];if(g!==void 0)++g.referenceCount,o[f]=g;else{if(g=o[f],g!==void 0){g._cacheIndex===null&&(++g.referenceCount,this._addInactiveBinding(g,l,m));continue}const y=t&&t._propertyBindings[f].binding.parsedPath;g=new zk(_n.create(r,m,y),d.ValueTypeName,d.getValueSize()),++g.referenceCount,this._addInactiveBinding(g,l,m),o[f]=g}a[f].resultBuffer=g.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,r)}const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){const i=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null;const f=a.actionByRoot,d=(e._localRoot||this._root).uuid;delete f[d],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_addInactiveBinding(e,t,r){const i=this._bindingsByRootAndName,s=this._bindings;let o=i[t];o===void 0&&(o={},i[t]=o),o[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,i=r.rootNode.uuid,s=r.path,o=this._bindingsByRootAndName,a=o[i],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[i]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return r===void 0&&(r=new K2(new Float32Array(2),new Float32Array(2),1,LK),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=r,t[r]=s}clipAction(e,t,r){const i=t||this._root,s=i.uuid;let o=typeof e=="string"?Eh.findByName(i,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let c=null;if(r===void 0&&(o!==null?r=o.blendMode:r=U_),l!==void 0){const f=l.actionByRoot[s];if(f!==void 0&&f.blendMode===r)return f;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const u=new Hk(this,o,t,r);return this._bindAction(u,c),this._addInactiveAction(u,a,s),u}existingAction(e,t){const r=t||this._root,i=r.uuid,s=typeof e=="string"?Eh.findByName(r,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,i=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==r;++c)t[c]._update(i,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,i=this._actionsByClip,s=i[r];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const u=c._cacheIndex,f=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,f._cacheIndex=u,t[u]=f,t.pop(),this._removeInactiveBindingsForAction(c)}delete i[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const o in r){const a=r[o].actionByRoot,l=a[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class xn{constructor(e){this.value=e}clone(){return new xn(this.value.clone===void 0?this.value:this.value.clone())}}let NK=0;class DK extends bo{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:NK++}),this.name="",this.usage=j0,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let r=0,i=t.length;r<i;r++){const s=Array.isArray(t[r])?t[r]:[t[r]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class UK extends Qv{constructor(e,t,r=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class FK{constructor(e,t,r,i,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class oR{constructor(e,t,r=0,i=1/0){this.ray=new Ph(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new uh,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return aT(e,this,r,t),r.sort($L),r}intersectObjects(e,t=!0,r=[]){for(let i=0,s=e.length;i<s;i++)aT(e[i],this,r,t);return r.sort($L),r}}function $L(n,e){return n.distance-e.distance}function aT(n,e,t,r){if(n.layers.test(e.layers)&&n.raycast(e,t),r===!0){const i=n.children;for(let s=0,o=i.length;s<o;s++)aT(i[s],e,t,!0)}}class lT{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(yr(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class OK{constructor(e=1,t=0,r=0){return this.radius=e,this.theta=t,this.y=r,this}set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return new this.constructor().copy(this)}}const eN=new Ge;class kK{constructor(e=new Ge(1/0,1/0),t=new Ge(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=eN.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,eN).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const tN=new Y,n1=new Y;class GK{constructor(e=new Y,t=new Y){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){tN.subVectors(e,this.start),n1.subVectors(this.end,this.start);const r=n1.dot(n1);let s=n1.dot(tN)/r;return t&&(s=yr(s,0,1)),s}closestPointToPoint(e,t,r){const i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const nN=new Y;class zK extends gn{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const r=new jt,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,u=a/l*Math.PI*2;i.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}r.setAttribute("position",new Rt(i,3));const s=new Oi({fog:!1,toneMapped:!1});this.cone=new la(r,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),nN.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(nN),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const dc=new Y,r1=new Bt,IS=new Bt;class Vk extends la{constructor(e){const t=Wk(e),r=new jt,i=[],s=[],o=new ht(0,0,1),a=new ht(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}r.setAttribute("position",new Rt(i,3)),r.setAttribute("color",new Rt(s,3));const l=new Oi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,i=r.getAttribute("position");IS.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(r1.multiplyMatrices(IS,a.matrixWorld),dc.setFromMatrixPosition(r1),i.setXYZ(o,dc.x,dc.y,dc.z),r1.multiplyMatrices(IS,a.parent.matrixWorld),dc.setFromMatrixPosition(r1),i.setXYZ(o+1,dc.x,dc.y,dc.z),o+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function Wk(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,Wk(n.children[t]));return e}class HK extends On{constructor(e,t,r){const i=new $v(t,4,2),s=new Ni({wireframe:!0,fog:!1,toneMapped:!1});super(i,s),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const VK=new Y,rN=new ht,iN=new ht;class WK extends gn{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const i=new qv(t);i.rotateY(Math.PI*.5),this.material=new Ni({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),o=new Float32Array(s.count*3);i.setAttribute("color",new vn(o,3)),this.add(new On(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");rN.copy(this.light.color),iN.copy(this.light.groundColor);for(let r=0,i=t.count;r<i;r++){const s=r<i/2?rN:iN;t.setXYZ(r,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(VK.setFromMatrixPosition(this.light.matrixWorld).negate())}}class XK extends la{constructor(e=10,t=10,r=4473924,i=8947848){r=new ht(r),i=new ht(i);const s=t/2,o=e/t,a=e/2,l=[],c=[];for(let d=0,m=0,g=-a;d<=t;d++,g+=o){l.push(-a,0,g,a,0,g),l.push(g,0,-a,g,0,a);const y=d===s?r:i;y.toArray(c,m),m+=3,y.toArray(c,m),m+=3,y.toArray(c,m),m+=3,y.toArray(c,m),m+=3}const u=new jt;u.setAttribute("position",new Rt(l,3)),u.setAttribute("color",new Rt(c,3));const f=new Oi({vertexColors:!0,toneMapped:!1});super(u,f),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class JK extends la{constructor(e=10,t=16,r=8,i=64,s=4473924,o=8947848){s=new ht(s),o=new ht(o);const a=[],l=[];if(t>1)for(let f=0;f<t;f++){const d=f/t*(Math.PI*2),m=Math.sin(d)*e,g=Math.cos(d)*e;a.push(0,0,0),a.push(m,0,g);const y=f&1?s:o;l.push(y.r,y.g,y.b),l.push(y.r,y.g,y.b)}for(let f=0;f<r;f++){const d=f&1?s:o,m=e-e/r*f;for(let g=0;g<i;g++){let y=g/i*(Math.PI*2),x=Math.sin(y)*m,v=Math.cos(y)*m;a.push(x,0,v),l.push(d.r,d.g,d.b),y=(g+1)/i*(Math.PI*2),x=Math.sin(y)*m,v=Math.cos(y)*m,a.push(x,0,v),l.push(d.r,d.g,d.b)}}const c=new jt;c.setAttribute("position",new Rt(a,3)),c.setAttribute("color",new Rt(l,3));const u=new Oi({vertexColors:!0,toneMapped:!1});super(c,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const sN=new Y,i1=new Y,oN=new Y;class KK extends gn{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new jt;i.setAttribute("position",new Rt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Oi({fog:!1,toneMapped:!1});this.lightPlane=new Vl(i,s),this.add(this.lightPlane),i=new jt,i.setAttribute("position",new Rt([0,0,0,0,0,1],3)),this.targetLine=new Vl(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),sN.setFromMatrixPosition(this.light.matrixWorld),i1.setFromMatrixPosition(this.light.target.matrixWorld),oN.subVectors(i1,sN),this.lightPlane.lookAt(i1),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(i1),this.targetLine.scale.z=oN.length()}}const s1=new Y,mr=new Xv;class QK extends la{constructor(e){const t=new jt,r=new Oi({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(g,y){l(g),l(y)}function l(g){i.push(0,0,0),s.push(0,0,0),o[g]===void 0&&(o[g]=[]),o[g].push(i.length/3-1)}t.setAttribute("position",new Rt(i,3)),t.setAttribute("color",new Rt(s,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new ht(16755200),u=new ht(16711680),f=new ht(43775),d=new ht(16777215),m=new ht(3355443);this.setColors(c,u,f,d,m)}setColors(e,t,r,i,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,r.r,r.g,r.b),a.setXYZ(33,r.r,r.g,r.b),a.setXYZ(34,r.r,r.g,r.b),a.setXYZ(35,r.r,r.g,r.b),a.setXYZ(36,r.r,r.g,r.b),a.setXYZ(37,r.r,r.g,r.b),a.setXYZ(38,i.r,i.g,i.b),a.setXYZ(39,i.r,i.g,i.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,r=1,i=1;mr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Sr("c",t,e,mr,0,0,-1),Sr("t",t,e,mr,0,0,1),Sr("n1",t,e,mr,-r,-i,-1),Sr("n2",t,e,mr,r,-i,-1),Sr("n3",t,e,mr,-r,i,-1),Sr("n4",t,e,mr,r,i,-1),Sr("f1",t,e,mr,-r,-i,1),Sr("f2",t,e,mr,r,-i,1),Sr("f3",t,e,mr,-r,i,1),Sr("f4",t,e,mr,r,i,1),Sr("u1",t,e,mr,r*.7,i*1.1,-1),Sr("u2",t,e,mr,-r*.7,i*1.1,-1),Sr("u3",t,e,mr,0,i*2,-1),Sr("cf1",t,e,mr,-r,0,1),Sr("cf2",t,e,mr,r,0,1),Sr("cf3",t,e,mr,0,-i,1),Sr("cf4",t,e,mr,0,i,1),Sr("cn1",t,e,mr,-r,0,-1),Sr("cn2",t,e,mr,r,0,-1),Sr("cn3",t,e,mr,0,-i,-1),Sr("cn4",t,e,mr,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Sr(n,e,t,r,i,s,o){s1.set(i,s,o).unproject(r);const a=e[n];if(a!==void 0){const l=t.getAttribute("position");for(let c=0,u=a.length;c<u;c++)l.setXYZ(a[c],s1.x,s1.y,s1.z)}}const o1=new Br;class jK extends la{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new jt;s.setIndex(new vn(r,1)),s.setAttribute("position",new vn(i,3)),super(s,new Oi({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&o1.setFromObject(this.object),o1.isEmpty())return;const t=o1.min,r=o1.max,i=this.geometry.attributes.position,s=i.array;s[0]=r.x,s[1]=r.y,s[2]=r.z,s[3]=t.x,s[4]=r.y,s[5]=r.z,s[6]=t.x,s[7]=t.y,s[8]=r.z,s[9]=r.x,s[10]=t.y,s[11]=r.z,s[12]=r.x,s[13]=r.y,s[14]=t.z,s[15]=t.x,s[16]=r.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=r.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class YK extends la{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new jt;s.setIndex(new vn(r,1)),s.setAttribute("position",new Rt(i,3)),super(s,new Oi({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class ZK extends Vl{constructor(e,t=1,r=16776960){const i=r,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new jt;o.setAttribute("position",new Rt(s,3)),o.computeBoundingSphere(),super(o,new Oi({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new jt;l.setAttribute("position",new Rt(a,3)),l.computeBoundingSphere(),this.add(new On(l,new Ni({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const aN=new Y;let a1,LS;class qK extends gn{constructor(e=new Y(0,0,1),t=new Y(0,0,0),r=1,i=16776960,s=r*.2,o=s*.2){super(),this.type="ArrowHelper",a1===void 0&&(a1=new jt,a1.setAttribute("position",new Rt([0,0,0,0,1,0],3)),LS=new Om(0,.5,1,5,1),LS.translate(0,-.5,0)),this.position.copy(t),this.line=new Vl(a1,new Oi({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new On(LS,new Ni({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{aN.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(aN,t)}}setLength(e,t=e*.2,r=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class $K extends la{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new jt;i.setAttribute("position",new Rt(t,3)),i.setAttribute("color",new Rt(r,3));const s=new Oi({vertexColors:!0,toneMapped:!1});super(i,s),this.type="AxesHelper"}setColors(e,t,r){const i=new ht,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(r),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class eQ{constructor(){this.type="ShapePath",this.color=new ht,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Z0,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,s,o){return this.currentPath.bezierCurveTo(e,t,r,i,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(v){const A=[];for(let w=0,S=v.length;w<S;w++){const M=v[w],b=new fh;b.curves=M.curves,A.push(b)}return A}function r(v,A){const w=A.length;let S=!1;for(let M=w-1,b=0;b<w;M=b++){let R=A[M],P=A[b],C=P.x-R.x,B=P.y-R.y;if(Math.abs(B)>Number.EPSILON){if(B<0&&(R=A[b],C=-C,P=A[M],B=-B),v.y<R.y||v.y>P.y)continue;if(v.y===R.y){if(v.x===R.x)return!0}else{const H=B*(v.x-R.x)-C*(v.y-R.y);if(H===0)return!0;if(H<0)continue;S=!S}}else{if(v.y!==R.y)continue;if(P.x<=v.x&&v.x<=R.x||R.x<=v.x&&v.x<=P.x)return!0}}return S}const i=ka.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const c=[];if(s.length===1)return a=s[0],l=new fh,l.curves=a.curves,c.push(l),c;let u=!i(s[0].getPoints());u=e?!u:u;const f=[],d=[];let m=[],g=0,y;d[g]=void 0,m[g]=[];for(let v=0,A=s.length;v<A;v++)a=s[v],y=a.getPoints(),o=i(y),o=e?!o:o,o?(!u&&d[g]&&g++,d[g]={s:new fh,p:y},d[g].s.curves=a.curves,u&&g++,m[g]=[]):m[g].push({h:a,p:y[0]});if(!d[0])return t(s);if(d.length>1){let v=!1,A=0;for(let w=0,S=d.length;w<S;w++)f[w]=[];for(let w=0,S=d.length;w<S;w++){const M=m[w];for(let b=0;b<M.length;b++){const R=M[b];let P=!0;for(let C=0;C<d.length;C++)r(R.p,d[C].p)&&(w!==C&&A++,P?(P=!1,f[C].push(R)):v=!0);P&&f[w].push(R)}}A>0&&v===!1&&(m=f)}let x;for(let v=0,A=d.length;v<A;v++){l=d[v].s,c.push(l),x=m[v];for(let w=0,S=x.length;w<S;w++)l.holes.push(x[w].h)}return c}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Bh}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Bh);const tQ=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:u2,AddEquation:Rc,AddOperation:_O,AdditiveAnimationBlendMode:_2,AdditiveBlending:xM,AgXToneMapping:MO,AlphaFormat:CO,AlwaysCompare:VO,AlwaysDepth:c2,AlwaysStencilFunc:ZM,AmbientLight:Nk,AnimationAction:Hk,AnimationClip:Eh,AnimationLoader:cK,AnimationMixer:sR,AnimationObjectGroup:IK,AnimationUtils:sK,ArcCurve:ck,ArrayCamera:rk,ArrowHelper:qK,AttachedBindMode:SM,Audio:Gk,AudioAnalyser:wK,AudioContext:tR,AudioListener:xK,AudioLoader:gK,AxesHelper:$K,BackSide:Xr,BasicDepthPacking:Tu,BasicShadowMap:ZF,BatchedMesh:lk,Bone:J_,BooleanKeyframeTrack:Lh,Box2:kK,Box3:Br,Box3Helper:YK,BoxGeometry:Ih,BoxHelper:jK,BufferAttribute:vn,BufferGeometry:jt,BufferGeometryLoader:Ok,ByteType:f2,Cache:Pl,Camera:Xv,CameraHelper:QK,CanvasTexture:RJ,CapsuleGeometry:Y_,CatmullRomCurve3:uk,CineonToneMapping:SO,CircleGeometry:Z_,ClampToEdgeWrapping:Qn,Clock:nR,Color:ht,ColorKeyframeTrack:Q2,ColorManagement:Pn,CompressedArrayTexture:TJ,CompressedCubeTexture:CJ,CompressedTexture:Q_,CompressedTextureLoader:uK,ConeGeometry:q_,ConstantAlphaFactor:hO,ConstantColorFactor:uO,CubeCamera:jO,CubeReflectionMapping:za,CubeRefractionMapping:mu,CubeTexture:Jv,CubeTextureLoader:Pk,CubeUVReflectionMapping:Um,CubicBezierCurve:G2,CubicBezierCurve3:fk,CubicInterpolant:Ck,CullFaceBack:yM,CullFaceFront:YF,CullFaceFrontBack:E6,CullFaceNone:jF,Curve:ca,CurvePath:dk,CustomBlending:qF,CustomToneMapping:bO,CylinderGeometry:Om,Cylindrical:OK,Data3DTexture:C2,DataArrayTexture:O_,DataTexture:au,DataTextureLoader:j2,DataUtils:Bf,DecrementStencilOp:P6,DecrementWrapStencilOp:L6,DefaultLoadingManager:Zd,DepthFormat:su,DepthStencilFormat:vu,DepthTexture:k_,DetachedBindMode:TO,DirectionalLight:$2,DirectionalLightHelper:KK,DiscreteInterpolant:Rk,DisplayP3ColorSpace:F_,DodecahedronGeometry:$_,DoubleSide:di,DstAlphaFactor:sO,DstColorFactor:aO,DynamicCopyUsage:K6,DynamicDrawUsage:qM,DynamicReadUsage:W6,EdgesGeometry:pk,EllipseCurve:j_,EqualCompare:kO,EqualDepth:gO,EqualStencilFunc:F6,EquirectangularReflectionMapping:ym,EquirectangularRefractionMapping:V0,Euler:Wv,EventDispatcher:bo,ExtrudeGeometry:tw,FileLoader:vi,Float16BufferAttribute:I9,Float32BufferAttribute:Rt,Float64BufferAttribute:L9,FloatType:Cr,Fog:X_,FogExp2:W_,FramebufferTexture:MJ,FrontSide:sa,Frustum:Kv,GLBufferAttribute:FK,GLSL1:j6,GLSL3:$M,GreaterCompare:GO,GreaterDepth:yO,GreaterEqualCompare:HO,GreaterEqualDepth:vO,GreaterEqualStencilFunc:z6,GreaterStencilFunc:k6,GridHelper:XK,Group:Da,HalfFloatType:Jr,HemisphereLight:Lk,HemisphereLightHelper:WK,IcosahedronGeometry:Zv,ImageBitmapLoader:kk,ImageLoader:tv,ImageUtils:T2,IncrementStencilOp:B6,IncrementWrapStencilOp:I6,InstancedBufferAttribute:Au,InstancedBufferGeometry:eR,InstancedInterleavedBuffer:UK,InstancedMesh:U2,Int16BufferAttribute:B9,Int32BufferAttribute:P9,Int8BufferAttribute:T9,IntType:D_,InterleavedBuffer:Qv,InterleavedBufferAttribute:xu,Interpolant:km,InterpolateDiscrete:Am,InterpolateLinear:Ah,InterpolateSmooth:j1,InvertStencilOp:N6,KeepStencilOp:pf,KeyframeTrack:ua,LOD:ak,LatheGeometry:Yv,Layers:uh,LessCompare:OO,LessDepth:mO,LessEqualCompare:b2,LessEqualDepth:H0,LessEqualStencilFunc:O6,LessStencilFunc:U6,Light:Bu,LightProbe:Fk,Line:Vl,Line3:GK,LineBasicMaterial:Oi,LineCurve:z2,LineCurve3:hk,LineDashedMaterial:bk,LineLoop:F2,LineSegments:la,LinearDisplayP3ColorSpace:Vv,LinearEncoding:E2,LinearFilter:un,LinearInterpolant:K2,LinearMipMapLinearFilter:bM,LinearMipMapNearestFilter:T6,LinearMipmapLinearFilter:Ha,LinearMipmapNearestFilter:L_,LinearSRGBColorSpace:is,LinearToneMapping:wO,LinearTransfer:J0,Loader:Ai,LoaderUtils:lu,LoadingManager:lw,LoopOnce:A2,LoopPingPong:NO,LoopRepeat:LO,LuminanceAlphaFormat:BO,LuminanceFormat:RO,MOUSE:hf,Material:ur,MaterialLoader:cw,MathUtils:Jd,Matrix3:tn,Matrix4:Bt,MaxEquation:EM,Mesh:On,MeshBasicMaterial:Ni,MeshDepthMaterial:z_,MeshDistanceMaterial:H_,MeshLambertMaterial:Ek,MeshMatcapMaterial:Sk,MeshNormalMaterial:X2,MeshPhongMaterial:_k,MeshPhysicalMaterial:Mo,MeshStandardMaterial:ey,MeshToonMaterial:wk,MinEquation:wM,MirroredRepeatWrapping:xm,MixOperation:AO,MultiplyBlending:_M,MultiplyOperation:Hv,NearestFilter:Vn,NearestMipMapLinearFilter:M6,NearestMipMapNearestFilter:b6,NearestMipmapLinearFilter:fp,NearestMipmapNearestFilter:W0,NeverCompare:FO,NeverDepth:pO,NeverStencilFunc:D6,NoBlending:gi,NoColorSpace:qi,NoToneMapping:na,NormalAnimationBlendMode:U_,NormalBlending:lh,NotEqualCompare:zO,NotEqualDepth:xO,NotEqualStencilFunc:G6,NumberKeyframeTrack:wh,Object3D:gn,ObjectLoader:pK,ObjectSpaceNormalMap:UO,OctahedronGeometry:qv,OneFactor:nO,OneMinusConstantAlphaFactor:dO,OneMinusConstantColorFactor:fO,OneMinusDstAlphaFactor:oO,OneMinusDstColorFactor:lO,OneMinusSrcAlphaFactor:GA,OneMinusSrcColorFactor:iO,OrthographicCamera:ra,P3Primaries:Q0,PCFShadowMap:I_,PCFSoftShadowMap:m0,PMREMGenerator:tT,Path:Z0,PerspectiveCamera:or,Plane:dl,PlaneGeometry:Wa,PlaneHelper:ZK,PointLight:q2,PointLightHelper:HK,Points:O2,PointsMaterial:K_,PolarGridHelper:JK,PolyhedronGeometry:Ru,PositionalAudio:_K,PropertyBinding:_n,PropertyMixer:zk,QuadraticBezierCurve:H2,QuadraticBezierCurve3:V2,Quaternion:Rr,QuaternionKeyframeTrack:Wl,QuaternionLinearInterpolant:Bk,RED_GREEN_RGTC2_Format:jM,RED_RGTC1_Format:IO,REVISION:Bh,RGBADepthPacking:S2,RGBAFormat:Ur,RGBAIntegerFormat:y2,RGBA_ASTC_10x10_Format:VM,RGBA_ASTC_10x5_Format:GM,RGBA_ASTC_10x6_Format:zM,RGBA_ASTC_10x8_Format:HM,RGBA_ASTC_12x10_Format:WM,RGBA_ASTC_12x12_Format:XM,RGBA_ASTC_4x4_Format:IM,RGBA_ASTC_5x4_Format:LM,RGBA_ASTC_5x5_Format:NM,RGBA_ASTC_6x5_Format:DM,RGBA_ASTC_6x6_Format:UM,RGBA_ASTC_8x5_Format:FM,RGBA_ASTC_8x6_Format:OM,RGBA_ASTC_8x8_Format:kM,RGBA_BPTC_Format:Q1,RGBA_ETC2_EAC_Format:PM,RGBA_PVRTC_2BPPV1_Format:RM,RGBA_PVRTC_4BPPV1_Format:CM,RGBA_S3TC_DXT1_Format:X1,RGBA_S3TC_DXT3_Format:J1,RGBA_S3TC_DXT5_Format:K1,RGB_BPTC_SIGNED_Format:JM,RGB_BPTC_UNSIGNED_Format:KM,RGB_ETC1_Format:x2,RGB_ETC2_Format:BM,RGB_PVRTC_2BPPV1_Format:TM,RGB_PVRTC_4BPPV1_Format:MM,RGB_S3TC_DXT1_Format:W1,RGFormat:PO,RGIntegerFormat:v2,RawShaderMaterial:Ak,Ray:Ph,Raycaster:oR,Rec709Primaries:K0,RectAreaLight:Dk,RedFormat:m2,RedIntegerFormat:g2,ReinhardToneMapping:EO,RenderTarget:JO,RepeatWrapping:gu,ReplaceStencilOp:R6,ReverseSubtractEquation:eO,RingGeometry:nw,SIGNED_RED_GREEN_RGTC2_Format:YM,SIGNED_RED_RGTC1_Format:QM,SRGBColorSpace:mn,SRGBTransfer:Hn,Scene:yu,ShaderChunk:Jt,ShaderLib:jo,ShaderMaterial:Pr,ShadowMaterial:xk,Shape:fh,ShapeGeometry:rw,ShapePath:eQ,ShapeUtils:ka,ShortType:h2,Skeleton:jv,SkeletonHelper:Vk,SkinnedMesh:D2,Source:Rf,Sphere:si,SphereGeometry:$v,Spherical:lT,SphericalHarmonics3:Uk,SplineCurve:W2,SpotLight:Z2,SpotLightHelper:zK,Sprite:ok,SpriteMaterial:N2,SrcAlphaFactor:kA,SrcAlphaSaturateFactor:cO,SrcColorFactor:rO,StaticCopyUsage:J6,StaticDrawUsage:j0,StaticReadUsage:V6,StereoCamera:vK,StreamCopyUsage:Q6,StreamDrawUsage:H6,StreamReadUsage:X6,StringKeyframeTrack:Nh,SubtractEquation:$F,SubtractiveBlending:AM,TOUCH:df,TangentSpaceNormalMap:Cu,TetrahedronGeometry:iw,Texture:Sn,TextureLoader:Ik,TorusGeometry:sw,TorusKnotGeometry:ow,Triangle:vs,TriangleFanDrawMode:zA,TriangleStripDrawMode:w2,TrianglesDrawMode:DO,TubeGeometry:aw,TwoPassDoubleSide:S6,UVMapping:pu,Uint16BufferAttribute:R2,Uint32BufferAttribute:B2,Uint8BufferAttribute:C9,Uint8ClampedBufferAttribute:R9,Uniform:xn,UniformsGroup:DK,UniformsLib:pt,UniformsUtils:P2,UnsignedByteType:Gr,UnsignedInt248Type:Nl,UnsignedIntType:qo,UnsignedShort4444Type:d2,UnsignedShort5551Type:p2,UnsignedShortType:N_,VSMShadowMap:Fo,Vector2:Ge,Vector3:Y,Vector4:wn,VectorKeyframeTrack:_u,VideoTexture:bJ,WebGL1Renderer:ik,WebGL3DRenderTarget:m9,WebGLArrayRenderTarget:p9,WebGLCoordinateSystem:$o,WebGLCubeRenderTarget:I2,WebGLMultipleRenderTargets:g9,WebGLRenderTarget:hr,WebGLRenderer:V_,WebGLUtils:nk,WebGPUCoordinateSystem:_m,WireframeGeometry:yk,WrapAroundEnding:X0,ZeroCurvatureEnding:Tf,ZeroFactor:tO,ZeroSlopeEnding:Cf,ZeroStencilOp:C6,_SRGBAFormat:HA,createCanvasElement:XO,sRGBEncoding:ou},Symbol.toStringTag,{value:"Module"}));var Xk={exports:{}},Dh={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Dh.ConcurrentRoot=1;Dh.ContinuousEventPriority=4;Dh.DefaultEventPriority=16;Dh.DiscreteEventPriority=1;Dh.IdleEventPriority=536870912;Dh.LegacyRoot=0;Xk.exports=Dh;var qd=Xk.exports;function nQ(n){let e;const t=new Set,r=(c,u)=>{const f=typeof c=="function"?c(e):c;if(f!==e){const d=e;e=u?f:Object.assign({},e,f),t.forEach(m=>m(e,d))}},i=()=>e,s=(c,u=i,f=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let d=u(e);function m(){const g=u(e);if(!f(d,g)){const y=d;c(d=g,y)}}return t.add(m),()=>t.delete(m)},l={setState:r,getState:i,subscribe:(c,u,f)=>u||f?s(c,u,f):(t.add(c),()=>t.delete(c)),destroy:()=>t.clear()};return e=n(r,i,l),l}const rQ=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),lN=rQ?te.useEffect:te.useLayoutEffect;function Jk(n){const e=typeof n=="function"?nQ(n):n,t=(r=e.getState,i=Object.is)=>{const[,s]=te.useReducer(x=>x+1,0),o=e.getState(),a=te.useRef(o),l=te.useRef(r),c=te.useRef(i),u=te.useRef(!1),f=te.useRef();f.current===void 0&&(f.current=r(o));let d,m=!1;(a.current!==o||l.current!==r||c.current!==i||u.current)&&(d=r(o),m=!i(f.current,d)),lN(()=>{m&&(f.current=d),a.current=o,l.current=r,c.current=i,u.current=!1});const g=te.useRef(o);lN(()=>{const x=()=>{try{const A=e.getState(),w=l.current(A);c.current(f.current,w)||(a.current=A,f.current=w,s())}catch{u.current=!0,s()}},v=e.subscribe(x);return e.getState()!==g.current&&x(),v},[]);const y=m?d:f.current;return te.useDebugValue(y),y};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[t,e];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},t}var Kk={exports:{}},Qk={exports:{}},jk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(X,K){var W=X.length;X.push(K);e:for(;0<W;){var V=W-1>>>1,Q=X[V];if(0<i(Q,K))X[V]=K,X[W]=Q,W=V;else break e}}function t(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var K=X[0],W=X.pop();if(W!==K){X[0]=W;e:for(var V=0,Q=X.length,q=Q>>>1;V<q;){var ne=2*(V+1)-1,fe=X[ne],pe=ne+1,ge=X[pe];if(0>i(fe,W))pe<Q&&0>i(ge,fe)?(X[V]=ge,X[pe]=W,V=pe):(X[V]=fe,X[ne]=W,V=ne);else if(pe<Q&&0>i(ge,W))X[V]=ge,X[pe]=W,V=pe;else break e}}return K}function i(X,K){var W=X.sortIndex-K.sortIndex;return W!==0?W:X.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,f=null,d=3,m=!1,g=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(X){for(var K=t(c);K!==null;){if(K.callback===null)r(c);else if(K.startTime<=X)r(c),K.sortIndex=K.expirationTime,e(l,K);else break;K=t(c)}}function S(X){if(y=!1,w(X),!g)if(t(l)!==null)g=!0,O(M);else{var K=t(c);K!==null&&ie(S,K.startTime-X)}}function M(X,K){g=!1,y&&(y=!1,v(P),P=-1),m=!0;var W=d;try{for(w(K),f=t(l);f!==null&&(!(f.expirationTime>K)||X&&!H());){var V=f.callback;if(typeof V=="function"){f.callback=null,d=f.priorityLevel;var Q=V(f.expirationTime<=K);K=n.unstable_now(),typeof Q=="function"?f.callback=Q:f===t(l)&&r(l),w(K)}else r(l);f=t(l)}if(f!==null)var q=!0;else{var ne=t(c);ne!==null&&ie(S,ne.startTime-K),q=!1}return q}finally{f=null,d=W,m=!1}}var b=!1,R=null,P=-1,C=5,B=-1;function H(){return!(n.unstable_now()-B<C)}function k(){if(R!==null){var X=n.unstable_now();B=X;var K=!0;try{K=R(!0,X)}finally{K?$():(b=!1,R=null)}}else b=!1}var $;if(typeof A=="function")$=function(){A(k)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,z=U.port2;U.port1.onmessage=k,$=function(){z.postMessage(null)}}else $=function(){x(k,0)};function O(X){R=X,b||(b=!0,$())}function ie(X,K){P=x(function(){X(n.unstable_now())},K)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(X){X.callback=null},n.unstable_continueExecution=function(){g||m||(g=!0,O(M))},n.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<X?Math.floor(1e3/X):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(X){switch(d){case 1:case 2:case 3:var K=3;break;default:K=d}var W=d;d=K;try{return X()}finally{d=W}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(X,K){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var W=d;d=X;try{return K()}finally{d=W}},n.unstable_scheduleCallback=function(X,K,W){var V=n.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?V+W:V):W=V,X){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=W+Q,X={id:u++,callback:K,priorityLevel:X,startTime:W,expirationTime:Q,sortIndex:-1},W>V?(X.sortIndex=W,e(c,X),t(l)===null&&X===t(c)&&(y?(v(P),P=-1):y=!0,ie(S,W-V))):(X.sortIndex=Q,e(l,X),g||m||(g=!0,O(M))),X},n.unstable_shouldYield=H,n.unstable_wrapCallback=function(X){var K=d;return function(){var W=d;d=K;try{return X.apply(this,arguments)}finally{d=W}}}})(jk);Qk.exports=jk;var cT=Qk.exports;/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iQ=function(e){var t={},r=te,i=cT,s=Object.assign;function o(h){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+h,_=1;_<arguments.length;_++)p+="&args[]="+encodeURIComponent(arguments[_]);return"Minified React error #"+h+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),g=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),v=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),S=Symbol.for("react.offscreen"),M=Symbol.iterator;function b(h){return h===null||typeof h!="object"?null:(h=M&&h[M]||h["@@iterator"],typeof h=="function"?h:null)}function R(h){if(h==null)return null;if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case u:return"Fragment";case c:return"Portal";case d:return"Profiler";case f:return"StrictMode";case x:return"Suspense";case v:return"SuspenseList"}if(typeof h=="object")switch(h.$$typeof){case g:return(h.displayName||"Context")+".Consumer";case m:return(h._context.displayName||"Context")+".Provider";case y:var p=h.render;return h=h.displayName,h||(h=p.displayName||p.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case A:return p=h.displayName||null,p!==null?p:R(h.type)||"Memo";case w:p=h._payload,h=h._init;try{return R(h(p))}catch{}}return null}function P(h){var p=h.type;switch(h.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return h=p.render,h=h.displayName||h.name||"",p.displayName||(h!==""?"ForwardRef("+h+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return R(p);case 8:return p===f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function C(h){var p=h,_=h;if(h.alternate)for(;p.return;)p=p.return;else{h=p;do p=h,p.flags&4098&&(_=p.return),h=p.return;while(h)}return p.tag===3?_:null}function B(h){if(C(h)!==h)throw Error(o(188))}function H(h){var p=h.alternate;if(!p){if(p=C(h),p===null)throw Error(o(188));return p!==h?null:h}for(var _=h,E=p;;){var T=_.return;if(T===null)break;var I=T.alternate;if(I===null){if(E=T.return,E!==null){_=E;continue}break}if(T.child===I.child){for(I=T.child;I;){if(I===_)return B(T),h;if(I===E)return B(T),p;I=I.sibling}throw Error(o(188))}if(_.return!==E.return)_=T,E=I;else{for(var se=!1,_e=T.child;_e;){if(_e===_){se=!0,_=T,E=I;break}if(_e===E){se=!0,E=T,_=I;break}_e=_e.sibling}if(!se){for(_e=I.child;_e;){if(_e===_){se=!0,_=I,E=T;break}if(_e===E){se=!0,E=I,_=T;break}_e=_e.sibling}if(!se)throw Error(o(189))}}if(_.alternate!==E)throw Error(o(190))}if(_.tag!==3)throw Error(o(188));return _.stateNode.current===_?h:p}function k(h){return h=H(h),h!==null?$(h):null}function $(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){var p=$(h);if(p!==null)return p;h=h.sibling}return null}function U(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){if(h.tag!==4){var p=U(h);if(p!==null)return p}h=h.sibling}return null}var z=Array.isArray,O=e.getPublicInstance,ie=e.getRootHostContext,X=e.getChildHostContext,K=e.prepareForCommit,W=e.resetAfterCommit,V=e.createInstance,Q=e.appendInitialChild,q=e.finalizeInitialChildren,ne=e.prepareUpdate,fe=e.shouldSetTextContent,pe=e.createTextInstance,ge=e.scheduleTimeout,Ce=e.cancelTimeout,Je=e.noTimeout,Xe=e.isPrimaryRenderer,Fe=e.supportsMutation,j=e.supportsPersistence,Te=e.supportsHydration,be=e.getInstanceFromNode,Ue=e.preparePortalMount,we=e.getCurrentEventPriority,et=e.detachDeletedInstance,Re=e.supportsMicrotasks,J=e.scheduleMicrotask,F=e.supportsTestSelectors,G=e.findFiberRoot,de=e.getBoundingRect,le=e.getTextContent,ye=e.isHiddenSubtree,Le=e.matchAccessibilityRole,Ve=e.setFocusIfFocusable,Oe=e.setupIntersectionObserver,ze=e.appendChild,Ye=e.appendChildToContainer,Ie=e.commitTextUpdate,gt=e.commitMount,yt=e.commitUpdate,ot=e.insertBefore,Ze=e.insertInContainerBefore,Ke=e.removeChild,ae=e.removeChildFromContainer,De=e.resetTextContent,rt=e.hideInstance,it=e.hideTextInstance,ve=e.unhideInstance,ce=e.unhideTextInstance,at=e.clearContainer,$e=e.cloneInstance,ct=e.createContainerChildSet,ft=e.appendChildToContainerChildSet,Tt=e.finalizeContainerChildren,mt=e.replaceContainerChildren,Dt=e.cloneHiddenInstance,qt=e.cloneHiddenTextInstance,Ft=e.canHydrateInstance,ln=e.canHydrateTextInstance,zn=e.canHydrateSuspenseInstance,zr=e.isSuspenseInstancePending,oi=e.isSuspenseInstanceFallback,xr=e.registerSuspenseInstanceRetry,dr=e.getNextHydratableSibling,Ot=e.getFirstHydratableChild,nr=e.getFirstHydratableChildWithinContainer,as=e.getFirstHydratableChildWithinSuspenseInstance,D=e.hydrateInstance,Z=e.hydrateTextInstance,me=e.hydrateSuspenseInstance,L=e.getNextHydratableInstanceAfterSuspenseInstance,ee=e.commitHydratedContainer,re=e.commitHydratedSuspenseInstance,he=e.clearSuspenseBoundary,ue=e.clearSuspenseBoundaryFromContainer,Pe=e.shouldDeleteUnhydratedTailInstances,ke=e.didNotMatchHydratedContainerTextInstance,We=e.didNotMatchHydratedTextInstance,Ae;function vt(h){if(Ae===void 0)try{throw Error()}catch(_){var p=_.stack.trim().match(/\n( *(at )?)/);Ae=p&&p[1]||""}return`
`+Ae+h}var nt=!1;function tt(h,p){if(!h||nt)return"";nt=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(ut){var E=ut}Reflect.construct(h,[],p)}else{try{p.call()}catch(ut){E=ut}h.call(p.prototype)}else{try{throw Error()}catch(ut){E=ut}h()}}catch(ut){if(ut&&E&&typeof ut.stack=="string"){for(var T=ut.stack.split(`
`),I=E.stack.split(`
`),se=T.length-1,_e=I.length-1;1<=se&&0<=_e&&T[se]!==I[_e];)_e--;for(;1<=se&&0<=_e;se--,_e--)if(T[se]!==I[_e]){if(se!==1||_e!==1)do if(se--,_e--,0>_e||T[se]!==I[_e]){var Qe=`
`+T[se].replace(" at new "," at ");return h.displayName&&Qe.includes("<anonymous>")&&(Qe=Qe.replace("<anonymous>",h.displayName)),Qe}while(1<=se&&0<=_e);break}}}finally{nt=!1,Error.prepareStackTrace=_}return(h=h?h.displayName||h.name:"")?vt(h):""}var Et=Object.prototype.hasOwnProperty,Pt=[],Lt=-1;function Vt(h){return{current:h}}function xt(h){0>Lt||(h.current=Pt[Lt],Pt[Lt]=null,Lt--)}function dt(h,p){Lt++,Pt[Lt]=h.current,h.current=p}var Kt={},Ut=Vt(Kt),kt=Vt(!1),bn=Kt;function Ln(h,p){var _=h.type.contextTypes;if(!_)return Kt;var E=h.stateNode;if(E&&E.__reactInternalMemoizedUnmaskedChildContext===p)return E.__reactInternalMemoizedMaskedChildContext;var T={},I;for(I in _)T[I]=p[I];return E&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=p,h.__reactInternalMemoizedMaskedChildContext=T),T}function Nn(h){return h=h.childContextTypes,h!=null}function en(){xt(kt),xt(Ut)}function $t(h,p,_){if(Ut.current!==Kt)throw Error(o(168));dt(Ut,p),dt(kt,_)}function kn(h,p,_){var E=h.stateNode;if(p=p.childContextTypes,typeof E.getChildContext!="function")return _;E=E.getChildContext();for(var T in E)if(!(T in p))throw Error(o(108,P(h)||"Unknown",T));return s({},_,E)}function Xt(h){return h=(h=h.stateNode)&&h.__reactInternalMemoizedMergedChildContext||Kt,bn=Ut.current,dt(Ut,h),dt(kt,kt.current),!0}function Wt(h,p,_){var E=h.stateNode;if(!E)throw Error(o(169));_?(h=kn(h,p,bn),E.__reactInternalMemoizedMergedChildContext=h,xt(kt),xt(Ut),dt(Ut,h)):xt(kt),dt(kt,_)}var Dn=Math.clz32?Math.clz32:Ts,ai=Math.log,Ar=Math.LN2;function Ts(h){return h>>>=0,h===0?32:31-(ai(h)/Ar|0)|0}var Xa=64,Ja=4194304;function Ka(h){switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return h&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return h}}function Iu(h,p){var _=h.pendingLanes;if(_===0)return 0;var E=0,T=h.suspendedLanes,I=h.pingedLanes,se=_&268435455;if(se!==0){var _e=se&~T;_e!==0?E=Ka(_e):(I&=se,I!==0&&(E=Ka(I)))}else se=_&~T,se!==0?E=Ka(se):I!==0&&(E=Ka(I));if(E===0)return 0;if(p!==0&&p!==E&&!(p&T)&&(T=E&-E,I=p&-p,T>=I||T===16&&(I&4194240)!==0))return p;if(E&4&&(E|=_&16),p=h.entangledLanes,p!==0)for(h=h.entanglements,p&=E;0<p;)_=31-Dn(p),T=1<<_,E|=h[_],p&=~T;return E}function uy(h,p){switch(h){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Wm(h,p){for(var _=h.suspendedLanes,E=h.pingedLanes,T=h.expirationTimes,I=h.pendingLanes;0<I;){var se=31-Dn(I),_e=1<<se,Qe=T[se];Qe===-1?(!(_e&_)||_e&E)&&(T[se]=uy(_e,p)):Qe<=p&&(h.expiredLanes|=_e),I&=~_e}}function Qa(h){return h=h.pendingLanes&-1073741825,h!==0?h:h&1073741824?1073741824:0}function kh(h){for(var p=[],_=0;31>_;_++)p.push(h);return p}function da(h,p,_){h.pendingLanes|=p,p!==536870912&&(h.suspendedLanes=0,h.pingedLanes=0),h=h.eventTimes,p=31-Dn(p),h[p]=_}function Yl(h,p){var _=h.pendingLanes&~p;h.pendingLanes=p,h.suspendedLanes=0,h.pingedLanes=0,h.expiredLanes&=p,h.mutableReadLanes&=p,h.entangledLanes&=p,p=h.entanglements;var E=h.eventTimes;for(h=h.expirationTimes;0<_;){var T=31-Dn(_),I=1<<T;p[T]=0,E[T]=-1,h[T]=-1,_&=~I}}function pa(h,p){var _=h.entangledLanes|=p;for(h=h.entanglements;_;){var E=31-Dn(_),T=1<<E;T&p|h[E]&p&&(h[E]|=p),_&=~T}}var fn=0;function Xm(h){return h&=-h,1<h?4<h?h&268435455?16:536870912:4:1}var ja=i.unstable_scheduleCallback,Gh=i.unstable_cancelCallback,Jm=i.unstable_shouldYield,fy=i.unstable_requestPaint,rr=i.unstable_now,Lu=i.unstable_ImmediatePriority,hy=i.unstable_UserBlockingPriority,ki=i.unstable_NormalPriority,Km=i.unstable_IdlePriority,Nu=null,Cs=null;function Qm(h){if(Cs&&typeof Cs.onCommitFiberRoot=="function")try{Cs.onCommitFiberRoot(Nu,h,void 0,(h.current.flags&128)===128)}catch{}}function dy(h,p){return h===p&&(h!==0||1/h===1/p)||h!==h&&p!==p}var Rs=typeof Object.is=="function"?Object.is:dy,Gi=null,ma=!1,Ys=!1;function jm(h){Gi===null?Gi=[h]:Gi.push(h)}function Ym(h){ma=!0,jm(h)}function ls(){if(!Ys&&Gi!==null){Ys=!0;var h=0,p=fn;try{var _=Gi;for(fn=1;h<_.length;h++){var E=_[h];do E=E(!0);while(E!==null)}Gi=null,ma=!1}catch(T){throw Gi!==null&&(Gi=Gi.slice(h+1)),ja(Lu,ls),T}finally{fn=p,Ys=!1}}return null}var Du=a.ReactCurrentBatchConfig;function Uu(h,p){if(Rs(h,p))return!0;if(typeof h!="object"||h===null||typeof p!="object"||p===null)return!1;var _=Object.keys(h),E=Object.keys(p);if(_.length!==E.length)return!1;for(E=0;E<_.length;E++){var T=_[E];if(!Et.call(p,T)||!Rs(h[T],p[T]))return!1}return!0}function Fu(h){switch(h.tag){case 5:return vt(h.type);case 16:return vt("Lazy");case 13:return vt("Suspense");case 19:return vt("SuspenseList");case 0:case 2:case 15:return h=tt(h.type,!1),h;case 11:return h=tt(h.type.render,!1),h;case 1:return h=tt(h.type,!0),h;default:return""}}function zi(h,p){if(h&&h.defaultProps){p=s({},p),h=h.defaultProps;for(var _ in h)p[_]===void 0&&(p[_]=h[_]);return p}return p}var jr=Vt(null),zh=null,Co=null,Zl=null;function Hh(){Zl=Co=zh=null}function py(h,p,_){Xe?(dt(jr,p._currentValue),p._currentValue=_):(dt(jr,p._currentValue2),p._currentValue2=_)}function Yr(h){var p=jr.current;xt(jr),Xe?h._currentValue=p:h._currentValue2=p}function Hi(h,p,_){for(;h!==null;){var E=h.alternate;if((h.childLanes&p)!==p?(h.childLanes|=p,E!==null&&(E.childLanes|=p)):E!==null&&(E.childLanes&p)!==p&&(E.childLanes|=p),h===_)break;h=h.return}}function _r(h,p){zh=h,Zl=Co=null,h=h.dependencies,h!==null&&h.firstContext!==null&&(h.lanes&p&&(Ls=!0),h.firstContext=null)}function wr(h){var p=Xe?h._currentValue:h._currentValue2;if(Zl!==h)if(h={context:h,memoizedValue:p,next:null},Co===null){if(zh===null)throw Error(o(308));Co=h,zh.dependencies={lanes:0,firstContext:h}}else Co=Co.next=h;return p}var Bs=null,ql=!1;function Pw(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ZR(h,p){h=h.updateQueue,p.updateQueue===h&&(p.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,effects:h.effects})}function Ya(h,p){return{eventTime:h,lane:p,tag:0,payload:null,callback:null,next:null}}function $l(h,p){var _=h.updateQueue;_!==null&&(_=_.shared,Ir!==null&&h.mode&1&&!(cn&2)?(h=_.interleaved,h===null?(p.next=p,Bs===null?Bs=[_]:Bs.push(_)):(p.next=h.next,h.next=p),_.interleaved=p):(h=_.pending,h===null?p.next=p:(p.next=h.next,h.next=p),_.pending=p))}function my(h,p,_){if(p=p.updateQueue,p!==null&&(p=p.shared,(_&4194240)!==0)){var E=p.lanes;E&=h.pendingLanes,_|=E,p.lanes=_,pa(h,_)}}function qR(h,p){var _=h.updateQueue,E=h.alternate;if(E!==null&&(E=E.updateQueue,_===E)){var T=null,I=null;if(_=_.firstBaseUpdate,_!==null){do{var se={eventTime:_.eventTime,lane:_.lane,tag:_.tag,payload:_.payload,callback:_.callback,next:null};I===null?T=I=se:I=I.next=se,_=_.next}while(_!==null);I===null?T=I=p:I=I.next=p}else T=I=p;_={baseState:E.baseState,firstBaseUpdate:T,lastBaseUpdate:I,shared:E.shared,effects:E.effects},h.updateQueue=_;return}h=_.lastBaseUpdate,h===null?_.firstBaseUpdate=p:h.next=p,_.lastBaseUpdate=p}function gy(h,p,_,E){var T=h.updateQueue;ql=!1;var I=T.firstBaseUpdate,se=T.lastBaseUpdate,_e=T.shared.pending;if(_e!==null){T.shared.pending=null;var Qe=_e,ut=Qe.next;Qe.next=null,se===null?I=ut:se.next=ut,se=Qe;var Ct=h.alternate;Ct!==null&&(Ct=Ct.updateQueue,_e=Ct.lastBaseUpdate,_e!==se&&(_e===null?Ct.firstBaseUpdate=ut:_e.next=ut,Ct.lastBaseUpdate=Qe))}if(I!==null){var Yt=T.baseState;se=0,Ct=ut=Qe=null,_e=I;do{var Gt=_e.lane,Gn=_e.eventTime;if((E&Gt)===Gt){Ct!==null&&(Ct=Ct.next={eventTime:Gn,lane:0,tag:_e.tag,payload:_e.payload,callback:_e.callback,next:null});e:{var Nt=h,Si=_e;switch(Gt=p,Gn=_,Si.tag){case 1:if(Nt=Si.payload,typeof Nt=="function"){Yt=Nt.call(Gn,Yt,Gt);break e}Yt=Nt;break e;case 3:Nt.flags=Nt.flags&-65537|128;case 0:if(Nt=Si.payload,Gt=typeof Nt=="function"?Nt.call(Gn,Yt,Gt):Nt,Gt==null)break e;Yt=s({},Yt,Gt);break e;case 2:ql=!0}}_e.callback!==null&&_e.lane!==0&&(h.flags|=64,Gt=T.effects,Gt===null?T.effects=[_e]:Gt.push(_e))}else Gn={eventTime:Gn,lane:Gt,tag:_e.tag,payload:_e.payload,callback:_e.callback,next:null},Ct===null?(ut=Ct=Gn,Qe=Yt):Ct=Ct.next=Gn,se|=Gt;if(_e=_e.next,_e===null){if(_e=T.shared.pending,_e===null)break;Gt=_e,_e=Gt.next,Gt.next=null,T.lastBaseUpdate=Gt,T.shared.pending=null}}while(1);if(Ct===null&&(Qe=Yt),T.baseState=Qe,T.firstBaseUpdate=ut,T.lastBaseUpdate=Ct,p=T.shared.interleaved,p!==null){T=p;do se|=T.lane,T=T.next;while(T!==p)}else I===null&&(T.shared.lanes=0);Zh|=se,h.lanes=se,h.memoizedState=Yt}}function $R(h,p,_){if(h=p.effects,p.effects=null,h!==null)for(p=0;p<h.length;p++){var E=h[p],T=E.callback;if(T!==null){if(E.callback=null,E=_,typeof T!="function")throw Error(o(191,T));T.call(E)}}}var eB=new r.Component().refs;function Iw(h,p,_,E){p=h.memoizedState,_=_(E,p),_=_==null?p:s({},p,_),h.memoizedState=_,h.lanes===0&&(h.updateQueue.baseState=_)}var vy={isMounted:function(h){return(h=h._reactInternals)?C(h)===h:!1},enqueueSetState:function(h,p,_){h=h._reactInternals;var E=Wi(),T=nc(h),I=Ya(E,T);I.payload=p,_!=null&&(I.callback=_),$l(h,I),p=to(h,T,E),p!==null&&my(p,h,T)},enqueueReplaceState:function(h,p,_){h=h._reactInternals;var E=Wi(),T=nc(h),I=Ya(E,T);I.tag=1,I.payload=p,_!=null&&(I.callback=_),$l(h,I),p=to(h,T,E),p!==null&&my(p,h,T)},enqueueForceUpdate:function(h,p){h=h._reactInternals;var _=Wi(),E=nc(h),T=Ya(_,E);T.tag=2,p!=null&&(T.callback=p),$l(h,T),p=to(h,E,_),p!==null&&my(p,h,E)}};function tB(h,p,_,E,T,I,se){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(E,I,se):p.prototype&&p.prototype.isPureReactComponent?!Uu(_,E)||!Uu(T,I):!0}function nB(h,p,_){var E=!1,T=Kt,I=p.contextType;return typeof I=="object"&&I!==null?I=wr(I):(T=Nn(p)?bn:Ut.current,E=p.contextTypes,I=(E=E!=null)?Ln(h,T):Kt),p=new p(_,I),h.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=vy,h.stateNode=p,p._reactInternals=h,E&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=T,h.__reactInternalMemoizedMaskedChildContext=I),p}function rB(h,p,_,E){h=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(_,E),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(_,E),p.state!==h&&vy.enqueueReplaceState(p,p.state,null)}function Lw(h,p,_,E){var T=h.stateNode;T.props=_,T.state=h.memoizedState,T.refs=eB,Pw(h);var I=p.contextType;typeof I=="object"&&I!==null?T.context=wr(I):(I=Nn(p)?bn:Ut.current,T.context=Ln(h,I)),T.state=h.memoizedState,I=p.getDerivedStateFromProps,typeof I=="function"&&(Iw(h,p,I,_),T.state=h.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(p=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),p!==T.state&&vy.enqueueReplaceState(T,T.state,null),gy(h,_,T,E),T.state=h.memoizedState),typeof T.componentDidMount=="function"&&(h.flags|=4194308)}var Vh=[],Wh=0,yy=null,xy=0,Zs=[],qs=0,Ou=null,Za=1,qa="";function ku(h,p){Vh[Wh++]=xy,Vh[Wh++]=yy,yy=h,xy=p}function iB(h,p,_){Zs[qs++]=Za,Zs[qs++]=qa,Zs[qs++]=Ou,Ou=h;var E=Za;h=qa;var T=32-Dn(E)-1;E&=~(1<<T),_+=1;var I=32-Dn(p)+T;if(30<I){var se=T-T%5;I=(E&(1<<se)-1).toString(32),E>>=se,T-=se,Za=1<<32-Dn(p)+T|_<<T|E,qa=I+h}else Za=1<<I|_<<T|E,qa=h}function Nw(h){h.return!==null&&(ku(h,1),iB(h,1,0))}function Dw(h){for(;h===yy;)yy=Vh[--Wh],Vh[Wh]=null,xy=Vh[--Wh],Vh[Wh]=null;for(;h===Ou;)Ou=Zs[--qs],Zs[qs]=null,qa=Zs[--qs],Zs[qs]=null,Za=Zs[--qs],Zs[qs]=null}var Ps=null,Is=null,Zn=!1,Zm=!1,Ro=null;function sB(h,p){var _=no(5,null,null,0);_.elementType="DELETED",_.stateNode=p,_.return=h,p=h.deletions,p===null?(h.deletions=[_],h.flags|=16):p.push(_)}function oB(h,p){switch(h.tag){case 5:return p=Ft(p,h.type,h.pendingProps),p!==null?(h.stateNode=p,Ps=h,Is=Ot(p),!0):!1;case 6:return p=ln(p,h.pendingProps),p!==null?(h.stateNode=p,Ps=h,Is=null,!0):!1;case 13:if(p=zn(p),p!==null){var _=Ou!==null?{id:Za,overflow:qa}:null;return h.memoizedState={dehydrated:p,treeContext:_,retryLane:1073741824},_=no(18,null,null,0),_.stateNode=p,_.return=h,h.child=_,Ps=h,Is=null,!0}return!1;default:return!1}}function Uw(h){return(h.mode&1)!==0&&(h.flags&128)===0}function Fw(h){if(Zn){var p=Is;if(p){var _=p;if(!oB(h,p)){if(Uw(h))throw Error(o(418));p=dr(_);var E=Ps;p&&oB(h,p)?sB(E,_):(h.flags=h.flags&-4097|2,Zn=!1,Ps=h)}}else{if(Uw(h))throw Error(o(418));h.flags=h.flags&-4097|2,Zn=!1,Ps=h}}}function aB(h){for(h=h.return;h!==null&&h.tag!==5&&h.tag!==3&&h.tag!==13;)h=h.return;Ps=h}function qm(h){if(!Te||h!==Ps)return!1;if(!Zn)return aB(h),Zn=!0,!1;if(h.tag!==3&&(h.tag!==5||Pe(h.type)&&!fe(h.type,h.memoizedProps))){var p=Is;if(p){if(Uw(h)){for(h=Is;h;)h=dr(h);throw Error(o(418))}for(;p;)sB(h,p),p=dr(p)}}if(aB(h),h.tag===13){if(!Te)throw Error(o(316));if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(o(317));Is=L(h)}else Is=Ps?dr(h.stateNode):null;return!0}function Xh(){Te&&(Is=Ps=null,Zm=Zn=!1)}function Ow(h){Ro===null?Ro=[h]:Ro.push(h)}function $m(h,p,_){if(h=_.ref,h!==null&&typeof h!="function"&&typeof h!="object"){if(_._owner){if(_=_._owner,_){if(_.tag!==1)throw Error(o(309));var E=_.stateNode}if(!E)throw Error(o(147,h));var T=E,I=""+h;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===I?p.ref:(p=function(se){var _e=T.refs;_e===eB&&(_e=T.refs={}),se===null?delete _e[I]:_e[I]=se},p._stringRef=I,p)}if(typeof h!="string")throw Error(o(284));if(!_._owner)throw Error(o(290,h))}return h}function Ay(h,p){throw h=Object.prototype.toString.call(p),Error(o(31,h==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":h))}function lB(h){var p=h._init;return p(h._payload)}function cB(h){function p(Ne,Se){if(h){var He=Ne.deletions;He===null?(Ne.deletions=[Se],Ne.flags|=16):He.push(Se)}}function _(Ne,Se){if(!h)return null;for(;Se!==null;)p(Ne,Se),Se=Se.sibling;return null}function E(Ne,Se){for(Ne=new Map;Se!==null;)Se.key!==null?Ne.set(Se.key,Se):Ne.set(Se.index,Se),Se=Se.sibling;return Ne}function T(Ne,Se){return Ne=ic(Ne,Se),Ne.index=0,Ne.sibling=null,Ne}function I(Ne,Se,He){return Ne.index=He,h?(He=Ne.alternate,He!==null?(He=He.index,He<Se?(Ne.flags|=2,Se):He):(Ne.flags|=2,Se)):(Ne.flags|=1048576,Se)}function se(Ne){return h&&Ne.alternate===null&&(Ne.flags|=2),Ne}function _e(Ne,Se,He,wt){return Se===null||Se.tag!==6?(Se=_E(He,Ne.mode,wt),Se.return=Ne,Se):(Se=T(Se,He),Se.return=Ne,Se)}function Qe(Ne,Se,He,wt){var It=He.type;return It===u?Ct(Ne,Se,He.props.children,wt,He.key):Se!==null&&(Se.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===w&&lB(It)===Se.type)?(wt=T(Se,He.props),wt.ref=$m(Ne,Se,He),wt.return=Ne,wt):(wt=Zy(He.type,He.key,He.props,null,Ne.mode,wt),wt.ref=$m(Ne,Se,He),wt.return=Ne,wt)}function ut(Ne,Se,He,wt){return Se===null||Se.tag!==4||Se.stateNode.containerInfo!==He.containerInfo||Se.stateNode.implementation!==He.implementation?(Se=wE(He,Ne.mode,wt),Se.return=Ne,Se):(Se=T(Se,He.children||[]),Se.return=Ne,Se)}function Ct(Ne,Se,He,wt,It){return Se===null||Se.tag!==7?(Se=Ju(He,Ne.mode,wt,It),Se.return=Ne,Se):(Se=T(Se,He),Se.return=Ne,Se)}function Yt(Ne,Se,He){if(typeof Se=="string"&&Se!==""||typeof Se=="number")return Se=_E(""+Se,Ne.mode,He),Se.return=Ne,Se;if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case l:return He=Zy(Se.type,Se.key,Se.props,null,Ne.mode,He),He.ref=$m(Ne,null,Se),He.return=Ne,He;case c:return Se=wE(Se,Ne.mode,He),Se.return=Ne,Se;case w:var wt=Se._init;return Yt(Ne,wt(Se._payload),He)}if(z(Se)||b(Se))return Se=Ju(Se,Ne.mode,He,null),Se.return=Ne,Se;Ay(Ne,Se)}return null}function Gt(Ne,Se,He,wt){var It=Se!==null?Se.key:null;if(typeof He=="string"&&He!==""||typeof He=="number")return It!==null?null:_e(Ne,Se,""+He,wt);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case l:return He.key===It?Qe(Ne,Se,He,wt):null;case c:return He.key===It?ut(Ne,Se,He,wt):null;case w:return It=He._init,Gt(Ne,Se,It(He._payload),wt)}if(z(He)||b(He))return It!==null?null:Ct(Ne,Se,He,wt,null);Ay(Ne,He)}return null}function Gn(Ne,Se,He,wt,It){if(typeof wt=="string"&&wt!==""||typeof wt=="number")return Ne=Ne.get(He)||null,_e(Se,Ne,""+wt,It);if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case l:return Ne=Ne.get(wt.key===null?He:wt.key)||null,Qe(Se,Ne,wt,It);case c:return Ne=Ne.get(wt.key===null?He:wt.key)||null,ut(Se,Ne,wt,It);case w:var rn=wt._init;return Gn(Ne,Se,He,rn(wt._payload),It)}if(z(wt)||b(wt))return Ne=Ne.get(He)||null,Ct(Se,Ne,wt,It,null);Ay(Se,wt)}return null}function Nt(Ne,Se,He,wt){for(var It=null,rn=null,Zt=Se,Mn=Se=0,qr=null;Zt!==null&&Mn<He.length;Mn++){Zt.index>Mn?(qr=Zt,Zt=null):qr=Zt.sibling;var Tn=Gt(Ne,Zt,He[Mn],wt);if(Tn===null){Zt===null&&(Zt=qr);break}h&&Zt&&Tn.alternate===null&&p(Ne,Zt),Se=I(Tn,Se,Mn),rn===null?It=Tn:rn.sibling=Tn,rn=Tn,Zt=qr}if(Mn===He.length)return _(Ne,Zt),Zn&&ku(Ne,Mn),It;if(Zt===null){for(;Mn<He.length;Mn++)Zt=Yt(Ne,He[Mn],wt),Zt!==null&&(Se=I(Zt,Se,Mn),rn===null?It=Zt:rn.sibling=Zt,rn=Zt);return Zn&&ku(Ne,Mn),It}for(Zt=E(Ne,Zt);Mn<He.length;Mn++)qr=Gn(Zt,Ne,Mn,He[Mn],wt),qr!==null&&(h&&qr.alternate!==null&&Zt.delete(qr.key===null?Mn:qr.key),Se=I(qr,Se,Mn),rn===null?It=qr:rn.sibling=qr,rn=qr);return h&&Zt.forEach(function(sc){return p(Ne,sc)}),Zn&&ku(Ne,Mn),It}function Si(Ne,Se,He,wt){var It=b(He);if(typeof It!="function")throw Error(o(150));if(He=It.call(He),He==null)throw Error(o(151));for(var rn=It=null,Zt=Se,Mn=Se=0,qr=null,Tn=He.next();Zt!==null&&!Tn.done;Mn++,Tn=He.next()){Zt.index>Mn?(qr=Zt,Zt=null):qr=Zt.sibling;var sc=Gt(Ne,Zt,Tn.value,wt);if(sc===null){Zt===null&&(Zt=qr);break}h&&Zt&&sc.alternate===null&&p(Ne,Zt),Se=I(sc,Se,Mn),rn===null?It=sc:rn.sibling=sc,rn=sc,Zt=qr}if(Tn.done)return _(Ne,Zt),Zn&&ku(Ne,Mn),It;if(Zt===null){for(;!Tn.done;Mn++,Tn=He.next())Tn=Yt(Ne,Tn.value,wt),Tn!==null&&(Se=I(Tn,Se,Mn),rn===null?It=Tn:rn.sibling=Tn,rn=Tn);return Zn&&ku(Ne,Mn),It}for(Zt=E(Ne,Zt);!Tn.done;Mn++,Tn=He.next())Tn=Gn(Zt,Ne,Mn,Tn.value,wt),Tn!==null&&(h&&Tn.alternate!==null&&Zt.delete(Tn.key===null?Mn:Tn.key),Se=I(Tn,Se,Mn),rn===null?It=Tn:rn.sibling=Tn,rn=Tn);return h&&Zt.forEach(function(jH){return p(Ne,jH)}),Zn&&ku(Ne,Mn),It}function ro(Ne,Se,He,wt){if(typeof He=="object"&&He!==null&&He.type===u&&He.key===null&&(He=He.props.children),typeof He=="object"&&He!==null){switch(He.$$typeof){case l:e:{for(var It=He.key,rn=Se;rn!==null;){if(rn.key===It){if(It=He.type,It===u){if(rn.tag===7){_(Ne,rn.sibling),Se=T(rn,He.props.children),Se.return=Ne,Ne=Se;break e}}else if(rn.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===w&&lB(It)===rn.type){_(Ne,rn.sibling),Se=T(rn,He.props),Se.ref=$m(Ne,rn,He),Se.return=Ne,Ne=Se;break e}_(Ne,rn);break}else p(Ne,rn);rn=rn.sibling}He.type===u?(Se=Ju(He.props.children,Ne.mode,wt,He.key),Se.return=Ne,Ne=Se):(wt=Zy(He.type,He.key,He.props,null,Ne.mode,wt),wt.ref=$m(Ne,Se,He),wt.return=Ne,Ne=wt)}return se(Ne);case c:e:{for(rn=He.key;Se!==null;){if(Se.key===rn)if(Se.tag===4&&Se.stateNode.containerInfo===He.containerInfo&&Se.stateNode.implementation===He.implementation){_(Ne,Se.sibling),Se=T(Se,He.children||[]),Se.return=Ne,Ne=Se;break e}else{_(Ne,Se);break}else p(Ne,Se);Se=Se.sibling}Se=wE(He,Ne.mode,wt),Se.return=Ne,Ne=Se}return se(Ne);case w:return rn=He._init,ro(Ne,Se,rn(He._payload),wt)}if(z(He))return Nt(Ne,Se,He,wt);if(b(He))return Si(Ne,Se,He,wt);Ay(Ne,He)}return typeof He=="string"&&He!==""||typeof He=="number"?(He=""+He,Se!==null&&Se.tag===6?(_(Ne,Se.sibling),Se=T(Se,He),Se.return=Ne,Ne=Se):(_(Ne,Se),Se=_E(He,Ne.mode,wt),Se.return=Ne,Ne=Se),se(Ne)):_(Ne,Se)}return ro}var Jh=cB(!0),uB=cB(!1),eg={},$s=Vt(eg),tg=Vt(eg),Kh=Vt(eg);function ga(h){if(h===eg)throw Error(o(174));return h}function kw(h,p){dt(Kh,p),dt(tg,h),dt($s,eg),h=ie(p),xt($s),dt($s,h)}function Qh(){xt($s),xt(tg),xt(Kh)}function fB(h){var p=ga(Kh.current),_=ga($s.current);p=X(_,h.type,p),_!==p&&(dt(tg,h),dt($s,p))}function Gw(h){tg.current===h&&(xt($s),xt(tg))}var ir=Vt(0);function _y(h){for(var p=h;p!==null;){if(p.tag===13){var _=p.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||zr(_)||oi(_)))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if(p.flags&128)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===h)break;for(;p.sibling===null;){if(p.return===null||p.return===h)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var zw=[];function Hw(){for(var h=0;h<zw.length;h++){var p=zw[h];Xe?p._workInProgressVersionPrimary=null:p._workInProgressVersionSecondary=null}zw.length=0}var wy=a.ReactCurrentDispatcher,eo=a.ReactCurrentBatchConfig,jh=0,pr=null,_i=null,Zr=null,Ey=!1,ng=!1,rg=0,AH=0;function wi(){throw Error(o(321))}function Vw(h,p){if(p===null)return!1;for(var _=0;_<p.length&&_<h.length;_++)if(!Rs(h[_],p[_]))return!1;return!0}function Ww(h,p,_,E,T,I){if(jh=I,pr=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,wy.current=h===null||h.memoizedState===null?SH:bH,h=_(E,T),ng){I=0;do{if(ng=!1,rg=0,25<=I)throw Error(o(301));I+=1,Zr=_i=null,p.updateQueue=null,wy.current=MH,h=_(E,T)}while(ng)}if(wy.current=Cy,p=_i!==null&&_i.next!==null,jh=0,Zr=_i=pr=null,Ey=!1,p)throw Error(o(300));return h}function Xw(){var h=rg!==0;return rg=0,h}function $a(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zr===null?pr.memoizedState=Zr=h:Zr=Zr.next=h,Zr}function va(){if(_i===null){var h=pr.alternate;h=h!==null?h.memoizedState:null}else h=_i.next;var p=Zr===null?pr.memoizedState:Zr.next;if(p!==null)Zr=p,_i=h;else{if(h===null)throw Error(o(310));_i=h,h={memoizedState:_i.memoizedState,baseState:_i.baseState,baseQueue:_i.baseQueue,queue:_i.queue,next:null},Zr===null?pr.memoizedState=Zr=h:Zr=Zr.next=h}return Zr}function Gu(h,p){return typeof p=="function"?p(h):p}function Sy(h){var p=va(),_=p.queue;if(_===null)throw Error(o(311));_.lastRenderedReducer=h;var E=_i,T=E.baseQueue,I=_.pending;if(I!==null){if(T!==null){var se=T.next;T.next=I.next,I.next=se}E.baseQueue=T=I,_.pending=null}if(T!==null){I=T.next,E=E.baseState;var _e=se=null,Qe=null,ut=I;do{var Ct=ut.lane;if((jh&Ct)===Ct)Qe!==null&&(Qe=Qe.next={lane:0,action:ut.action,hasEagerState:ut.hasEagerState,eagerState:ut.eagerState,next:null}),E=ut.hasEagerState?ut.eagerState:h(E,ut.action);else{var Yt={lane:Ct,action:ut.action,hasEagerState:ut.hasEagerState,eagerState:ut.eagerState,next:null};Qe===null?(_e=Qe=Yt,se=E):Qe=Qe.next=Yt,pr.lanes|=Ct,Zh|=Ct}ut=ut.next}while(ut!==null&&ut!==I);Qe===null?se=E:Qe.next=_e,Rs(E,p.memoizedState)||(Ls=!0),p.memoizedState=E,p.baseState=se,p.baseQueue=Qe,_.lastRenderedState=E}if(h=_.interleaved,h!==null){T=h;do I=T.lane,pr.lanes|=I,Zh|=I,T=T.next;while(T!==h)}else T===null&&(_.lanes=0);return[p.memoizedState,_.dispatch]}function by(h){var p=va(),_=p.queue;if(_===null)throw Error(o(311));_.lastRenderedReducer=h;var E=_.dispatch,T=_.pending,I=p.memoizedState;if(T!==null){_.pending=null;var se=T=T.next;do I=h(I,se.action),se=se.next;while(se!==T);Rs(I,p.memoizedState)||(Ls=!0),p.memoizedState=I,p.baseQueue===null&&(p.baseState=I),_.lastRenderedState=I}return[I,E]}function hB(){}function dB(h,p){var _=pr,E=va(),T=p(),I=!Rs(E.memoizedState,T);if(I&&(E.memoizedState=T,Ls=!0),E=E.queue,sg(gB.bind(null,_,E,h),[h]),E.getSnapshot!==p||I||Zr!==null&&Zr.memoizedState.tag&1){if(_.flags|=2048,ig(9,mB.bind(null,_,E,T,p),void 0,null),Ir===null)throw Error(o(349));jh&30||pB(_,p,T)}return T}function pB(h,p,_){h.flags|=16384,h={getSnapshot:p,value:_},p=pr.updateQueue,p===null?(p={lastEffect:null,stores:null},pr.updateQueue=p,p.stores=[h]):(_=p.stores,_===null?p.stores=[h]:_.push(h))}function mB(h,p,_,E){p.value=_,p.getSnapshot=E,vB(p)&&to(h,1,-1)}function gB(h,p,_){return _(function(){vB(p)&&to(h,1,-1)})}function vB(h){var p=h.getSnapshot;h=h.value;try{var _=p();return!Rs(h,_)}catch{return!0}}function Jw(h){var p=$a();return typeof h=="function"&&(h=h()),p.memoizedState=p.baseState=h,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gu,lastRenderedState:h},p.queue=h,h=h.dispatch=EH.bind(null,pr,h),[p.memoizedState,h]}function ig(h,p,_,E){return h={tag:h,create:p,destroy:_,deps:E,next:null},p=pr.updateQueue,p===null?(p={lastEffect:null,stores:null},pr.updateQueue=p,p.lastEffect=h.next=h):(_=p.lastEffect,_===null?p.lastEffect=h.next=h:(E=_.next,_.next=h,h.next=E,p.lastEffect=h)),h}function yB(){return va().memoizedState}function My(h,p,_,E){var T=$a();pr.flags|=h,T.memoizedState=ig(1|p,_,void 0,E===void 0?null:E)}function Ty(h,p,_,E){var T=va();E=E===void 0?null:E;var I=void 0;if(_i!==null){var se=_i.memoizedState;if(I=se.destroy,E!==null&&Vw(E,se.deps)){T.memoizedState=ig(p,_,I,E);return}}pr.flags|=h,T.memoizedState=ig(1|p,_,I,E)}function Kw(h,p){return My(8390656,8,h,p)}function sg(h,p){return Ty(2048,8,h,p)}function xB(h,p){return Ty(4,2,h,p)}function AB(h,p){return Ty(4,4,h,p)}function _B(h,p){if(typeof p=="function")return h=h(),p(h),function(){p(null)};if(p!=null)return h=h(),p.current=h,function(){p.current=null}}function wB(h,p,_){return _=_!=null?_.concat([h]):null,Ty(4,4,_B.bind(null,p,h),_)}function Qw(){}function EB(h,p){var _=va();p=p===void 0?null:p;var E=_.memoizedState;return E!==null&&p!==null&&Vw(p,E[1])?E[0]:(_.memoizedState=[h,p],h)}function SB(h,p){var _=va();p=p===void 0?null:p;var E=_.memoizedState;return E!==null&&p!==null&&Vw(p,E[1])?E[0]:(h=h(),_.memoizedState=[h,p],h)}function _H(h,p){var _=fn;fn=_!==0&&4>_?_:4,h(!0);var E=eo.transition;eo.transition={};try{h(!1),p()}finally{fn=_,eo.transition=E}}function bB(){return va().memoizedState}function wH(h,p,_){var E=nc(h);_={lane:E,action:_,hasEagerState:!1,eagerState:null,next:null},MB(h)?TB(p,_):(CB(h,p,_),_=Wi(),h=to(h,E,_),h!==null&&RB(h,p,E))}function EH(h,p,_){var E=nc(h),T={lane:E,action:_,hasEagerState:!1,eagerState:null,next:null};if(MB(h))TB(p,T);else{CB(h,p,T);var I=h.alternate;if(h.lanes===0&&(I===null||I.lanes===0)&&(I=p.lastRenderedReducer,I!==null))try{var se=p.lastRenderedState,_e=I(se,_);if(T.hasEagerState=!0,T.eagerState=_e,Rs(_e,se))return}catch{}finally{}_=Wi(),h=to(h,E,_),h!==null&&RB(h,p,E)}}function MB(h){var p=h.alternate;return h===pr||p!==null&&p===pr}function TB(h,p){ng=Ey=!0;var _=h.pending;_===null?p.next=p:(p.next=_.next,_.next=p),h.pending=p}function CB(h,p,_){Ir!==null&&h.mode&1&&!(cn&2)?(h=p.interleaved,h===null?(_.next=_,Bs===null?Bs=[p]:Bs.push(p)):(_.next=h.next,h.next=_),p.interleaved=_):(h=p.pending,h===null?_.next=_:(_.next=h.next,h.next=_),p.pending=_)}function RB(h,p,_){if(_&4194240){var E=p.lanes;E&=h.pendingLanes,_|=E,p.lanes=_,pa(h,_)}}var Cy={readContext:wr,useCallback:wi,useContext:wi,useEffect:wi,useImperativeHandle:wi,useInsertionEffect:wi,useLayoutEffect:wi,useMemo:wi,useReducer:wi,useRef:wi,useState:wi,useDebugValue:wi,useDeferredValue:wi,useTransition:wi,useMutableSource:wi,useSyncExternalStore:wi,useId:wi,unstable_isNewReconciler:!1},SH={readContext:wr,useCallback:function(h,p){return $a().memoizedState=[h,p===void 0?null:p],h},useContext:wr,useEffect:Kw,useImperativeHandle:function(h,p,_){return _=_!=null?_.concat([h]):null,My(4194308,4,_B.bind(null,p,h),_)},useLayoutEffect:function(h,p){return My(4194308,4,h,p)},useInsertionEffect:function(h,p){return My(4,2,h,p)},useMemo:function(h,p){var _=$a();return p=p===void 0?null:p,h=h(),_.memoizedState=[h,p],h},useReducer:function(h,p,_){var E=$a();return p=_!==void 0?_(p):p,E.memoizedState=E.baseState=p,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:p},E.queue=h,h=h.dispatch=wH.bind(null,pr,h),[E.memoizedState,h]},useRef:function(h){var p=$a();return h={current:h},p.memoizedState=h},useState:Jw,useDebugValue:Qw,useDeferredValue:function(h){var p=Jw(h),_=p[0],E=p[1];return Kw(function(){var T=eo.transition;eo.transition={};try{E(h)}finally{eo.transition=T}},[h]),_},useTransition:function(){var h=Jw(!1),p=h[0];return h=_H.bind(null,h[1]),$a().memoizedState=h,[p,h]},useMutableSource:function(){},useSyncExternalStore:function(h,p,_){var E=pr,T=$a();if(Zn){if(_===void 0)throw Error(o(407));_=_()}else{if(_=p(),Ir===null)throw Error(o(349));jh&30||pB(E,p,_)}T.memoizedState=_;var I={value:_,getSnapshot:p};return T.queue=I,Kw(gB.bind(null,E,I,h),[h]),E.flags|=2048,ig(9,mB.bind(null,E,I,_,p),void 0,null),_},useId:function(){var h=$a(),p=Ir.identifierPrefix;if(Zn){var _=qa,E=Za;_=(E&~(1<<32-Dn(E)-1)).toString(32)+_,p=":"+p+"R"+_,_=rg++,0<_&&(p+="H"+_.toString(32)),p+=":"}else _=AH++,p=":"+p+"r"+_.toString(32)+":";return h.memoizedState=p},unstable_isNewReconciler:!1},bH={readContext:wr,useCallback:EB,useContext:wr,useEffect:sg,useImperativeHandle:wB,useInsertionEffect:xB,useLayoutEffect:AB,useMemo:SB,useReducer:Sy,useRef:yB,useState:function(){return Sy(Gu)},useDebugValue:Qw,useDeferredValue:function(h){var p=Sy(Gu),_=p[0],E=p[1];return sg(function(){var T=eo.transition;eo.transition={};try{E(h)}finally{eo.transition=T}},[h]),_},useTransition:function(){var h=Sy(Gu)[0],p=va().memoizedState;return[h,p]},useMutableSource:hB,useSyncExternalStore:dB,useId:bB,unstable_isNewReconciler:!1},MH={readContext:wr,useCallback:EB,useContext:wr,useEffect:sg,useImperativeHandle:wB,useInsertionEffect:xB,useLayoutEffect:AB,useMemo:SB,useReducer:by,useRef:yB,useState:function(){return by(Gu)},useDebugValue:Qw,useDeferredValue:function(h){var p=by(Gu),_=p[0],E=p[1];return sg(function(){var T=eo.transition;eo.transition={};try{E(h)}finally{eo.transition=T}},[h]),_},useTransition:function(){var h=by(Gu)[0],p=va().memoizedState;return[h,p]},useMutableSource:hB,useSyncExternalStore:dB,useId:bB,unstable_isNewReconciler:!1};function jw(h,p){try{var _="",E=p;do _+=Fu(E),E=E.return;while(E);var T=_}catch(I){T=`
Error generating stack: `+I.message+`
`+I.stack}return{value:h,source:p,stack:T}}function Yw(h,p){try{console.error(p.value)}catch(_){setTimeout(function(){throw _})}}var TH=typeof WeakMap=="function"?WeakMap:Map;function BB(h,p,_){_=Ya(-1,_),_.tag=3,_.payload={element:null};var E=p.value;return _.callback=function(){Wy||(Wy=!0,pE=E),Yw(h,p)},_}function PB(h,p,_){_=Ya(-1,_),_.tag=3;var E=h.type.getDerivedStateFromError;if(typeof E=="function"){var T=p.value;_.payload=function(){return E(T)},_.callback=function(){Yw(h,p)}}var I=h.stateNode;return I!==null&&typeof I.componentDidCatch=="function"&&(_.callback=function(){Yw(h,p),typeof E!="function"&&(ec===null?ec=new Set([this]):ec.add(this));var se=p.stack;this.componentDidCatch(p.value,{componentStack:se!==null?se:""})}),_}function IB(h,p,_){var E=h.pingCache;if(E===null){E=h.pingCache=new TH;var T=new Set;E.set(p,T)}else T=E.get(p),T===void 0&&(T=new Set,E.set(p,T));T.has(_)||(T.add(_),h=zH.bind(null,h,p,_),p.then(h,h))}function LB(h){do{var p;if((p=h.tag===13)&&(p=h.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return h;h=h.return}while(h!==null);return null}function NB(h,p,_,E,T){return h.mode&1?(h.flags|=65536,h.lanes=T,h):(h===p?h.flags|=65536:(h.flags|=128,_.flags|=131072,_.flags&=-52805,_.tag===1&&(_.alternate===null?_.tag=17:(p=Ya(-1,1),p.tag=2,$l(_,p))),_.lanes|=1),h)}function ya(h){h.flags|=4}function DB(h,p){if(h!==null&&h.child===p.child)return!0;if(p.flags&16)return!1;for(h=p.child;h!==null;){if(h.flags&12854||h.subtreeFlags&12854)return!1;h=h.sibling}return!0}var og,ag,Ry,By;if(Fe)og=function(h,p){for(var _=p.child;_!==null;){if(_.tag===5||_.tag===6)Q(h,_.stateNode);else if(_.tag!==4&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===p)break;for(;_.sibling===null;){if(_.return===null||_.return===p)return;_=_.return}_.sibling.return=_.return,_=_.sibling}},ag=function(){},Ry=function(h,p,_,E,T){if(h=h.memoizedProps,h!==E){var I=p.stateNode,se=ga($s.current);_=ne(I,_,h,E,T,se),(p.updateQueue=_)&&ya(p)}},By=function(h,p,_,E){_!==E&&ya(p)};else if(j){og=function(h,p,_,E){for(var T=p.child;T!==null;){if(T.tag===5){var I=T.stateNode;_&&E&&(I=Dt(I,T.type,T.memoizedProps,T)),Q(h,I)}else if(T.tag===6)I=T.stateNode,_&&E&&(I=qt(I,T.memoizedProps,T)),Q(h,I);else if(T.tag!==4){if(T.tag===22&&T.memoizedState!==null)I=T.child,I!==null&&(I.return=T),og(h,T,!0,!0);else if(T.child!==null){T.child.return=T,T=T.child;continue}}if(T===p)break;for(;T.sibling===null;){if(T.return===null||T.return===p)return;T=T.return}T.sibling.return=T.return,T=T.sibling}};var UB=function(h,p,_,E){for(var T=p.child;T!==null;){if(T.tag===5){var I=T.stateNode;_&&E&&(I=Dt(I,T.type,T.memoizedProps,T)),ft(h,I)}else if(T.tag===6)I=T.stateNode,_&&E&&(I=qt(I,T.memoizedProps,T)),ft(h,I);else if(T.tag!==4){if(T.tag===22&&T.memoizedState!==null)I=T.child,I!==null&&(I.return=T),UB(h,T,!0,!0);else if(T.child!==null){T.child.return=T,T=T.child;continue}}if(T===p)break;for(;T.sibling===null;){if(T.return===null||T.return===p)return;T=T.return}T.sibling.return=T.return,T=T.sibling}};ag=function(h,p){var _=p.stateNode;if(!DB(h,p)){h=_.containerInfo;var E=ct(h);UB(E,p,!1,!1),_.pendingChildren=E,ya(p),Tt(h,E)}},Ry=function(h,p,_,E,T){var I=h.stateNode,se=h.memoizedProps;if((h=DB(h,p))&&se===E)p.stateNode=I;else{var _e=p.stateNode,Qe=ga($s.current),ut=null;se!==E&&(ut=ne(_e,_,se,E,T,Qe)),h&&ut===null?p.stateNode=I:(I=$e(I,ut,_,se,E,p,h,_e),q(I,_,E,T,Qe)&&ya(p),p.stateNode=I,h?ya(p):og(I,p,!1,!1))}},By=function(h,p,_,E){_!==E?(h=ga(Kh.current),_=ga($s.current),p.stateNode=pe(E,h,_,p),ya(p)):p.stateNode=h.stateNode}}else ag=function(){},Ry=function(){},By=function(){};function lg(h,p){if(!Zn)switch(h.tailMode){case"hidden":p=h.tail;for(var _=null;p!==null;)p.alternate!==null&&(_=p),p=p.sibling;_===null?h.tail=null:_.sibling=null;break;case"collapsed":_=h.tail;for(var E=null;_!==null;)_.alternate!==null&&(E=_),_=_.sibling;E===null?p||h.tail===null?h.tail=null:h.tail.sibling=null:E.sibling=null}}function Ei(h){var p=h.alternate!==null&&h.alternate.child===h.child,_=0,E=0;if(p)for(var T=h.child;T!==null;)_|=T.lanes|T.childLanes,E|=T.subtreeFlags&14680064,E|=T.flags&14680064,T.return=h,T=T.sibling;else for(T=h.child;T!==null;)_|=T.lanes|T.childLanes,E|=T.subtreeFlags,E|=T.flags,T.return=h,T=T.sibling;return h.subtreeFlags|=E,h.childLanes=_,p}function CH(h,p,_){var E=p.pendingProps;switch(Dw(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ei(p),null;case 1:return Nn(p.type)&&en(),Ei(p),null;case 3:return E=p.stateNode,Qh(),xt(kt),xt(Ut),Hw(),E.pendingContext&&(E.context=E.pendingContext,E.pendingContext=null),(h===null||h.child===null)&&(qm(p)?ya(p):h===null||h.memoizedState.isDehydrated&&!(p.flags&256)||(p.flags|=1024,Ro!==null&&(vE(Ro),Ro=null))),ag(h,p),Ei(p),null;case 5:Gw(p),_=ga(Kh.current);var T=p.type;if(h!==null&&p.stateNode!=null)Ry(h,p,T,E,_),h.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!E){if(p.stateNode===null)throw Error(o(166));return Ei(p),null}if(h=ga($s.current),qm(p)){if(!Te)throw Error(o(175));h=D(p.stateNode,p.type,p.memoizedProps,_,h,p,!Zm),p.updateQueue=h,h!==null&&ya(p)}else{var I=V(T,E,_,h,p);og(I,p,!1,!1),p.stateNode=I,q(I,T,E,_,h)&&ya(p)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return Ei(p),null;case 6:if(h&&p.stateNode!=null)By(h,p,h.memoizedProps,E);else{if(typeof E!="string"&&p.stateNode===null)throw Error(o(166));if(h=ga(Kh.current),_=ga($s.current),qm(p)){if(!Te)throw Error(o(176));if(h=p.stateNode,E=p.memoizedProps,(_=Z(h,E,p,!Zm))&&(T=Ps,T!==null))switch(I=(T.mode&1)!==0,T.tag){case 3:ke(T.stateNode.containerInfo,h,E,I);break;case 5:We(T.type,T.memoizedProps,T.stateNode,h,E,I)}_&&ya(p)}else p.stateNode=pe(E,h,_,p)}return Ei(p),null;case 13:if(xt(ir),E=p.memoizedState,Zn&&Is!==null&&p.mode&1&&!(p.flags&128)){for(h=Is;h;)h=dr(h);return Xh(),p.flags|=98560,p}if(E!==null&&E.dehydrated!==null){if(E=qm(p),h===null){if(!E)throw Error(o(318));if(!Te)throw Error(o(344));if(h=p.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(o(317));me(h,p)}else Xh(),!(p.flags&128)&&(p.memoizedState=null),p.flags|=4;return Ei(p),null}return Ro!==null&&(vE(Ro),Ro=null),p.flags&128?(p.lanes=_,p):(E=E!==null,_=!1,h===null?qm(p):_=h.memoizedState!==null,E&&!_&&(p.child.flags|=8192,p.mode&1&&(h===null||ir.current&1?Hr===0&&(Hr=3):xE())),p.updateQueue!==null&&(p.flags|=4),Ei(p),null);case 4:return Qh(),ag(h,p),h===null&&Ue(p.stateNode.containerInfo),Ei(p),null;case 10:return Yr(p.type._context),Ei(p),null;case 17:return Nn(p.type)&&en(),Ei(p),null;case 19:if(xt(ir),T=p.memoizedState,T===null)return Ei(p),null;if(E=(p.flags&128)!==0,I=T.rendering,I===null)if(E)lg(T,!1);else{if(Hr!==0||h!==null&&h.flags&128)for(h=p.child;h!==null;){if(I=_y(h),I!==null){for(p.flags|=128,lg(T,!1),h=I.updateQueue,h!==null&&(p.updateQueue=h,p.flags|=4),p.subtreeFlags=0,h=_,E=p.child;E!==null;)_=E,T=h,_.flags&=14680066,I=_.alternate,I===null?(_.childLanes=0,_.lanes=T,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=I.childLanes,_.lanes=I.lanes,_.child=I.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=I.memoizedProps,_.memoizedState=I.memoizedState,_.updateQueue=I.updateQueue,_.type=I.type,T=I.dependencies,_.dependencies=T===null?null:{lanes:T.lanes,firstContext:T.firstContext}),E=E.sibling;return dt(ir,ir.current&1|2),p.child}h=h.sibling}T.tail!==null&&rr()>dE&&(p.flags|=128,E=!0,lg(T,!1),p.lanes=4194304)}else{if(!E)if(h=_y(I),h!==null){if(p.flags|=128,E=!0,h=h.updateQueue,h!==null&&(p.updateQueue=h,p.flags|=4),lg(T,!0),T.tail===null&&T.tailMode==="hidden"&&!I.alternate&&!Zn)return Ei(p),null}else 2*rr()-T.renderingStartTime>dE&&_!==1073741824&&(p.flags|=128,E=!0,lg(T,!1),p.lanes=4194304);T.isBackwards?(I.sibling=p.child,p.child=I):(h=T.last,h!==null?h.sibling=I:p.child=I,T.last=I)}return T.tail!==null?(p=T.tail,T.rendering=p,T.tail=p.sibling,T.renderingStartTime=rr(),p.sibling=null,h=ir.current,dt(ir,E?h&1|2:h&1),p):(Ei(p),null);case 22:case 23:return yE(),E=p.memoizedState!==null,h!==null&&h.memoizedState!==null!==E&&(p.flags|=8192),E&&p.mode&1?Ns&1073741824&&(Ei(p),Fe&&p.subtreeFlags&6&&(p.flags|=8192)):Ei(p),null;case 24:return null;case 25:return null}throw Error(o(156,p.tag))}var RH=a.ReactCurrentOwner,Ls=!1;function Vi(h,p,_,E){p.child=h===null?uB(p,null,_,E):Jh(p,h.child,_,E)}function FB(h,p,_,E,T){_=_.render;var I=p.ref;return _r(p,T),E=Ww(h,p,_,E,I,T),_=Xw(),h!==null&&!Ls?(p.updateQueue=h.updateQueue,p.flags&=-2053,h.lanes&=~T,el(h,p,T)):(Zn&&_&&Nw(p),p.flags|=1,Vi(h,p,E,T),p.child)}function OB(h,p,_,E,T){if(h===null){var I=_.type;return typeof I=="function"&&!AE(I)&&I.defaultProps===void 0&&_.compare===null&&_.defaultProps===void 0?(p.tag=15,p.type=I,kB(h,p,I,E,T)):(h=Zy(_.type,null,E,p,p.mode,T),h.ref=p.ref,h.return=p,p.child=h)}if(I=h.child,!(h.lanes&T)){var se=I.memoizedProps;if(_=_.compare,_=_!==null?_:Uu,_(se,E)&&h.ref===p.ref)return el(h,p,T)}return p.flags|=1,h=ic(I,E),h.ref=p.ref,h.return=p,p.child=h}function kB(h,p,_,E,T){if(h!==null&&Uu(h.memoizedProps,E)&&h.ref===p.ref)if(Ls=!1,(h.lanes&T)!==0)h.flags&131072&&(Ls=!0);else return p.lanes=h.lanes,el(h,p,T);return Zw(h,p,_,E,T)}function GB(h,p,_){var E=p.pendingProps,T=E.children,I=h!==null?h.memoizedState:null;if(E.mode==="hidden")if(!(p.mode&1))p.memoizedState={baseLanes:0,cachePool:null},dt(Yh,Ns),Ns|=_;else if(_&1073741824)p.memoizedState={baseLanes:0,cachePool:null},E=I!==null?I.baseLanes:_,dt(Yh,Ns),Ns|=E;else return h=I!==null?I.baseLanes|_:_,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:h,cachePool:null},p.updateQueue=null,dt(Yh,Ns),Ns|=h,null;else I!==null?(E=I.baseLanes|_,p.memoizedState=null):E=_,dt(Yh,Ns),Ns|=E;return Vi(h,p,T,_),p.child}function zB(h,p){var _=p.ref;(h===null&&_!==null||h!==null&&h.ref!==_)&&(p.flags|=512,p.flags|=2097152)}function Zw(h,p,_,E,T){var I=Nn(_)?bn:Ut.current;return I=Ln(p,I),_r(p,T),_=Ww(h,p,_,E,I,T),E=Xw(),h!==null&&!Ls?(p.updateQueue=h.updateQueue,p.flags&=-2053,h.lanes&=~T,el(h,p,T)):(Zn&&E&&Nw(p),p.flags|=1,Vi(h,p,_,T),p.child)}function HB(h,p,_,E,T){if(Nn(_)){var I=!0;Xt(p)}else I=!1;if(_r(p,T),p.stateNode===null)h!==null&&(h.alternate=null,p.alternate=null,p.flags|=2),nB(p,_,E),Lw(p,_,E,T),E=!0;else if(h===null){var se=p.stateNode,_e=p.memoizedProps;se.props=_e;var Qe=se.context,ut=_.contextType;typeof ut=="object"&&ut!==null?ut=wr(ut):(ut=Nn(_)?bn:Ut.current,ut=Ln(p,ut));var Ct=_.getDerivedStateFromProps,Yt=typeof Ct=="function"||typeof se.getSnapshotBeforeUpdate=="function";Yt||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(_e!==E||Qe!==ut)&&rB(p,se,E,ut),ql=!1;var Gt=p.memoizedState;se.state=Gt,gy(p,E,se,T),Qe=p.memoizedState,_e!==E||Gt!==Qe||kt.current||ql?(typeof Ct=="function"&&(Iw(p,_,Ct,E),Qe=p.memoizedState),(_e=ql||tB(p,_,_e,E,Gt,Qe,ut))?(Yt||typeof se.UNSAFE_componentWillMount!="function"&&typeof se.componentWillMount!="function"||(typeof se.componentWillMount=="function"&&se.componentWillMount(),typeof se.UNSAFE_componentWillMount=="function"&&se.UNSAFE_componentWillMount()),typeof se.componentDidMount=="function"&&(p.flags|=4194308)):(typeof se.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=E,p.memoizedState=Qe),se.props=E,se.state=Qe,se.context=ut,E=_e):(typeof se.componentDidMount=="function"&&(p.flags|=4194308),E=!1)}else{se=p.stateNode,ZR(h,p),_e=p.memoizedProps,ut=p.type===p.elementType?_e:zi(p.type,_e),se.props=ut,Yt=p.pendingProps,Gt=se.context,Qe=_.contextType,typeof Qe=="object"&&Qe!==null?Qe=wr(Qe):(Qe=Nn(_)?bn:Ut.current,Qe=Ln(p,Qe));var Gn=_.getDerivedStateFromProps;(Ct=typeof Gn=="function"||typeof se.getSnapshotBeforeUpdate=="function")||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(_e!==Yt||Gt!==Qe)&&rB(p,se,E,Qe),ql=!1,Gt=p.memoizedState,se.state=Gt,gy(p,E,se,T);var Nt=p.memoizedState;_e!==Yt||Gt!==Nt||kt.current||ql?(typeof Gn=="function"&&(Iw(p,_,Gn,E),Nt=p.memoizedState),(ut=ql||tB(p,_,ut,E,Gt,Nt,Qe)||!1)?(Ct||typeof se.UNSAFE_componentWillUpdate!="function"&&typeof se.componentWillUpdate!="function"||(typeof se.componentWillUpdate=="function"&&se.componentWillUpdate(E,Nt,Qe),typeof se.UNSAFE_componentWillUpdate=="function"&&se.UNSAFE_componentWillUpdate(E,Nt,Qe)),typeof se.componentDidUpdate=="function"&&(p.flags|=4),typeof se.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof se.componentDidUpdate!="function"||_e===h.memoizedProps&&Gt===h.memoizedState||(p.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||_e===h.memoizedProps&&Gt===h.memoizedState||(p.flags|=1024),p.memoizedProps=E,p.memoizedState=Nt),se.props=E,se.state=Nt,se.context=Qe,E=ut):(typeof se.componentDidUpdate!="function"||_e===h.memoizedProps&&Gt===h.memoizedState||(p.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||_e===h.memoizedProps&&Gt===h.memoizedState||(p.flags|=1024),E=!1)}return qw(h,p,_,E,I,T)}function qw(h,p,_,E,T,I){zB(h,p);var se=(p.flags&128)!==0;if(!E&&!se)return T&&Wt(p,_,!1),el(h,p,I);E=p.stateNode,RH.current=p;var _e=se&&typeof _.getDerivedStateFromError!="function"?null:E.render();return p.flags|=1,h!==null&&se?(p.child=Jh(p,h.child,null,I),p.child=Jh(p,null,_e,I)):Vi(h,p,_e,I),p.memoizedState=E.state,T&&Wt(p,_,!0),p.child}function VB(h){var p=h.stateNode;p.pendingContext?$t(h,p.pendingContext,p.pendingContext!==p.context):p.context&&$t(h,p.context,!1),kw(h,p.containerInfo)}function WB(h,p,_,E,T){return Xh(),Ow(T),p.flags|=256,Vi(h,p,_,E),p.child}var Py={dehydrated:null,treeContext:null,retryLane:0};function Iy(h){return{baseLanes:h,cachePool:null}}function XB(h,p,_){var E=p.pendingProps,T=ir.current,I=!1,se=(p.flags&128)!==0,_e;if((_e=se)||(_e=h!==null&&h.memoizedState===null?!1:(T&2)!==0),_e?(I=!0,p.flags&=-129):(h===null||h.memoizedState!==null)&&(T|=1),dt(ir,T&1),h===null)return Fw(p),h=p.memoizedState,h!==null&&(h=h.dehydrated,h!==null)?(p.mode&1?oi(h)?p.lanes=8:p.lanes=1073741824:p.lanes=1,null):(T=E.children,h=E.fallback,I?(E=p.mode,I=p.child,T={mode:"hidden",children:T},!(E&1)&&I!==null?(I.childLanes=0,I.pendingProps=T):I=qy(T,E,0,null),h=Ju(h,E,_,null),I.return=p,h.return=p,I.sibling=h,p.child=I,p.child.memoizedState=Iy(_),p.memoizedState=Py,h):$w(p,T));if(T=h.memoizedState,T!==null){if(_e=T.dehydrated,_e!==null){if(se)return p.flags&256?(p.flags&=-257,Ly(h,p,_,Error(o(422)))):p.memoizedState!==null?(p.child=h.child,p.flags|=128,null):(I=E.fallback,T=p.mode,E=qy({mode:"visible",children:E.children},T,0,null),I=Ju(I,T,_,null),I.flags|=2,E.return=p,I.return=p,E.sibling=I,p.child=E,p.mode&1&&Jh(p,h.child,null,_),p.child.memoizedState=Iy(_),p.memoizedState=Py,I);if(!(p.mode&1))p=Ly(h,p,_,null);else if(oi(_e))p=Ly(h,p,_,Error(o(419)));else if(E=(_&h.childLanes)!==0,Ls||E){if(E=Ir,E!==null){switch(_&-_){case 4:I=2;break;case 16:I=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:I=32;break;case 536870912:I=268435456;break;default:I=0}E=I&(E.suspendedLanes|_)?0:I,E!==0&&E!==T.retryLane&&(T.retryLane=E,to(h,E,-1))}xE(),p=Ly(h,p,_,Error(o(421)))}else zr(_e)?(p.flags|=128,p.child=h.child,p=HH.bind(null,h),xr(_e,p),p=null):(_=T.treeContext,Te&&(Is=as(_e),Ps=p,Zn=!0,Ro=null,Zm=!1,_!==null&&(Zs[qs++]=Za,Zs[qs++]=qa,Zs[qs++]=Ou,Za=_.id,qa=_.overflow,Ou=p)),p=$w(p,p.pendingProps.children),p.flags|=4096);return p}return I?(E=KB(h,p,E.children,E.fallback,_),I=p.child,T=h.child.memoizedState,I.memoizedState=T===null?Iy(_):{baseLanes:T.baseLanes|_,cachePool:null},I.childLanes=h.childLanes&~_,p.memoizedState=Py,E):(_=JB(h,p,E.children,_),p.memoizedState=null,_)}return I?(E=KB(h,p,E.children,E.fallback,_),I=p.child,T=h.child.memoizedState,I.memoizedState=T===null?Iy(_):{baseLanes:T.baseLanes|_,cachePool:null},I.childLanes=h.childLanes&~_,p.memoizedState=Py,E):(_=JB(h,p,E.children,_),p.memoizedState=null,_)}function $w(h,p){return p=qy({mode:"visible",children:p},h.mode,0,null),p.return=h,h.child=p}function JB(h,p,_,E){var T=h.child;return h=T.sibling,_=ic(T,{mode:"visible",children:_}),!(p.mode&1)&&(_.lanes=E),_.return=p,_.sibling=null,h!==null&&(E=p.deletions,E===null?(p.deletions=[h],p.flags|=16):E.push(h)),p.child=_}function KB(h,p,_,E,T){var I=p.mode;h=h.child;var se=h.sibling,_e={mode:"hidden",children:_};return!(I&1)&&p.child!==h?(_=p.child,_.childLanes=0,_.pendingProps=_e,p.deletions=null):(_=ic(h,_e),_.subtreeFlags=h.subtreeFlags&14680064),se!==null?E=ic(se,E):(E=Ju(E,I,T,null),E.flags|=2),E.return=p,_.return=p,_.sibling=E,p.child=_,E}function Ly(h,p,_,E){return E!==null&&Ow(E),Jh(p,h.child,null,_),h=$w(p,p.pendingProps.children),h.flags|=2,p.memoizedState=null,h}function QB(h,p,_){h.lanes|=p;var E=h.alternate;E!==null&&(E.lanes|=p),Hi(h.return,p,_)}function eE(h,p,_,E,T){var I=h.memoizedState;I===null?h.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:E,tail:_,tailMode:T}:(I.isBackwards=p,I.rendering=null,I.renderingStartTime=0,I.last=E,I.tail=_,I.tailMode=T)}function jB(h,p,_){var E=p.pendingProps,T=E.revealOrder,I=E.tail;if(Vi(h,p,E.children,_),E=ir.current,E&2)E=E&1|2,p.flags|=128;else{if(h!==null&&h.flags&128)e:for(h=p.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&QB(h,_,p);else if(h.tag===19)QB(h,_,p);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===p)break e;for(;h.sibling===null;){if(h.return===null||h.return===p)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}E&=1}if(dt(ir,E),!(p.mode&1))p.memoizedState=null;else switch(T){case"forwards":for(_=p.child,T=null;_!==null;)h=_.alternate,h!==null&&_y(h)===null&&(T=_),_=_.sibling;_=T,_===null?(T=p.child,p.child=null):(T=_.sibling,_.sibling=null),eE(p,!1,T,_,I);break;case"backwards":for(_=null,T=p.child,p.child=null;T!==null;){if(h=T.alternate,h!==null&&_y(h)===null){p.child=T;break}h=T.sibling,T.sibling=_,_=T,T=h}eE(p,!0,_,null,I);break;case"together":eE(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function el(h,p,_){if(h!==null&&(p.dependencies=h.dependencies),Zh|=p.lanes,!(_&p.childLanes))return null;if(h!==null&&p.child!==h.child)throw Error(o(153));if(p.child!==null){for(h=p.child,_=ic(h,h.pendingProps),p.child=_,_.return=p;h.sibling!==null;)h=h.sibling,_=_.sibling=ic(h,h.pendingProps),_.return=p;_.sibling=null}return p.child}function BH(h,p,_){switch(p.tag){case 3:VB(p),Xh();break;case 5:fB(p);break;case 1:Nn(p.type)&&Xt(p);break;case 4:kw(p,p.stateNode.containerInfo);break;case 10:py(p,p.type._context,p.memoizedProps.value);break;case 13:var E=p.memoizedState;if(E!==null)return E.dehydrated!==null?(dt(ir,ir.current&1),p.flags|=128,null):_&p.child.childLanes?XB(h,p,_):(dt(ir,ir.current&1),h=el(h,p,_),h!==null?h.sibling:null);dt(ir,ir.current&1);break;case 19:if(E=(_&p.childLanes)!==0,h.flags&128){if(E)return jB(h,p,_);p.flags|=128}var T=p.memoizedState;if(T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),dt(ir,ir.current),E)break;return null;case 22:case 23:return p.lanes=0,GB(h,p,_)}return el(h,p,_)}function PH(h,p){switch(Dw(p),p.tag){case 1:return Nn(p.type)&&en(),h=p.flags,h&65536?(p.flags=h&-65537|128,p):null;case 3:return Qh(),xt(kt),xt(Ut),Hw(),h=p.flags,h&65536&&!(h&128)?(p.flags=h&-65537|128,p):null;case 5:return Gw(p),null;case 13:if(xt(ir),h=p.memoizedState,h!==null&&h.dehydrated!==null){if(p.alternate===null)throw Error(o(340));Xh()}return h=p.flags,h&65536?(p.flags=h&-65537|128,p):null;case 19:return xt(ir),null;case 4:return Qh(),null;case 10:return Yr(p.type._context),null;case 22:case 23:return yE(),null;case 24:return null;default:return null}}var Ny=!1,zu=!1,IH=typeof WeakSet=="function"?WeakSet:Set,At=null;function Dy(h,p){var _=h.ref;if(_!==null)if(typeof _=="function")try{_(null)}catch(E){fs(h,p,E)}else _.current=null}function tE(h,p,_){try{_()}catch(E){fs(h,p,E)}}var YB=!1;function LH(h,p){for(K(h.containerInfo),At=p;At!==null;)if(h=At,p=h.child,(h.subtreeFlags&1028)!==0&&p!==null)p.return=h,At=p;else for(;At!==null;){h=At;try{var _=h.alternate;if(h.flags&1024)switch(h.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var E=_.memoizedProps,T=_.memoizedState,I=h.stateNode,se=I.getSnapshotBeforeUpdate(h.elementType===h.type?E:zi(h.type,E),T);I.__reactInternalSnapshotBeforeUpdate=se}break;case 3:Fe&&at(h.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(_e){fs(h,h.return,_e)}if(p=h.sibling,p!==null){p.return=h.return,At=p;break}At=h.return}return _=YB,YB=!1,_}function Hu(h,p,_){var E=p.updateQueue;if(E=E!==null?E.lastEffect:null,E!==null){var T=E=E.next;do{if((T.tag&h)===h){var I=T.destroy;T.destroy=void 0,I!==void 0&&tE(p,_,I)}T=T.next}while(T!==E)}}function cg(h,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var _=p=p.next;do{if((_.tag&h)===h){var E=_.create;_.destroy=E()}_=_.next}while(_!==p)}}function nE(h){var p=h.ref;if(p!==null){var _=h.stateNode;switch(h.tag){case 5:h=O(_);break;default:h=_}typeof p=="function"?p(h):p.current=h}}function ZB(h,p,_){if(Cs&&typeof Cs.onCommitFiberUnmount=="function")try{Cs.onCommitFiberUnmount(Nu,p)}catch{}switch(p.tag){case 0:case 11:case 14:case 15:if(h=p.updateQueue,h!==null&&(h=h.lastEffect,h!==null)){var E=h=h.next;do{var T=E,I=T.destroy;T=T.tag,I!==void 0&&(T&2||T&4)&&tE(p,_,I),E=E.next}while(E!==h)}break;case 1:if(Dy(p,_),h=p.stateNode,typeof h.componentWillUnmount=="function")try{h.props=p.memoizedProps,h.state=p.memoizedState,h.componentWillUnmount()}catch(se){fs(p,_,se)}break;case 5:Dy(p,_);break;case 4:Fe?rP(h,p,_):j&&j&&(p=p.stateNode.containerInfo,_=ct(p),mt(p,_))}}function qB(h,p,_){for(var E=p;;)if(ZB(h,E,_),E.child===null||Fe&&E.tag===4){if(E===p)break;for(;E.sibling===null;){if(E.return===null||E.return===p)return;E=E.return}E.sibling.return=E.return,E=E.sibling}else E.child.return=E,E=E.child}function $B(h){var p=h.alternate;p!==null&&(h.alternate=null,$B(p)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(p=h.stateNode,p!==null&&et(p)),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}function eP(h){return h.tag===5||h.tag===3||h.tag===4}function tP(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||eP(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function nP(h){if(Fe){e:{for(var p=h.return;p!==null;){if(eP(p))break e;p=p.return}throw Error(o(160))}var _=p;switch(_.tag){case 5:p=_.stateNode,_.flags&32&&(De(p),_.flags&=-33),_=tP(h),iE(h,_,p);break;case 3:case 4:p=_.stateNode.containerInfo,_=tP(h),rE(h,_,p);break;default:throw Error(o(161))}}}function rE(h,p,_){var E=h.tag;if(E===5||E===6)h=h.stateNode,p?Ze(_,h,p):Ye(_,h);else if(E!==4&&(h=h.child,h!==null))for(rE(h,p,_),h=h.sibling;h!==null;)rE(h,p,_),h=h.sibling}function iE(h,p,_){var E=h.tag;if(E===5||E===6)h=h.stateNode,p?ot(_,h,p):ze(_,h);else if(E!==4&&(h=h.child,h!==null))for(iE(h,p,_),h=h.sibling;h!==null;)iE(h,p,_),h=h.sibling}function rP(h,p,_){for(var E=p,T=!1,I,se;;){if(!T){T=E.return;e:for(;;){if(T===null)throw Error(o(160));switch(I=T.stateNode,T.tag){case 5:se=!1;break e;case 3:I=I.containerInfo,se=!0;break e;case 4:I=I.containerInfo,se=!0;break e}T=T.return}T=!0}if(E.tag===5||E.tag===6)qB(h,E,_),se?ae(I,E.stateNode):Ke(I,E.stateNode);else if(E.tag===18)se?ue(I,E.stateNode):he(I,E.stateNode);else if(E.tag===4){if(E.child!==null){I=E.stateNode.containerInfo,se=!0,E.child.return=E,E=E.child;continue}}else if(ZB(h,E,_),E.child!==null){E.child.return=E,E=E.child;continue}if(E===p)break;for(;E.sibling===null;){if(E.return===null||E.return===p)return;E=E.return,E.tag===4&&(T=!1)}E.sibling.return=E.return,E=E.sibling}}function sE(h,p){if(Fe){switch(p.tag){case 0:case 11:case 14:case 15:Hu(3,p,p.return),cg(3,p),Hu(5,p,p.return);return;case 1:return;case 5:var _=p.stateNode;if(_!=null){var E=p.memoizedProps;h=h!==null?h.memoizedProps:E;var T=p.type,I=p.updateQueue;p.updateQueue=null,I!==null&&yt(_,I,T,h,E,p)}return;case 6:if(p.stateNode===null)throw Error(o(162));_=p.memoizedProps,Ie(p.stateNode,h!==null?h.memoizedProps:_,_);return;case 3:Te&&h!==null&&h.memoizedState.isDehydrated&&ee(p.stateNode.containerInfo);return;case 12:return;case 13:Uy(p);return;case 19:Uy(p);return;case 17:return}throw Error(o(163))}switch(p.tag){case 0:case 11:case 14:case 15:Hu(3,p,p.return),cg(3,p),Hu(5,p,p.return);return;case 12:return;case 13:Uy(p);return;case 19:Uy(p);return;case 3:Te&&h!==null&&h.memoizedState.isDehydrated&&ee(p.stateNode.containerInfo);break;case 22:case 23:return}e:if(j){switch(p.tag){case 1:case 5:case 6:break e;case 3:case 4:p=p.stateNode,mt(p.containerInfo,p.pendingChildren);break e}throw Error(o(163))}}function Uy(h){var p=h.updateQueue;if(p!==null){h.updateQueue=null;var _=h.stateNode;_===null&&(_=h.stateNode=new IH),p.forEach(function(E){var T=VH.bind(null,h,E);_.has(E)||(_.add(E),E.then(T,T))})}}function NH(h,p){for(At=p;At!==null;){p=At;var _=p.deletions;if(_!==null)for(var E=0;E<_.length;E++){var T=_[E];try{var I=h;Fe?rP(I,T,p):qB(I,T,p);var se=T.alternate;se!==null&&(se.return=null),T.return=null}catch(It){fs(T,p,It)}}if(_=p.child,p.subtreeFlags&12854&&_!==null)_.return=p,At=_;else for(;At!==null;){p=At;try{var _e=p.flags;if(_e&32&&Fe&&De(p.stateNode),_e&512){var Qe=p.alternate;if(Qe!==null){var ut=Qe.ref;ut!==null&&(typeof ut=="function"?ut(null):ut.current=null)}}if(_e&8192)switch(p.tag){case 13:if(p.memoizedState!==null){var Ct=p.alternate;(Ct===null||Ct.memoizedState===null)&&(hE=rr())}break;case 22:var Yt=p.memoizedState!==null,Gt=p.alternate,Gn=Gt!==null&&Gt.memoizedState!==null;if(_=p,Fe){e:if(E=_,T=Yt,I=null,Fe)for(var Nt=E;;){if(Nt.tag===5){if(I===null){I=Nt;var Si=Nt.stateNode;T?rt(Si):ve(Nt.stateNode,Nt.memoizedProps)}}else if(Nt.tag===6){if(I===null){var ro=Nt.stateNode;T?it(ro):ce(ro,Nt.memoizedProps)}}else if((Nt.tag!==22&&Nt.tag!==23||Nt.memoizedState===null||Nt===E)&&Nt.child!==null){Nt.child.return=Nt,Nt=Nt.child;continue}if(Nt===E)break;for(;Nt.sibling===null;){if(Nt.return===null||Nt.return===E)break e;I===Nt&&(I=null),Nt=Nt.return}I===Nt&&(I=null),Nt.sibling.return=Nt.return,Nt=Nt.sibling}}if(Yt&&!Gn&&_.mode&1){At=_;for(var Ne=_.child;Ne!==null;){for(_=At=Ne;At!==null;){E=At;var Se=E.child;switch(E.tag){case 0:case 11:case 14:case 15:Hu(4,E,E.return);break;case 1:Dy(E,E.return);var He=E.stateNode;if(typeof He.componentWillUnmount=="function"){var wt=E.return;try{He.props=E.memoizedProps,He.state=E.memoizedState,He.componentWillUnmount()}catch(It){fs(E,wt,It)}}break;case 5:Dy(E,E.return);break;case 22:if(E.memoizedState!==null){oP(_);continue}}Se!==null?(Se.return=E,At=Se):oP(_)}Ne=Ne.sibling}}}switch(_e&4102){case 2:nP(p),p.flags&=-3;break;case 6:nP(p),p.flags&=-3,sE(p.alternate,p);break;case 4096:p.flags&=-4097;break;case 4100:p.flags&=-4097,sE(p.alternate,p);break;case 4:sE(p.alternate,p)}}catch(It){fs(p,p.return,It)}if(_=p.sibling,_!==null){_.return=p.return,At=_;break}At=p.return}}}function DH(h,p,_){At=h,iP(h)}function iP(h,p,_){for(var E=(h.mode&1)!==0;At!==null;){var T=At,I=T.child;if(T.tag===22&&E){var se=T.memoizedState!==null||Ny;if(!se){var _e=T.alternate,Qe=_e!==null&&_e.memoizedState!==null||zu;_e=Ny;var ut=zu;if(Ny=se,(zu=Qe)&&!ut)for(At=T;At!==null;)se=At,Qe=se.child,se.tag===22&&se.memoizedState!==null?aP(T):Qe!==null?(Qe.return=se,At=Qe):aP(T);for(;I!==null;)At=I,iP(I),I=I.sibling;At=T,Ny=_e,zu=ut}sP(h)}else T.subtreeFlags&8772&&I!==null?(I.return=T,At=I):sP(h)}}function sP(h){for(;At!==null;){var p=At;if(p.flags&8772){var _=p.alternate;try{if(p.flags&8772)switch(p.tag){case 0:case 11:case 15:zu||cg(5,p);break;case 1:var E=p.stateNode;if(p.flags&4&&!zu)if(_===null)E.componentDidMount();else{var T=p.elementType===p.type?_.memoizedProps:zi(p.type,_.memoizedProps);E.componentDidUpdate(T,_.memoizedState,E.__reactInternalSnapshotBeforeUpdate)}var I=p.updateQueue;I!==null&&$R(p,I,E);break;case 3:var se=p.updateQueue;if(se!==null){if(_=null,p.child!==null)switch(p.child.tag){case 5:_=O(p.child.stateNode);break;case 1:_=p.child.stateNode}$R(p,se,_)}break;case 5:var _e=p.stateNode;_===null&&p.flags&4&&gt(_e,p.type,p.memoizedProps,p);break;case 6:break;case 4:break;case 12:break;case 13:if(Te&&p.memoizedState===null){var Qe=p.alternate;if(Qe!==null){var ut=Qe.memoizedState;if(ut!==null){var Ct=ut.dehydrated;Ct!==null&&re(Ct)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}zu||p.flags&512&&nE(p)}catch(Yt){fs(p,p.return,Yt)}}if(p===h){At=null;break}if(_=p.sibling,_!==null){_.return=p.return,At=_;break}At=p.return}}function oP(h){for(;At!==null;){var p=At;if(p===h){At=null;break}var _=p.sibling;if(_!==null){_.return=p.return,At=_;break}At=p.return}}function aP(h){for(;At!==null;){var p=At;try{switch(p.tag){case 0:case 11:case 15:var _=p.return;try{cg(4,p)}catch(Qe){fs(p,_,Qe)}break;case 1:var E=p.stateNode;if(typeof E.componentDidMount=="function"){var T=p.return;try{E.componentDidMount()}catch(Qe){fs(p,T,Qe)}}var I=p.return;try{nE(p)}catch(Qe){fs(p,I,Qe)}break;case 5:var se=p.return;try{nE(p)}catch(Qe){fs(p,se,Qe)}}}catch(Qe){fs(p,p.return,Qe)}if(p===h){At=null;break}var _e=p.sibling;if(_e!==null){_e.return=p.return,At=_e;break}At=p.return}}var Fy=0,Oy=1,ky=2,Gy=3,zy=4;if(typeof Symbol=="function"&&Symbol.for){var ug=Symbol.for;Fy=ug("selector.component"),Oy=ug("selector.has_pseudo_class"),ky=ug("selector.role"),Gy=ug("selector.test_id"),zy=ug("selector.text")}function oE(h){var p=be(h);if(p!=null){if(typeof p.memoizedProps["data-testname"]!="string")throw Error(o(364));return p}if(h=G(h),h===null)throw Error(o(362));return h.stateNode.current}function aE(h,p){switch(p.$$typeof){case Fy:if(h.type===p.value)return!0;break;case Oy:e:{p=p.value,h=[h,0];for(var _=0;_<h.length;){var E=h[_++],T=h[_++],I=p[T];if(E.tag!==5||!ye(E)){for(;I!=null&&aE(E,I);)T++,I=p[T];if(T===p.length){p=!0;break e}else for(E=E.child;E!==null;)h.push(E,T),E=E.sibling}}p=!1}return p;case ky:if(h.tag===5&&Le(h.stateNode,p.value))return!0;break;case zy:if((h.tag===5||h.tag===6)&&(h=le(h),h!==null&&0<=h.indexOf(p.value)))return!0;break;case Gy:if(h.tag===5&&(h=h.memoizedProps["data-testname"],typeof h=="string"&&h.toLowerCase()===p.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function lE(h){switch(h.$$typeof){case Fy:return"<"+(R(h.value)||"Unknown")+">";case Oy:return":has("+(lE(h)||"")+")";case ky:return'[role="'+h.value+'"]';case zy:return'"'+h.value+'"';case Gy:return'[data-testname="'+h.value+'"]';default:throw Error(o(365))}}function lP(h,p){var _=[];h=[h,0];for(var E=0;E<h.length;){var T=h[E++],I=h[E++],se=p[I];if(T.tag!==5||!ye(T)){for(;se!=null&&aE(T,se);)I++,se=p[I];if(I===p.length)_.push(T);else for(T=T.child;T!==null;)h.push(T,I),T=T.sibling}}return _}function cE(h,p){if(!F)throw Error(o(363));h=oE(h),h=lP(h,p),p=[],h=Array.from(h);for(var _=0;_<h.length;){var E=h[_++];if(E.tag===5)ye(E)||p.push(E.stateNode);else for(E=E.child;E!==null;)h.push(E),E=E.sibling}return p}var UH=Math.ceil,Hy=a.ReactCurrentDispatcher,uE=a.ReactCurrentOwner,Er=a.ReactCurrentBatchConfig,cn=0,Ir=null,Lr=null,li=0,Ns=0,Yh=Vt(0),Hr=0,fg=null,Zh=0,Vy=0,fE=0,hg=null,cs=null,hE=0,dE=1/0;function qh(){dE=rr()+500}var Wy=!1,pE=null,ec=null,Xy=!1,tc=null,Jy=0,dg=0,mE=null,Ky=-1,Qy=0;function Wi(){return cn&6?rr():Ky!==-1?Ky:Ky=rr()}function nc(h){return h.mode&1?cn&2&&li!==0?li&-li:Du.transition!==null?(Qy===0&&(h=Xa,Xa<<=1,!(Xa&4194240)&&(Xa=64),Qy=h),Qy):(h=fn,h!==0?h:we()):1}function to(h,p,_){if(50<dg)throw dg=0,mE=null,Error(o(185));var E=jy(h,p);return E===null?null:(da(E,p,_),(!(cn&2)||E!==Ir)&&(E===Ir&&(!(cn&2)&&(Vy|=p),Hr===4&&rc(E,li)),us(E,_),p===1&&cn===0&&!(h.mode&1)&&(qh(),ma&&ls())),E)}function jy(h,p){h.lanes|=p;var _=h.alternate;for(_!==null&&(_.lanes|=p),_=h,h=h.return;h!==null;)h.childLanes|=p,_=h.alternate,_!==null&&(_.childLanes|=p),_=h,h=h.return;return _.tag===3?_.stateNode:null}function us(h,p){var _=h.callbackNode;Wm(h,p);var E=Iu(h,h===Ir?li:0);if(E===0)_!==null&&Gh(_),h.callbackNode=null,h.callbackPriority=0;else if(p=E&-E,h.callbackPriority!==p){if(_!=null&&Gh(_),p===1)h.tag===0?Ym(uP.bind(null,h)):jm(uP.bind(null,h)),Re?J(function(){cn===0&&ls()}):ja(Lu,ls),_=null;else{switch(Xm(E)){case 1:_=Lu;break;case 4:_=hy;break;case 16:_=ki;break;case 536870912:_=Km;break;default:_=ki}_=xP(_,cP.bind(null,h))}h.callbackPriority=p,h.callbackNode=_}}function cP(h,p){if(Ky=-1,Qy=0,cn&6)throw Error(o(327));var _=h.callbackNode;if(Xu()&&h.callbackNode!==_)return null;var E=Iu(h,h===Ir?li:0);if(E===0)return null;if(E&30||E&h.expiredLanes||p)p=Yy(h,E);else{p=E;var T=cn;cn|=2;var I=dP();(Ir!==h||li!==p)&&(qh(),Vu(h,p));do try{kH();break}catch(_e){hP(h,_e)}while(1);Hh(),Hy.current=I,cn=T,Lr!==null?p=0:(Ir=null,li=0,p=Hr)}if(p!==0){if(p===2&&(T=Qa(h),T!==0&&(E=T,p=gE(h,T))),p===1)throw _=fg,Vu(h,0),rc(h,E),us(h,rr()),_;if(p===6)rc(h,E);else{if(T=h.current.alternate,!(E&30)&&!FH(T)&&(p=Yy(h,E),p===2&&(I=Qa(h),I!==0&&(E=I,p=gE(h,I))),p===1))throw _=fg,Vu(h,0),rc(h,E),us(h,rr()),_;switch(h.finishedWork=T,h.finishedLanes=E,p){case 0:case 1:throw Error(o(345));case 2:Wu(h,cs);break;case 3:if(rc(h,E),(E&130023424)===E&&(p=hE+500-rr(),10<p)){if(Iu(h,0)!==0)break;if(T=h.suspendedLanes,(T&E)!==E){Wi(),h.pingedLanes|=h.suspendedLanes&T;break}h.timeoutHandle=ge(Wu.bind(null,h,cs),p);break}Wu(h,cs);break;case 4:if(rc(h,E),(E&4194240)===E)break;for(p=h.eventTimes,T=-1;0<E;){var se=31-Dn(E);I=1<<se,se=p[se],se>T&&(T=se),E&=~I}if(E=T,E=rr()-E,E=(120>E?120:480>E?480:1080>E?1080:1920>E?1920:3e3>E?3e3:4320>E?4320:1960*UH(E/1960))-E,10<E){h.timeoutHandle=ge(Wu.bind(null,h,cs),E);break}Wu(h,cs);break;case 5:Wu(h,cs);break;default:throw Error(o(329))}}}return us(h,rr()),h.callbackNode===_?cP.bind(null,h):null}function gE(h,p){var _=hg;return h.current.memoizedState.isDehydrated&&(Vu(h,p).flags|=256),h=Yy(h,p),h!==2&&(p=cs,cs=_,p!==null&&vE(p)),h}function vE(h){cs===null?cs=h:cs.push.apply(cs,h)}function FH(h){for(var p=h;;){if(p.flags&16384){var _=p.updateQueue;if(_!==null&&(_=_.stores,_!==null))for(var E=0;E<_.length;E++){var T=_[E],I=T.getSnapshot;T=T.value;try{if(!Rs(I(),T))return!1}catch{return!1}}}if(_=p.child,p.subtreeFlags&16384&&_!==null)_.return=p,p=_;else{if(p===h)break;for(;p.sibling===null;){if(p.return===null||p.return===h)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function rc(h,p){for(p&=~fE,p&=~Vy,h.suspendedLanes|=p,h.pingedLanes&=~p,h=h.expirationTimes;0<p;){var _=31-Dn(p),E=1<<_;h[_]=-1,p&=~E}}function uP(h){if(cn&6)throw Error(o(327));Xu();var p=Iu(h,0);if(!(p&1))return us(h,rr()),null;var _=Yy(h,p);if(h.tag!==0&&_===2){var E=Qa(h);E!==0&&(p=E,_=gE(h,E))}if(_===1)throw _=fg,Vu(h,0),rc(h,p),us(h,rr()),_;if(_===6)throw Error(o(345));return h.finishedWork=h.current.alternate,h.finishedLanes=p,Wu(h,cs),us(h,rr()),null}function fP(h){tc!==null&&tc.tag===0&&!(cn&6)&&Xu();var p=cn;cn|=1;var _=Er.transition,E=fn;try{if(Er.transition=null,fn=1,h)return h()}finally{fn=E,Er.transition=_,cn=p,!(cn&6)&&ls()}}function yE(){Ns=Yh.current,xt(Yh)}function Vu(h,p){h.finishedWork=null,h.finishedLanes=0;var _=h.timeoutHandle;if(_!==Je&&(h.timeoutHandle=Je,Ce(_)),Lr!==null)for(_=Lr.return;_!==null;){var E=_;switch(Dw(E),E.tag){case 1:E=E.type.childContextTypes,E!=null&&en();break;case 3:Qh(),xt(kt),xt(Ut),Hw();break;case 5:Gw(E);break;case 4:Qh();break;case 13:xt(ir);break;case 19:xt(ir);break;case 10:Yr(E.type._context);break;case 22:case 23:yE()}_=_.return}if(Ir=h,Lr=h=ic(h.current,null),li=Ns=p,Hr=0,fg=null,fE=Vy=Zh=0,cs=hg=null,Bs!==null){for(p=0;p<Bs.length;p++)if(_=Bs[p],E=_.interleaved,E!==null){_.interleaved=null;var T=E.next,I=_.pending;if(I!==null){var se=I.next;I.next=T,E.next=se}_.pending=E}Bs=null}return h}function hP(h,p){do{var _=Lr;try{if(Hh(),wy.current=Cy,Ey){for(var E=pr.memoizedState;E!==null;){var T=E.queue;T!==null&&(T.pending=null),E=E.next}Ey=!1}if(jh=0,Zr=_i=pr=null,ng=!1,rg=0,uE.current=null,_===null||_.return===null){Hr=1,fg=p,Lr=null;break}e:{var I=h,se=_.return,_e=_,Qe=p;if(p=li,_e.flags|=32768,Qe!==null&&typeof Qe=="object"&&typeof Qe.then=="function"){var ut=Qe,Ct=_e,Yt=Ct.tag;if(!(Ct.mode&1)&&(Yt===0||Yt===11||Yt===15)){var Gt=Ct.alternate;Gt?(Ct.updateQueue=Gt.updateQueue,Ct.memoizedState=Gt.memoizedState,Ct.lanes=Gt.lanes):(Ct.updateQueue=null,Ct.memoizedState=null)}var Gn=LB(se);if(Gn!==null){Gn.flags&=-257,NB(Gn,se,_e,I,p),Gn.mode&1&&IB(I,ut,p),p=Gn,Qe=ut;var Nt=p.updateQueue;if(Nt===null){var Si=new Set;Si.add(Qe),p.updateQueue=Si}else Nt.add(Qe);break e}else{if(!(p&1)){IB(I,ut,p),xE();break e}Qe=Error(o(426))}}else if(Zn&&_e.mode&1){var ro=LB(se);if(ro!==null){!(ro.flags&65536)&&(ro.flags|=256),NB(ro,se,_e,I,p),Ow(Qe);break e}}I=Qe,Hr!==4&&(Hr=2),hg===null?hg=[I]:hg.push(I),Qe=jw(Qe,_e),_e=se;do{switch(_e.tag){case 3:_e.flags|=65536,p&=-p,_e.lanes|=p;var Ne=BB(_e,Qe,p);qR(_e,Ne);break e;case 1:I=Qe;var Se=_e.type,He=_e.stateNode;if(!(_e.flags&128)&&(typeof Se.getDerivedStateFromError=="function"||He!==null&&typeof He.componentDidCatch=="function"&&(ec===null||!ec.has(He)))){_e.flags|=65536,p&=-p,_e.lanes|=p;var wt=PB(_e,I,p);qR(_e,wt);break e}}_e=_e.return}while(_e!==null)}mP(_)}catch(It){p=It,Lr===_&&_!==null&&(Lr=_=_.return);continue}break}while(1)}function dP(){var h=Hy.current;return Hy.current=Cy,h===null?Cy:h}function xE(){(Hr===0||Hr===3||Hr===2)&&(Hr=4),Ir===null||!(Zh&268435455)&&!(Vy&268435455)||rc(Ir,li)}function Yy(h,p){var _=cn;cn|=2;var E=dP();Ir===h&&li===p||Vu(h,p);do try{OH();break}catch(T){hP(h,T)}while(1);if(Hh(),cn=_,Hy.current=E,Lr!==null)throw Error(o(261));return Ir=null,li=0,Hr}function OH(){for(;Lr!==null;)pP(Lr)}function kH(){for(;Lr!==null&&!Jm();)pP(Lr)}function pP(h){var p=yP(h.alternate,h,Ns);h.memoizedProps=h.pendingProps,p===null?mP(h):Lr=p,uE.current=null}function mP(h){var p=h;do{var _=p.alternate;if(h=p.return,p.flags&32768){if(_=PH(_,p),_!==null){_.flags&=32767,Lr=_;return}if(h!==null)h.flags|=32768,h.subtreeFlags=0,h.deletions=null;else{Hr=6,Lr=null;return}}else if(_=CH(_,p,Ns),_!==null){Lr=_;return}if(p=p.sibling,p!==null){Lr=p;return}Lr=p=h}while(p!==null);Hr===0&&(Hr=5)}function Wu(h,p){var _=fn,E=Er.transition;try{Er.transition=null,fn=1,GH(h,p,_)}finally{Er.transition=E,fn=_}return null}function GH(h,p,_){do Xu();while(tc!==null);if(cn&6)throw Error(o(327));var E=h.finishedWork,T=h.finishedLanes;if(E===null)return null;if(h.finishedWork=null,h.finishedLanes=0,E===h.current)throw Error(o(177));h.callbackNode=null,h.callbackPriority=0;var I=E.lanes|E.childLanes;if(Yl(h,I),h===Ir&&(Lr=Ir=null,li=0),!(E.subtreeFlags&2064)&&!(E.flags&2064)||Xy||(Xy=!0,xP(ki,function(){return Xu(),null})),I=(E.flags&15990)!==0,E.subtreeFlags&15990||I){I=Er.transition,Er.transition=null;var se=fn;fn=1;var _e=cn;cn|=4,uE.current=null,LH(h,E),NH(h,E),W(h.containerInfo),h.current=E,DH(E),fy(),cn=_e,fn=se,Er.transition=I}else h.current=E;if(Xy&&(Xy=!1,tc=h,Jy=T),I=h.pendingLanes,I===0&&(ec=null),Qm(E.stateNode),us(h,rr()),p!==null)for(_=h.onRecoverableError,E=0;E<p.length;E++)_(p[E]);if(Wy)throw Wy=!1,h=pE,pE=null,h;return Jy&1&&h.tag!==0&&Xu(),I=h.pendingLanes,I&1?h===mE?dg++:(dg=0,mE=h):dg=0,ls(),null}function Xu(){if(tc!==null){var h=Xm(Jy),p=Er.transition,_=fn;try{if(Er.transition=null,fn=16>h?16:h,tc===null)var E=!1;else{if(h=tc,tc=null,Jy=0,cn&6)throw Error(o(331));var T=cn;for(cn|=4,At=h.current;At!==null;){var I=At,se=I.child;if(At.flags&16){var _e=I.deletions;if(_e!==null){for(var Qe=0;Qe<_e.length;Qe++){var ut=_e[Qe];for(At=ut;At!==null;){var Ct=At;switch(Ct.tag){case 0:case 11:case 15:Hu(8,Ct,I)}var Yt=Ct.child;if(Yt!==null)Yt.return=Ct,At=Yt;else for(;At!==null;){Ct=At;var Gt=Ct.sibling,Gn=Ct.return;if($B(Ct),Ct===ut){At=null;break}if(Gt!==null){Gt.return=Gn,At=Gt;break}At=Gn}}}var Nt=I.alternate;if(Nt!==null){var Si=Nt.child;if(Si!==null){Nt.child=null;do{var ro=Si.sibling;Si.sibling=null,Si=ro}while(Si!==null)}}At=I}}if(I.subtreeFlags&2064&&se!==null)se.return=I,At=se;else e:for(;At!==null;){if(I=At,I.flags&2048)switch(I.tag){case 0:case 11:case 15:Hu(9,I,I.return)}var Ne=I.sibling;if(Ne!==null){Ne.return=I.return,At=Ne;break e}At=I.return}}var Se=h.current;for(At=Se;At!==null;){se=At;var He=se.child;if(se.subtreeFlags&2064&&He!==null)He.return=se,At=He;else e:for(se=Se;At!==null;){if(_e=At,_e.flags&2048)try{switch(_e.tag){case 0:case 11:case 15:cg(9,_e)}}catch(It){fs(_e,_e.return,It)}if(_e===se){At=null;break e}var wt=_e.sibling;if(wt!==null){wt.return=_e.return,At=wt;break e}At=_e.return}}if(cn=T,ls(),Cs&&typeof Cs.onPostCommitFiberRoot=="function")try{Cs.onPostCommitFiberRoot(Nu,h)}catch{}E=!0}return E}finally{fn=_,Er.transition=p}}return!1}function gP(h,p,_){p=jw(_,p),p=BB(h,p,1),$l(h,p),p=Wi(),h=jy(h,1),h!==null&&(da(h,1,p),us(h,p))}function fs(h,p,_){if(h.tag===3)gP(h,h,_);else for(;p!==null;){if(p.tag===3){gP(p,h,_);break}else if(p.tag===1){var E=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(ec===null||!ec.has(E))){h=jw(_,h),h=PB(p,h,1),$l(p,h),h=Wi(),p=jy(p,1),p!==null&&(da(p,1,h),us(p,h));break}}p=p.return}}function zH(h,p,_){var E=h.pingCache;E!==null&&E.delete(p),p=Wi(),h.pingedLanes|=h.suspendedLanes&_,Ir===h&&(li&_)===_&&(Hr===4||Hr===3&&(li&130023424)===li&&500>rr()-hE?Vu(h,0):fE|=_),us(h,p)}function vP(h,p){p===0&&(h.mode&1?(p=Ja,Ja<<=1,!(Ja&130023424)&&(Ja=4194304)):p=1);var _=Wi();h=jy(h,p),h!==null&&(da(h,p,_),us(h,_))}function HH(h){var p=h.memoizedState,_=0;p!==null&&(_=p.retryLane),vP(h,_)}function VH(h,p){var _=0;switch(h.tag){case 13:var E=h.stateNode,T=h.memoizedState;T!==null&&(_=T.retryLane);break;case 19:E=h.stateNode;break;default:throw Error(o(314))}E!==null&&E.delete(p),vP(h,_)}var yP;yP=function(h,p,_){if(h!==null)if(h.memoizedProps!==p.pendingProps||kt.current)Ls=!0;else{if(!(h.lanes&_)&&!(p.flags&128))return Ls=!1,BH(h,p,_);Ls=!!(h.flags&131072)}else Ls=!1,Zn&&p.flags&1048576&&iB(p,xy,p.index);switch(p.lanes=0,p.tag){case 2:var E=p.type;h!==null&&(h.alternate=null,p.alternate=null,p.flags|=2),h=p.pendingProps;var T=Ln(p,Ut.current);_r(p,_),T=Ww(null,p,E,h,T,_);var I=Xw();return p.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,Nn(E)?(I=!0,Xt(p)):I=!1,p.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,Pw(p),T.updater=vy,p.stateNode=T,T._reactInternals=p,Lw(p,E,h,_),p=qw(null,p,E,!0,I,_)):(p.tag=0,Zn&&I&&Nw(p),Vi(null,p,T,_),p=p.child),p;case 16:E=p.elementType;e:{switch(h!==null&&(h.alternate=null,p.alternate=null,p.flags|=2),h=p.pendingProps,T=E._init,E=T(E._payload),p.type=E,T=p.tag=XH(E),h=zi(E,h),T){case 0:p=Zw(null,p,E,h,_);break e;case 1:p=HB(null,p,E,h,_);break e;case 11:p=FB(null,p,E,h,_);break e;case 14:p=OB(null,p,E,zi(E.type,h),_);break e}throw Error(o(306,E,""))}return p;case 0:return E=p.type,T=p.pendingProps,T=p.elementType===E?T:zi(E,T),Zw(h,p,E,T,_);case 1:return E=p.type,T=p.pendingProps,T=p.elementType===E?T:zi(E,T),HB(h,p,E,T,_);case 3:e:{if(VB(p),h===null)throw Error(o(387));E=p.pendingProps,I=p.memoizedState,T=I.element,ZR(h,p),gy(p,E,null,_);var se=p.memoizedState;if(E=se.element,Te&&I.isDehydrated)if(I={element:E,isDehydrated:!1,cache:se.cache,transitions:se.transitions},p.updateQueue.baseState=I,p.memoizedState=I,p.flags&256){T=Error(o(423)),p=WB(h,p,E,_,T);break e}else if(E!==T){T=Error(o(424)),p=WB(h,p,E,_,T);break e}else for(Te&&(Is=nr(p.stateNode.containerInfo),Ps=p,Zn=!0,Ro=null,Zm=!1),_=uB(p,null,E,_),p.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling;else{if(Xh(),E===T){p=el(h,p,_);break e}Vi(h,p,E,_)}p=p.child}return p;case 5:return fB(p),h===null&&Fw(p),E=p.type,T=p.pendingProps,I=h!==null?h.memoizedProps:null,se=T.children,fe(E,T)?se=null:I!==null&&fe(E,I)&&(p.flags|=32),zB(h,p),Vi(h,p,se,_),p.child;case 6:return h===null&&Fw(p),null;case 13:return XB(h,p,_);case 4:return kw(p,p.stateNode.containerInfo),E=p.pendingProps,h===null?p.child=Jh(p,null,E,_):Vi(h,p,E,_),p.child;case 11:return E=p.type,T=p.pendingProps,T=p.elementType===E?T:zi(E,T),FB(h,p,E,T,_);case 7:return Vi(h,p,p.pendingProps,_),p.child;case 8:return Vi(h,p,p.pendingProps.children,_),p.child;case 12:return Vi(h,p,p.pendingProps.children,_),p.child;case 10:e:{if(E=p.type._context,T=p.pendingProps,I=p.memoizedProps,se=T.value,py(p,E,se),I!==null)if(Rs(I.value,se)){if(I.children===T.children&&!kt.current){p=el(h,p,_);break e}}else for(I=p.child,I!==null&&(I.return=p);I!==null;){var _e=I.dependencies;if(_e!==null){se=I.child;for(var Qe=_e.firstContext;Qe!==null;){if(Qe.context===E){if(I.tag===1){Qe=Ya(-1,_&-_),Qe.tag=2;var ut=I.updateQueue;if(ut!==null){ut=ut.shared;var Ct=ut.pending;Ct===null?Qe.next=Qe:(Qe.next=Ct.next,Ct.next=Qe),ut.pending=Qe}}I.lanes|=_,Qe=I.alternate,Qe!==null&&(Qe.lanes|=_),Hi(I.return,_,p),_e.lanes|=_;break}Qe=Qe.next}}else if(I.tag===10)se=I.type===p.type?null:I.child;else if(I.tag===18){if(se=I.return,se===null)throw Error(o(341));se.lanes|=_,_e=se.alternate,_e!==null&&(_e.lanes|=_),Hi(se,_,p),se=I.sibling}else se=I.child;if(se!==null)se.return=I;else for(se=I;se!==null;){if(se===p){se=null;break}if(I=se.sibling,I!==null){I.return=se.return,se=I;break}se=se.return}I=se}Vi(h,p,T.children,_),p=p.child}return p;case 9:return T=p.type,E=p.pendingProps.children,_r(p,_),T=wr(T),E=E(T),p.flags|=1,Vi(h,p,E,_),p.child;case 14:return E=p.type,T=zi(E,p.pendingProps),T=zi(E.type,T),OB(h,p,E,T,_);case 15:return kB(h,p,p.type,p.pendingProps,_);case 17:return E=p.type,T=p.pendingProps,T=p.elementType===E?T:zi(E,T),h!==null&&(h.alternate=null,p.alternate=null,p.flags|=2),p.tag=1,Nn(E)?(h=!0,Xt(p)):h=!1,_r(p,_),nB(p,E,T),Lw(p,E,T,_),qw(null,p,E,!0,h,_);case 19:return jB(h,p,_);case 22:return GB(h,p,_)}throw Error(o(156,p.tag))};function xP(h,p){return ja(h,p)}function WH(h,p,_,E){this.tag=h,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function no(h,p,_,E){return new WH(h,p,_,E)}function AE(h){return h=h.prototype,!(!h||!h.isReactComponent)}function XH(h){if(typeof h=="function")return AE(h)?1:0;if(h!=null){if(h=h.$$typeof,h===y)return 11;if(h===A)return 14}return 2}function ic(h,p){var _=h.alternate;return _===null?(_=no(h.tag,p,h.key,h.mode),_.elementType=h.elementType,_.type=h.type,_.stateNode=h.stateNode,_.alternate=h,h.alternate=_):(_.pendingProps=p,_.type=h.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=h.flags&14680064,_.childLanes=h.childLanes,_.lanes=h.lanes,_.child=h.child,_.memoizedProps=h.memoizedProps,_.memoizedState=h.memoizedState,_.updateQueue=h.updateQueue,p=h.dependencies,_.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},_.sibling=h.sibling,_.index=h.index,_.ref=h.ref,_}function Zy(h,p,_,E,T,I){var se=2;if(E=h,typeof h=="function")AE(h)&&(se=1);else if(typeof h=="string")se=5;else e:switch(h){case u:return Ju(_.children,T,I,p);case f:se=8,T|=8;break;case d:return h=no(12,_,p,T|2),h.elementType=d,h.lanes=I,h;case x:return h=no(13,_,p,T),h.elementType=x,h.lanes=I,h;case v:return h=no(19,_,p,T),h.elementType=v,h.lanes=I,h;case S:return qy(_,T,I,p);default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case m:se=10;break e;case g:se=9;break e;case y:se=11;break e;case A:se=14;break e;case w:se=16,E=null;break e}throw Error(o(130,h==null?h:typeof h,""))}return p=no(se,_,p,T),p.elementType=h,p.type=E,p.lanes=I,p}function Ju(h,p,_,E){return h=no(7,h,E,p),h.lanes=_,h}function qy(h,p,_,E){return h=no(22,h,E,p),h.elementType=S,h.lanes=_,h.stateNode={},h}function _E(h,p,_){return h=no(6,h,null,p),h.lanes=_,h}function wE(h,p,_){return p=no(4,h.children!==null?h.children:[],h.key,p),p.lanes=_,p.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},p}function JH(h,p,_,E,T){this.tag=p,this.containerInfo=h,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Je,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kh(0),this.expirationTimes=kh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kh(0),this.identifierPrefix=E,this.onRecoverableError=T,Te&&(this.mutableSourceEagerHydrationData=null)}function AP(h,p,_,E,T,I,se,_e,Qe){return h=new JH(h,p,_,_e,Qe),p===1?(p=1,I===!0&&(p|=8)):p=0,I=no(3,null,null,p),h.current=I,I.stateNode=h,I.memoizedState={element:E,isDehydrated:_,cache:null,transitions:null},Pw(I),h}function _P(h){if(!h)return Kt;h=h._reactInternals;e:{if(C(h)!==h||h.tag!==1)throw Error(o(170));var p=h;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(Nn(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(o(171))}if(h.tag===1){var _=h.type;if(Nn(_))return kn(h,_,p)}return p}function wP(h){var p=h._reactInternals;if(p===void 0)throw typeof h.render=="function"?Error(o(188)):(h=Object.keys(h).join(","),Error(o(268,h)));return h=k(p),h===null?null:h.stateNode}function EP(h,p){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var _=h.retryLane;h.retryLane=_!==0&&_<p?_:p}}function EE(h,p){EP(h,p),(h=h.alternate)&&EP(h,p)}function KH(h){return h=k(h),h===null?null:h.stateNode}function QH(){return null}return t.attemptContinuousHydration=function(h){if(h.tag===13){var p=Wi();to(h,134217728,p),EE(h,134217728)}},t.attemptHydrationAtCurrentPriority=function(h){if(h.tag===13){var p=Wi(),_=nc(h);to(h,_,p),EE(h,_)}},t.attemptSynchronousHydration=function(h){switch(h.tag){case 3:var p=h.stateNode;if(p.current.memoizedState.isDehydrated){var _=Ka(p.pendingLanes);_!==0&&(pa(p,_|1),us(p,rr()),!(cn&6)&&(qh(),ls()))}break;case 13:var E=Wi();fP(function(){return to(h,1,E)}),EE(h,1)}},t.batchedUpdates=function(h,p){var _=cn;cn|=1;try{return h(p)}finally{cn=_,cn===0&&(qh(),ma&&ls())}},t.createComponentSelector=function(h){return{$$typeof:Fy,value:h}},t.createContainer=function(h,p,_,E,T,I,se){return AP(h,p,!1,null,_,E,T,I,se)},t.createHasPseudoClassSelector=function(h){return{$$typeof:Oy,value:h}},t.createHydrationContainer=function(h,p,_,E,T,I,se,_e,Qe){return h=AP(_,E,!0,h,T,I,se,_e,Qe),h.context=_P(null),_=h.current,E=Wi(),T=nc(_),I=Ya(E,T),I.callback=p??null,$l(_,I),h.current.lanes=T,da(h,T,E),us(h,E),h},t.createPortal=function(h,p,_){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:E==null?null:""+E,children:h,containerInfo:p,implementation:_}},t.createRoleSelector=function(h){return{$$typeof:ky,value:h}},t.createTestNameSelector=function(h){return{$$typeof:Gy,value:h}},t.createTextSelector=function(h){return{$$typeof:zy,value:h}},t.deferredUpdates=function(h){var p=fn,_=Er.transition;try{return Er.transition=null,fn=16,h()}finally{fn=p,Er.transition=_}},t.discreteUpdates=function(h,p,_,E,T){var I=fn,se=Er.transition;try{return Er.transition=null,fn=1,h(p,_,E,T)}finally{fn=I,Er.transition=se,cn===0&&qh()}},t.findAllNodes=cE,t.findBoundingRects=function(h,p){if(!F)throw Error(o(363));p=cE(h,p),h=[];for(var _=0;_<p.length;_++)h.push(de(p[_]));for(p=h.length-1;0<p;p--){_=h[p];for(var E=_.x,T=E+_.width,I=_.y,se=I+_.height,_e=p-1;0<=_e;_e--)if(p!==_e){var Qe=h[_e],ut=Qe.x,Ct=ut+Qe.width,Yt=Qe.y,Gt=Yt+Qe.height;if(E>=ut&&I>=Yt&&T<=Ct&&se<=Gt){h.splice(p,1);break}else if(E!==ut||_.width!==Qe.width||Gt<I||Yt>se){if(!(I!==Yt||_.height!==Qe.height||Ct<E||ut>T)){ut>E&&(Qe.width+=ut-E,Qe.x=E),Ct<T&&(Qe.width=T-ut),h.splice(p,1);break}}else{Yt>I&&(Qe.height+=Yt-I,Qe.y=I),Gt<se&&(Qe.height=se-Yt),h.splice(p,1);break}}}return h},t.findHostInstance=wP,t.findHostInstanceWithNoPortals=function(h){return h=H(h),h=h!==null?U(h):null,h===null?null:h.stateNode},t.findHostInstanceWithWarning=function(h){return wP(h)},t.flushControlled=function(h){var p=cn;cn|=1;var _=Er.transition,E=fn;try{Er.transition=null,fn=1,h()}finally{fn=E,Er.transition=_,cn=p,cn===0&&(qh(),ls())}},t.flushPassiveEffects=Xu,t.flushSync=fP,t.focusWithin=function(h,p){if(!F)throw Error(o(363));for(h=oE(h),p=lP(h,p),p=Array.from(p),h=0;h<p.length;){var _=p[h++];if(!ye(_)){if(_.tag===5&&Ve(_.stateNode))return!0;for(_=_.child;_!==null;)p.push(_),_=_.sibling}}return!1},t.getCurrentUpdatePriority=function(){return fn},t.getFindAllNodesFailureDescription=function(h,p){if(!F)throw Error(o(363));var _=0,E=[];h=[oE(h),0];for(var T=0;T<h.length;){var I=h[T++],se=h[T++],_e=p[se];if((I.tag!==5||!ye(I))&&(aE(I,_e)&&(E.push(lE(_e)),se++,se>_&&(_=se)),se<p.length))for(I=I.child;I!==null;)h.push(I,se),I=I.sibling}if(_<p.length){for(h=[];_<p.length;_++)h.push(lE(p[_]));return`findAllNodes was able to match part of the selector:
  `+(E.join(" > ")+`

No matching component was found for:
  `)+h.join(" > ")}return null},t.getPublicRootInstance=function(h){if(h=h.current,!h.child)return null;switch(h.child.tag){case 5:return O(h.child.stateNode);default:return h.child.stateNode}},t.injectIntoDevTools=function(h){if(h={bundleType:h.bundleType,version:h.version,rendererPackageName:h.rendererPackageName,rendererConfig:h.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:KH,findFiberByHostInstance:h.findFiberByHostInstance||QH,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")h=!1;else{var p=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(p.isDisabled||!p.supportsFiber)h=!0;else{try{Nu=p.inject(h),Cs=p}catch{}h=!!p.checkDCE}}return h},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(h,p,_,E){if(!F)throw Error(o(363));h=cE(h,p);var T=Oe(h,_,E).disconnect;return{disconnect:function(){T()}}},t.registerMutableSourceForHydration=function(h,p){var _=p._getVersion;_=_(p._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[p,_]:h.mutableSourceEagerHydrationData.push(p,_)},t.runWithPriority=function(h,p){var _=fn;try{return fn=h,p()}finally{fn=_}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(h,p,_,E){var T=p.current,I=Wi(),se=nc(T);return _=_P(_),p.context===null?p.context=_:p.pendingContext=_,p=Ya(I,se),p.payload={element:h},E=E===void 0?null:E,E!==null&&(p.callback=E),$l(T,p),h=to(T,se,I),h!==null&&my(h,T,se),se},t};Kk.exports=iQ;var sQ=Kk.exports;const oQ=dC(sQ),aQ=n=>typeof n=="object"&&typeof n.then=="function",If=[];function Yk(n,e,t=(r,i)=>r===i){if(n===e)return!0;if(!n||!e)return!1;const r=n.length;if(e.length!==r)return!1;for(let i=0;i<r;i++)if(!t(n[i],e[i]))return!1;return!0}function Zk(n,e=null,t=!1,r={}){e===null&&(e=[n]);for(const s of If)if(Yk(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return r.lifespan&&r.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,r.lifespan)),s.response;if(!t)throw s.promise}const i={keys:e,equal:r.equal,remove:()=>{const s=If.indexOf(i);s!==-1&&If.splice(s,1)},promise:(aQ(n)?n:n(...e)).then(s=>{i.response=s,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))}).catch(s=>i.error=s)};if(If.push(i),!t)throw i.promise}const qk=(n,e,t)=>Zk(n,e,!1,t),lQ=(n,e,t)=>void Zk(n,e,!0,t),cQ=n=>{if(n===void 0||n.length===0)If.splice(0,If.length);else{const e=If.find(t=>Yk(n,t.keys,t.equal));e&&e.remove()}},aR={},uw=n=>void Object.assign(aR,n);function uQ(n,e){function t(u,{args:f=[],attach:d,...m},g){let y=`${u[0].toUpperCase()}${u.slice(1)}`,x;if(u==="primitive"){if(m.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const v=m.object;x=Td(v,{type:u,root:g,attach:d,primitive:!0})}else{const v=aR[y];if(!v)throw new Error(`R3F: ${y} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(f))throw new Error("R3F: The args prop must be an array!");x=Td(new v(...f),{type:u,root:g,attach:d,memoizedProps:{args:f}})}return x.__r3f.attach===void 0&&(x instanceof jt?x.__r3f.attach="geometry":x instanceof ur&&(x.__r3f.attach="material")),y!=="inject"&&US(x,m),x}function r(u,f){let d=!1;if(f){var m,g;(m=f.__r3f)!=null&&m.attach?DS(u,f,f.__r3f.attach):f.isObject3D&&u.isObject3D&&(u.add(f),d=!0),d||(g=u.__r3f)==null||g.objects.push(f),f.__r3f||Td(f,{}),f.__r3f.parent=u,fT(f),Cd(f)}}function i(u,f,d){let m=!1;if(f){var g,y;if((g=f.__r3f)!=null&&g.attach)DS(u,f,f.__r3f.attach);else if(f.isObject3D&&u.isObject3D){f.parent=u,f.dispatchEvent({type:"added"});const x=u.children.filter(A=>A!==f),v=x.indexOf(d);u.children=[...x.slice(0,v),f,...x.slice(v)],m=!0}m||(y=u.__r3f)==null||y.objects.push(f),f.__r3f||Td(f,{}),f.__r3f.parent=u,fT(f),Cd(f)}}function s(u,f,d=!1){u&&[...u].forEach(m=>o(f,m,d))}function o(u,f,d){if(f){var m,g,y;if(f.__r3f&&(f.__r3f.parent=null),(m=u.__r3f)!=null&&m.objects&&(u.__r3f.objects=u.__r3f.objects.filter(S=>S!==f)),(g=f.__r3f)!=null&&g.attach)dN(u,f,f.__r3f.attach);else if(f.isObject3D&&u.isObject3D){var x;u.remove(f),(x=f.__r3f)!=null&&x.root&&vQ(f.__r3f.root,f)}const A=(y=f.__r3f)==null?void 0:y.primitive,w=d===void 0?f.dispose!==null&&!A:d;if(!A){var v;s((v=f.__r3f)==null?void 0:v.objects,f,w),s(f.children,f,w)}delete f.__r3f,w&&f.dispose&&f.type!=="Scene"&&cT.unstable_scheduleCallback(cT.unstable_IdlePriority,()=>{try{f.dispose()}catch{}}),Cd(u)}}function a(u,f,d,m){var g;const y=(g=u.__r3f)==null?void 0:g.parent;if(!y)return;const x=t(f,d,u.__r3f.root);if(u.children){for(const v of u.children)v.__r3f&&r(x,v);u.children=u.children.filter(v=>!v.__r3f)}u.__r3f.objects.forEach(v=>r(x,v)),u.__r3f.objects=[],u.__r3f.autoRemovedBeforeAppend||o(y,u),x.parent&&(x.__r3f.autoRemovedBeforeAppend=!0),r(y,x),x.raycast&&x.__r3f.eventCount&&x.__r3f.root.getState().internal.interaction.push(x),[m,m.alternate].forEach(v=>{v!==null&&(v.stateNode=x,v.ref&&(typeof v.ref=="function"?v.ref(x):v.ref.current=x))})}const l=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:oQ({createInstance:t,removeChild:o,appendChild:r,appendInitialChild:r,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(u,f)=>{if(!f)return;const d=u.getState().scene;d.__r3f&&(d.__r3f.root=u,r(d,f))},removeChildFromContainer:(u,f)=>{f&&o(u.getState().scene,f)},insertInContainerBefore:(u,f,d)=>{if(!f||!d)return;const m=u.getState().scene;m.__r3f&&i(m,f,d)},getRootHostContext:()=>null,getChildHostContext:u=>u,finalizeInitialChildren(u){var f;return!!((f=u==null?void 0:u.__r3f)!=null?f:{}).handlers},prepareUpdate(u,f,d,m){if(u.__r3f.primitive&&m.object&&m.object!==u)return[!0];{const{args:g=[],children:y,...x}=m,{args:v=[],children:A,...w}=d;if(!Array.isArray(g))throw new Error("R3F: the args prop must be an array!");if(g.some((M,b)=>M!==v[b]))return[!0];const S=s4(u,x,w,!0);return S.changes.length?[!1,S]:null}},commitUpdate(u,[f,d],m,g,y,x){f?a(u,m,y,x):US(u,d)},commitMount(u,f,d,m){var g;const y=(g=u.__r3f)!=null?g:{};u.raycast&&y.handlers&&y.eventCount&&u.__r3f.root.getState().internal.interaction.push(u)},getPublicInstance:u=>u,prepareForCommit:()=>null,preparePortalMount:u=>Td(u.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(u){var f;const{attach:d,parent:m}=(f=u.__r3f)!=null?f:{};d&&m&&dN(m,u,d),u.isObject3D&&(u.visible=!1),Cd(u)},unhideInstance(u,f){var d;const{attach:m,parent:g}=(d=u.__r3f)!=null?d:{};m&&g&&DS(g,u,m),(u.isObject3D&&f.visible==null||f.visible)&&(u.visible=!0),Cd(u)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():qd.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Kn.fun(performance.now)?performance.now:Kn.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Kn.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Kn.fun(clearTimeout)?clearTimeout:void 0}),applyProps:US}}var cN,uN;const NS=n=>"colorSpace"in n||"outputColorSpace"in n,$k=()=>{var n;return(n=aR.ColorManagement)!=null?n:null},e4=n=>n&&n.isOrthographicCamera,fQ=n=>n&&n.hasOwnProperty("current"),ty=typeof window<"u"&&((cN=window.document)!=null&&cN.createElement||((uN=window.navigator)==null?void 0:uN.product)==="ReactNative")?te.useLayoutEffect:te.useEffect;function t4(n){const e=te.useRef(n);return ty(()=>void(e.current=n),[n]),e}function hQ({set:n}){return ty(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class n4 extends te.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}n4.getDerivedStateFromError=()=>({error:!0});const r4="__default",fN=new Map,dQ=n=>n&&!!n.memoized&&!!n.changes;function i4(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}const Ng=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()},Kn={obj:n=>n===Object(n)&&!Kn.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:r="reference",strict:i=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(Kn.str(n)||Kn.num(n))return n===e;const s=Kn.obj(n);if(s&&r==="reference")return n===e;const o=Kn.arr(n);if(o&&t==="reference")return n===e;if((o||s)&&n===e)return!0;let a;for(a in n)if(!(a in e))return!1;if(s&&t==="shallow"&&r==="shallow"){for(a in i?e:n)if(!Kn.equ(n[a],e[a],{strict:i,objects:"reference"}))return!1}else for(a in i?e:n)if(n[a]!==e[a])return!1;if(Kn.und(a)){if(o&&n.length===0&&e.length===0||s&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function pQ(n){const e={nodes:{},materials:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}function mQ(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function Td(n,e){const t=n;return(e!=null&&e.primitive||!t.__r3f)&&(t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e}),n}function uT(n,e){let t=n;if(e.includes("-")){const r=e.split("-"),i=r.pop();return t=r.reduce((s,o)=>s[o],n),{target:t,key:i}}else return{target:t,key:e}}const hN=/-\d+$/;function DS(n,e,t){if(Kn.str(t)){if(hN.test(t)){const s=t.replace(hN,""),{target:o,key:a}=uT(n,s);Array.isArray(o[a])||(o[a]=[])}const{target:r,key:i}=uT(n,t);e.__r3f.previousAttach=r[i],r[i]=e}else e.__r3f.previousAttach=t(n,e)}function dN(n,e,t){var r,i;if(Kn.str(t)){const{target:s,key:o}=uT(n,t),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(r=e.__r3f)==null||r.previousAttach==null||r.previousAttach(n,e);(i=e.__r3f)==null||delete i.previousAttach}function s4(n,{children:e,key:t,ref:r,...i},{children:s,key:o,ref:a,...l}={},c=!1){var u;const f=(u=n==null?void 0:n.__r3f)!=null?u:{},d=Object.entries(i),m=[];if(c){const y=Object.keys(l);for(let x=0;x<y.length;x++)i.hasOwnProperty(y[x])||d.unshift([y[x],r4+"remove"])}d.forEach(([y,x])=>{var v;if((v=n.__r3f)!=null&&v.primitive&&y==="object"||Kn.equ(x,l[y]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(y))return m.push([y,x,!0,[]]);let A=[];y.includes("-")&&(A=y.split("-")),m.push([y,x,!1,A]);for(const w in i){const S=i[w];w.startsWith(`${y}-`)&&m.push([w,S,!1,w.split("-")])}});const g={...i};return f.memoizedProps&&f.memoizedProps.args&&(g.args=f.memoizedProps.args),f.memoizedProps&&f.memoizedProps.attach&&(g.attach=f.memoizedProps.attach),{memoized:g,changes:m}}function US(n,e){var t,r,i;const s=(t=n.__r3f)!=null?t:{},o=s.root,a=(r=o==null||o.getState==null?void 0:o.getState())!=null?r:{},{memoized:l,changes:c}=dQ(e)?e:s4(n,e),u=s.eventCount;n.__r3f&&(n.__r3f.memoizedProps=l);for(let d=0;d<c.length;d++){let[m,g,y,x]=c[d];if(NS(n)){const S="srgb",M="srgb-linear";m==="encoding"?(m="colorSpace",g=g===3001?S:M):m==="outputEncoding"&&(m="outputColorSpace",g=g===3001?S:M)}let v=n,A=v[m];if(x.length&&(A=x.reduce((w,S)=>w[S],n),!(A&&A.set))){const[w,...S]=x.reverse();v=S.reverse().reduce((M,b)=>M[b],n),m=w}if(g===r4+"remove")if(v.constructor){let w=fN.get(v.constructor);w||(w=new v.constructor,fN.set(v.constructor,w)),g=w[m]}else g=0;if(y)g?s.handlers[m]=g:delete s.handlers[m],s.eventCount=Object.keys(s.handlers).length;else if(A&&A.set&&(A.copy||A instanceof uh)){if(Array.isArray(g))A.fromArray?A.fromArray(g):A.set(...g);else if(A.copy&&g&&g.constructor&&A.constructor===g.constructor)A.copy(g);else if(g!==void 0){const w=A instanceof ht;!w&&A.setScalar?A.setScalar(g):A instanceof uh&&g instanceof uh?A.mask=g.mask:A.set(g),!$k()&&!a.linear&&w&&A.convertSRGBToLinear()}}else if(v[m]=g,v[m]instanceof Sn&&v[m].format===Ur&&v[m].type===Gr){const w=v[m];NS(w)&&NS(a.gl)?w.colorSpace=a.gl.outputColorSpace:w.encoding=a.gl.outputEncoding}Cd(n)}if(s.parent&&a.internal&&n.raycast&&u!==s.eventCount){const d=a.internal.interaction.indexOf(n);d>-1&&a.internal.interaction.splice(d,1),s.eventCount&&a.internal.interaction.push(n)}return!(c.length===1&&c[0][0]==="onUpdate")&&c.length&&(i=n.__r3f)!=null&&i.parent&&fT(n),n}function Cd(n){var e,t;const r=(e=n.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();r&&r.internal.frames===0&&r.invalidate()}function fT(n){n.onUpdate==null||n.onUpdate(n)}function o4(n,e){n.manual||(e4(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function l1(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function gQ(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return qd.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return qd.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return qd.ContinuousEventPriority;default:return qd.DefaultEventPriority}}function a4(n,e,t,r){const i=t.get(e);i&&(t.delete(e),t.size===0&&(n.delete(r),i.target.releasePointerCapture(r)))}function vQ(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(r=>r!==e),t.initialHits=t.initialHits.filter(r=>r!==e),t.hovered.forEach((r,i)=>{(r.eventObject===e||r.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((r,i)=>{a4(t.capturedMap,e,r,i)})}function yQ(n){function e(l){const{internal:c}=n.getState(),u=l.offsetX-c.initialClick[0],f=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(u*u+f*f))}function t(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(u=>{var f;return(f=c.__r3f)==null?void 0:f.handlers["onPointer"+u]}))}function r(l,c){const u=n.getState(),f=new Set,d=[],m=c?c(u.internal.interaction):u.internal.interaction;for(let v=0;v<m.length;v++){const A=Ng(m[v]);A&&(A.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(l,u);function g(v){const A=Ng(v);if(!A||!A.events.enabled||A.raycaster.camera===null)return[];if(A.raycaster.camera===void 0){var w;A.events.compute==null||A.events.compute(l,A,(w=A.previousRoot)==null?void 0:w.getState()),A.raycaster.camera===void 0&&(A.raycaster.camera=null)}return A.raycaster.camera?A.raycaster.intersectObject(v,!0):[]}let y=m.flatMap(g).sort((v,A)=>{const w=Ng(v.object),S=Ng(A.object);return!w||!S?v.distance-A.distance:S.events.priority-w.events.priority||v.distance-A.distance}).filter(v=>{const A=l1(v);return f.has(A)?!1:(f.add(A),!0)});u.events.filter&&(y=u.events.filter(y,u));for(const v of y){let A=v.object;for(;A;){var x;(x=A.__r3f)!=null&&x.eventCount&&d.push({...v,eventObject:A}),A=A.parent}}if("pointerId"in l&&u.internal.capturedMap.has(l.pointerId))for(let v of u.internal.capturedMap.get(l.pointerId).values())f.has(l1(v.intersection))||d.push(v.intersection);return d}function i(l,c,u,f){const d=n.getState();if(l.length){const m={stopped:!1};for(const g of l){const y=Ng(g.object)||d,{raycaster:x,pointer:v,camera:A,internal:w}=y,S=new Y(v.x,v.y,0).unproject(A),M=B=>{var H,k;return(H=(k=w.capturedMap.get(B))==null?void 0:k.has(g.eventObject))!=null?H:!1},b=B=>{const H={intersection:g,target:c.target};w.capturedMap.has(B)?w.capturedMap.get(B).set(g.eventObject,H):w.capturedMap.set(B,new Map([[g.eventObject,H]])),c.target.setPointerCapture(B)},R=B=>{const H=w.capturedMap.get(B);H&&a4(w.capturedMap,g.eventObject,H,B)};let P={};for(let B in c){let H=c[B];typeof H!="function"&&(P[B]=H)}let C={...g,...P,pointer:v,intersections:l,stopped:m.stopped,delta:u,unprojectedPoint:S,ray:x.ray,camera:A,stopPropagation(){const B="pointerId"in c&&w.capturedMap.get(c.pointerId);if((!B||B.has(g.eventObject))&&(C.stopped=m.stopped=!0,w.hovered.size&&Array.from(w.hovered.values()).find(H=>H.eventObject===g.eventObject))){const H=l.slice(0,l.indexOf(g));s([...H,g])}},target:{hasPointerCapture:M,setPointerCapture:b,releasePointerCapture:R},currentTarget:{hasPointerCapture:M,setPointerCapture:b,releasePointerCapture:R},nativeEvent:c};if(f(C),m.stopped===!0)break}}return l}function s(l){const{internal:c}=n.getState();for(const u of c.hovered.values())if(!l.length||!l.find(f=>f.object===u.object&&f.index===u.index&&f.instanceId===u.instanceId)){const d=u.eventObject.__r3f,m=d==null?void 0:d.handlers;if(c.hovered.delete(l1(u)),d!=null&&d.eventCount){const g={...u,intersections:l};m.onPointerOut==null||m.onPointerOut(g),m.onPointerLeave==null||m.onPointerLeave(g)}}}function o(l,c){for(let u=0;u<c.length;u++){const f=c[u].__r3f;f==null||f.handlers.onPointerMissed==null||f.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:u}=n.getState();"pointerId"in c&&u.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(c.pointerId)&&(u.capturedMap.delete(c.pointerId),s([]))})}}return function(u){const{onPointerMissed:f,internal:d}=n.getState();d.lastEvent.current=u;const m=l==="onPointerMove",g=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",x=r(u,m?t:void 0),v=g?e(u):0;l==="onPointerDown"&&(d.initialClick=[u.offsetX,u.offsetY],d.initialHits=x.map(w=>w.eventObject)),g&&!x.length&&v<=2&&(o(u,d.interaction),f&&f(u)),m&&s(x);function A(w){const S=w.eventObject,M=S.__r3f,b=M==null?void 0:M.handlers;if(M!=null&&M.eventCount)if(m){if(b.onPointerOver||b.onPointerEnter||b.onPointerOut||b.onPointerLeave){const R=l1(w),P=d.hovered.get(R);P?P.stopped&&w.stopPropagation():(d.hovered.set(R,w),b.onPointerOver==null||b.onPointerOver(w),b.onPointerEnter==null||b.onPointerEnter(w))}b.onPointerMove==null||b.onPointerMove(w)}else{const R=b[l];R?(!g||d.initialHits.includes(S))&&(o(u,d.interaction.filter(P=>!d.initialHits.includes(P))),R(w)):g&&d.initialHits.includes(S)&&o(u,d.interaction.filter(P=>!d.initialHits.includes(P)))}}i(x,u,v,A)}}return{handlePointer:a}}const xQ=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],l4=n=>!!(n!=null&&n.render),lR=te.createContext(null),AQ=(n,e)=>{const t=Jk((a,l)=>{const c=new Y,u=new Y,f=new Y;function d(v=l().camera,A=u,w=l().size){const{width:S,height:M,top:b,left:R}=w,P=S/M;A instanceof Y?f.copy(A):f.set(...A);const C=v.getWorldPosition(c).distanceTo(f);if(e4(v))return{width:S/v.zoom,height:M/v.zoom,top:b,left:R,factor:1,distance:C,aspect:P};{const B=v.fov*Math.PI/180,H=2*Math.tan(B/2)*C,k=H*(S/M);return{width:k,height:H,top:b,left:R,factor:S/k,distance:C,aspect:P}}}let m;const g=v=>a(A=>({performance:{...A.performance,current:v}})),y=new Ge;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(v=1)=>n(l(),v),advance:(v,A)=>e(v,A,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new nR,pointer:y,mouse:y,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const v=l();m&&clearTimeout(m),v.performance.current!==v.performance.min&&g(v.performance.min),m=setTimeout(()=>g(l().performance.max),v.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:d},setEvents:v=>a(A=>({...A,events:{...A.events,...v}})),setSize:(v,A,w,S,M)=>{const b=l().camera,R={width:v,height:A,top:S||0,left:M||0,updateStyle:w};a(P=>({size:R,viewport:{...P.viewport,...d(b,u,R)}}))},setDpr:v=>a(A=>{const w=i4(v);return{viewport:{...A.viewport,dpr:w,initialDpr:A.viewport.initialDpr||w}}}),setFrameloop:(v="always")=>{const A=l().clock;A.stop(),A.elapsedTime=0,v!=="never"&&(A.start(),A.elapsedTime=0),a(()=>({frameloop:v}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:te.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(v,A,w)=>{const S=l().internal;return S.priority=S.priority+(A>0?1:0),S.subscribers.push({ref:v,priority:A,store:w}),S.subscribers=S.subscribers.sort((M,b)=>M.priority-b.priority),()=>{const M=l().internal;M!=null&&M.subscribers&&(M.priority=M.priority-(A>0?1:0),M.subscribers=M.subscribers.filter(b=>b.ref!==v))}}}}}),r=t.getState();let i=r.size,s=r.viewport.dpr,o=r.camera;return t.subscribe(()=>{const{camera:a,size:l,viewport:c,gl:u,set:f}=t.getState();if(l!==i||c.dpr!==s){var d;i=l,s=c.dpr,o4(a,l),u.setPixelRatio(c.dpr);const m=(d=l.updateStyle)!=null?d:typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(l.width,l.height,m)}a!==o&&(o=a,f(m=>({viewport:{...m.viewport,...m.viewport.getCurrentViewport(a)}})))}),t.subscribe(a=>n(a)),t};let c1,_Q=new Set,wQ=new Set,EQ=new Set;function FS(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function Dg(n,e){switch(n){case"before":return FS(_Q,e);case"after":return FS(wQ,e);case"tail":return FS(EQ,e)}}let OS,kS;function GS(n,e,t){let r=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(r=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),OS=e.internal.subscribers,c1=0;c1<OS.length;c1++)kS=OS[c1],kS.ref.current(kS.store.getState(),r,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function SQ(n){let e=!1,t,r,i;function s(l){r=requestAnimationFrame(s),e=!0,t=0,Dg("before",l);for(const u of n.values()){var c;i=u.store.getState(),i.internal.active&&(i.frameloop==="always"||i.internal.frames>0)&&!((c=i.gl.xr)!=null&&c.isPresenting)&&(t+=GS(l,i))}if(Dg("after",l),t===0)return Dg("tail",l),e=!1,cancelAnimationFrame(r)}function o(l,c=1){var u;if(!l)return n.forEach(f=>o(f.store.getState()),c);(u=l.gl.xr)!=null&&u.isPresenting||!l.internal.active||l.frameloop==="never"||(l.internal.frames=Math.min(60,l.internal.frames+c),e||(e=!0,requestAnimationFrame(s)))}function a(l,c=!0,u,f){if(c&&Dg("before",l),u)GS(l,u,f);else for(const d of n.values())GS(l,d.store.getState());c&&Dg("after",l)}return{loop:s,invalidate:o,advance:a}}function cR(){const n=te.useContext(lR);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function $n(n=t=>t,e){return cR()(n,e)}function fa(n,e=0){const t=cR(),r=t.getState().internal.subscribe,i=t4(n);return ty(()=>r(i,e,t),[e,r,t]),null}function c4(n,e){return function(t,...r){const i=new t;return n&&n(i),Promise.all(r.map(s=>new Promise((o,a)=>i.load(s,l=>{l.scene&&Object.assign(l,pQ(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l.message})`))))))}}function Xl(n,e,t,r){const i=Array.isArray(e)?e:[e],s=qk(c4(t,r),[n,...i],{equal:Kn.equ});return Array.isArray(e)?s:s[0]}Xl.preload=function(n,e,t){const r=Array.isArray(e)?e:[e];return lQ(c4(t),[n,...r])};Xl.clear=function(n,e){const t=Array.isArray(e)?e:[e];return cQ([n,...t])};const Sm=new Map,{invalidate:pN,advance:mN}=SQ(Sm),{reconciler:nv,applyProps:bc}=uQ(Sm,gQ),_d={objects:"shallow",strict:!1},bQ=(n,e)=>{const t=typeof n=="function"?n(e):n;return l4(t)?t:new V_({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function MQ(n,e){if(e)return e;if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:t,height:r,top:i,left:s}=n.parentElement.getBoundingClientRect();return{width:t,height:r,top:i,left:s}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function TQ(n){const e=Sm.get(n),t=e==null?void 0:e.fiber,r=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,s=r||AQ(pN,mN),o=t||nv.createContainer(s,qd.ConcurrentRoot,null,!1,null,"",i,null);e||Sm.set(n,{fiber:o,store:s});let a,l=!1,c;return{configure(u={}){let{gl:f,size:d,scene:m,events:g,onCreated:y,shadows:x=!1,linear:v=!1,flat:A=!1,legacy:w=!1,orthographic:S=!1,frameloop:M="always",dpr:b=[1,2],performance:R,raycaster:P,camera:C,onPointerMissed:B}=u,H=s.getState(),k=H.gl;H.gl||H.set({gl:k=bQ(f,n)});let $=H.raycaster;$||H.set({raycaster:$=new oR});const{params:U,...z}=P||{};if(Kn.equ(z,$,_d)||bc($,{...z}),Kn.equ(U,$.params,_d)||bc($,{params:{...$.params,...U}}),!H.camera||H.camera===c&&!Kn.equ(c,C,_d)){c=C;const V=C instanceof Xv,Q=V?C:S?new ra(0,0,0,0,.1,1e3):new or(75,0,.1,1e3);V||(Q.position.z=5,C&&bc(Q,C),!H.camera&&!(C!=null&&C.rotation)&&Q.lookAt(0,0,0)),H.set({camera:Q})}if(!H.scene){let V;m instanceof yu?V=m:(V=new yu,m&&bc(V,m)),H.set({scene:Td(V)})}if(!H.xr){const V=(ne,fe)=>{const pe=s.getState();pe.frameloop!=="never"&&mN(ne,!0,pe,fe)},Q=()=>{const ne=s.getState();ne.gl.xr.enabled=ne.gl.xr.isPresenting,ne.gl.xr.setAnimationLoop(ne.gl.xr.isPresenting?V:null),ne.gl.xr.isPresenting||pN(ne)},q={connect(){const ne=s.getState().gl;ne.xr.addEventListener("sessionstart",Q),ne.xr.addEventListener("sessionend",Q)},disconnect(){const ne=s.getState().gl;ne.xr.removeEventListener("sessionstart",Q),ne.xr.removeEventListener("sessionend",Q)}};k.xr&&q.connect(),H.set({xr:q})}if(k.shadowMap){const V=k.shadowMap.enabled,Q=k.shadowMap.type;if(k.shadowMap.enabled=!!x,Kn.boo(x))k.shadowMap.type=m0;else if(Kn.str(x)){var O;const q={basic:ZF,percentage:I_,soft:m0,variance:Fo};k.shadowMap.type=(O=q[x])!=null?O:m0}else Kn.obj(x)&&Object.assign(k.shadowMap,x);(V!==k.shadowMap.enabled||Q!==k.shadowMap.type)&&(k.shadowMap.needsUpdate=!0)}const ie=$k();ie&&("enabled"in ie?ie.enabled=!w:"legacyMode"in ie&&(ie.legacyMode=w)),bc(k,{outputEncoding:v?3e3:3001,toneMapping:A?na:u2}),H.legacy!==w&&H.set(()=>({legacy:w})),H.linear!==v&&H.set(()=>({linear:v})),H.flat!==A&&H.set(()=>({flat:A})),f&&!Kn.fun(f)&&!l4(f)&&!Kn.equ(f,k,_d)&&bc(k,f),g&&!H.events.handlers&&H.set({events:g(s)});const W=MQ(n,d);return Kn.equ(W,H.size,_d)||H.setSize(W.width,W.height,W.updateStyle,W.top,W.left),b&&H.viewport.dpr!==i4(b)&&H.setDpr(b),H.frameloop!==M&&H.setFrameloop(M),H.onPointerMissed||H.set({onPointerMissed:B}),R&&!Kn.equ(R,H.performance,_d)&&H.set(V=>({performance:{...V.performance,...R}})),a=y,l=!0,this},render(u){return l||this.configure(),nv.updateContainer(te.createElement(CQ,{store:s,children:u,onCreated:a,rootElement:n}),o,null,()=>{}),s},unmount(){u4(n)}}}function CQ({store:n,children:e,onCreated:t,rootElement:r}){return ty(()=>{const i=n.getState();i.set(s=>({internal:{...s.internal,active:!0}})),t&&t(i),n.getState().events.connected||i.events.connect==null||i.events.connect(r)},[]),te.createElement(lR.Provider,{value:n},e)}function u4(n,e){const t=Sm.get(n),r=t==null?void 0:t.fiber;if(r){const i=t==null?void 0:t.store.getState();i&&(i.internal.active=!1),nv.updateContainer(null,r,null,()=>{i&&setTimeout(()=>{try{var s,o,a,l;i.events.disconnect==null||i.events.disconnect(),(s=i.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=i.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=i.gl)!=null&&l.xr&&i.xr.disconnect(),mQ(i),Sm.delete(n),e&&e(n)}catch{}},500)})}}function RQ(n,e,t){return te.createElement(BQ,{key:e.uuid,children:n,container:e,state:t})}function BQ({state:n={},children:e,container:t}){const{events:r,size:i,...s}=n,o=cR(),[a]=te.useState(()=>new oR),[l]=te.useState(()=>new Ge),c=te.useCallback((f,d)=>{const m={...f};Object.keys(f).forEach(y=>{(xQ.includes(y)||f[y]!==d[y]&&d[y])&&delete m[y]});let g;if(d&&i){const y=d.camera;g=f.viewport.getCurrentViewport(y,new Y,i),y!==f.camera&&o4(y,i)}return{...m,scene:t,raycaster:a,pointer:l,mouse:l,previousRoot:o,events:{...f.events,...d==null?void 0:d.events,...r},size:{...f.size,...i},viewport:{...f.viewport,...g},...s}},[n]),[u]=te.useState(()=>{const f=o.getState();return Jk((m,g)=>({...f,scene:t,raycaster:a,pointer:l,mouse:l,previousRoot:o,events:{...f.events,...r},size:{...f.size,...i},...s,set:m,get:g,setEvents:y=>m(x=>({...x,events:{...x.events,...y}}))}))});return te.useEffect(()=>{const f=o.subscribe(d=>u.setState(m=>c(d,m)));return()=>{f(),u.destroy()}},[]),te.useEffect(()=>{u.setState(f=>c(o.getState(),f))},[c]),te.createElement(te.Fragment,null,nv.createPortal(te.createElement(lR.Provider,{value:u},e),u,null))}nv.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:te.version});function oa(){return oa=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},oa.apply(null,arguments)}function gN(n,e){let t;return(...r)=>{window.clearTimeout(t),t=window.setTimeout(()=>n(...r),e)}}function PQ({debounce:n,scroll:e,polyfill:t,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,o]=te.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),a=te.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=n?typeof n=="number"?n:n.scroll:null,c=n?typeof n=="number"?n:n.resize:null,u=te.useRef(!1);te.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[f,d,m]=te.useMemo(()=>{const v=()=>{if(!a.current.element)return;const{left:A,top:w,width:S,height:M,bottom:b,right:R,x:P,y:C}=a.current.element.getBoundingClientRect(),B={left:A,top:w,width:S,height:M,bottom:b,right:R,x:P,y:C};a.current.element instanceof HTMLElement&&r&&(B.height=a.current.element.offsetHeight,B.width=a.current.element.offsetWidth),Object.freeze(B),u.current&&!DQ(a.current.lastBounds,B)&&o(a.current.lastBounds=B)};return[v,c?gN(v,c):v,l?gN(v,l):v]},[o,r,l,c]);function g(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(v=>v.removeEventListener("scroll",m,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function y(){a.current.element&&(a.current.resizeObserver=new i(m),a.current.resizeObserver.observe(a.current.element),e&&a.current.scrollContainers&&a.current.scrollContainers.forEach(v=>v.addEventListener("scroll",m,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{m()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}const x=v=>{!v||v===a.current.element||(g(),a.current.element=v,a.current.scrollContainers=f4(v),y())};return LQ(m,!!e),IQ(d),te.useEffect(()=>{g(),y()},[e,m,d]),te.useEffect(()=>g,[]),[x,s,f]}function IQ(n){te.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function LQ(n,e){te.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function f4(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:r,overflowY:i}=window.getComputedStyle(n);return[t,r,i].some(s=>s==="auto"||s==="scroll")&&e.push(n),[...e,...f4(n.parentElement)]}const NQ=["x","y","top","bottom","left","right","width","height"],DQ=(n,e)=>NQ.every(t=>n[t]===e[t]);var UQ=Object.defineProperty,FQ=Object.defineProperties,OQ=Object.getOwnPropertyDescriptors,vN=Object.getOwnPropertySymbols,kQ=Object.prototype.hasOwnProperty,GQ=Object.prototype.propertyIsEnumerable,yN=(n,e,t)=>e in n?UQ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,xN=(n,e)=>{for(var t in e||(e={}))kQ.call(e,t)&&yN(n,t,e[t]);if(vN)for(var t of vN(e))GQ.call(e,t)&&yN(n,t,e[t]);return n},zQ=(n,e)=>FQ(n,OQ(e)),AN,_N;typeof window<"u"&&((AN=window.document)!=null&&AN.createElement||((_N=window.navigator)==null?void 0:_N.product)==="ReactNative")?te.useLayoutEffect:te.useEffect;function h4(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=e?n.return:n.child;for(;r;){const i=h4(r,e,t);if(i)return i;r=e?null:r.sibling}}function d4(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const wN=console.error;console.error=function(){const n=[...arguments].join("");if(n!=null&&n.startsWith("Warning:")&&n.includes("useContext")){console.error=wN;return}return wN.apply(this,arguments)};const uR=d4(te.createContext(null));class p4 extends te.Component{render(){return te.createElement(uR.Provider,{value:this._reactInternals},this.props.children)}}function HQ(){const n=te.useContext(uR);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=te.useId();return te.useMemo(()=>{for(const r of[n,n==null?void 0:n.alternate]){if(!r)continue;const i=h4(r,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[n,e])}function VQ(){const n=HQ(),[e]=te.useState(()=>new Map);e.clear();let t=n;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==uR&&!e.has(i)&&e.set(i,te.useContext(d4(i)))}t=t.return}return e}function WQ(){const n=VQ();return te.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>te.createElement(e,null,te.createElement(t.Provider,zQ(xN({},r),{value:n.get(t)}))),e=>te.createElement(p4,xN({},e))),[n])}const zS={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function XQ(n){const{handlePointer:e}=yQ(n);return{priority:1,enabled:!0,compute(t,r,i){r.pointer.set(t.offsetX/r.size.width*2-1,-(t.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(zS).reduce((t,r)=>({...t,[r]:e(r)}),{}),update:()=>{var t;const{events:r,internal:i}=n.getState();(t=i.lastEvent)!=null&&t.current&&r.handlers&&r.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var r;const{set:i,events:s}=n.getState();s.disconnect==null||s.disconnect(),i(o=>({events:{...o.events,connected:t}})),Object.entries((r=s.handlers)!=null?r:[]).forEach(([o,a])=>{const[l,c]=zS[o];t.addEventListener(l,a,{passive:c})})},disconnect:()=>{const{set:t,events:r}=n.getState();if(r.connected){var i;Object.entries((i=r.handlers)!=null?i:[]).forEach(([s,o])=>{if(r&&r.connected instanceof HTMLElement){const[a]=zS[s];r.connected.removeEventListener(a,o)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}const JQ=te.forwardRef(function({children:e,fallback:t,resize:r,style:i,gl:s,events:o=XQ,eventSource:a,eventPrefix:l,shadows:c,linear:u,flat:f,legacy:d,orthographic:m,frameloop:g,dpr:y,performance:x,raycaster:v,camera:A,onPointerMissed:w,onCreated:S,...M},b){te.useMemo(()=>uw(tQ),[]);const R=WQ(),[P,C]=PQ({scroll:!0,debounce:{scroll:50,resize:0},...r}),B=te.useRef(null),H=te.useRef(null);te.useImperativeHandle(b,()=>B.current);const k=t4(w),[$,U]=te.useState(!1),[z,O]=te.useState(!1);if($)throw $;if(z)throw z;const ie=te.useRef(null);ty(()=>{const K=B.current;C.width>0&&C.height>0&&K&&(ie.current||(ie.current=TQ(K)),ie.current.configure({gl:s,events:o,shadows:c,linear:u,flat:f,legacy:d,orthographic:m,frameloop:g,dpr:y,performance:x,raycaster:v,camera:A,size:C,onPointerMissed:(...W)=>k.current==null?void 0:k.current(...W),onCreated:W=>{W.events.connect==null||W.events.connect(a?fQ(a)?a.current:a:H.current),l&&W.setEvents({compute:(V,Q)=>{const q=V[l+"X"],ne=V[l+"Y"];Q.pointer.set(q/Q.size.width*2-1,-(ne/Q.size.height)*2+1),Q.raycaster.setFromCamera(Q.pointer,Q.camera)}}),S==null||S(W)}}),ie.current.render(te.createElement(R,null,te.createElement(n4,{set:O},te.createElement(te.Suspense,{fallback:te.createElement(hQ,{set:U})},e)))))}),te.useEffect(()=>{const K=B.current;if(K)return()=>u4(K)},[]);const X=a?"none":"auto";return te.createElement("div",oa({ref:H,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:X,...i}},M),te.createElement("div",{ref:P,style:{width:"100%",height:"100%"}},te.createElement("canvas",{ref:B,style:{display:"block"}},t)))}),KQ=te.forwardRef(function(e,t){return te.createElement(p4,null,te.createElement(JQ,oa({},e,{ref:t})))});/**
 * postprocessing v6.38.2 build Mon Dec 22 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rschen
 * @license Zlib
 */var HS=1/1e3,QQ=1e3,jQ=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(n){typeof document<"u"&&document.hidden!==void 0&&(n?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=n)}get delta(){return this._delta*HS}get fixedDelta(){return this._fixedDelta*HS}set fixedDelta(n){this._fixedDelta=n*QQ}get elapsed(){return this._elapsed*HS}update(n){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(n!==void 0?n:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(n){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},YQ=(()=>{const n=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),t=new jt;return t.setAttribute("position",new vn(n,3)),t.setAttribute("uv",new vn(e,2)),t})(),Ms=class hT{static get fullscreenGeometry(){return YQ}constructor(e="Pass",t=new yu,r=new ra){this.name=e,this.renderer=null,this.scene=t,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new On(hT.fullscreenGeometry,e),t.frustumCulled=!1,this.scene===null&&(this.scene=new yu),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=Tu){}render(e,t,r,i,s){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,r){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof hr||t instanceof ur||t instanceof Sn||t instanceof hT)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},ZQ=class extends Ms{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(n,e,t,r,i){const s=n.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},qQ=`#ifdef COLOR_WRITE
#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#endif
#ifdef DEPTH_WRITE
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}
#endif
#ifdef USE_WEIGHTS
uniform vec4 channelWeights;
#endif
uniform float opacity;varying vec2 vUv;void main(){
#ifdef COLOR_WRITE
vec4 texel=texture2D(inputBuffer,vUv);
#ifdef USE_WEIGHTS
texel*=channelWeights;
#endif
gl_FragColor=opacity*texel;
#ifdef COLOR_SPACE_CONVERSION
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
#else
gl_FragColor=vec4(0.0);
#endif
#ifdef DEPTH_WRITE
gl_FragDepth=readDepth(vUv);
#endif
}`,m4="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",g4=class extends Pr{constructor(){super({name:"CopyMaterial",defines:{COLOR_SPACE_CONVERSION:"1",DEPTH_PACKING:"0",COLOR_WRITE:"1"},uniforms:{inputBuffer:new xn(null),depthBuffer:new xn(null),channelWeights:new xn(null),opacity:new xn(1)},blending:gi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:qQ,vertexShader:m4}),this.depthFunc=c2}get inputBuffer(){return this.uniforms.inputBuffer.value}set inputBuffer(n){const e=n!==null;this.colorWrite!==e&&(e?this.defines.COLOR_WRITE=!0:delete this.defines.COLOR_WRITE,this.colorWrite=e,this.needsUpdate=!0),this.uniforms.inputBuffer.value=n}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(n){const e=n!==null;this.depthWrite!==e&&(e?this.defines.DEPTH_WRITE=!0:delete this.defines.DEPTH_WRITE,this.depthTest=e,this.depthWrite=e,this.needsUpdate=!0),this.uniforms.depthBuffer.value=n}set depthPacking(n){this.defines.DEPTH_PACKING=n.toFixed(0),this.needsUpdate=!0}get colorSpaceConversion(){return this.defines.COLOR_SPACE_CONVERSION!==void 0}set colorSpaceConversion(n){this.colorSpaceConversion!==n&&(n?this.defines.COLOR_SPACE_CONVERSION=!0:delete this.defines.COLOR_SPACE_CONVERSION,this.needsUpdate=!0)}get channelWeights(){return this.uniforms.channelWeights.value}set channelWeights(n){n!==null?(this.defines.USE_WEIGHTS="1",this.uniforms.channelWeights.value=n):delete this.defines.USE_WEIGHTS,this.needsUpdate=!0}setInputBuffer(n){this.uniforms.inputBuffer.value=n}getOpacity(n){return this.uniforms.opacity.value}setOpacity(n){this.uniforms.opacity.value=n}},$Q=class extends Ms{constructor(n,e=!0){super("CopyPass"),this.fullscreenMaterial=new g4,this.needsSwap=!1,this.renderTarget=n,n===void 0&&(this.renderTarget=new hr(1,1,{minFilter:un,magFilter:un,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(n){this.autoResize=n}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(n){this.autoResize=n}render(n,e,t,r,i){this.fullscreenMaterial.inputBuffer=e.texture,n.setRenderTarget(this.renderToScreen?null:this.renderTarget),n.render(this.scene,this.camera)}setSize(n,e){this.autoResize&&this.renderTarget.setSize(n,e)}initialize(n,e,t){t!==void 0&&(this.renderTarget.texture.type=t,t!==Gr?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":n!==null&&n.outputColorSpace===mn&&(this.renderTarget.texture.colorSpace=mn))}},EN=new ht,v4=class extends Ms{constructor(n=!0,e=!0,t=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=n,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(n,e,t){this.color=n,this.depth=e,this.stencil=t}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(n){this.overrideClearColor=n}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(n){this.overrideClearAlpha=n}render(n,e,t,r,i){const s=this.overrideClearColor,o=this.overrideClearAlpha,a=n.getClearAlpha(),l=s!==null,c=o>=0;l?(n.getClearColor(EN),n.setClearColor(s,c?o:a)):c&&n.setClearAlpha(o),n.setRenderTarget(this.renderToScreen?null:e),n.clear(this.color,this.depth,this.stencil),l?n.setClearColor(EN,a):c&&n.setClearAlpha(a)}},ej=class extends Ms{constructor(n,e){super("MaskPass",n,e),this.needsSwap=!1,this.clearPass=new v4(!1,!1,!0),this.inverse=!1}set mainScene(n){this.scene=n}set mainCamera(n){this.camera=n}get inverted(){return this.inverse}set inverted(n){this.inverse=n}get clear(){return this.clearPass.enabled}set clear(n){this.clearPass.enabled=n}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(n){this.inverted=n}render(n,e,t,r,i){const s=n.getContext(),o=n.state.buffers,a=this.scene,l=this.camera,c=this.clearPass,u=this.inverted?0:1,f=1-u;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.stencil.setFunc(s.ALWAYS,u,4294967295),o.stencil.setClear(f),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(n,null):(c.render(n,e),c.render(n,t))),this.renderToScreen?(n.setRenderTarget(null),n.render(a,l)):(n.setRenderTarget(e),n.render(a,l),n.setRenderTarget(t),n.render(a,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(s.EQUAL,1,4294967295),o.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.stencil.setLocked(!0)}},tj=class{constructor(e=null,{depthBuffer:t=!0,stencilBuffer:r=!1,multisampling:i=0,frameBufferType:s}={}){this.renderer=null,this.inputBuffer=this.createBuffer(t,r,s,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new $Q,this.depthTexture=null,this.passes=[],this.timer=new jQ,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){const t=this.inputBuffer,r=this.multisampling;r>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):r!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,e!==null){const t=e.getSize(new Ge),r=e.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===Gr&&e.outputColorSpace===mn&&(this.inputBuffer.texture.colorSpace=mn,this.outputBuffer.texture.colorSpace=mn,this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(t.width,t.height);for(const s of this.passes)s.initialize(e,r,i)}}replaceRenderer(e,t=!0){const r=this.renderer,i=r.domElement.parentNode;return this.setRenderer(e),t&&i!==null&&(i.removeChild(r.domElement),i.appendChild(e.domElement)),r}createDepthTexture(){const e=this.depthTexture=new k_;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=vu,e.type=Nl):e.type=qo,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,r,i){const s=this.renderer,o=s===null?new Ge:s.getDrawingBufferSize(new Ge),a={minFilter:un,magFilter:un,stencilBuffer:t,depthBuffer:e,type:r},l=new hr(o.width,o.height,a);return i>0&&(l.samples=i),r===Gr&&s!==null&&s.outputColorSpace===mn&&(l.texture.colorSpace=mn),l.texture.name="EffectComposer.Buffer",l.texture.generateMipmaps=!1,l}setMainScene(e){for(const t of this.passes)t.mainScene=e}setMainCamera(e){for(const t of this.passes)t.mainCamera=e}addPass(e,t){const r=this.passes,i=this.renderer,s=i.getDrawingBufferSize(new Ge),o=i.getContext().getContextAttributes().alpha,a=this.inputBuffer.texture.type;if(e.setRenderer(i),e.setSize(s.width,s.height),e.initialize(i,o,a),this.autoRenderToScreen&&(r.length>0&&(r[r.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?r.splice(t,0,e):r.push(e),this.autoRenderToScreen&&(r[r.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const l=this.createDepthTexture();for(e of r)e.setDepthTexture(l)}else e.setDepthTexture(this.depthTexture)}removePass(e){const t=this.passes,r=t.indexOf(e);if(r!==-1&&t.splice(r,1).length>0){if(this.depthTexture!==null){const o=(l,c)=>l||c.needsDepthTexture;t.reduce(o,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&r===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){const e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){const t=this.renderer,r=this.copyPass;let i=this.inputBuffer,s=this.outputBuffer,o=!1,a,l,c;e===void 0&&(this.timer.update(),e=this.timer.getDelta());for(const u of this.passes)u.enabled&&(u.render(t,i,s,e,o),u.needsSwap&&(o&&(r.renderToScreen=u.renderToScreen,a=t.getContext(),l=t.state.buffers.stencil,l.setFunc(a.NOTEQUAL,1,4294967295),r.render(t,i,s,e,o),l.setFunc(a.EQUAL,1,4294967295)),c=i,i=s,s=c),u instanceof ej?o=!0:u instanceof ZQ&&(o=!1))}setSize(e,t,r){const i=this.renderer,s=i.getSize(new Ge);(e===void 0||t===void 0)&&(e=s.width,t=s.height),(s.width!==e||s.height!==t)&&i.setSize(e,t,r);const o=i.getDrawingBufferSize(new Ge);this.inputBuffer.setSize(o.width,o.height),this.outputBuffer.setSize(o.width,o.height);for(const a of this.passes)a.setSize(o.width,o.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Ms.fullscreenGeometry.dispose()}},Dl={NONE:0,DEPTH:1,CONVOLUTION:2},Rn={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},nj=class{constructor(){this.shaderParts=new Map([[Rn.FRAGMENT_HEAD,null],[Rn.FRAGMENT_MAIN_UV,null],[Rn.FRAGMENT_MAIN_IMAGE,null],[Rn.VERTEX_HEAD,null],[Rn.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=Dl.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=is}},VS=!1,SN=class{constructor(n=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(n),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case di:t=this.materialsFlatShadedDoubleSide;break;case Xr:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case di:t=this.materialsDoubleSide;break;case Xr:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}cloneMaterial(n){if(!(n instanceof Pr))return n.clone();const e=n.uniforms,t=new Map;for(const i in e){const s=e[i].value;s.isRenderTargetTexture&&(e[i].value=null,t.set(i,s))}const r=n.clone();for(const i of t)e[i[0]].value=i[1],r.uniforms[i[0]].value=i[1];return r}setMaterial(n){if(this.disposeMaterials(),this.material=n,n!==null){const e=this.materials=[this.cloneMaterial(n),this.cloneMaterial(n),this.cloneMaterial(n)];for(const t of e)t.uniforms=Object.assign({},n.uniforms),t.side=sa;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.side=Xr,r}),this.materialsDoubleSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.side=di,r}),this.materialsFlatShaded=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.flatShading=!0,r}),this.materialsFlatShadedBackSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.flatShading=!0,r.side=Xr,r}),this.materialsFlatShadedDoubleSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.flatShading=!0,r.side=di,r})}}render(n,e,t){const r=n.shadowMap.enabled;if(n.shadowMap.enabled=!1,VS){const i=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),n.render(e,t);for(const s of i)s[0].material=s[1];this.meshCount!==i.size&&i.clear()}else{const i=e.overrideMaterial;e.overrideMaterial=this.material,n.render(e,t),e.overrideMaterial=i}n.shadowMap.enabled=r}disposeMaterials(){if(this.material!==null){const n=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of n)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return VS}static set workaroundEnabled(n){VS=n}},pc=-1,Di=class extends bo{constructor(n,e=pc,t=pc,r=1){super(),this.resizable=n,this.baseSize=new Ge(1,1),this.preferredSize=new Ge(e,t),this.target=this.preferredSize,this.s=r,this.effectiveSize=new Ge,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const n=this.baseSize,e=this.preferredSize,t=this.effectiveSize,r=this.scale;e.width!==pc?t.width=e.width:e.height!==pc?t.width=Math.round(e.height*(n.width/Math.max(n.height,1))):t.width=Math.round(n.width*r),e.height!==pc?t.height=e.height:e.width!==pc?t.height=Math.round(e.width/Math.max(n.width/Math.max(n.height,1),1)):t.height=Math.round(n.height*r)}get width(){return this.effectiveSize.width}set width(n){this.preferredWidth=n}get height(){return this.effectiveSize.height}set height(n){this.preferredHeight=n}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(n){this.s!==n&&(this.s=n,this.preferredSize.setScalar(pc),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(n){this.scale=n}get baseWidth(){return this.baseSize.width}set baseWidth(n){this.baseSize.width!==n&&(this.baseSize.width=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(n){this.baseWidth=n}get baseHeight(){return this.baseSize.height}set baseHeight(n){this.baseSize.height!==n&&(this.baseSize.height=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(n){this.baseHeight=n}setBaseSize(n,e){(this.baseSize.width!==n||this.baseSize.height!==e)&&(this.baseSize.set(n,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(n){this.preferredSize.width!==n&&(this.preferredSize.width=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(n){this.preferredWidth=n}get preferredHeight(){return this.preferredSize.height}set preferredHeight(n){this.preferredSize.height!==n&&(this.preferredSize.height=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(n){this.preferredHeight=n}setPreferredSize(n,e){(this.preferredSize.width!==n||this.preferredSize.height!==e)&&(this.preferredSize.set(n,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(n){this.s=n.scale,this.baseSize.set(n.baseWidth,n.baseHeight),this.preferredSize.set(n.preferredWidth,n.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return pc}},hn={SKIP:9,SET:30,ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},rj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb+src.rgb;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",ij="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){return mix(dst,src,src.a*opacity);}",sj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=(dst.rgb+src.rgb)*0.5;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",oj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(b.xy,a.z));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",aj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=dst.rgb,b=src.rgb;vec3 c=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/max(b,1e-9))),vec3(1.0),step(1.0,a));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",lj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=dst.rgb,b=src.rgb;vec3 c=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",cj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=min(dst.rgb,src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",uj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=abs(dst.rgb-src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",fj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb/max(src.rgb,1e-9);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",hj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb+src.rgb-2.0*dst.rgb*src.rgb;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",dj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=min(dst.rgb,1.0);vec3 b=min(src.rgb,1.0);vec3 c=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",pj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=step(1.0,dst.rgb+src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",mj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(b.x,a.yz));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",gj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(1.0-src.rgb,0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",vj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=src.rgb*max(1.0-dst.rgb,0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",yj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(dst.rgb,src.rgb);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",xj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=clamp(src.rgb+dst.rgb-1.0,0.0,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Aj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=min(dst.rgb+src.rgb,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",_j="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=clamp(2.0*src.rgb+dst.rgb-1.0,0.0,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",wj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(a.xy,b.z));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Ej="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb*src.rgb;return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Sj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(1.0-abs(1.0-dst.rgb-src.rgb),0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",bj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){return mix(dst,src,opacity);}",Mj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=2.0*src.rgb*dst.rgb;vec3 b=1.0-2.0*(1.0-src.rgb)*(1.0-dst.rgb);vec3 c=mix(a,b,step(0.5,dst.rgb));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Tj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 src2=2.0*src.rgb;vec3 c=mix(mix(src2,dst.rgb,step(0.5*dst.rgb,src.rgb)),max(src2-1.0,vec3(0.0)),step(dst.rgb,src2-1.0));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Cj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=min(dst.rgb*dst.rgb/max(1.0-src.rgb,1e-9),1.0);vec3 c=mix(a,src.rgb,step(1.0,src.rgb));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Rj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 a=RGBToHSL(dst.rgb);vec3 b=RGBToHSL(src.rgb);vec3 c=HSLToRGB(vec3(a.x,b.y,a.z));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Bj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=dst.rgb+src.rgb-min(dst.rgb*src.rgb,1.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Pj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 src2=2.0*src.rgb;vec3 d=dst.rgb+(src2-1.0);vec3 w=step(0.5,src.rgb);vec3 a=dst.rgb-(1.0-src2)*dst.rgb*(1.0-dst.rgb);vec3 b=mix(d*(sqrt(dst.rgb)-dst.rgb),d*dst.rgb*((16.0*dst.rgb-12.0)*dst.rgb+3.0),w*(1.0-step(0.25,dst.rgb)));vec3 c=mix(a,b,w);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Ij="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){return src;}",Lj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=max(dst.rgb-src.rgb,0.0);return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Nj="vec4 blend(const in vec4 dst,const in vec4 src,const in float opacity){vec3 c=mix(max(1.0-min((1.0-dst.rgb)/(2.0*src.rgb),1.0),0.0),min(dst.rgb/(2.0*(1.0-src.rgb)),1.0),step(0.5,src.rgb));return mix(dst,vec4(c,max(dst.a,src.a)),opacity);}",Dj=new Map([[hn.ADD,rj],[hn.ALPHA,ij],[hn.AVERAGE,sj],[hn.COLOR,oj],[hn.COLOR_BURN,aj],[hn.COLOR_DODGE,lj],[hn.DARKEN,cj],[hn.DIFFERENCE,uj],[hn.DIVIDE,fj],[hn.DST,null],[hn.EXCLUSION,hj],[hn.HARD_LIGHT,dj],[hn.HARD_MIX,pj],[hn.HUE,mj],[hn.INVERT,gj],[hn.INVERT_RGB,vj],[hn.LIGHTEN,yj],[hn.LINEAR_BURN,xj],[hn.LINEAR_DODGE,Aj],[hn.LINEAR_LIGHT,_j],[hn.LUMINOSITY,wj],[hn.MULTIPLY,Ej],[hn.NEGATION,Sj],[hn.NORMAL,bj],[hn.OVERLAY,Mj],[hn.PIN_LIGHT,Tj],[hn.REFLECT,Cj],[hn.SATURATION,Rj],[hn.SCREEN,Bj],[hn.SOFT_LIGHT,Pj],[hn.SRC,Ij],[hn.SUBTRACT,Lj],[hn.VIVID_LIGHT,Nj]]),Uj=class extends bo{constructor(n,e=1){super(),this._blendFunction=n,this.opacity=new xn(e)}getOpacity(){return this.opacity.value}setOpacity(n){this.opacity.value=n}get blendFunction(){return this._blendFunction}set blendFunction(n){this._blendFunction=n,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(n){this.blendFunction=n}getShaderCode(){return Dj.get(this.blendFunction)}},dT=class extends bo{constructor(n,e,{attributes:t=Dl.NONE,blendFunction:r=hn.NORMAL,defines:i=new Map,uniforms:s=new Map,extensions:o=null,vertexShader:a=null}={}){super(),this.name=n,this.renderer=null,this.attributes=t,this.fragmentShader=e,this.vertexShader=a,this.defines=i,this.uniforms=s,this.extensions=o,this.blendMode=new Uj(r),this.blendMode.addEventListener("change",l=>this.setChanged()),this._inputColorSpace=is,this._outputColorSpace=qi}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(n){this._inputColorSpace=n,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(n){this._outputColorSpace=n,this.setChanged()}set mainScene(n){}set mainCamera(n){}getName(){return this.name}setRenderer(n){this.renderer=n}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(n){this.attributes=n,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(n){this.fragmentShader=n,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(n){this.vertexShader=n,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(n,e=Tu){}update(n,e,t){}setSize(n,e){}initialize(n,e,t){}dispose(){for(const n of Object.keys(this)){const e=this[n];(e instanceof hr||e instanceof ur||e instanceof Sn||e instanceof Ms)&&this[n].dispose()}}},fR={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},Fj=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,Oj="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",kj=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Gj=class extends Pr{constructor(n=new wn){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new xn(null),texelSize:new xn(new wn),scale:new xn(1),kernel:new xn(0)},blending:gi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Fj,vertexShader:Oj}),this.setTexelSize(n.x,n.y),this.kernelSize=fR.MEDIUM}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.inputBuffer=n}get kernelSequence(){return kj[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(n){this.uniforms.scale.value=n}getScale(){return this.uniforms.scale.value}setScale(n){this.uniforms.scale.value=n}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(n){this.uniforms.kernel.value=n}setKernel(n){this.kernel=n}setTexelSize(n,e){this.uniforms.texelSize.value.set(n,e,n*.5,e*.5)}setSize(n,e){const t=1/n,r=1/e;this.uniforms.texelSize.value.set(t,r,t*.5,r*.5)}},zj=class extends Ms{constructor({kernelSize:n=fR.MEDIUM,resolutionScale:e=.5,width:t=Di.AUTO_SIZE,height:r=Di.AUTO_SIZE,resolutionX:i=t,resolutionY:s=r}={}){super("KawaseBlurPass"),this.renderTargetA=new hr(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const o=this.resolution=new Di(this,i,s,e);o.addEventListener("change",a=>this.setSize(o.baseWidth,o.baseHeight)),this._blurMaterial=new Gj,this._blurMaterial.kernelSize=n,this.copyMaterial=new g4}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(n){this._blurMaterial=n}get dithering(){return this.copyMaterial.dithering}set dithering(n){this.copyMaterial.dithering=n}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(n){this.blurMaterial.kernelSize=n}get width(){return this.resolution.width}set width(n){this.resolution.preferredWidth=n}get height(){return this.resolution.height}set height(n){this.resolution.preferredHeight=n}get scale(){return this.blurMaterial.scale}set scale(n){this.blurMaterial.scale=n}getScale(){return this.blurMaterial.scale}setScale(n){this.blurMaterial.scale=n}getKernelSize(){return this.kernelSize}setKernelSize(n){this.kernelSize=n}getResolutionScale(){return this.resolution.scale}setResolutionScale(n){this.resolution.scale=n}render(n,e,t,r,i){const s=this.scene,o=this.camera,a=this.renderTargetA,l=this.renderTargetB,c=this.blurMaterial,u=c.kernelSequence;let f=e;this.fullscreenMaterial=c;for(let d=0,m=u.length;d<m;++d){const g=d&1?l:a;c.kernel=u[d],c.inputBuffer=f.texture,n.setRenderTarget(g),n.render(s,o),f=g}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=f.texture,n.setRenderTarget(this.renderToScreen?null:t),n.render(s,o)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e);const r=t.width,i=t.height;this.renderTargetA.setSize(r,i),this.renderTargetB.setSize(r,i),this.blurMaterial.setSize(n,e)}initialize(n,e,t){t!==void 0&&(this.renderTargetA.texture.type=t,this.renderTargetB.texture.type=t,t!==Gr?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):n!==null&&n.outputColorSpace===mn&&(this.renderTargetA.texture.colorSpace=mn,this.renderTargetB.texture.colorSpace=mn))}static get AUTO_SIZE(){return Di.AUTO_SIZE}},Hj=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);float mask=1.0;
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);mask=low*high;
#elif defined(THRESHOLD)
mask=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=texel*mask;
#else
gl_FragColor=vec4(l*mask);
#endif
}`,Vj=class extends Pr{constructor(n=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:Bh.replace(/\D+/g,"")},uniforms:{inputBuffer:new xn(null),threshold:new xn(0),smoothing:new xn(1),range:new xn(null)},blending:gi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Hj,vertexShader:m4}),this.colorOutput=n,this.luminanceRange=e}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}get threshold(){return this.uniforms.threshold.value}set threshold(n){this.smoothing>0||n>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=n}getThreshold(){return this.threshold}setThreshold(n){this.threshold=n}get smoothing(){return this.uniforms.smoothing.value}set smoothing(n){this.threshold>0||n>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=n}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(n){this.smoothing=n}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(n){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(n){n?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(n){return this.colorOutput}setColorOutputEnabled(n){this.colorOutput=n}get useRange(){return this.luminanceRange!==null}set useRange(n){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(n){n!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=n,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(n){this.luminanceRange=n}},Wj=class extends Ms{constructor({renderTarget:n,luminanceRange:e,colorOutput:t,resolutionScale:r=1,width:i=Di.AUTO_SIZE,height:s=Di.AUTO_SIZE,resolutionX:o=i,resolutionY:a=s}={}){super("LuminancePass"),this.fullscreenMaterial=new Vj(t,e),this.needsSwap=!1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new hr(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const l=this.resolution=new Di(this,o,a,r);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(n,e,t,r,i){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,n.setRenderTarget(this.renderToScreen?null:this.renderTarget),n.render(this.scene,this.camera)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e),this.renderTarget.setSize(t.width,t.height)}initialize(n,e,t){t!==void 0&&t!==Gr&&(this.renderTarget.texture.type=t,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Xj=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,Jj="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",Kj=class extends Pr{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new xn(null),texelSize:new xn(new Ge)},blending:gi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Xj,vertexShader:Jj})}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}},Qj=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,jj="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",Yj=class extends Pr{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new xn(null),supportBuffer:new xn(null),texelSize:new xn(new Ge),radius:new xn(.85)},blending:gi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Qj,vertexShader:jj})}set inputBuffer(n){this.uniforms.inputBuffer.value=n}set supportBuffer(n){this.uniforms.supportBuffer.value=n}get radius(){return this.uniforms.radius.value}set radius(n){this.uniforms.radius.value=n}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}},Zj=class extends Ms{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new hr(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new Kj,this.upsamplingMaterial=new Yj,this.resolution=new Ge}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(n){if(this.levels!==n){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let t=0;t<n;++t){const r=e.clone();r.texture.name="Downsampling.Mipmap"+t,this.downsamplingMipmaps.push(r)}this.upsamplingMipmaps.push(e);for(let t=1,r=n-1;t<r;++t){const i=e.clone();i.texture.name="Upsampling.Mipmap"+t,this.upsamplingMipmaps.push(i)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(n){this.upsamplingMaterial.radius=n}render(n,e,t,r,i){const{scene:s,camera:o}=this,{downsamplingMaterial:a,upsamplingMaterial:l}=this,{downsamplingMipmaps:c,upsamplingMipmaps:u}=this;let f=e;this.fullscreenMaterial=a;for(let d=0,m=c.length;d<m;++d){const g=c[d];a.setSize(f.width,f.height),a.inputBuffer=f.texture,n.setRenderTarget(g),n.render(s,o),f=g}this.fullscreenMaterial=l;for(let d=u.length-1;d>=0;--d){const m=u[d];l.setSize(f.width,f.height),l.inputBuffer=f.texture,l.supportBuffer=c[d].texture,n.setRenderTarget(m),n.render(s,o),f=m}}setSize(n,e){const t=this.resolution;t.set(n,e);let r=t.width,i=t.height;for(let s=0,o=this.downsamplingMipmaps.length;s<o;++s)r=Math.round(r*.5),i=Math.round(i*.5),this.downsamplingMipmaps[s].setSize(r,i),s<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[s].setSize(r,i)}initialize(n,e,t){if(t!==void 0){const r=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const i of r)i.texture.type=t;if(t!==Gr)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(n!==null&&n.outputColorSpace===mn)for(const i of r)i.texture.colorSpace=mn}}dispose(){super.dispose();for(const n of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))n.dispose()}},qj=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=texture2D(map,uv)*intensity;}`,$j=class extends dT{constructor({blendFunction:n=hn.SCREEN,luminanceThreshold:e=1,luminanceSmoothing:t=.03,mipmapBlur:r=!0,intensity:i=1,radius:s=.85,levels:o=8,kernelSize:a=fR.LARGE,resolutionScale:l=.5,width:c=Di.AUTO_SIZE,height:u=Di.AUTO_SIZE,resolutionX:f=c,resolutionY:d=u}={}){super("BloomEffect",qj,{blendFunction:n,uniforms:new Map([["map",new xn(null)],["intensity",new xn(i)]])}),this.renderTarget=new hr(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new zj({kernelSize:a}),this.luminancePass=new Wj({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=t,this.mipmapBlurPass=new Zj,this.mipmapBlurPass.enabled=r,this.mipmapBlurPass.radius=s,this.mipmapBlurPass.levels=o,this.uniforms.get("map").value=r?this.mipmapBlurPass.texture:this.renderTarget.texture;const m=this.resolution=new Di(this,f,d,l);m.addEventListener("change",g=>this.setSize(m.baseWidth,m.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(n){this.resolution.preferredWidth=n}get height(){return this.resolution.height}set height(n){this.resolution.preferredHeight=n}get dithering(){return this.blurPass.dithering}set dithering(n){this.blurPass.dithering=n}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(n){this.blurPass.kernelSize=n}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(n){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(n){this.uniforms.get("intensity").value=n}getIntensity(){return this.intensity}setIntensity(n){this.intensity=n}getResolutionScale(){return this.resolution.scale}setResolutionScale(n){this.resolution.scale=n}update(n,e,t){const r=this.renderTarget,i=this.luminancePass;i.enabled?(i.render(n,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(n,i.renderTarget):this.blurPass.render(n,i.renderTarget,r)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(n,e):this.blurPass.render(n,e,r)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e),this.renderTarget.setSize(t.width,t.height),this.blurPass.resolution.copy(t),this.luminancePass.setSize(n,e),this.mipmapBlurPass.setSize(n,e)}initialize(n,e,t){this.blurPass.initialize(n,e,t),this.luminancePass.initialize(n,e,t),this.mipmapBlurPass.initialize(n,e,t),t!==void 0&&(this.renderTarget.texture.type=t,n!==null&&n.outputColorSpace===mn&&(this.renderTarget.texture.colorSpace=mn))}},y4=class extends Ms{constructor(n,e,t=null){super("RenderPass",n,e),this.needsSwap=!1,this.clearPass=new v4,this.overrideMaterialManager=t===null?null:new SN(t),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(n){this.scene=n}set mainCamera(n){this.camera=n}get renderToScreen(){return super.renderToScreen}set renderToScreen(n){super.renderToScreen=n,this.clearPass.renderToScreen=n}get overrideMaterial(){const n=this.overrideMaterialManager;return n!==null?n.material:null}set overrideMaterial(n){const e=this.overrideMaterialManager;n!==null?e!==null?e.setMaterial(n):this.overrideMaterialManager=new SN(n):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(n){this.overrideMaterial=n}get clear(){return this.clearPass.enabled}set clear(n){this.clearPass.enabled=n}getSelection(){return this.selection}setSelection(n){this.selection=n}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(n){this.ignoreBackground=n}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(n){this.skipShadowMapUpdate=n}getClearPass(){return this.clearPass}render(n,e,t,r,i){const s=this.scene,o=this.camera,a=this.selection,l=o.layers.mask,c=s.background,u=n.shadowMap.autoUpdate,f=this.renderToScreen?null:e;a!==null&&o.layers.set(a.getLayer()),this.skipShadowMapUpdate&&(n.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(n,e),n.setRenderTarget(f),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(n,s,o):n.render(s,o),o.layers.mask=l,s.background=c,n.shadowMap.autoUpdate=u}},eY=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,tY="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",nY=class extends Pr{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new xn(null),normalBuffer:new xn(null),texelSize:new xn(new Ge)},blending:gi,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:eY,vertexShader:tY})}set depthBuffer(n){this.uniforms.depthBuffer.value=n}set depthPacking(n){this.defines.DEPTH_PACKING=n.toFixed(0),this.needsUpdate=!0}setDepthBuffer(n,e=Tu){this.depthBuffer=n,this.depthPacking=e}set normalBuffer(n){this.uniforms.normalBuffer.value=n,n!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(n){this.normalBuffer=n}setTexelSize(n,e){this.uniforms.texelSize.value.set(n,e)}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}},rY=class extends Ms{constructor({normalBuffer:n=null,resolutionScale:e=.5,width:t=Di.AUTO_SIZE,height:r=Di.AUTO_SIZE,resolutionX:i=t,resolutionY:s=r}={}){super("DepthDownsamplingPass");const o=new nY;o.normalBuffer=n,this.fullscreenMaterial=o,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new hr(1,1,{minFilter:Vn,magFilter:Vn,depthBuffer:!1,type:Cr}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const a=this.resolution=new Di(this,i,s,e);a.addEventListener("change",l=>this.setSize(a.baseWidth,a.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(n,e=Tu){this.fullscreenMaterial.depthBuffer=n,this.fullscreenMaterial.depthPacking=e}render(n,e,t,r,i){n.setRenderTarget(this.renderToScreen?null:this.renderTarget),n.render(this.scene,this.camera)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e),this.renderTarget.setSize(t.width,t.height),this.fullscreenMaterial.setSize(n,e)}initialize(n,e,t){const r=n.getContext();if(!(r.getExtension("EXT_color_buffer_float")||r.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}},iY=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#if defined(USE_LOGARITHMIC_DEPTH_BUFFER) || defined(LOG_DEPTH)
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#elif defined(USE_REVERSED_DEPTH_BUFFER)
depth=1.0-depth;
#endif
return depth;}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,sY="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",oY=class extends Pr{constructor(n,e,t,r,i=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:Bh.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new xn(null),depthBuffer:new xn(null),resolution:new xn(new Ge),texelSize:new xn(new Ge),cameraNear:new xn(.3),cameraFar:new xn(1e3),aspect:new xn(1),time:new xn(0)},blending:gi,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:i}),n&&this.setShaderParts(n),e&&this.setDefines(e),t&&this.setUniforms(t),this.copyCameraSettings(r)}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(n){this.uniforms.depthBuffer.value=n}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(n){this.defines.DEPTH_PACKING=n.toFixed(0),this.needsUpdate=!0}setDepthBuffer(n,e=Tu){this.depthBuffer=n,this.depthPacking=e}setShaderData(n){this.setShaderParts(n.shaderParts),this.setDefines(n.defines),this.setUniforms(n.uniforms),this.setExtensions(n.extensions)}setShaderParts(n){return this.fragmentShader=iY.replace(Rn.FRAGMENT_HEAD,n.get(Rn.FRAGMENT_HEAD)||"").replace(Rn.FRAGMENT_MAIN_UV,n.get(Rn.FRAGMENT_MAIN_UV)||"").replace(Rn.FRAGMENT_MAIN_IMAGE,n.get(Rn.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=sY.replace(Rn.VERTEX_HEAD,n.get(Rn.VERTEX_HEAD)||"").replace(Rn.VERTEX_MAIN_SUPPORT,n.get(Rn.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(n){for(const e of n.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(n){for(const e of n.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(n){this.extensions={};for(const e of n)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(n){this.encodeOutput!==n&&(n?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(n){return this.encodeOutput}setOutputEncodingEnabled(n){this.encodeOutput=n}get time(){return this.uniforms.time.value}set time(n){this.uniforms.time.value=n}setDeltaTime(n){this.uniforms.time.value+=n}adoptCameraSettings(n){this.copyCameraSettings(n)}copyCameraSettings(n){n&&(this.uniforms.cameraNear.value=n.near,this.uniforms.cameraFar.value=n.far,n instanceof or?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(n,e){const t=this.uniforms;t.resolution.value.set(n,e),t.texelSize.value.set(1/n,1/e),t.aspect.value=n/e}static get Section(){return Rn}};function bN(n,e,t){for(const r of e){const i="$1"+n+r.charAt(0).toUpperCase()+r.slice(1),s=new RegExp("([^\\.])(\\b"+r+"\\b)","g");for(const o of t.entries())o[1]!==null&&t.set(o[0],o[1].replace(s,i))}}function aY(n,e,t){let r=e.getFragmentShader(),i=e.getVertexShader();const s=r!==void 0&&/mainImage/.test(r),o=r!==void 0&&/mainUv/.test(r);if(t.attributes|=e.getAttributes(),r===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(o&&t.attributes&Dl.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!s&&!o)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const a=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,l=t.shaderParts;let c=l.get(Rn.FRAGMENT_HEAD)||"",u=l.get(Rn.FRAGMENT_MAIN_UV)||"",f=l.get(Rn.FRAGMENT_MAIN_IMAGE)||"",d=l.get(Rn.VERTEX_HEAD)||"",m=l.get(Rn.VERTEX_MAIN_SUPPORT)||"";const g=new Set,y=new Set;if(o&&(u+=`	${n}MainUv(UV);
`,t.uvTransformation=!0),i!==null&&/mainSupport/.test(i)){const A=/mainSupport *\([\w\s]*?uv\s*?\)/.test(i);m+=`	${n}MainSupport(`,m+=A?`vUv);
`:`);
`;for(const w of i.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const S of w[1].split(/\s*,\s*/))t.varyings.add(S),g.add(S),y.add(S);for(const w of i.matchAll(a))y.add(w[1])}for(const A of r.matchAll(a))y.add(A[1]);for(const A of e.defines.keys())y.add(A.replace(/\([\w\s,]*\)/g,""));for(const A of e.uniforms.keys())y.add(A);y.delete("while"),y.delete("for"),y.delete("if"),e.uniforms.forEach((A,w)=>t.uniforms.set(n+w.charAt(0).toUpperCase()+w.slice(1),A)),e.defines.forEach((A,w)=>t.defines.set(n+w.charAt(0).toUpperCase()+w.slice(1),A));const x=new Map([["fragment",r],["vertex",i]]);bN(n,y,t.defines),bN(n,y,x),r=x.get("fragment"),i=x.get("vertex");const v=e.blendMode;if(t.blendModes.set(v.blendFunction,v),s){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(f+=e.inputColorSpace===mn?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==qi?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const A=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;f+=`${n}MainImage(color0, UV, `,t.attributes&Dl.DEPTH&&A.test(r)&&(f+="depth, ",t.readDepth=!0),f+=`color1);
	`;const w=n+"BlendOpacity";t.uniforms.set(w,v.opacity),f+=`color0 = blend${v.blendFunction}(color0, color1, ${w});

	`,c+=`uniform float ${w};

`}if(c+=r+`
`,i!==null&&(d+=i+`
`),l.set(Rn.FRAGMENT_HEAD,c),l.set(Rn.FRAGMENT_MAIN_UV,u),l.set(Rn.FRAGMENT_MAIN_IMAGE,f),l.set(Rn.VERTEX_HEAD,d),l.set(Rn.VERTEX_MAIN_SUPPORT,m),e.extensions!==null)for(const A of e.extensions)t.extensions.add(A)}}var lY=class extends Ms{constructor(n,...e){super("EffectPass"),this.fullscreenMaterial=new oY(null,null,null,n),this.listener=t=>this.handleEvent(t),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(n){for(const e of this.effects)e.mainScene=n}set mainCamera(n){this.fullscreenMaterial.copyCameraSettings(n);for(const e of this.effects)e.mainCamera=n}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(n){this.fullscreenMaterial.encodeOutput=n}get dithering(){return this.fullscreenMaterial.dithering}set dithering(n){const e=this.fullscreenMaterial;e.dithering=n,e.needsUpdate=!0}setEffects(n){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=n.sort((e,t)=>t.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const n=new nj;let e=0;for(const o of this.effects)if(o.blendMode.blendFunction===hn.DST)n.attributes|=o.getAttributes()&Dl.DEPTH;else{if(n.attributes&o.getAttributes()&Dl.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${o.name})`);aY("e"+e++,o,n)}let t=n.shaderParts.get(Rn.FRAGMENT_HEAD),r=n.shaderParts.get(Rn.FRAGMENT_MAIN_IMAGE),i=n.shaderParts.get(Rn.FRAGMENT_MAIN_UV);const s=/\bblend\b/g;for(const o of n.blendModes.values())t+=o.getShaderCode().replace(s,`blend${o.blendFunction}`)+`
`;n.attributes&Dl.DEPTH?(n.readDepth&&(r=`float depth = readDepth(UV);

	`+r),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,n.colorSpace===mn&&(r+=`color0 = sRGBToLinear(color0);
	`),n.uvTransformation?(i=`vec2 transformedUv = vUv;
`+i,n.defines.set("UV","transformedUv")):n.defines.set("UV","vUv"),n.shaderParts.set(Rn.FRAGMENT_HEAD,t),n.shaderParts.set(Rn.FRAGMENT_MAIN_IMAGE,r),n.shaderParts.set(Rn.FRAGMENT_MAIN_UV,i);for(const[o,a]of n.shaderParts)a!==null&&n.shaderParts.set(o,a.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(n)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(n,e=Tu){this.fullscreenMaterial.depthBuffer=n,this.fullscreenMaterial.depthPacking=e;for(const t of this.effects)t.setDepthTexture(n,e)}render(n,e,t,r,i){for(const s of this.effects)s.update(n,e,r);if(!this.skipRendering||this.renderToScreen){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=r*this.timeScale,n.setRenderTarget(this.renderToScreen?null:t),n.render(this.scene,this.camera)}}setSize(n,e){this.fullscreenMaterial.setSize(n,e);for(const t of this.effects)t.setSize(n,e)}initialize(n,e,t){this.renderer=n;for(const r of this.effects)r.initialize(n,e,t);this.updateMaterial(),t!==void 0&&t!==Gr&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const n of this.effects)n.removeEventListener("change",this.listener),n.dispose()}handleEvent(n){switch(n.type){case"change":this.recompile();break}}},cY=class extends Ms{constructor(n,e,{renderTarget:t,resolutionScale:r=1,width:i=Di.AUTO_SIZE,height:s=Di.AUTO_SIZE,resolutionX:o=i,resolutionY:a=s}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new y4(n,e,new X2);const l=this.renderPass;l.ignoreBackground=!0,l.skipShadowMapUpdate=!0;const c=l.getClearPass();c.overrideClearColor=new ht(7829503),c.overrideClearAlpha=1,this.renderTarget=t,this.renderTarget===void 0&&(this.renderTarget=new hr(1,1,{minFilter:Vn,magFilter:Vn}),this.renderTarget.texture.name="NormalPass.Target");const u=this.resolution=new Di(this,o,a,r);u.addEventListener("change",f=>this.setSize(u.baseWidth,u.baseHeight))}set mainScene(n){this.renderPass.mainScene=n}set mainCamera(n){this.renderPass.mainCamera=n}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(n){this.resolution.scale=n}render(n,e,t,r,i){const s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(n,s,s)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e),this.renderTarget.setSize(t.width,t.height)}};let Ug;function uY(){var n;if(Ug!==void 0)return Ug;try{let e;const t=document.createElement("canvas");return Ug=!!(window.WebGL2RenderingContext&&(e=t.getContext("webgl2"))),e&&((n=e.getExtension("WEBGL_lose_context"))==null||n.loseContext()),Ug}catch{return Ug=!1}}const hR=(()=>parseInt(Bh.replace(/\D+/g,"")))();function MN(n,e){if(e===DO)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===zA||e===w2){let t=n.getIndex();if(t===null){const o=[],a=n.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const r=t.count-2,i=[];if(t)if(e===zA)for(let o=1;o<=r;o++)i.push(t.getX(0)),i.push(t.getX(o)),i.push(t.getX(o+1));else for(let o=0;o<r;o++)o%2===0?(i.push(t.getX(o)),i.push(t.getX(o+1)),i.push(t.getX(o+2))):(i.push(t.getX(o+2)),i.push(t.getX(o+1)),i.push(t.getX(o)));i.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(i),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}var Ao=Uint8Array,Yc=Uint16Array,pT=Uint32Array,x4=new Ao([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),A4=new Ao([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),fY=new Ao([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_4=function(n,e){for(var t=new Yc(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var i=new pT(t[30]),r=1;r<30;++r)for(var s=t[r];s<t[r+1];++s)i[s]=s-t[r]<<5|r;return[t,i]},w4=_4(x4,2),E4=w4[0],hY=w4[1];E4[28]=258,hY[258]=28;var dY=_4(A4,0),pY=dY[0],mT=new Yc(32768);for(var jn=0;jn<32768;++jn){var mc=(jn&43690)>>>1|(jn&21845)<<1;mc=(mc&52428)>>>2|(mc&13107)<<2,mc=(mc&61680)>>>4|(mc&3855)<<4,mT[jn]=((mc&65280)>>>8|(mc&255)<<8)>>>1}var A0=function(n,e,t){for(var r=n.length,i=0,s=new Yc(e);i<r;++i)++s[n[i]-1];var o=new Yc(e);for(i=0;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;var a;if(t){a=new Yc(1<<e);var l=15-e;for(i=0;i<r;++i)if(n[i])for(var c=i<<4|n[i],u=e-n[i],f=o[n[i]-1]++<<u,d=f|(1<<u)-1;f<=d;++f)a[mT[f]>>>l]=c}else for(a=new Yc(r),i=0;i<r;++i)n[i]&&(a[i]=mT[o[n[i]-1]++]>>>15-n[i]);return a},ny=new Ao(288);for(var jn=0;jn<144;++jn)ny[jn]=8;for(var jn=144;jn<256;++jn)ny[jn]=9;for(var jn=256;jn<280;++jn)ny[jn]=7;for(var jn=280;jn<288;++jn)ny[jn]=8;var S4=new Ao(32);for(var jn=0;jn<32;++jn)S4[jn]=5;var mY=A0(ny,9,1),gY=A0(S4,5,1),WS=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},No=function(n,e,t){var r=e/8|0;return(n[r]|n[r+1]<<8)>>(e&7)&t},XS=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},vY=function(n){return(n/8|0)+(n&7&&1)},yY=function(n,e,t){(e==null||e<0)&&(e=0),(t==null||t>n.length)&&(t=n.length);var r=new(n instanceof Yc?Yc:n instanceof pT?pT:Ao)(t-e);return r.set(n.subarray(e,t)),r},xY=function(n,e,t){var r=n.length;if(!r||t&&!t.l&&r<5)return e||new Ao(0);var i=!e||t,s=!t||t.i;t||(t={}),e||(e=new Ao(r*3));var o=function(pe){var ge=e.length;if(pe>ge){var Ce=new Ao(Math.max(ge*2,pe));Ce.set(e),e=Ce}},a=t.f||0,l=t.p||0,c=t.b||0,u=t.l,f=t.d,d=t.m,m=t.n,g=r*8;do{if(!u){t.f=a=No(n,l,1);var y=No(n,l+1,3);if(l+=3,y)if(y==1)u=mY,f=gY,d=9,m=5;else if(y==2){var w=No(n,l,31)+257,S=No(n,l+10,15)+4,M=w+No(n,l+5,31)+1;l+=14;for(var b=new Ao(M),R=new Ao(19),P=0;P<S;++P)R[fY[P]]=No(n,l+P*3,7);l+=S*3;for(var C=WS(R),B=(1<<C)-1,H=A0(R,C,1),P=0;P<M;){var k=H[No(n,l,B)];l+=k&15;var x=k>>>4;if(x<16)b[P++]=x;else{var $=0,U=0;for(x==16?(U=3+No(n,l,3),l+=2,$=b[P-1]):x==17?(U=3+No(n,l,7),l+=3):x==18&&(U=11+No(n,l,127),l+=7);U--;)b[P++]=$}}var z=b.subarray(0,w),O=b.subarray(w);d=WS(z),m=WS(O),u=A0(z,d,1),f=A0(O,m,1)}else throw"invalid block type";else{var x=vY(l)+4,v=n[x-4]|n[x-3]<<8,A=x+v;if(A>r){if(s)throw"unexpected EOF";break}i&&o(c+v),e.set(n.subarray(x,A),c),t.b=c+=v,t.p=l=A*8;continue}if(l>g){if(s)throw"unexpected EOF";break}}i&&o(c+131072);for(var ie=(1<<d)-1,X=(1<<m)-1,K=l;;K=l){var $=u[XS(n,l)&ie],W=$>>>4;if(l+=$&15,l>g){if(s)throw"unexpected EOF";break}if(!$)throw"invalid length/literal";if(W<256)e[c++]=W;else if(W==256){K=l,u=null;break}else{var V=W-254;if(W>264){var P=W-257,Q=x4[P];V=No(n,l,(1<<Q)-1)+E4[P],l+=Q}var q=f[XS(n,l)&X],ne=q>>>4;if(!q)throw"invalid distance";l+=q&15;var O=pY[ne];if(ne>3){var Q=A4[ne];O+=XS(n,l)&(1<<Q)-1,l+=Q}if(l>g){if(s)throw"unexpected EOF";break}i&&o(c+131072);for(var fe=c+V;c<fe;c+=4)e[c]=e[c-O],e[c+1]=e[c+1-O],e[c+2]=e[c+2-O],e[c+3]=e[c+3-O];c=fe}}t.l=u,t.p=K,t.b=c,u&&(a=1,t.m=d,t.d=f,t.n=m)}while(!a);return c==e.length?e:yY(e,0,c)},AY=new Ao(0),_Y=function(n){if((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(n[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function u1(n,e){return xY((_Y(n),n.subarray(2,-4)),e)}var wY=typeof TextDecoder<"u"&&new TextDecoder,EY=0;try{wY.decode(AY,{stream:!0}),EY=1}catch{}const SY=n=>n&&n.isCubeTexture;class bY extends On{constructor(e,t){var r,i;const s=SY(e),a=((i=s?(r=e.image[0])==null?void 0:r.width:e.image.width)!=null?i:1024)/4,l=Math.floor(Math.log2(a)),c=Math.pow(2,l),u=3*Math.max(c,16*7),f=4*c,d=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/u}`,`#define CUBEUV_TEXEL_HEIGHT ${1/f}`,`#define CUBEUV_MAX_MIP ${l}.0`],m=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,g=d.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${hR>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,y={map:{value:e},height:{value:(t==null?void 0:t.height)||15},radius:{value:(t==null?void 0:t.radius)||100}},x=new Zv(1,16),v=new Pr({uniforms:y,fragmentShader:g,vertexShader:m,side:di});super(x,v)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}function b4(n,e,t={}){const r=new Y,i=new Rr,s=new Y,o=new Bt,a=new Bt,l=new Bt;t.preserveMatrix=t.preserveMatrix!==void 0?t.preserveMatrix:!0,t.preservePosition=t.preservePosition!==void 0?t.preservePosition:!0,t.preserveHipPosition=t.preserveHipPosition!==void 0?t.preserveHipPosition:!1,t.useTargetMatrix=t.useTargetMatrix!==void 0?t.useTargetMatrix:!1,t.hip=t.hip!==void 0?t.hip:"hip",t.names=t.names||{};const c=e.isObject3D?e.skeleton.bones:XA(e),u=n.isObject3D?n.skeleton.bones:XA(n);let f,d,m,g,y;if(n.isObject3D?n.skeleton.pose():(t.useTargetMatrix=!0,t.preserveMatrix=!1),t.preservePosition){y=[];for(let x=0;x<u.length;x++)y.push(u[x].position.clone())}if(t.preserveMatrix){n.updateMatrixWorld(),n.matrixWorld.identity();for(let x=0;x<n.children.length;++x)n.children[x].updateMatrixWorld(!0)}if(t.offsets){f=[];for(let x=0;x<u.length;++x)d=u[x],m=t.names[d.name]||d.name,t.offsets[m]&&(d.matrix.multiply(t.offsets[m]),d.matrix.decompose(d.position,d.quaternion,d.scale),d.updateMatrixWorld()),f.push(d.matrixWorld.clone())}for(let x=0;x<u.length;++x){if(d=u[x],m=t.names[d.name]||d.name,g=M4(m,c),l.copy(d.matrixWorld),g){if(g.updateMatrixWorld(),t.useTargetMatrix?a.copy(g.matrixWorld):(a.copy(n.matrixWorld).invert(),a.multiply(g.matrixWorld)),s.setFromMatrixScale(a),a.scale(s.set(1/s.x,1/s.y,1/s.z)),l.makeRotationFromQuaternion(i.setFromRotationMatrix(a)),n.isObject3D){const v=u.indexOf(d),A=f?f[v]:o.copy(n.skeleton.boneInverses[v]).invert();l.multiply(A)}l.copyPosition(a)}d.parent&&d.parent.isBone?(d.matrix.copy(d.parent.matrixWorld).invert(),d.matrix.multiply(l)):d.matrix.copy(l),t.preserveHipPosition&&m===t.hip&&d.matrix.setPosition(r.set(0,d.position.y,0)),d.matrix.decompose(d.position,d.quaternion,d.scale),d.updateMatrixWorld()}if(t.preservePosition)for(let x=0;x<u.length;++x)d=u[x],m=t.names[d.name]||d.name,m!==t.hip&&d.position.copy(y[x]);t.preserveMatrix&&n.updateMatrixWorld(!0)}function MY(n,e,t,r={}){r.useFirstFramePosition=r.useFirstFramePosition!==void 0?r.useFirstFramePosition:!1,r.fps=r.fps!==void 0?r.fps:30,r.names=r.names||[],e.isObject3D||(e=CY(e));const i=Math.round(t.duration*(r.fps/1e3)*1e3),s=1/r.fps,o=[],a=new sR(e),l=XA(n.skeleton),c=[];let u,f,d,m,g;a.clipAction(t).play(),a.update(0),e.updateMatrixWorld();for(let y=0;y<i;++y){const x=y*s;b4(n,e,r);for(let v=0;v<l.length;++v)g=r.names[l[v].name]||l[v].name,d=M4(g,e.skeleton),d&&(f=l[v],m=c[v]=c[v]||{bone:f},r.hip===g&&(m.pos||(m.pos={times:new Float32Array(i),values:new Float32Array(i*3)}),r.useFirstFramePosition&&(y===0&&(u=f.position.clone()),f.position.sub(u)),m.pos.times[y]=x,f.position.toArray(m.pos.values,y*3)),m.quat||(m.quat={times:new Float32Array(i),values:new Float32Array(i*4)}),m.quat.times[y]=x,f.quaternion.toArray(m.quat.values,y*4));a.update(s),e.updateMatrixWorld()}for(let y=0;y<c.length;++y)m=c[y],m&&(m.pos&&o.push(new _u(".bones["+m.bone.name+"].position",m.pos.times,m.pos.values)),o.push(new Wl(".bones["+m.bone.name+"].quaternion",m.quat.times,m.quat.values)));return a.uncacheAction(t),new Eh(t.name,-1,o)}function TY(n){const e=new Map,t=new Map,r=n.clone();return T4(n,r,function(i,s){e.set(s,i),t.set(i,s)}),r.traverse(function(i){if(!i.isSkinnedMesh)return;const s=i,o=e.get(i),a=o.skeleton.bones;s.skeleton=o.skeleton.clone(),s.bindMatrix.copy(o.bindMatrix),s.skeleton.bones=a.map(function(l){return t.get(l)}),s.bind(s.skeleton,s.bindMatrix)}),r}function M4(n,e){for(let t=0,r=XA(e);t<r.length;t++)if(n===r[t].name)return r[t]}function XA(n){return Array.isArray(n)?n:n.bones}function CY(n){const e=new Vk(n.bones[0]);return e.skeleton=n,e}function T4(n,e,t){t(n,e);for(let r=0;r<n.children.length;r++)T4(n.children[r],e.children[r],t)}const RY={retarget:b4,retargetClip:MY,clone:TY};var BY=Object.defineProperty,PY=(n,e,t)=>e in n?BY(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,IY=(n,e,t)=>(PY(n,typeof e!="symbol"?e+"":e,t),t);class LY{constructor(){IY(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}}var NY=Object.defineProperty,DY=(n,e,t)=>e in n?NY(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,zt=(n,e,t)=>(DY(n,typeof e!="symbol"?e+"":e,t),t);const f1=new Ph,TN=new dl,UY=Math.cos(70*(Math.PI/180)),CN=(n,e)=>(n%e+e)%e;let FY=class extends LY{constructor(e,t){super(),zt(this,"object"),zt(this,"domElement"),zt(this,"enabled",!0),zt(this,"target",new Y),zt(this,"minDistance",0),zt(this,"maxDistance",1/0),zt(this,"minZoom",0),zt(this,"maxZoom",1/0),zt(this,"minPolarAngle",0),zt(this,"maxPolarAngle",Math.PI),zt(this,"minAzimuthAngle",-1/0),zt(this,"maxAzimuthAngle",1/0),zt(this,"enableDamping",!1),zt(this,"dampingFactor",.05),zt(this,"enableZoom",!0),zt(this,"zoomSpeed",1),zt(this,"enableRotate",!0),zt(this,"rotateSpeed",1),zt(this,"enablePan",!0),zt(this,"panSpeed",1),zt(this,"screenSpacePanning",!0),zt(this,"keyPanSpeed",7),zt(this,"zoomToCursor",!1),zt(this,"autoRotate",!1),zt(this,"autoRotateSpeed",2),zt(this,"reverseOrbit",!1),zt(this,"reverseHorizontalOrbit",!1),zt(this,"reverseVerticalOrbit",!1),zt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),zt(this,"mouseButtons",{LEFT:hf.ROTATE,MIDDLE:hf.DOLLY,RIGHT:hf.PAN}),zt(this,"touches",{ONE:df.ROTATE,TWO:df.DOLLY_PAN}),zt(this,"target0"),zt(this,"position0"),zt(this,"zoom0"),zt(this,"_domElementKeyEvents",null),zt(this,"getPolarAngle"),zt(this,"getAzimuthalAngle"),zt(this,"setPolarAngle"),zt(this,"setAzimuthalAngle"),zt(this,"getDistance"),zt(this,"getZoomScale"),zt(this,"listenToKeyEvents"),zt(this,"stopListenToKeyEvents"),zt(this,"saveState"),zt(this,"reset"),zt(this,"update"),zt(this,"connect"),zt(this,"dispose"),zt(this,"dollyIn"),zt(this,"dollyOut"),zt(this,"getScale"),zt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>u.phi,this.getAzimuthalAngle=()=>u.theta,this.setPolarAngle=ae=>{let De=CN(ae,2*Math.PI),rt=u.phi;rt<0&&(rt+=2*Math.PI),De<0&&(De+=2*Math.PI);let it=Math.abs(De-rt);2*Math.PI-it<it&&(De<rt?De+=2*Math.PI:rt+=2*Math.PI),f.phi=De-rt,r.update()},this.setAzimuthalAngle=ae=>{let De=CN(ae,2*Math.PI),rt=u.theta;rt<0&&(rt+=2*Math.PI),De<0&&(De+=2*Math.PI);let it=Math.abs(De-rt);2*Math.PI-it<it&&(De<rt?De+=2*Math.PI:rt+=2*Math.PI),f.theta=De-rt,r.update()},this.getDistance=()=>r.object.position.distanceTo(r.target),this.listenToKeyEvents=ae=>{ae.addEventListener("keydown",ze),this._domElementKeyEvents=ae},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",ze),this._domElementKeyEvents=null},this.saveState=()=>{r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=()=>{r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(i),r.update(),l=a.NONE},this.update=(()=>{const ae=new Y,De=new Y(0,1,0),rt=new Rr().setFromUnitVectors(e.up,De),it=rt.clone().invert(),ve=new Y,ce=new Rr,at=2*Math.PI;return function(){const ct=r.object.position;rt.setFromUnitVectors(e.up,De),it.copy(rt).invert(),ae.copy(ct).sub(r.target),ae.applyQuaternion(rt),u.setFromVector3(ae),r.autoRotate&&l===a.NONE&&U(k()),r.enableDamping?(u.theta+=f.theta*r.dampingFactor,u.phi+=f.phi*r.dampingFactor):(u.theta+=f.theta,u.phi+=f.phi);let ft=r.minAzimuthAngle,Tt=r.maxAzimuthAngle;isFinite(ft)&&isFinite(Tt)&&(ft<-Math.PI?ft+=at:ft>Math.PI&&(ft-=at),Tt<-Math.PI?Tt+=at:Tt>Math.PI&&(Tt-=at),ft<=Tt?u.theta=Math.max(ft,Math.min(Tt,u.theta)):u.theta=u.theta>(ft+Tt)/2?Math.max(ft,u.theta):Math.min(Tt,u.theta)),u.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,u.phi)),u.makeSafe(),r.enableDamping===!0?r.target.addScaledVector(m,r.dampingFactor):r.target.add(m),r.zoomToCursor&&C||r.object.isOrthographicCamera?u.radius=q(u.radius):u.radius=q(u.radius*d),ae.setFromSpherical(u),ae.applyQuaternion(it),ct.copy(r.target).add(ae),r.object.matrixAutoUpdate||r.object.updateMatrix(),r.object.lookAt(r.target),r.enableDamping===!0?(f.theta*=1-r.dampingFactor,f.phi*=1-r.dampingFactor,m.multiplyScalar(1-r.dampingFactor)):(f.set(0,0,0),m.set(0,0,0));let mt=!1;if(r.zoomToCursor&&C){let Dt=null;if(r.object instanceof or&&r.object.isPerspectiveCamera){const qt=ae.length();Dt=q(qt*d);const Ft=qt-Dt;r.object.position.addScaledVector(R,Ft),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){const qt=new Y(P.x,P.y,0);qt.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/d)),r.object.updateProjectionMatrix(),mt=!0;const Ft=new Y(P.x,P.y,0);Ft.unproject(r.object),r.object.position.sub(Ft).add(qt),r.object.updateMatrixWorld(),Dt=ae.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;Dt!==null&&(r.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(Dt).add(r.object.position):(f1.origin.copy(r.object.position),f1.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(f1.direction))<UY?e.lookAt(r.target):(TN.setFromNormalAndCoplanarPoint(r.object.up,r.target),f1.intersectPlane(TN,r.target))))}else r.object instanceof ra&&r.object.isOrthographicCamera&&(mt=d!==1,mt&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/d)),r.object.updateProjectionMatrix()));return d=1,C=!1,mt||ve.distanceToSquared(r.object.position)>c||8*(1-ce.dot(r.object.quaternion))>c?(r.dispatchEvent(i),ve.copy(r.object.position),ce.copy(r.object.quaternion),mt=!1,!0):!1}})(),this.connect=ae=>{r.domElement=ae,r.domElement.style.touchAction="none",r.domElement.addEventListener("contextmenu",gt),r.domElement.addEventListener("pointerdown",de),r.domElement.addEventListener("pointercancel",ye),r.domElement.addEventListener("wheel",Oe)},this.dispose=()=>{var ae,De,rt,it,ve,ce;r.domElement&&(r.domElement.style.touchAction="auto"),(ae=r.domElement)==null||ae.removeEventListener("contextmenu",gt),(De=r.domElement)==null||De.removeEventListener("pointerdown",de),(rt=r.domElement)==null||rt.removeEventListener("pointercancel",ye),(it=r.domElement)==null||it.removeEventListener("wheel",Oe),(ve=r.domElement)==null||ve.ownerDocument.removeEventListener("pointermove",le),(ce=r.domElement)==null||ce.ownerDocument.removeEventListener("pointerup",ye),r._domElementKeyEvents!==null&&r._domElementKeyEvents.removeEventListener("keydown",ze)};const r=this,i={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,u=new lT,f=new lT;let d=1;const m=new Y,g=new Ge,y=new Ge,x=new Ge,v=new Ge,A=new Ge,w=new Ge,S=new Ge,M=new Ge,b=new Ge,R=new Y,P=new Ge;let C=!1;const B=[],H={};function k(){return 2*Math.PI/60/60*r.autoRotateSpeed}function $(){return Math.pow(.95,r.zoomSpeed)}function U(ae){r.reverseOrbit||r.reverseHorizontalOrbit?f.theta+=ae:f.theta-=ae}function z(ae){r.reverseOrbit||r.reverseVerticalOrbit?f.phi+=ae:f.phi-=ae}const O=(()=>{const ae=new Y;return function(rt,it){ae.setFromMatrixColumn(it,0),ae.multiplyScalar(-rt),m.add(ae)}})(),ie=(()=>{const ae=new Y;return function(rt,it){r.screenSpacePanning===!0?ae.setFromMatrixColumn(it,1):(ae.setFromMatrixColumn(it,0),ae.crossVectors(r.object.up,ae)),ae.multiplyScalar(rt),m.add(ae)}})(),X=(()=>{const ae=new Y;return function(rt,it){const ve=r.domElement;if(ve&&r.object instanceof or&&r.object.isPerspectiveCamera){const ce=r.object.position;ae.copy(ce).sub(r.target);let at=ae.length();at*=Math.tan(r.object.fov/2*Math.PI/180),O(2*rt*at/ve.clientHeight,r.object.matrix),ie(2*it*at/ve.clientHeight,r.object.matrix)}else ve&&r.object instanceof ra&&r.object.isOrthographicCamera?(O(rt*(r.object.right-r.object.left)/r.object.zoom/ve.clientWidth,r.object.matrix),ie(it*(r.object.top-r.object.bottom)/r.object.zoom/ve.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}})();function K(ae){r.object instanceof or&&r.object.isPerspectiveCamera||r.object instanceof ra&&r.object.isOrthographicCamera?d=ae:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function W(ae){K(d/ae)}function V(ae){K(d*ae)}function Q(ae){if(!r.zoomToCursor||!r.domElement)return;C=!0;const De=r.domElement.getBoundingClientRect(),rt=ae.clientX-De.left,it=ae.clientY-De.top,ve=De.width,ce=De.height;P.x=rt/ve*2-1,P.y=-(it/ce)*2+1,R.set(P.x,P.y,1).unproject(r.object).sub(r.object.position).normalize()}function q(ae){return Math.max(r.minDistance,Math.min(r.maxDistance,ae))}function ne(ae){g.set(ae.clientX,ae.clientY)}function fe(ae){Q(ae),S.set(ae.clientX,ae.clientY)}function pe(ae){v.set(ae.clientX,ae.clientY)}function ge(ae){y.set(ae.clientX,ae.clientY),x.subVectors(y,g).multiplyScalar(r.rotateSpeed);const De=r.domElement;De&&(U(2*Math.PI*x.x/De.clientHeight),z(2*Math.PI*x.y/De.clientHeight)),g.copy(y),r.update()}function Ce(ae){M.set(ae.clientX,ae.clientY),b.subVectors(M,S),b.y>0?W($()):b.y<0&&V($()),S.copy(M),r.update()}function Je(ae){A.set(ae.clientX,ae.clientY),w.subVectors(A,v).multiplyScalar(r.panSpeed),X(w.x,w.y),v.copy(A),r.update()}function Xe(ae){Q(ae),ae.deltaY<0?V($()):ae.deltaY>0&&W($()),r.update()}function Fe(ae){let De=!1;switch(ae.code){case r.keys.UP:X(0,r.keyPanSpeed),De=!0;break;case r.keys.BOTTOM:X(0,-r.keyPanSpeed),De=!0;break;case r.keys.LEFT:X(r.keyPanSpeed,0),De=!0;break;case r.keys.RIGHT:X(-r.keyPanSpeed,0),De=!0;break}De&&(ae.preventDefault(),r.update())}function j(){if(B.length==1)g.set(B[0].pageX,B[0].pageY);else{const ae=.5*(B[0].pageX+B[1].pageX),De=.5*(B[0].pageY+B[1].pageY);g.set(ae,De)}}function Te(){if(B.length==1)v.set(B[0].pageX,B[0].pageY);else{const ae=.5*(B[0].pageX+B[1].pageX),De=.5*(B[0].pageY+B[1].pageY);v.set(ae,De)}}function be(){const ae=B[0].pageX-B[1].pageX,De=B[0].pageY-B[1].pageY,rt=Math.sqrt(ae*ae+De*De);S.set(0,rt)}function Ue(){r.enableZoom&&be(),r.enablePan&&Te()}function we(){r.enableZoom&&be(),r.enableRotate&&j()}function et(ae){if(B.length==1)y.set(ae.pageX,ae.pageY);else{const rt=Ke(ae),it=.5*(ae.pageX+rt.x),ve=.5*(ae.pageY+rt.y);y.set(it,ve)}x.subVectors(y,g).multiplyScalar(r.rotateSpeed);const De=r.domElement;De&&(U(2*Math.PI*x.x/De.clientHeight),z(2*Math.PI*x.y/De.clientHeight)),g.copy(y)}function Re(ae){if(B.length==1)A.set(ae.pageX,ae.pageY);else{const De=Ke(ae),rt=.5*(ae.pageX+De.x),it=.5*(ae.pageY+De.y);A.set(rt,it)}w.subVectors(A,v).multiplyScalar(r.panSpeed),X(w.x,w.y),v.copy(A)}function J(ae){const De=Ke(ae),rt=ae.pageX-De.x,it=ae.pageY-De.y,ve=Math.sqrt(rt*rt+it*it);M.set(0,ve),b.set(0,Math.pow(M.y/S.y,r.zoomSpeed)),W(b.y),S.copy(M)}function F(ae){r.enableZoom&&J(ae),r.enablePan&&Re(ae)}function G(ae){r.enableZoom&&J(ae),r.enableRotate&&et(ae)}function de(ae){var De,rt;r.enabled!==!1&&(B.length===0&&((De=r.domElement)==null||De.ownerDocument.addEventListener("pointermove",le),(rt=r.domElement)==null||rt.ownerDocument.addEventListener("pointerup",ye)),yt(ae),ae.pointerType==="touch"?Ye(ae):Le(ae))}function le(ae){r.enabled!==!1&&(ae.pointerType==="touch"?Ie(ae):Ve(ae))}function ye(ae){var De,rt,it;ot(ae),B.length===0&&((De=r.domElement)==null||De.releasePointerCapture(ae.pointerId),(rt=r.domElement)==null||rt.ownerDocument.removeEventListener("pointermove",le),(it=r.domElement)==null||it.ownerDocument.removeEventListener("pointerup",ye)),r.dispatchEvent(o),l=a.NONE}function Le(ae){let De;switch(ae.button){case 0:De=r.mouseButtons.LEFT;break;case 1:De=r.mouseButtons.MIDDLE;break;case 2:De=r.mouseButtons.RIGHT;break;default:De=-1}switch(De){case hf.DOLLY:if(r.enableZoom===!1)return;fe(ae),l=a.DOLLY;break;case hf.ROTATE:if(ae.ctrlKey||ae.metaKey||ae.shiftKey){if(r.enablePan===!1)return;pe(ae),l=a.PAN}else{if(r.enableRotate===!1)return;ne(ae),l=a.ROTATE}break;case hf.PAN:if(ae.ctrlKey||ae.metaKey||ae.shiftKey){if(r.enableRotate===!1)return;ne(ae),l=a.ROTATE}else{if(r.enablePan===!1)return;pe(ae),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(s)}function Ve(ae){if(r.enabled!==!1)switch(l){case a.ROTATE:if(r.enableRotate===!1)return;ge(ae);break;case a.DOLLY:if(r.enableZoom===!1)return;Ce(ae);break;case a.PAN:if(r.enablePan===!1)return;Je(ae);break}}function Oe(ae){r.enabled===!1||r.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(ae.preventDefault(),r.dispatchEvent(s),Xe(ae),r.dispatchEvent(o))}function ze(ae){r.enabled===!1||r.enablePan===!1||Fe(ae)}function Ye(ae){switch(Ze(ae),B.length){case 1:switch(r.touches.ONE){case df.ROTATE:if(r.enableRotate===!1)return;j(),l=a.TOUCH_ROTATE;break;case df.PAN:if(r.enablePan===!1)return;Te(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(r.touches.TWO){case df.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;Ue(),l=a.TOUCH_DOLLY_PAN;break;case df.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;we(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(s)}function Ie(ae){switch(Ze(ae),l){case a.TOUCH_ROTATE:if(r.enableRotate===!1)return;et(ae),r.update();break;case a.TOUCH_PAN:if(r.enablePan===!1)return;Re(ae),r.update();break;case a.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;F(ae),r.update();break;case a.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;G(ae),r.update();break;default:l=a.NONE}}function gt(ae){r.enabled!==!1&&ae.preventDefault()}function yt(ae){B.push(ae)}function ot(ae){delete H[ae.pointerId];for(let De=0;De<B.length;De++)if(B[De].pointerId==ae.pointerId){B.splice(De,1);return}}function Ze(ae){let De=H[ae.pointerId];De===void 0&&(De=new Ge,H[ae.pointerId]=De),De.set(ae.pageX,ae.pageY)}function Ke(ae){const De=ae.pointerId===B[0].pointerId?B[1]:B[0];return H[De.pointerId]}this.dollyIn=(ae=$())=>{V(ae),r.update()},this.dollyOut=(ae=$())=>{W(ae),r.update()},this.getScale=()=>d,this.setScale=ae=>{K(ae),r.update()},this.getZoomScale=()=>$(),t!==void 0&&this.connect(t),this.update()}};function JA(n){if(typeof TextDecoder<"u")return new TextDecoder().decode(n);let e="";for(let t=0,r=n.length;t<r;t++)e+=String.fromCharCode(n[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const Lf="srgb",Ul="srgb-linear",RN=3001,OY=3e3;class dR extends Ai{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new VY(t)}),this.register(function(t){return new WY(t)}),this.register(function(t){return new $Y(t)}),this.register(function(t){return new eZ(t)}),this.register(function(t){return new tZ(t)}),this.register(function(t){return new JY(t)}),this.register(function(t){return new KY(t)}),this.register(function(t){return new QY(t)}),this.register(function(t){return new jY(t)}),this.register(function(t){return new HY(t)}),this.register(function(t){return new YY(t)}),this.register(function(t){return new XY(t)}),this.register(function(t){return new qY(t)}),this.register(function(t){return new ZY(t)}),this.register(function(t){return new GY(t)}),this.register(function(t){return new nZ(t)}),this.register(function(t){return new rZ(t)})}load(e,t,r,i){const s=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const c=lu.extractUrlBase(e);o=lu.resolveURL(c,this.path)}else o=lu.extractUrlBase(e);this.manager.itemStart(e);const a=function(c){i?i(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new vi(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},r,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,i){let s;const o={},a={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(JA(new Uint8Array(e.slice(0,4)))===C4){try{o[dn.KHR_BINARY_GLTF]=new iZ(e)}catch(u){i&&i(u);return}s=JSON.parse(o[dn.KHR_BINARY_GLTF].content)}else s=JSON.parse(JA(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const l=new vZ(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const u=this.pluginCallbacks[c](l);u.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[u.name]=u,o[u.name]=!0}if(s.extensionsUsed)for(let c=0;c<s.extensionsUsed.length;++c){const u=s.extensionsUsed[c],f=s.extensionsRequired||[];switch(u){case dn.KHR_MATERIALS_UNLIT:o[u]=new zY;break;case dn.KHR_DRACO_MESH_COMPRESSION:o[u]=new sZ(s,this.dracoLoader);break;case dn.KHR_TEXTURE_TRANSFORM:o[u]=new oZ;break;case dn.KHR_MESH_QUANTIZATION:o[u]=new aZ;break;default:f.indexOf(u)>=0&&a[u]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}l.setExtensions(o),l.setPlugins(a),l.parse(r,i)}parseAsync(e,t){const r=this;return new Promise(function(i,s){r.parse(e,t,i,s)})}}function kY(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const dn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class GY{constructor(e){this.parser=e,this.name=dn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let r=0,i=t.length;r<i;r++){const s=t[r];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,r="light:"+e;let i=t.cache.get(r);if(i)return i;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const u=new ht(16777215);l.color!==void 0&&u.setRGB(l.color[0],l.color[1],l.color[2],Ul);const f=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new $2(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new q2(u),c.distance=f;break;case"spot":c=new Z2(u),c.distance=f,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,cl(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),i=Promise.resolve(c),t.cache.add(r,i),i}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,r=this.parser,s=r.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return r._getNodeRef(t.cache,a,l)})}}class zY{constructor(){this.name=dn.KHR_MATERIALS_UNLIT}getMaterialType(){return Ni}extendParams(e,t,r){const i=[];e.color=new ht(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Ul),e.opacity=o[3]}s.baseColorTexture!==void 0&&i.push(r.assignTexture(e,"map",s.baseColorTexture,Lf))}return Promise.all(i)}}class HY{constructor(e){this.parser=e,this.name=dn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class VY{constructor(e){this.parser=e,this.name=dn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Mo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(r.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(r.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(r.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Ge(a,a)}return Promise.all(s)}}class WY{constructor(e){this.parser=e,this.name=dn.KHR_MATERIALS_DISPERSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Mo}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}}class XY{constructor(e){this.parser=e,this.name=dn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Mo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(r.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(r.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class JY{constructor(e){this.parser=e,this.name=dn.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Mo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new ht(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=i.extensions[this.name];if(o.sheenColorFactor!==void 0){const a=o.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],Ul)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(r.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Lf)),o.sheenRoughnessTexture!==void 0&&s.push(r.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class KY{constructor(e){this.parser=e,this.name=dn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Mo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(r.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class QY{constructor(e){this.parser=e,this.name=dn.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Mo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(r.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new ht().setRGB(a[0],a[1],a[2],Ul),Promise.all(s)}}class jY{constructor(e){this.parser=e,this.name=dn.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Mo}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class YY{constructor(e){this.parser=e,this.name=dn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Mo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(r.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new ht().setRGB(a[0],a[1],a[2],Ul),o.specularColorTexture!==void 0&&s.push(r.assignTexture(t,"specularColorMap",o.specularColorTexture,Lf)),Promise.all(s)}}class ZY{constructor(e){this.parser=e,this.name=dn.EXT_MATERIALS_BUMP}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Mo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(r.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}}class qY{constructor(e){this.parser=e,this.name=dn.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Mo}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(r.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class $Y{constructor(e){this.parser=e,this.name=dn.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,r=t.json,i=r.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const s=i.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class eZ{constructor(e){this.parser=e,this.name=dn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=i.images[o.source];let l=r.textureLoader;if(a.uri){const c=r.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return r.loadTextureImage(e,o.source,l);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class tZ{constructor(e){this.parser=e,this.name=dn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=i.images[o.source];let l=r.textureLoader;if(a.uri){const c=r.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return r.loadTextureImage(e,o.source,l);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class nZ{constructor(e){this.name=dn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const i=r.extensions[this.name],s=this.parser.getDependency("buffer",i.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=i.byteOffset||0,c=i.byteLength||0,u=i.count,f=i.byteStride,d=new Uint8Array(a,l,c);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(u,f,d,i.mode,i.filter).then(function(m){return m.buffer}):o.ready.then(function(){const m=new ArrayBuffer(u*f);return o.decodeGltfBuffer(new Uint8Array(m),u,f,d,i.mode,i.filter),m})})}else return null}}class rZ{constructor(e){this.name=dn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const i=t.meshes[r.mesh];for(const c of i.primitives)if(c.mode!==uo.TRIANGLES&&c.mode!==uo.TRIANGLE_STRIP&&c.mode!==uo.TRIANGLE_FAN&&c.mode!==void 0)return null;const o=r.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(u=>(l[c]=u,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const u=c.pop(),f=u.isGroup?u.children:[u],d=c[0].count,m=[];for(const g of f){const y=new Bt,x=new Y,v=new Rr,A=new Y(1,1,1),w=new U2(g.geometry,g.material,d);for(let S=0;S<d;S++)l.TRANSLATION&&x.fromBufferAttribute(l.TRANSLATION,S),l.ROTATION&&v.fromBufferAttribute(l.ROTATION,S),l.SCALE&&A.fromBufferAttribute(l.SCALE,S),w.setMatrixAt(S,y.compose(x,v,A));for(const S in l)if(S==="_COLOR_0"){const M=l[S];w.instanceColor=new Au(M.array,M.itemSize,M.normalized)}else S!=="TRANSLATION"&&S!=="ROTATION"&&S!=="SCALE"&&g.geometry.setAttribute(S,l[S]);gn.prototype.copy.call(w,g),this.parser.assignFinalMaterial(w),m.push(w)}return u.isGroup?(u.clear(),u.add(...m),u):m[0]}))}}const C4="glTF",Fg=12,BN={JSON:1313821514,BIN:5130562};class iZ{constructor(e){this.name=dn.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Fg);if(this.header={magic:JA(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==C4)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-Fg,i=new DataView(e,Fg);let s=0;for(;s<r;){const o=i.getUint32(s,!0);s+=4;const a=i.getUint32(s,!0);if(s+=4,a===BN.JSON){const l=new Uint8Array(e,Fg+s,o);this.content=JA(l)}else if(a===BN.BIN){const l=Fg+s;this.body=e.slice(l,l+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class sZ{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=dn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const r=this.json,i=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const u in o){const f=gT[u]||u.toLowerCase();a[f]=o[u]}for(const u in e.attributes){const f=gT[u]||u.toLowerCase();if(o[u]!==void 0){const d=r.accessors[e.attributes[u]],m=dp[d.componentType];c[f]=m.name,l[f]=d.normalized===!0}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(f,d){i.decodeDracoFile(u,function(m){for(const g in m.attributes){const y=m.attributes[g],x=l[g];x!==void 0&&(y.normalized=x)}f(m)},a,c,Ul,d)})})}}class oZ{constructor(){this.name=dn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class aZ{constructor(){this.name=dn.KHR_MESH_QUANTIZATION}}class R4 extends km{constructor(e,t,r,i){super(e,t,r,i)}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i*3+i;for(let o=0;o!==i;o++)t[o]=r[s+o];return t}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,u=i-t,f=(r-t)/u,d=f*f,m=d*f,g=e*c,y=g-c,x=-2*m+3*d,v=m-d,A=1-x,w=v-d+f;for(let S=0;S!==a;S++){const M=o[y+S+a],b=o[y+S+l]*u,R=o[g+S+a],P=o[g+S]*u;s[S]=A*M+w*b+x*R+v*P}return s}}const lZ=new Rr;class cZ extends R4{interpolate_(e,t,r,i){const s=super.interpolate_(e,t,r,i);return lZ.fromArray(s).normalize().toArray(s),s}}const uo={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},dp={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},PN={9728:Vn,9729:un,9984:W0,9985:L_,9986:fp,9987:Ha},IN={33071:Qn,33648:xm,10497:gu},JS={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},gT={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...hR>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},gc={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},uZ={CUBICSPLINE:void 0,LINEAR:Ah,STEP:Am},KS={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function fZ(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new ey({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:sa})),n.DefaultMaterial}function rf(n,e,t){for(const r in t.extensions)n[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function cl(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function hZ(n,e,t){let r=!1,i=!1,s=!1;for(let c=0,u=e.length;c<u;c++){const f=e[c];if(f.POSITION!==void 0&&(r=!0),f.NORMAL!==void 0&&(i=!0),f.COLOR_0!==void 0&&(s=!0),r&&i&&s)break}if(!r&&!i&&!s)return Promise.resolve(n);const o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const f=e[c];if(r){const d=f.POSITION!==void 0?t.getDependency("accessor",f.POSITION):n.attributes.position;o.push(d)}if(i){const d=f.NORMAL!==void 0?t.getDependency("accessor",f.NORMAL):n.attributes.normal;a.push(d)}if(s){const d=f.COLOR_0!==void 0?t.getDependency("accessor",f.COLOR_0):n.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],f=c[1],d=c[2];return r&&(n.morphAttributes.position=u),i&&(n.morphAttributes.normal=f),s&&(n.morphAttributes.color=d),n.morphTargetsRelative=!0,n})}function dZ(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,r=e.weights.length;t<r;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let r=0,i=t.length;r<i;r++)n.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function pZ(n){let e;const t=n.extensions&&n.extensions[dn.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+QS(t.attributes):e=n.indices+":"+QS(n.attributes)+":"+n.mode,n.targets!==void 0)for(let r=0,i=n.targets.length;r<i;r++)e+=":"+QS(n.targets[r]);return e}function QS(n){let e="";const t=Object.keys(n).sort();for(let r=0,i=t.length;r<i;r++)e+=t[r]+":"+n[t[r]]+";";return e}function vT(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function mZ(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const gZ=new Bt;class vZ{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new kY,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,i=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,i=navigator.userAgent.indexOf("Firefox")>-1,s=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||r||i&&s<98?this.textureLoader=new Ik(this.options.manager):this.textureLoader=new kk(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new vi(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const r=this,i=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(o){const a={scene:o[0][i.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:i.asset,parser:r,userData:{}};return rf(s,a,i),cl(a,i),Promise.all(r._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){for(const l of a.scenes)l.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let i=0,s=t.length;i<s;i++){const o=t[i].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let i=0,s=e.length;i<s;i++){const o=e[i];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(r[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;const i=r.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[c,u]of o.children.entries())s(u,a.children[c])};return s(r,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){const i=e(t[r]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const r=[];for(let i=0;i<t.length;i++){const s=e(t[i]);s&&r.push(s)}return r}getDependency(e,t){const r=e+":"+t;let i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":i=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e);break}this.cache.add(r,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const r=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(s,o){return r.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],r=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[dn.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(s,o){r.load(lu.resolveURL(t.uri,i.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(r){const i=t.byteLength||0,s=t.byteOffset||0;return r.slice(s,s+i)})}loadAccessor(e){const t=this,r=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const o=JS[i.type],a=dp[i.componentType],l=i.normalized===!0,c=new a(i.count*o);return Promise.resolve(new vn(c,o,l))}const s=[];return i.bufferView!==void 0?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),i.sparse!==void 0&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=JS[i.type],c=dp[i.componentType],u=c.BYTES_PER_ELEMENT,f=u*l,d=i.byteOffset||0,m=i.bufferView!==void 0?r.bufferViews[i.bufferView].byteStride:void 0,g=i.normalized===!0;let y,x;if(m&&m!==f){const v=Math.floor(d/m),A="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+v+":"+i.count;let w=t.cache.get(A);w||(y=new c(a,v*m,i.count*m/u),w=new Qv(y,m/u),t.cache.add(A,w)),x=new xu(w,l,d%m/u,g)}else a===null?y=new c(i.count*l):y=new c(a,d,i.count*l),x=new vn(y,l,g);if(i.sparse!==void 0){const v=JS.SCALAR,A=dp[i.sparse.indices.componentType],w=i.sparse.indices.byteOffset||0,S=i.sparse.values.byteOffset||0,M=new A(o[1],w,i.sparse.count*v),b=new c(o[2],S,i.sparse.count*l);a!==null&&(x=new vn(x.array.slice(),x.itemSize,x.normalized));for(let R=0,P=M.length;R<P;R++){const C=M[R];if(x.setX(C,b[R*l]),l>=2&&x.setY(C,b[R*l+1]),l>=3&&x.setZ(C,b[R*l+2]),l>=4&&x.setW(C,b[R*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return x})}loadTexture(e){const t=this.json,r=this.options,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=r.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,r){const i=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,r).then(function(u){u.flipY=!1,u.name=o.name||a.name||"",u.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(u.name=a.uri);const d=(s.samplers||{})[o.sampler]||{};return u.magFilter=PN[d.magFilter]||un,u.minFilter=PN[d.minFilter]||Ha,u.wrapS=IN[d.wrapS]||gu,u.wrapT=IN[d.wrapT]||gu,i.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this,i=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(f=>f.clone());const o=i.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(o.bufferView!==void 0)l=r.getDependency("bufferView",o.bufferView).then(function(f){c=!0;const d=new Blob([f],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(f){return new Promise(function(d,m){let g=d;t.isImageBitmapLoader===!0&&(g=function(y){const x=new Sn(y);x.needsUpdate=!0,d(x)}),t.load(lu.resolveURL(f,s.path),g,void 0,m)})}).then(function(f){return c===!0&&a.revokeObjectURL(l),cl(f,o),f.userData.mimeType=o.mimeType||mZ(o.uri),f}).catch(function(f){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),f});return this.sourceCache[e]=u,u}assignTexture(e,t,r,i){const s=this;return this.getDependency("texture",r.index).then(function(o){if(!o)return null;if(r.texCoord!==void 0&&r.texCoord>0&&(o=o.clone(),o.channel=r.texCoord),s.extensions[dn.KHR_TEXTURE_TRANSFORM]){const a=r.extensions!==void 0?r.extensions[dn.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[dn.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return i!==void 0&&(typeof i=="number"&&(i=i===RN?Lf:Ul),"colorSpace"in o?o.colorSpace=i:o.encoding=i===Lf?RN:OY),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let r=e.material;const i=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+r.uuid;let l=this.cache.get(a);l||(l=new K_,ur.prototype.copy.call(l,r),l.color.copy(r.color),l.map=r.map,l.sizeAttenuation=!1,this.cache.add(a,l)),r=l}else if(e.isLine){const a="LineBasicMaterial:"+r.uuid;let l=this.cache.get(a);l||(l=new Oi,ur.prototype.copy.call(l,r),l.color.copy(r.color),l.map=r.map,this.cache.add(a,l)),r=l}if(i||s||o){let a="ClonedMaterial:"+r.uuid+":";i&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=r.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),i&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(r))),r=l}e.material=r}getMaterialType(){return ey}loadMaterial(e){const t=this,r=this.json,i=this.extensions,s=r.materials[e];let o;const a={},l=s.extensions||{},c=[];if(l[dn.KHR_MATERIALS_UNLIT]){const f=i[dn.KHR_MATERIALS_UNLIT];o=f.getMaterialType(),c.push(f.extendParams(a,s,t))}else{const f=s.pbrMetallicRoughness||{};if(a.color=new ht(1,1,1),a.opacity=1,Array.isArray(f.baseColorFactor)){const d=f.baseColorFactor;a.color.setRGB(d[0],d[1],d[2],Ul),a.opacity=d[3]}f.baseColorTexture!==void 0&&c.push(t.assignTexture(a,"map",f.baseColorTexture,Lf)),a.metalness=f.metallicFactor!==void 0?f.metallicFactor:1,a.roughness=f.roughnessFactor!==void 0?f.roughnessFactor:1,f.metallicRoughnessTexture!==void 0&&(c.push(t.assignTexture(a,"metalnessMap",f.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",f.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=di);const u=s.alphaMode||KS.OPAQUE;if(u===KS.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===KS.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==Ni&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Ge(1,1),s.normalTexture.scale!==void 0)){const f=s.normalTexture.scale;a.normalScale.set(f,f)}if(s.occlusionTexture!==void 0&&o!==Ni&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==Ni){const f=s.emissiveFactor;a.emissive=new ht().setRGB(f[0],f[1],f[2],Ul)}return s.emissiveTexture!==void 0&&o!==Ni&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,Lf)),Promise.all(c).then(function(){const f=new o(a);return s.name&&(f.name=s.name),cl(f,s),t.associations.set(f,{materials:e}),s.extensions&&rf(i,f,s),f})}createUniqueName(e){const t=_n.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,r=this.extensions,i=this.primitiveCache;function s(a){return r[dn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return LN(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=pZ(c),f=i[u];if(f)o.push(f.promise);else{let d;c.extensions&&c.extensions[dn.KHR_DRACO_MESH_COMPRESSION]?d=s(c):d=LN(new jt,c,t),i[u]={primitive:c,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.json,i=this.extensions,s=r.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const u=o[l].material===void 0?fZ(this.cache):this.getDependency("material",o[l].material);a.push(u)}return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],f=[];for(let m=0,g=u.length;m<g;m++){const y=u[m],x=o[m];let v;const A=c[m];if(x.mode===uo.TRIANGLES||x.mode===uo.TRIANGLE_STRIP||x.mode===uo.TRIANGLE_FAN||x.mode===void 0)v=s.isSkinnedMesh===!0?new D2(y,A):new On(y,A),v.isSkinnedMesh===!0&&v.normalizeSkinWeights(),x.mode===uo.TRIANGLE_STRIP?v.geometry=MN(v.geometry,w2):x.mode===uo.TRIANGLE_FAN&&(v.geometry=MN(v.geometry,zA));else if(x.mode===uo.LINES)v=new la(y,A);else if(x.mode===uo.LINE_STRIP)v=new Vl(y,A);else if(x.mode===uo.LINE_LOOP)v=new F2(y,A);else if(x.mode===uo.POINTS)v=new O2(y,A);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+x.mode);Object.keys(v.geometry.morphAttributes).length>0&&dZ(v,s),v.name=t.createUniqueName(s.name||"mesh_"+e),cl(v,s),x.extensions&&rf(i,v,x),t.assignFinalMaterial(v),f.push(v)}for(let m=0,g=f.length;m<g;m++)t.associations.set(f[m],{meshes:e,primitives:m});if(f.length===1)return s.extensions&&rf(i,f[0],s),f[0];const d=new Da;s.extensions&&rf(i,d,s),t.associations.set(d,{meshes:e});for(let m=0,g=f.length;m<g;m++)d.add(f[m]);return d})}loadCamera(e){let t;const r=this.json.cameras[e],i=r[r.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?t=new or(Jd.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):r.type==="orthographic"&&(t=new ra(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),cl(t,r),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],r=[];for(let i=0,s=t.joints.length;i<s;i++)r.push(this._loadNodeShallow(t.joints[i]));return t.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(i){const s=i.pop(),o=i,a=[],l=[];for(let c=0,u=o.length;c<u;c++){const f=o[c];if(f){a.push(f);const d=new Bt;s!==null&&d.fromArray(s.array,c*16),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}return new jv(a,l)})}loadAnimation(e){const t=this.json,r=this,i=t.animations[e],s=i.name?i.name:"animation_"+e,o=[],a=[],l=[],c=[],u=[];for(let f=0,d=i.channels.length;f<d;f++){const m=i.channels[f],g=i.samplers[m.sampler],y=m.target,x=y.node,v=i.parameters!==void 0?i.parameters[g.input]:g.input,A=i.parameters!==void 0?i.parameters[g.output]:g.output;y.node!==void 0&&(o.push(this.getDependency("node",x)),a.push(this.getDependency("accessor",v)),l.push(this.getDependency("accessor",A)),c.push(g),u.push(y))}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c),Promise.all(u)]).then(function(f){const d=f[0],m=f[1],g=f[2],y=f[3],x=f[4],v=[];for(let A=0,w=d.length;A<w;A++){const S=d[A],M=m[A],b=g[A],R=y[A],P=x[A];if(S===void 0)continue;S.updateMatrix&&S.updateMatrix();const C=r._createAnimationTracks(S,M,b,R,P);if(C)for(let B=0;B<C.length;B++)v.push(C[B])}return new Eh(s,void 0,v)})}createNodeMesh(e){const t=this.json,r=this,i=t.nodes[e];return i.mesh===void 0?null:r.getDependency("mesh",i.mesh).then(function(s){const o=r._getNodeRef(r.meshCache,i.mesh,s);return i.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=i.weights.length;l<c;l++)a.morphTargetInfluences[l]=i.weights[l]}),o})}loadNode(e){const t=this.json,r=this,i=t.nodes[e],s=r._loadNodeShallow(e),o=[],a=i.children||[];for(let c=0,u=a.length;c<u;c++)o.push(r.getDependency("node",a[c]));const l=i.skin===void 0?Promise.resolve(null):r.getDependency("skin",i.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const u=c[0],f=c[1],d=c[2];d!==null&&u.traverse(function(m){m.isSkinnedMesh&&m.bind(d,gZ)});for(let m=0,g=f.length;m<g;m++)u.add(f[m]);return u})}_loadNodeShallow(e){const t=this.json,r=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],o=s.name?i.createUniqueName(s.name):"",a=[],l=i._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(i.getDependency("camera",s.camera).then(function(c){return i._getNodeRef(i.cameraCache,s.camera,c)})),i._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let u;if(s.isBone===!0?u=new J_:c.length>1?u=new Da:c.length===1?u=c[0]:u=new gn,u!==c[0])for(let f=0,d=c.length;f<d;f++)u.add(c[f]);if(s.name&&(u.userData.name=s.name,u.name=o),cl(u,s),s.extensions&&rf(r,u,s),s.matrix!==void 0){const f=new Bt;f.fromArray(s.matrix),u.applyMatrix4(f)}else s.translation!==void 0&&u.position.fromArray(s.translation),s.rotation!==void 0&&u.quaternion.fromArray(s.rotation),s.scale!==void 0&&u.scale.fromArray(s.scale);return i.associations.has(u)||i.associations.set(u,{}),i.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){const t=this.extensions,r=this.json.scenes[e],i=this,s=new Da;r.name&&(s.name=i.createUniqueName(r.name)),cl(s,r),r.extensions&&rf(t,s,r);const o=r.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(i.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let u=0,f=l.length;u<f;u++)s.add(l[u]);const c=u=>{const f=new Map;for(const[d,m]of i.associations)(d instanceof ur||d instanceof Sn)&&f.set(d,m);return u.traverse(d=>{const m=i.associations.get(d);m!=null&&f.set(d,m)}),f};return i.associations=c(s),s})}_createAnimationTracks(e,t,r,i,s){const o=[],a=e.name?e.name:e.uuid,l=[];gc[s.path]===gc.weights?e.traverse(function(d){d.morphTargetInfluences&&l.push(d.name?d.name:d.uuid)}):l.push(a);let c;switch(gc[s.path]){case gc.weights:c=wh;break;case gc.rotation:c=Wl;break;case gc.position:case gc.scale:c=_u;break;default:switch(r.itemSize){case 1:c=wh;break;case 2:case 3:default:c=_u;break}break}const u=i.interpolation!==void 0?uZ[i.interpolation]:Ah,f=this._getArrayFromAccessor(r);for(let d=0,m=l.length;d<m;d++){const g=new c(l[d]+"."+gc[s.path],t.array,f,u);i.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(g),o.push(g)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const r=vT(t.constructor),i=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)i[s]=t[s]*r;t=i}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(r){const i=this instanceof Wl?cZ:R4;return new i(this.times,this.values,this.getValueSize()/3,r)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function yZ(n,e,t){const r=e.attributes,i=new Br;if(r.POSITION!==void 0){const a=t.json.accessors[r.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(i.set(new Y(l[0],l[1],l[2]),new Y(c[0],c[1],c[2])),a.normalized){const u=vT(dp[a.componentType]);i.min.multiplyScalar(u),i.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new Y,l=new Y;for(let c=0,u=s.length;c<u;c++){const f=s[c];if(f.POSITION!==void 0){const d=t.json.accessors[f.POSITION],m=d.min,g=d.max;if(m!==void 0&&g!==void 0){if(l.setX(Math.max(Math.abs(m[0]),Math.abs(g[0]))),l.setY(Math.max(Math.abs(m[1]),Math.abs(g[1]))),l.setZ(Math.max(Math.abs(m[2]),Math.abs(g[2]))),d.normalized){const y=vT(dp[d.componentType]);l.multiplyScalar(y)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(a)}n.boundingBox=i;const o=new si;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,n.boundingSphere=o}function LN(n,e,t){const r=e.attributes,i=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){n.setAttribute(a,l)})}for(const o in r){const a=gT[o]||o.toLowerCase();a in n.attributes||i.push(s(r[o],a))}if(e.indices!==void 0&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(a){n.setIndex(a)});i.push(o)}return cl(n,e),yZ(n,e,t),Promise.all(i).then(function(){return e.targets!==void 0?hZ(n,e.targets,t):n})}class xZ extends j2{constructor(e){super(e),this.type=Jr}parse(e){const o=function(P,C){switch(P){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(C||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(C||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(C||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(C||""))}},u=`
`,f=function(P,C,B){C=C||1024;let k=P.pos,$=-1,U=0,z="",O=String.fromCharCode.apply(null,new Uint16Array(P.subarray(k,k+128)));for(;0>($=O.indexOf(u))&&U<C&&k<P.byteLength;)z+=O,U+=O.length,k+=128,O+=String.fromCharCode.apply(null,new Uint16Array(P.subarray(k,k+128)));return-1<$?(B!==!1&&(P.pos+=U+$+1),z+O.slice(0,$)):!1},d=function(P){const C=/^#\?(\S+)/,B=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,H=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,k=/^\s*FORMAT=(\S+)\s*$/,$=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,U={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let z,O;for((P.pos>=P.byteLength||!(z=f(P)))&&o(1,"no header found"),(O=z.match(C))||o(3,"bad initial token"),U.valid|=1,U.programtype=O[1],U.string+=z+`
`;z=f(P),z!==!1;){if(U.string+=z+`
`,z.charAt(0)==="#"){U.comments+=z+`
`;continue}if((O=z.match(B))&&(U.gamma=parseFloat(O[1])),(O=z.match(H))&&(U.exposure=parseFloat(O[1])),(O=z.match(k))&&(U.valid|=2,U.format=O[1]),(O=z.match($))&&(U.valid|=4,U.height=parseInt(O[1],10),U.width=parseInt(O[2],10)),U.valid&2&&U.valid&4)break}return U.valid&2||o(3,"missing format specifier"),U.valid&4||o(3,"missing image size specifier"),U},m=function(P,C,B){const H=C;if(H<8||H>32767||P[0]!==2||P[1]!==2||P[2]&128)return new Uint8Array(P);H!==(P[2]<<8|P[3])&&o(3,"wrong scanline width");const k=new Uint8Array(4*C*B);k.length||o(4,"unable to allocate buffer space");let $=0,U=0;const z=4*H,O=new Uint8Array(4),ie=new Uint8Array(z);let X=B;for(;X>0&&U<P.byteLength;){U+4>P.byteLength&&o(1),O[0]=P[U++],O[1]=P[U++],O[2]=P[U++],O[3]=P[U++],(O[0]!=2||O[1]!=2||(O[2]<<8|O[3])!=H)&&o(3,"bad rgbe scanline format");let K=0,W;for(;K<z&&U<P.byteLength;){W=P[U++];const Q=W>128;if(Q&&(W-=128),(W===0||K+W>z)&&o(3,"bad scanline data"),Q){const q=P[U++];for(let ne=0;ne<W;ne++)ie[K++]=q}else ie.set(P.subarray(U,U+W),K),K+=W,U+=W}const V=H;for(let Q=0;Q<V;Q++){let q=0;k[$]=ie[Q+q],q+=H,k[$+1]=ie[Q+q],q+=H,k[$+2]=ie[Q+q],q+=H,k[$+3]=ie[Q+q],$+=4}X--}return k},g=function(P,C,B,H){const k=P[C+3],$=Math.pow(2,k-128)/255;B[H+0]=P[C+0]*$,B[H+1]=P[C+1]*$,B[H+2]=P[C+2]*$,B[H+3]=1},y=function(P,C,B,H){const k=P[C+3],$=Math.pow(2,k-128)/255;B[H+0]=Bf.toHalfFloat(Math.min(P[C+0]*$,65504)),B[H+1]=Bf.toHalfFloat(Math.min(P[C+1]*$,65504)),B[H+2]=Bf.toHalfFloat(Math.min(P[C+2]*$,65504)),B[H+3]=Bf.toHalfFloat(1)},x=new Uint8Array(e);x.pos=0;const v=d(x),A=v.width,w=v.height,S=m(x.subarray(x.pos),A,w);let M,b,R;switch(this.type){case Cr:R=S.length/4;const P=new Float32Array(R*4);for(let B=0;B<R;B++)g(S,B*4,P,B*4);M=P,b=Cr;break;case Jr:R=S.length/4;const C=new Uint16Array(R*4);for(let B=0;B<R;B++)y(S,B*4,C,B*4);M=C,b=Jr;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:A,height:w,data:M,header:v.string,gamma:v.gamma,exposure:v.exposure,type:b}}setDataType(e){return this.type=e,this}load(e,t,r,i){function s(o,a){switch(o.type){case Cr:case Jr:"colorSpace"in o?o.colorSpace="srgb-linear":o.encoding=3e3,o.minFilter=un,o.magFilter=un,o.generateMipmaps=!1,o.flipY=!0;break}t&&t(o,a)}return super.load(e,s,r,i)}}const Og=hR>=152;class AZ extends j2{constructor(e){super(e),this.type=Jr}parse(e){const C=Math.pow(2.7182818,2.2);function B(D,Z){for(var me=0,L=0;L<65536;++L)(L==0||D[L>>3]&1<<(L&7))&&(Z[me++]=L);for(var ee=me-1;me<65536;)Z[me++]=0;return ee}function H(D){for(var Z=0;Z<16384;Z++)D[Z]={},D[Z].len=0,D[Z].lit=0,D[Z].p=null}const k={l:0,c:0,lc:0};function $(D,Z,me,L,ee){for(;me<D;)Z=Z<<8|Ke(L,ee),me+=8;me-=D,k.l=Z>>me&(1<<D)-1,k.c=Z,k.lc=me}const U=new Array(59);function z(D){for(var Z=0;Z<=58;++Z)U[Z]=0;for(var Z=0;Z<65537;++Z)U[D[Z]]+=1;for(var me=0,Z=58;Z>0;--Z){var L=me+U[Z]>>1;U[Z]=me,me=L}for(var Z=0;Z<65537;++Z){var ee=D[Z];ee>0&&(D[Z]=ee|U[ee]++<<6)}}function O(D,Z,me,L,ee,re,he){for(var ue=me,Pe=0,ke=0;ee<=re;ee++){if(ue.value-me.value>L)return!1;$(6,Pe,ke,D,ue);var We=k.l;if(Pe=k.c,ke=k.lc,he[ee]=We,We==63){if(ue.value-me.value>L)throw"Something wrong with hufUnpackEncTable";$(8,Pe,ke,D,ue);var Ae=k.l+6;if(Pe=k.c,ke=k.lc,ee+Ae>re+1)throw"Something wrong with hufUnpackEncTable";for(;Ae--;)he[ee++]=0;ee--}else if(We>=59){var Ae=We-59+2;if(ee+Ae>re+1)throw"Something wrong with hufUnpackEncTable";for(;Ae--;)he[ee++]=0;ee--}}z(he)}function ie(D){return D&63}function X(D){return D>>6}function K(D,Z,me,L){for(;Z<=me;Z++){var ee=X(D[Z]),re=ie(D[Z]);if(ee>>re)throw"Invalid table entry";if(re>14){var he=L[ee>>re-14];if(he.len)throw"Invalid table entry";if(he.lit++,he.p){var ue=he.p;he.p=new Array(he.lit);for(var Pe=0;Pe<he.lit-1;++Pe)he.p[Pe]=ue[Pe]}else he.p=new Array(1);he.p[he.lit-1]=Z}else if(re)for(var ke=0,Pe=1<<14-re;Pe>0;Pe--){var he=L[(ee<<14-re)+ke];if(he.len||he.p)throw"Invalid table entry";he.len=re,he.lit=Z,ke++}}return!0}const W={c:0,lc:0};function V(D,Z,me,L){D=D<<8|Ke(me,L),Z+=8,W.c=D,W.lc=Z}const Q={c:0,lc:0};function q(D,Z,me,L,ee,re,he,ue,Pe,ke){if(D==Z){L<8&&(V(me,L,ee,he),me=W.c,L=W.lc),L-=8;var We=me>>L,We=new Uint8Array([We])[0];if(Pe.value+We>ke)return!1;for(var Ae=ue[Pe.value-1];We-- >0;)ue[Pe.value++]=Ae}else if(Pe.value<ke)ue[Pe.value++]=D;else return!1;Q.c=me,Q.lc=L}function ne(D){return D&65535}function fe(D){var Z=ne(D);return Z>32767?Z-65536:Z}const pe={a:0,b:0};function ge(D,Z){var me=fe(D),L=fe(Z),ee=L,re=me+(ee&1)+(ee>>1),he=re,ue=re-ee;pe.a=he,pe.b=ue}function Ce(D,Z){var me=ne(D),L=ne(Z),ee=me-(L>>1)&65535,re=L+ee-32768&65535;pe.a=re,pe.b=ee}function Je(D,Z,me,L,ee,re,he){for(var ue=he<16384,Pe=me>ee?ee:me,ke=1,We;ke<=Pe;)ke<<=1;for(ke>>=1,We=ke,ke>>=1;ke>=1;){for(var Ae=0,vt=Ae+re*(ee-We),nt=re*ke,tt=re*We,Et=L*ke,Pt=L*We,Lt,Vt,xt,dt;Ae<=vt;Ae+=tt){for(var Kt=Ae,Ut=Ae+L*(me-We);Kt<=Ut;Kt+=Pt){var kt=Kt+Et,bn=Kt+nt,Ln=bn+Et;ue?(ge(D[Kt+Z],D[bn+Z]),Lt=pe.a,xt=pe.b,ge(D[kt+Z],D[Ln+Z]),Vt=pe.a,dt=pe.b,ge(Lt,Vt),D[Kt+Z]=pe.a,D[kt+Z]=pe.b,ge(xt,dt),D[bn+Z]=pe.a,D[Ln+Z]=pe.b):(Ce(D[Kt+Z],D[bn+Z]),Lt=pe.a,xt=pe.b,Ce(D[kt+Z],D[Ln+Z]),Vt=pe.a,dt=pe.b,Ce(Lt,Vt),D[Kt+Z]=pe.a,D[kt+Z]=pe.b,Ce(xt,dt),D[bn+Z]=pe.a,D[Ln+Z]=pe.b)}if(me&ke){var bn=Kt+nt;ue?ge(D[Kt+Z],D[bn+Z]):Ce(D[Kt+Z],D[bn+Z]),Lt=pe.a,D[bn+Z]=pe.b,D[Kt+Z]=Lt}}if(ee&ke)for(var Kt=Ae,Ut=Ae+L*(me-We);Kt<=Ut;Kt+=Pt){var kt=Kt+Et;ue?ge(D[Kt+Z],D[kt+Z]):Ce(D[Kt+Z],D[kt+Z]),Lt=pe.a,D[kt+Z]=pe.b,D[Kt+Z]=Lt}We=ke,ke>>=1}return Ae}function Xe(D,Z,me,L,ee,re,he,ue,Pe,ke){for(var We=0,Ae=0,vt=ue,nt=Math.trunc(ee.value+(re+7)/8);ee.value<nt;)for(V(We,Ae,me,ee),We=W.c,Ae=W.lc;Ae>=14;){var tt=We>>Ae-14&16383,Et=Z[tt];if(Et.len)Ae-=Et.len,q(Et.lit,he,We,Ae,me,L,ee,Pe,ke,vt),We=Q.c,Ae=Q.lc;else{if(!Et.p)throw"hufDecode issues";var Pt;for(Pt=0;Pt<Et.lit;Pt++){for(var Lt=ie(D[Et.p[Pt]]);Ae<Lt&&ee.value<nt;)V(We,Ae,me,ee),We=W.c,Ae=W.lc;if(Ae>=Lt&&X(D[Et.p[Pt]])==(We>>Ae-Lt&(1<<Lt)-1)){Ae-=Lt,q(Et.p[Pt],he,We,Ae,me,L,ee,Pe,ke,vt),We=Q.c,Ae=Q.lc;break}}if(Pt==Et.lit)throw"hufDecode issues"}}var Vt=8-re&7;for(We>>=Vt,Ae-=Vt;Ae>0;){var Et=Z[We<<14-Ae&16383];if(Et.len)Ae-=Et.len,q(Et.lit,he,We,Ae,me,L,ee,Pe,ke,vt),We=Q.c,Ae=Q.lc;else throw"hufDecode issues"}return!0}function Fe(D,Z,me,L,ee,re){var he={value:0},ue=me.value,Pe=Ze(Z,me),ke=Ze(Z,me);me.value+=4;var We=Ze(Z,me);if(me.value+=4,Pe<0||Pe>=65537||ke<0||ke>=65537)throw"Something wrong with HUF_ENCSIZE";var Ae=new Array(65537),vt=new Array(16384);H(vt);var nt=L-(me.value-ue);if(O(D,Z,me,nt,Pe,ke,Ae),We>8*(L-(me.value-ue)))throw"Something wrong with hufUncompress";K(Ae,Pe,ke,vt),Xe(Ae,vt,D,Z,me,We,ke,re,ee,he)}function j(D,Z,me){for(var L=0;L<me;++L)Z[L]=D[Z[L]]}function Te(D){for(var Z=1;Z<D.length;Z++){var me=D[Z-1]+D[Z]-128;D[Z]=me}}function be(D,Z){for(var me=0,L=Math.floor((D.length+1)/2),ee=0,re=D.length-1;!(ee>re||(Z[ee++]=D[me++],ee>re));)Z[ee++]=D[L++]}function Ue(D){for(var Z=D.byteLength,me=new Array,L=0,ee=new DataView(D);Z>0;){var re=ee.getInt8(L++);if(re<0){var he=-re;Z-=he+1;for(var ue=0;ue<he;ue++)me.push(ee.getUint8(L++))}else{var he=re;Z-=2;for(var Pe=ee.getUint8(L++),ue=0;ue<he+1;ue++)me.push(Pe)}}return me}function we(D,Z,me,L,ee,re){var kt=new DataView(re.buffer),he=me[D.idx[0]].width,ue=me[D.idx[0]].height,Pe=3,ke=Math.floor(he/8),We=Math.ceil(he/8),Ae=Math.ceil(ue/8),vt=he-(We-1)*8,nt=ue-(Ae-1)*8,tt={value:0},Et=new Array(Pe),Pt=new Array(Pe),Lt=new Array(Pe),Vt=new Array(Pe),xt=new Array(Pe);for(let $t=0;$t<Pe;++$t)xt[$t]=Z[D.idx[$t]],Et[$t]=$t<1?0:Et[$t-1]+We*Ae,Pt[$t]=new Float32Array(64),Lt[$t]=new Uint16Array(64),Vt[$t]=new Uint16Array(We*64);for(let $t=0;$t<Ae;++$t){var dt=8;$t==Ae-1&&(dt=nt);var Kt=8;for(let Xt=0;Xt<We;++Xt){Xt==We-1&&(Kt=vt);for(let Wt=0;Wt<Pe;++Wt)Lt[Wt].fill(0),Lt[Wt][0]=ee[Et[Wt]++],et(tt,L,Lt[Wt]),Re(Lt[Wt],Pt[Wt]),J(Pt[Wt]);F(Pt);for(let Wt=0;Wt<Pe;++Wt)G(Pt[Wt],Vt[Wt],Xt*64)}let kn=0;for(let Xt=0;Xt<Pe;++Xt){const Wt=me[D.idx[Xt]].type;for(let Dn=8*$t;Dn<8*$t+dt;++Dn){kn=xt[Xt][Dn];for(let ai=0;ai<ke;++ai){const Ar=ai*64+(Dn&7)*8;kt.setUint16(kn+0*2*Wt,Vt[Xt][Ar+0],!0),kt.setUint16(kn+1*2*Wt,Vt[Xt][Ar+1],!0),kt.setUint16(kn+2*2*Wt,Vt[Xt][Ar+2],!0),kt.setUint16(kn+3*2*Wt,Vt[Xt][Ar+3],!0),kt.setUint16(kn+4*2*Wt,Vt[Xt][Ar+4],!0),kt.setUint16(kn+5*2*Wt,Vt[Xt][Ar+5],!0),kt.setUint16(kn+6*2*Wt,Vt[Xt][Ar+6],!0),kt.setUint16(kn+7*2*Wt,Vt[Xt][Ar+7],!0),kn+=8*2*Wt}}if(ke!=We)for(let Dn=8*$t;Dn<8*$t+dt;++Dn){const ai=xt[Xt][Dn]+8*ke*2*Wt,Ar=ke*64+(Dn&7)*8;for(let Ts=0;Ts<Kt;++Ts)kt.setUint16(ai+Ts*2*Wt,Vt[Xt][Ar+Ts],!0)}}}for(var Ut=new Uint16Array(he),kt=new DataView(re.buffer),bn=0;bn<Pe;++bn){me[D.idx[bn]].decoded=!0;var Ln=me[D.idx[bn]].type;if(me[bn].type==2)for(var Nn=0;Nn<ue;++Nn){const $t=xt[bn][Nn];for(var en=0;en<he;++en)Ut[en]=kt.getUint16($t+en*2*Ln,!0);for(var en=0;en<he;++en)kt.setFloat32($t+en*2*Ln,ve(Ut[en]),!0)}}}function et(D,Z,me){for(var L,ee=1;ee<64;)L=Z[D.value],L==65280?ee=64:L>>8==255?ee+=L&255:(me[ee]=L,ee++),D.value++}function Re(D,Z){Z[0]=ve(D[0]),Z[1]=ve(D[1]),Z[2]=ve(D[5]),Z[3]=ve(D[6]),Z[4]=ve(D[14]),Z[5]=ve(D[15]),Z[6]=ve(D[27]),Z[7]=ve(D[28]),Z[8]=ve(D[2]),Z[9]=ve(D[4]),Z[10]=ve(D[7]),Z[11]=ve(D[13]),Z[12]=ve(D[16]),Z[13]=ve(D[26]),Z[14]=ve(D[29]),Z[15]=ve(D[42]),Z[16]=ve(D[3]),Z[17]=ve(D[8]),Z[18]=ve(D[12]),Z[19]=ve(D[17]),Z[20]=ve(D[25]),Z[21]=ve(D[30]),Z[22]=ve(D[41]),Z[23]=ve(D[43]),Z[24]=ve(D[9]),Z[25]=ve(D[11]),Z[26]=ve(D[18]),Z[27]=ve(D[24]),Z[28]=ve(D[31]),Z[29]=ve(D[40]),Z[30]=ve(D[44]),Z[31]=ve(D[53]),Z[32]=ve(D[10]),Z[33]=ve(D[19]),Z[34]=ve(D[23]),Z[35]=ve(D[32]),Z[36]=ve(D[39]),Z[37]=ve(D[45]),Z[38]=ve(D[52]),Z[39]=ve(D[54]),Z[40]=ve(D[20]),Z[41]=ve(D[22]),Z[42]=ve(D[33]),Z[43]=ve(D[38]),Z[44]=ve(D[46]),Z[45]=ve(D[51]),Z[46]=ve(D[55]),Z[47]=ve(D[60]),Z[48]=ve(D[21]),Z[49]=ve(D[34]),Z[50]=ve(D[37]),Z[51]=ve(D[47]),Z[52]=ve(D[50]),Z[53]=ve(D[56]),Z[54]=ve(D[59]),Z[55]=ve(D[61]),Z[56]=ve(D[35]),Z[57]=ve(D[36]),Z[58]=ve(D[48]),Z[59]=ve(D[49]),Z[60]=ve(D[57]),Z[61]=ve(D[58]),Z[62]=ve(D[62]),Z[63]=ve(D[63])}function J(D){const Z=.5*Math.cos(.7853975),me=.5*Math.cos(3.14159/16),L=.5*Math.cos(3.14159/8),ee=.5*Math.cos(3*3.14159/16),re=.5*Math.cos(5*3.14159/16),he=.5*Math.cos(3*3.14159/8),ue=.5*Math.cos(7*3.14159/16);for(var Pe=new Array(4),ke=new Array(4),We=new Array(4),Ae=new Array(4),vt=0;vt<8;++vt){var nt=vt*8;Pe[0]=L*D[nt+2],Pe[1]=he*D[nt+2],Pe[2]=L*D[nt+6],Pe[3]=he*D[nt+6],ke[0]=me*D[nt+1]+ee*D[nt+3]+re*D[nt+5]+ue*D[nt+7],ke[1]=ee*D[nt+1]-ue*D[nt+3]-me*D[nt+5]-re*D[nt+7],ke[2]=re*D[nt+1]-me*D[nt+3]+ue*D[nt+5]+ee*D[nt+7],ke[3]=ue*D[nt+1]-re*D[nt+3]+ee*D[nt+5]-me*D[nt+7],We[0]=Z*(D[nt+0]+D[nt+4]),We[3]=Z*(D[nt+0]-D[nt+4]),We[1]=Pe[0]+Pe[3],We[2]=Pe[1]-Pe[2],Ae[0]=We[0]+We[1],Ae[1]=We[3]+We[2],Ae[2]=We[3]-We[2],Ae[3]=We[0]-We[1],D[nt+0]=Ae[0]+ke[0],D[nt+1]=Ae[1]+ke[1],D[nt+2]=Ae[2]+ke[2],D[nt+3]=Ae[3]+ke[3],D[nt+4]=Ae[3]-ke[3],D[nt+5]=Ae[2]-ke[2],D[nt+6]=Ae[1]-ke[1],D[nt+7]=Ae[0]-ke[0]}for(var tt=0;tt<8;++tt)Pe[0]=L*D[16+tt],Pe[1]=he*D[16+tt],Pe[2]=L*D[48+tt],Pe[3]=he*D[48+tt],ke[0]=me*D[8+tt]+ee*D[24+tt]+re*D[40+tt]+ue*D[56+tt],ke[1]=ee*D[8+tt]-ue*D[24+tt]-me*D[40+tt]-re*D[56+tt],ke[2]=re*D[8+tt]-me*D[24+tt]+ue*D[40+tt]+ee*D[56+tt],ke[3]=ue*D[8+tt]-re*D[24+tt]+ee*D[40+tt]-me*D[56+tt],We[0]=Z*(D[tt]+D[32+tt]),We[3]=Z*(D[tt]-D[32+tt]),We[1]=Pe[0]+Pe[3],We[2]=Pe[1]-Pe[2],Ae[0]=We[0]+We[1],Ae[1]=We[3]+We[2],Ae[2]=We[3]-We[2],Ae[3]=We[0]-We[1],D[0+tt]=Ae[0]+ke[0],D[8+tt]=Ae[1]+ke[1],D[16+tt]=Ae[2]+ke[2],D[24+tt]=Ae[3]+ke[3],D[32+tt]=Ae[3]-ke[3],D[40+tt]=Ae[2]-ke[2],D[48+tt]=Ae[1]-ke[1],D[56+tt]=Ae[0]-ke[0]}function F(D){for(var Z=0;Z<64;++Z){var me=D[0][Z],L=D[1][Z],ee=D[2][Z];D[0][Z]=me+1.5747*ee,D[1][Z]=me-.1873*L-.4682*ee,D[2][Z]=me+1.8556*L}}function G(D,Z,me){for(var L=0;L<64;++L)Z[me+L]=Bf.toHalfFloat(de(D[L]))}function de(D){return D<=1?Math.sign(D)*Math.pow(Math.abs(D),2.2):Math.sign(D)*Math.pow(C,Math.abs(D)-1)}function le(D){return new DataView(D.array.buffer,D.offset.value,D.size)}function ye(D){var Z=D.viewer.buffer.slice(D.offset.value,D.offset.value+D.size),me=new Uint8Array(Ue(Z)),L=new Uint8Array(me.length);return Te(me),be(me,L),new DataView(L.buffer)}function Le(D){var Z=D.array.slice(D.offset.value,D.offset.value+D.size),me=u1(Z),L=new Uint8Array(me.length);return Te(me),be(me,L),new DataView(L.buffer)}function Ve(D){for(var Z=D.viewer,me={value:D.offset.value},L=new Uint16Array(D.width*D.scanlineBlockSize*(D.channels*D.type)),ee=new Uint8Array(8192),re=0,he=new Array(D.channels),ue=0;ue<D.channels;ue++)he[ue]={},he[ue].start=re,he[ue].end=he[ue].start,he[ue].nx=D.width,he[ue].ny=D.lines,he[ue].size=D.type,re+=he[ue].nx*he[ue].ny*he[ue].size;var Pe=ce(Z,me),ke=ce(Z,me);if(ke>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(Pe<=ke)for(var ue=0;ue<ke-Pe+1;ue++)ee[ue+Pe]=ae(Z,me);var We=new Uint16Array(65536),Ae=B(ee,We),vt=Ze(Z,me);Fe(D.array,Z,me,vt,L,re);for(var ue=0;ue<D.channels;++ue)for(var nt=he[ue],tt=0;tt<he[ue].size;++tt)Je(L,nt.start+tt,nt.nx,nt.size,nt.ny,nt.nx*nt.size,Ae);j(We,L,re);for(var Et=0,Pt=new Uint8Array(L.buffer.byteLength),Lt=0;Lt<D.lines;Lt++)for(var Vt=0;Vt<D.channels;Vt++){var nt=he[Vt],xt=nt.nx*nt.size,dt=new Uint8Array(L.buffer,nt.end*2,xt*2);Pt.set(dt,Et),Et+=xt*2,nt.end+=xt}return new DataView(Pt.buffer)}function Oe(D){var Z=D.array.slice(D.offset.value,D.offset.value+D.size),me=u1(Z);const L=D.lines*D.channels*D.width,ee=D.type==1?new Uint16Array(L):new Uint32Array(L);let re=0,he=0;const ue=new Array(4);for(let Pe=0;Pe<D.lines;Pe++)for(let ke=0;ke<D.channels;ke++){let We=0;switch(D.type){case 1:ue[0]=re,ue[1]=ue[0]+D.width,re=ue[1]+D.width;for(let Ae=0;Ae<D.width;++Ae){const vt=me[ue[0]++]<<8|me[ue[1]++];We+=vt,ee[he]=We,he++}break;case 2:ue[0]=re,ue[1]=ue[0]+D.width,ue[2]=ue[1]+D.width,re=ue[2]+D.width;for(let Ae=0;Ae<D.width;++Ae){const vt=me[ue[0]++]<<24|me[ue[1]++]<<16|me[ue[2]++]<<8;We+=vt,ee[he]=We,he++}break}}return new DataView(ee.buffer)}function ze(D){var Z=D.viewer,me={value:D.offset.value},L=new Uint8Array(D.width*D.lines*(D.channels*D.type*2)),ee={version:De(Z,me),unknownUncompressedSize:De(Z,me),unknownCompressedSize:De(Z,me),acCompressedSize:De(Z,me),dcCompressedSize:De(Z,me),rleCompressedSize:De(Z,me),rleUncompressedSize:De(Z,me),rleRawSize:De(Z,me),totalAcUncompressedCount:De(Z,me),totalDcUncompressedCount:De(Z,me),acCompression:De(Z,me)};if(ee.version<2)throw"EXRLoader.parse: "+dr.compression+" version "+ee.version+" is unsupported";for(var re=new Array,he=ce(Z,me)-2;he>0;){var ue=Ye(Z.buffer,me),Pe=ae(Z,me),ke=Pe>>2&3,We=(Pe>>4)-1,Ae=new Int8Array([We])[0],vt=ae(Z,me);re.push({name:ue,index:Ae,type:vt,compression:ke}),he-=ue.length+3}for(var nt=dr.channels,tt=new Array(D.channels),Et=0;Et<D.channels;++Et){var Pt=tt[Et]={},Lt=nt[Et];Pt.name=Lt.name,Pt.compression=0,Pt.decoded=!1,Pt.type=Lt.pixelType,Pt.pLinear=Lt.pLinear,Pt.width=D.width,Pt.height=D.lines}for(var Vt={idx:new Array(3)},xt=0;xt<D.channels;++xt)for(var Pt=tt[xt],Et=0;Et<re.length;++Et){var dt=re[Et];Pt.name==dt.name&&(Pt.compression=dt.compression,dt.index>=0&&(Vt.idx[dt.index]=xt),Pt.offset=xt)}if(ee.acCompressedSize>0)switch(ee.acCompression){case 0:var kt=new Uint16Array(ee.totalAcUncompressedCount);Fe(D.array,Z,me,ee.acCompressedSize,kt,ee.totalAcUncompressedCount);break;case 1:var Kt=D.array.slice(me.value,me.value+ee.totalAcUncompressedCount),Ut=u1(Kt),kt=new Uint16Array(Ut.buffer);me.value+=ee.totalAcUncompressedCount;break}if(ee.dcCompressedSize>0){var bn={array:D.array,offset:me,size:ee.dcCompressedSize},Ln=new Uint16Array(Le(bn).buffer);me.value+=ee.dcCompressedSize}if(ee.rleRawSize>0){var Kt=D.array.slice(me.value,me.value+ee.rleCompressedSize),Ut=u1(Kt),Nn=Ue(Ut.buffer);me.value+=ee.rleCompressedSize}for(var en=0,$t=new Array(tt.length),Et=0;Et<$t.length;++Et)$t[Et]=new Array;for(var kn=0;kn<D.lines;++kn)for(var Xt=0;Xt<tt.length;++Xt)$t[Xt].push(en),en+=tt[Xt].width*D.type*2;we(Vt,$t,tt,kt,Ln,L);for(var Et=0;Et<tt.length;++Et){var Pt=tt[Et];if(!Pt.decoded)switch(Pt.compression){case 2:for(var Wt=0,Dn=0,kn=0;kn<D.lines;++kn){for(var ai=$t[Et][Wt],Ar=0;Ar<Pt.width;++Ar){for(var Ts=0;Ts<2*Pt.type;++Ts)L[ai++]=Nn[Dn+Ts*Pt.width*Pt.height];Dn++}Wt++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(L.buffer)}function Ye(D,Z){for(var me=new Uint8Array(D),L=0;me[Z.value+L]!=0;)L+=1;var ee=new TextDecoder().decode(me.slice(Z.value,Z.value+L));return Z.value=Z.value+L+1,ee}function Ie(D,Z,me){var L=new TextDecoder().decode(new Uint8Array(D).slice(Z.value,Z.value+me));return Z.value=Z.value+me,L}function gt(D,Z){var me=ot(D,Z),L=Ze(D,Z);return[me,L]}function yt(D,Z){var me=Ze(D,Z),L=Ze(D,Z);return[me,L]}function ot(D,Z){var me=D.getInt32(Z.value,!0);return Z.value=Z.value+4,me}function Ze(D,Z){var me=D.getUint32(Z.value,!0);return Z.value=Z.value+4,me}function Ke(D,Z){var me=D[Z.value];return Z.value=Z.value+1,me}function ae(D,Z){var me=D.getUint8(Z.value);return Z.value=Z.value+1,me}const De=function(D,Z){let me;return"getBigInt64"in DataView.prototype?me=Number(D.getBigInt64(Z.value,!0)):me=D.getUint32(Z.value+4,!0)+Number(D.getUint32(Z.value,!0)<<32),Z.value+=8,me};function rt(D,Z){var me=D.getFloat32(Z.value,!0);return Z.value+=4,me}function it(D,Z){return Bf.toHalfFloat(rt(D,Z))}function ve(D){var Z=(D&31744)>>10,me=D&1023;return(D>>15?-1:1)*(Z?Z===31?me?NaN:1/0:Math.pow(2,Z-15)*(1+me/1024):6103515625e-14*(me/1024))}function ce(D,Z){var me=D.getUint16(Z.value,!0);return Z.value+=2,me}function at(D,Z){return ve(ce(D,Z))}function $e(D,Z,me,L){for(var ee=me.value,re=[];me.value<ee+L-1;){var he=Ye(Z,me),ue=ot(D,me),Pe=ae(D,me);me.value+=3;var ke=ot(D,me),We=ot(D,me);re.push({name:he,pixelType:ue,pLinear:Pe,xSampling:ke,ySampling:We})}return me.value+=1,re}function ct(D,Z){var me=rt(D,Z),L=rt(D,Z),ee=rt(D,Z),re=rt(D,Z),he=rt(D,Z),ue=rt(D,Z),Pe=rt(D,Z),ke=rt(D,Z);return{redX:me,redY:L,greenX:ee,greenY:re,blueX:he,blueY:ue,whiteX:Pe,whiteY:ke}}function ft(D,Z){var me=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],L=ae(D,Z);return me[L]}function Tt(D,Z){var me=Ze(D,Z),L=Ze(D,Z),ee=Ze(D,Z),re=Ze(D,Z);return{xMin:me,yMin:L,xMax:ee,yMax:re}}function mt(D,Z){var me=["INCREASING_Y"],L=ae(D,Z);return me[L]}function Dt(D,Z){var me=rt(D,Z),L=rt(D,Z);return[me,L]}function qt(D,Z){var me=rt(D,Z),L=rt(D,Z),ee=rt(D,Z);return[me,L,ee]}function Ft(D,Z,me,L,ee){if(L==="string"||L==="stringvector"||L==="iccProfile")return Ie(Z,me,ee);if(L==="chlist")return $e(D,Z,me,ee);if(L==="chromaticities")return ct(D,me);if(L==="compression")return ft(D,me);if(L==="box2i")return Tt(D,me);if(L==="lineOrder")return mt(D,me);if(L==="float")return rt(D,me);if(L==="v2f")return Dt(D,me);if(L==="v3f")return qt(D,me);if(L==="int")return ot(D,me);if(L==="rational")return gt(D,me);if(L==="timecode")return yt(D,me);if(L==="preview")return me.value+=ee,"skipped";me.value+=ee}function ln(D,Z,me){const L={};if(D.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";L.version=D.getUint8(4);const ee=D.getUint8(5);L.spec={singleTile:!!(ee&2),longName:!!(ee&4),deepFormat:!!(ee&8),multiPart:!!(ee&16)},me.value=8;for(var re=!0;re;){var he=Ye(Z,me);if(he==0)re=!1;else{var ue=Ye(Z,me),Pe=Ze(D,me),ke=Ft(D,Z,me,ue,Pe);ke===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${ue}'.`):L[he]=ke}}if(ee&-5)throw console.error("EXRHeader:",L),"THREE.EXRLoader: provided file is currently unsupported.";return L}function zn(D,Z,me,L,ee){const re={size:0,viewer:Z,array:me,offset:L,width:D.dataWindow.xMax-D.dataWindow.xMin+1,height:D.dataWindow.yMax-D.dataWindow.yMin+1,channels:D.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:D.channels[0].pixelType,uncompress:null,getter:null,format:null,[Og?"colorSpace":"encoding"]:null};switch(D.compression){case"NO_COMPRESSION":re.lines=1,re.uncompress=le;break;case"RLE_COMPRESSION":re.lines=1,re.uncompress=ye;break;case"ZIPS_COMPRESSION":re.lines=1,re.uncompress=Le;break;case"ZIP_COMPRESSION":re.lines=16,re.uncompress=Le;break;case"PIZ_COMPRESSION":re.lines=32,re.uncompress=Ve;break;case"PXR24_COMPRESSION":re.lines=16,re.uncompress=Oe;break;case"DWAA_COMPRESSION":re.lines=32,re.uncompress=ze;break;case"DWAB_COMPRESSION":re.lines=256,re.uncompress=ze;break;default:throw"EXRLoader.parse: "+D.compression+" is unsupported"}if(re.scanlineBlockSize=re.lines,re.type==1)switch(ee){case Cr:re.getter=at,re.inputSize=2;break;case Jr:re.getter=ce,re.inputSize=2;break}else if(re.type==2)switch(ee){case Cr:re.getter=rt,re.inputSize=4;break;case Jr:re.getter=it,re.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+re.type+" for "+D.compression+".";re.blockCount=(D.dataWindow.yMax+1)/re.scanlineBlockSize;for(var he=0;he<re.blockCount;he++)De(Z,L);re.outputChannels=re.channels==3?4:re.channels;const ue=re.width*re.height*re.outputChannels;switch(ee){case Cr:re.byteArray=new Float32Array(ue),re.channels<re.outputChannels&&re.byteArray.fill(1,0,ue);break;case Jr:re.byteArray=new Uint16Array(ue),re.channels<re.outputChannels&&re.byteArray.fill(15360,0,ue);break;default:console.error("THREE.EXRLoader: unsupported type: ",ee);break}return re.bytesPerLine=re.width*re.inputSize*re.channels,re.outputChannels==4?re.format=Ur:re.format=m2,Og?re.colorSpace="srgb-linear":re.encoding=3e3,re}const zr=new DataView(e),oi=new Uint8Array(e),xr={value:0},dr=ln(zr,e,xr),Ot=zn(dr,zr,oi,xr,this.type),nr={value:0},as={R:0,G:1,B:2,A:3,Y:0};for(let D=0;D<Ot.height/Ot.scanlineBlockSize;D++){const Z=Ze(zr,xr);Ot.size=Ze(zr,xr),Ot.lines=Z+Ot.scanlineBlockSize>Ot.height?Ot.height-Z:Ot.scanlineBlockSize;const L=Ot.size<Ot.lines*Ot.bytesPerLine?Ot.uncompress(Ot):le(Ot);xr.value+=Ot.size;for(let ee=0;ee<Ot.scanlineBlockSize;ee++){const re=ee+D*Ot.scanlineBlockSize;if(re>=Ot.height)break;for(let he=0;he<Ot.channels;he++){const ue=as[dr.channels[he].name];for(let Pe=0;Pe<Ot.width;Pe++){nr.value=(ee*(Ot.channels*Ot.width)+he*Ot.width+Pe)*Ot.inputSize;const ke=(Ot.height-1-re)*(Ot.width*Ot.outputChannels)+Pe*Ot.outputChannels+ue;Ot.byteArray[ke]=Ot.getter(L,nr)}}}}return{header:dr,width:Ot.width,height:Ot.height,data:Ot.byteArray,format:Ot.format,[Og?"colorSpace":"encoding"]:Ot[Og?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,r,i){function s(o,a){Og?o.colorSpace=a.colorSpace:o.encoding=a.encoding,o.minFilter=un,o.magFilter=un,o.generateMipmaps=!1,o.flipY=!1,t&&t(o,a)}return super.load(e,s,r,i)}}const jS=new WeakMap;class _Z extends Ai{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){const s=new vi(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,a).then(t).catch(i)},r,i)}decodeDracoFile(e,t,r,i){const s={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const l in t.attributeTypes){const c=t.attributeTypes[l];c.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[l]=c.name)}const r=JSON.stringify(t);if(jS.has(e)){const l=jS.get(e);if(l.key===r)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const s=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(s,o).then(l=>(i=l,new Promise((c,u)=>{i._callbacks[s]={resolve:c,reject:u},i.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{i&&s&&this._releaseTask(i,s)}),jS.set(e,{key:r,promise:a}),a}_createGeometry(e){const t=new jt;e.index&&t.setIndex(new vn(e.index.array,1));for(let r=0;r<e.attributes.length;r++){const i=e.attributes[r],s=i.name,o=i.array,a=i.itemSize;t.setAttribute(s,new vn(o,a))}return t}_loadLibrary(e,t){const r=new vi(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((i,s)=>{r.load(e,i,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{const i=r[0];e||(this.decoderConfig.wasmBinary=r[1]);const s=wZ.toString(),o=["/* draco decoder */",i,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(s){const o=s.data;switch(o.type){case"decode":i._callbacks[o.id].resolve(o);break;case"error":i._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,s){return i._taskLoad>s._taskLoad?-1:1});const r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function wZ(){let n,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":n=a.decoderConfig,e=new Promise(function(u){n.onModuleLoaded=function(f){u({draco:f})},DracoDecoderModule(n)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(u=>{const f=u.draco,d=new f.Decoder,m=new f.DecoderBuffer;m.Init(new Int8Array(l),l.byteLength);try{const g=t(f,d,m,c),y=g.attributes.map(x=>x.array.buffer);g.index&&y.push(g.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:g},y)}catch(g){console.error(g),self.postMessage({type:"error",id:a.id,error:g.message})}finally{f.destroy(m),f.destroy(d)}});break}};function t(o,a,l,c){const u=c.attributeIDs,f=c.attributeTypes;let d,m;const g=a.GetEncodedGeometryType(l);if(g===o.TRIANGULAR_MESH)d=new o.Mesh,m=a.DecodeBufferToMesh(l,d);else if(g===o.POINT_CLOUD)d=new o.PointCloud,m=a.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!m.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+m.error_msg());const y={index:null,attributes:[]};for(const x in u){const v=self[f[x]];let A,w;if(c.useUniqueIDs)w=u[x],A=a.GetAttributeByUniqueId(d,w);else{if(w=a.GetAttributeId(d,o[u[x]]),w===-1)continue;A=a.GetAttribute(d,w)}y.attributes.push(i(o,a,d,x,v,A))}return g===o.TRIANGULAR_MESH&&(y.index=r(o,a,d)),o.destroy(d),y}function r(o,a,l){const u=l.num_faces()*3,f=u*4,d=o._malloc(f);a.GetTrianglesUInt32Array(l,f,d);const m=new Uint32Array(o.HEAPF32.buffer,d,u).slice();return o._free(d),{array:m,itemSize:1}}function i(o,a,l,c,u,f){const d=f.num_components(),g=l.num_points()*d,y=g*u.BYTES_PER_ELEMENT,x=s(o,u),v=o._malloc(y);a.GetAttributeDataArrayForAllPoints(l,f,x,y,v);const A=new u(o.HEAPF32.buffer,v,g).slice();return o._free(v),{name:c,array:A,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let h1;const YS=()=>{if(h1)return h1;const n="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),r=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let i=n;WebAssembly.validate(t)&&(i=e);let s;const o=WebAssembly.instantiate(a(i),{}).then(f=>{s=f.instance,s.exports.__wasm_call_ctors()});function a(f){const d=new Uint8Array(f.length);for(let g=0;g<f.length;++g){const y=f.charCodeAt(g);d[g]=y>96?y-71:y>64?y-65:y>47?y+4:y>46?63:62}let m=0;for(let g=0;g<f.length;++g)d[m++]=d[g]<60?r[d[g]]:(d[g]-60)*64+d[++g];return d.buffer.slice(0,m)}function l(f,d,m,g,y,x){const v=s.exports.sbrk,A=m+3&-4,w=v(A*g),S=v(y.length),M=new Uint8Array(s.exports.memory.buffer);M.set(y,S);const b=f(w,m,g,S,y.length);if(b===0&&x&&x(w,A,g),d.set(M.subarray(w,w+m*g)),v(w-v(0)),b!==0)throw new Error(`Malformed buffer data: ${b}`)}const c={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},u={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return h1={ready:o,supported:!0,decodeVertexBuffer(f,d,m,g,y){l(s.exports.meshopt_decodeVertexBuffer,f,d,m,g,s.exports[c[y]])},decodeIndexBuffer(f,d,m,g){l(s.exports.meshopt_decodeIndexBuffer,f,d,m,g)},decodeIndexSequence(f,d,m,g){l(s.exports.meshopt_decodeIndexSequence,f,d,m,g)},decodeGltfBuffer(f,d,m,g,y,x){l(s.exports[u[y]],f,d,m,g,s.exports[c[x]])}},h1},EZ=te.createContext(null),NN=n=>(n.getAttributes()&Dl.CONVOLUTION)===Dl.CONVOLUTION,SZ=um.memo(te.forwardRef(({children:n,camera:e,scene:t,resolutionScale:r,enabled:i=!0,renderPriority:s=1,autoClear:o=!0,depthBuffer:a,enableNormalPass:l,stencilBuffer:c,multisampling:u=8,frameBufferType:f=Jr},d)=>{const{gl:m,scene:g,camera:y,size:x}=$n(),v=t||g,A=e||y,[w,S,M]=te.useMemo(()=>{const P=uY(),C=new tj(m,{depthBuffer:a,stencilBuffer:c,multisampling:u>0&&P?u:0,frameBufferType:f});C.addPass(new y4(v,A));let B=null,H=null;return l&&(H=new cY(v,A),H.enabled=!1,C.addPass(H),r!==void 0&&P&&(B=new rY({normalBuffer:H.texture,resolutionScale:r}),B.enabled=!1,C.addPass(B))),[C,H,B]},[A,m,a,c,u,f,v,l,r]);te.useEffect(()=>w==null?void 0:w.setSize(x.width,x.height),[w,x]),fa((P,C)=>{if(i){const B=m.autoClear;m.autoClear=o,c&&!o&&m.clearStencil(),w.render(C),m.autoClear=B}},i?s:0);const b=te.useRef(null);te.useLayoutEffect(()=>{var P;const C=[],B=(P=b.current)==null?void 0:P.__r3f;if(B&&w){const H=B.objects;for(let k=0;k<H.length;k++){const $=H[k];if($ instanceof dT){const U=[$];if(!NN($)){let O=null;for(;(O=H[k+1])instanceof dT&&!NN(O);)U.push(O),k++}const z=new lY(A,...U);C.push(z)}else $ instanceof Ms&&C.push($)}for(const k of C)w==null||w.addPass(k);S&&(S.enabled=!0),M&&(M.enabled=!0)}return()=>{for(const H of C)w==null||w.removePass(H);S&&(S.enabled=!1),M&&(M.enabled=!1)}},[w,n,A,S,M]),te.useEffect(()=>{const P=m.toneMapping;return m.toneMapping=na,()=>{m.toneMapping=P}},[m]);const R=te.useMemo(()=>({composer:w,normalPass:S,downSamplingPass:M,resolutionScale:r,camera:A,scene:v}),[w,S,M,r,A,v]);return te.useImperativeHandle(d,()=>w,[w]),Me(EZ.Provider,{value:R,children:Me("group",{ref:b,children:n})})}));let bZ=0;const DN=new WeakMap,MZ=(n,e)=>um.forwardRef(function({blendFunction:r=e==null?void 0:e.blendFunction,opacity:i=e==null?void 0:e.opacity,...s},o){let a=DN.get(n);if(!a){const u=`@react-three/postprocessing/${n.name}-${bZ++}`;uw({[u]:n}),DN.set(n,a=u)}const l=$n(u=>u.camera),c=um.useMemo(()=>{var u,f;return[...(u=e==null?void 0:e.args)!=null?u:[],...(f=s.args)!=null?f:[{...e,...s}]]},[JSON.stringify(s)]);return Me(a,{camera:l,"blendMode-blendFunction":r,"blendMode-opacity-value":i,...s,ref:o,args:c})}),TZ=MZ($j,{blendFunction:hn.ADD}),UN=n=>{let e;const t=new Set,r=(c,u)=>{const f=typeof c=="function"?c(e):c;if(!Object.is(f,e)){const d=e;e=u??(typeof f!="object"||f===null)?f:Object.assign({},e,f),t.forEach(m=>m(e,d))}},i=()=>e,a={setState:r,getState:i,getInitialState:()=>l,subscribe:c=>(t.add(c),()=>t.delete(c))},l=e=n(r,i,a);return a},CZ=n=>n?UN(n):UN,RZ=n=>n;function BZ(n,e=RZ){const t=um.useSyncExternalStore(n.subscribe,()=>e(n.getState()),()=>e(n.getInitialState()));return um.useDebugValue(t),t}const FN=n=>{const e=CZ(n),t=r=>BZ(e,r);return Object.assign(t,e),t},PZ=n=>n?FN(n):FN;let kg=0;const IZ=PZ(n=>(Zd.onStart=(e,t,r)=>{n({active:!0,item:e,loaded:t,total:r,progress:(t-kg)/(r-kg)*100})},Zd.onLoad=()=>{n({active:!1})},Zd.onError=e=>n(t=>({errors:[...t.errors,e]})),Zd.onProgress=(e,t,r)=>{t===r&&(kg=r),n({active:!0,item:e,loaded:t,total:r,progress:(t-kg)/(r-kg)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})),LZ=n=>`Loading ${n.toFixed(2)}%`;function NZ({containerStyles:n,innerStyles:e,barStyles:t,dataStyles:r,dataInterpolation:i=LZ,initialState:s=o=>o}){const{active:o,progress:a}=IZ(),l=te.useRef(0),c=te.useRef(0),u=te.useRef(null),[f,d]=te.useState(s(o));te.useEffect(()=>{let g;return o!==f&&(g=setTimeout(()=>d(o),300)),()=>clearTimeout(g)},[f,o]);const m=te.useCallback(()=>{u.current&&(l.current+=(a-l.current)/2,(l.current>.95*a||a===100)&&(l.current=a),u.current.innerText=i(l.current),l.current<a&&(c.current=requestAnimationFrame(m)))},[i,a]);return te.useEffect(()=>(m(),()=>cancelAnimationFrame(c.current)),[m]),f?te.createElement("div",{style:{...d1.container,opacity:o?1:0,...n}},te.createElement("div",null,te.createElement("div",{style:{...d1.inner,...e}},te.createElement("div",{style:{...d1.bar,transform:`scaleX(${a/100})`,...t}}),te.createElement("span",{ref:u,style:{...d1.data,...r}})))):null}const d1={container:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"#171717",display:"flex",alignItems:"center",justifyContent:"center",transition:"opacity 300ms ease",zIndex:1e3},inner:{width:100,height:3,background:"#272727",textAlign:"center"},bar:{height:3,width:"100%",background:"white",transition:"transform 200ms",transformOrigin:"left center"},data:{display:"inline-block",position:"relative",fontVariantNumeric:"tabular-nums",marginTop:"0.8em",color:"#f0f0f0",fontSize:"0.6em",fontFamily:'-apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", "Helvetica Neue", Helvetica, Arial, Roboto, Ubuntu, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',whiteSpace:"nowrap"}},ON=te.forwardRef(function({children:e,follow:t=!0,lockX:r=!1,lockY:i=!1,lockZ:s=!1,...o},a){const l=te.useRef(null),c=te.useRef(null),u=new Rr;return fa(({camera:f})=>{if(!t||!c.current)return;const d=l.current.rotation.clone();c.current.updateMatrix(),c.current.updateWorldMatrix(!1,!1),c.current.getWorldQuaternion(u),f.getWorldQuaternion(l.current.quaternion).premultiply(u.invert()),r&&(l.current.rotation.x=d.x),i&&(l.current.rotation.y=d.y),s&&(l.current.rotation.z=d.z)}),te.useImperativeHandle(a,()=>c.current,[]),te.createElement("group",oa({ref:c},o),te.createElement("group",{ref:l},e))});function DZ(){var n=Object.create(null);function e(i,s){var o=i.id,a=i.name,l=i.dependencies;l===void 0&&(l=[]);var c=i.init;c===void 0&&(c=function(){});var u=i.getTransferables;if(u===void 0&&(u=null),!n[o])try{l=l.map(function(d){return d&&d.isWorkerModule&&(e(d,function(m){if(m instanceof Error)throw m}),d=n[d.id].value),d}),c=r("<"+a+">.init",c),u&&(u=r("<"+a+">.getTransferables",u));var f=null;typeof c=="function"?f=c.apply(void 0,l):console.error("worker module init function failed to rehydrate"),n[o]={id:o,value:f,getTransferables:u},s(f)}catch(d){d&&d.noLog||console.error(d),s(d)}}function t(i,s){var o,a=i.id,l=i.args;(!n[a]||typeof n[a].value!="function")&&s(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var c=(o=n[a]).value.apply(o,l);c&&typeof c.then=="function"?c.then(u,function(f){return s(f instanceof Error?f:new Error(""+f))}):u(c)}catch(f){s(f)}function u(f){try{var d=n[a].getTransferables&&n[a].getTransferables(f);(!d||!Array.isArray(d)||!d.length)&&(d=void 0),s(f,d)}catch(m){console.error(m),s(m)}}}function r(i,s){var o=void 0;self.troikaDefine=function(l){return o=l};var a=URL.createObjectURL(new Blob(["/** "+i.replace(/\*/g,"")+` **/

troikaDefine(
`+s+`
)`],{type:"application/javascript"}));try{importScripts(a)}catch(l){console.error(l)}return URL.revokeObjectURL(a),delete self.troikaDefine,o}self.addEventListener("message",function(i){var s=i.data,o=s.messageId,a=s.action,l=s.data;try{a==="registerModule"&&e(l,function(c){c instanceof Error?postMessage({messageId:o,success:!1,error:c.message}):postMessage({messageId:o,success:!0,result:{isCallable:typeof c=="function"}})}),a==="callModule"&&t(l,function(c,u){c instanceof Error?postMessage({messageId:o,success:!1,error:c.message}):postMessage({messageId:o,success:!0,result:c},u||void 0)})}catch(c){postMessage({messageId:o,success:!1,error:c.stack})}})}function UZ(n){var e=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return e._getInitResult().then(function(i){if(typeof i=="function")return i.apply(void 0,t);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var t=n.dependencies,r=n.init;t=Array.isArray(t)?t.map(function(s){return s&&(s=s.onMainThread||s,s._getInitResult&&(s=s._getInitResult())),s}):[];var i=Promise.all(t).then(function(s){return r.apply(null,s)});return e._getInitResult=function(){return i},i},e}var B4=function(){var n=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),n=!0}catch(t){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+t.message+"]")}return B4=function(){return n},n},FZ=0,OZ=0,ZS=!1,_0=Object.create(null),w0=Object.create(null),yT=Object.create(null);function Gm(n){if((!n||typeof n.init!="function")&&!ZS)throw new Error("requires `options.init` function");var e=n.dependencies,t=n.init,r=n.getTransferables,i=n.workerId,s=UZ(n);i==null&&(i="#default");var o="workerModule"+ ++FZ,a=n.name||o,l=null;e=e&&e.map(function(u){return typeof u=="function"&&!u.workerModuleData&&(ZS=!0,u=Gm({workerId:i,name:"<"+a+"> function dependency: "+u.name,init:`function(){return (
`+Z1(u)+`
)}`}),ZS=!1),u&&u.workerModuleData&&(u=u.workerModuleData),u});function c(){for(var u=[],f=arguments.length;f--;)u[f]=arguments[f];if(!B4())return s.apply(void 0,u);if(!l){l=kN(i,"registerModule",c.workerModuleData);var d=function(){l=null,w0[i].delete(d)};(w0[i]||(w0[i]=new Set)).add(d)}return l.then(function(m){var g=m.isCallable;if(g)return kN(i,"callModule",{id:o,args:u});throw new Error("Worker module function was called but `init` did not return a callable function")})}return c.workerModuleData={isWorkerModule:!0,id:o,name:a,dependencies:e,init:Z1(t),getTransferables:r&&Z1(r)},c.onMainThread=s,c}function kZ(n){w0[n]&&w0[n].forEach(function(e){e()}),_0[n]&&(_0[n].terminate(),delete _0[n])}function Z1(n){var e=n.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function GZ(n){var e=_0[n];if(!e){var t=Z1(DZ);e=_0[n]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+n.replace(/\*/g,"")+` **/

;(`+t+")()"],{type:"application/javascript"}))),e.onmessage=function(r){var i=r.data,s=i.messageId,o=yT[s];if(!o)throw new Error("WorkerModule response with empty or unknown messageId");delete yT[s],o(i)}}return e}function kN(n,e,t){return new Promise(function(r,i){var s=++OZ;yT[s]=function(o){o.success?r(o.result):i(new Error("Error in worker "+e+" call: "+o.error))},GZ(n).postMessage({messageId:s,action:e,data:t})})}function P4(){var n=function(e){function t(K,W,V,Q,q,ne,fe,pe){var ge=1-fe;pe.x=ge*ge*K+2*ge*fe*V+fe*fe*q,pe.y=ge*ge*W+2*ge*fe*Q+fe*fe*ne}function r(K,W,V,Q,q,ne,fe,pe,ge,Ce){var Je=1-ge;Ce.x=Je*Je*Je*K+3*Je*Je*ge*V+3*Je*ge*ge*q+ge*ge*ge*fe,Ce.y=Je*Je*Je*W+3*Je*Je*ge*Q+3*Je*ge*ge*ne+ge*ge*ge*pe}function i(K,W){for(var V=/([MLQCZ])([^MLQCZ]*)/g,Q,q,ne,fe,pe;Q=V.exec(K);){var ge=Q[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(Ce){return parseFloat(Ce)});switch(Q[1]){case"M":fe=q=ge[0],pe=ne=ge[1];break;case"L":(ge[0]!==fe||ge[1]!==pe)&&W("L",fe,pe,fe=ge[0],pe=ge[1]);break;case"Q":{W("Q",fe,pe,fe=ge[2],pe=ge[3],ge[0],ge[1]);break}case"C":{W("C",fe,pe,fe=ge[4],pe=ge[5],ge[0],ge[1],ge[2],ge[3]);break}case"Z":(fe!==q||pe!==ne)&&W("L",fe,pe,q,ne);break}}}function s(K,W,V){V===void 0&&(V=16);var Q={x:0,y:0};i(K,function(q,ne,fe,pe,ge,Ce,Je,Xe,Fe){switch(q){case"L":W(ne,fe,pe,ge);break;case"Q":{for(var j=ne,Te=fe,be=1;be<V;be++)t(ne,fe,Ce,Je,pe,ge,be/(V-1),Q),W(j,Te,Q.x,Q.y),j=Q.x,Te=Q.y;break}case"C":{for(var Ue=ne,we=fe,et=1;et<V;et++)r(ne,fe,Ce,Je,Xe,Fe,pe,ge,et/(V-1),Q),W(Ue,we,Q.x,Q.y),Ue=Q.x,we=Q.y;break}}})}var o="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",a="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",l=new WeakMap,c={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function u(K,W){var V=K.getContext?K.getContext("webgl",c):K,Q=l.get(V);if(!Q){let Ue=function(G){var de=ne[G];if(!de&&(de=ne[G]=V.getExtension(G),!de))throw new Error(G+" not supported");return de},we=function(G,de){var le=V.createShader(de);return V.shaderSource(le,G),V.compileShader(le),le},et=function(G,de,le,ye){if(!fe[G]){var Le={},Ve={},Oe=V.createProgram();V.attachShader(Oe,we(de,V.VERTEX_SHADER)),V.attachShader(Oe,we(le,V.FRAGMENT_SHADER)),V.linkProgram(Oe),fe[G]={program:Oe,transaction:function(Ye){V.useProgram(Oe),Ye({setUniform:function(gt,yt){for(var ot=[],Ze=arguments.length-2;Ze-- >0;)ot[Ze]=arguments[Ze+2];var Ke=Ve[yt]||(Ve[yt]=V.getUniformLocation(Oe,yt));V["uniform"+gt].apply(V,[Ke].concat(ot))},setAttribute:function(gt,yt,ot,Ze,Ke){var ae=Le[gt];ae||(ae=Le[gt]={buf:V.createBuffer(),loc:V.getAttribLocation(Oe,gt),data:null}),V.bindBuffer(V.ARRAY_BUFFER,ae.buf),V.vertexAttribPointer(ae.loc,yt,V.FLOAT,!1,0,0),V.enableVertexAttribArray(ae.loc),q?V.vertexAttribDivisor(ae.loc,Ze):Ue("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(ae.loc,Ze),Ke!==ae.data&&(V.bufferData(V.ARRAY_BUFFER,Ke,ot),ae.data=Ke)}})}}}fe[G].transaction(ye)},Re=function(G,de){ge++;try{V.activeTexture(V.TEXTURE0+ge);var le=pe[G];le||(le=pe[G]=V.createTexture(),V.bindTexture(V.TEXTURE_2D,le),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,V.NEAREST),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,V.NEAREST)),V.bindTexture(V.TEXTURE_2D,le),de(le,ge)}finally{ge--}},J=function(G,de,le){var ye=V.createFramebuffer();Ce.push(ye),V.bindFramebuffer(V.FRAMEBUFFER,ye),V.activeTexture(V.TEXTURE0+de),V.bindTexture(V.TEXTURE_2D,G),V.framebufferTexture2D(V.FRAMEBUFFER,V.COLOR_ATTACHMENT0,V.TEXTURE_2D,G,0);try{le(ye)}finally{V.deleteFramebuffer(ye),V.bindFramebuffer(V.FRAMEBUFFER,Ce[--Ce.length-1]||null)}},F=function(){ne={},fe={},pe={},ge=-1,Ce.length=0};var Je=Ue,Xe=we,Fe=et,j=Re,Te=J,be=F,q=typeof WebGL2RenderingContext<"u"&&V instanceof WebGL2RenderingContext,ne={},fe={},pe={},ge=-1,Ce=[];V.canvas.addEventListener("webglcontextlost",function(G){F(),G.preventDefault()},!1),l.set(V,Q={gl:V,isWebGL2:q,getExtension:Ue,withProgram:et,withTexture:Re,withTextureFramebuffer:J,handleContextLoss:F})}W(Q)}function f(K,W,V,Q,q,ne,fe,pe){fe===void 0&&(fe=15),pe===void 0&&(pe=null),u(K,function(ge){var Ce=ge.gl,Je=ge.withProgram,Xe=ge.withTexture;Xe("copy",function(Fe,j){Ce.texImage2D(Ce.TEXTURE_2D,0,Ce.RGBA,q,ne,0,Ce.RGBA,Ce.UNSIGNED_BYTE,W),Je("copy",o,a,function(Te){var be=Te.setUniform,Ue=Te.setAttribute;Ue("aUV",2,Ce.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),be("1i","image",j),Ce.bindFramebuffer(Ce.FRAMEBUFFER,pe||null),Ce.disable(Ce.BLEND),Ce.colorMask(fe&8,fe&4,fe&2,fe&1),Ce.viewport(V,Q,q,ne),Ce.scissor(V,Q,q,ne),Ce.drawArrays(Ce.TRIANGLES,0,3)})})})}function d(K,W,V){var Q=K.width,q=K.height;u(K,function(ne){var fe=ne.gl,pe=new Uint8Array(Q*q*4);fe.readPixels(0,0,Q,q,fe.RGBA,fe.UNSIGNED_BYTE,pe),K.width=W,K.height=V,f(fe,pe,0,0,Q,q)})}var m=Object.freeze({__proto__:null,withWebGLContext:u,renderImageData:f,resizeWebGLCanvasWithoutClearing:d});function g(K,W,V,Q,q,ne){ne===void 0&&(ne=1);var fe=new Uint8Array(K*W),pe=Q[2]-Q[0],ge=Q[3]-Q[1],Ce=[];s(V,function(Ue,we,et,Re){Ce.push({x1:Ue,y1:we,x2:et,y2:Re,minX:Math.min(Ue,et),minY:Math.min(we,Re),maxX:Math.max(Ue,et),maxY:Math.max(we,Re)})}),Ce.sort(function(Ue,we){return Ue.maxX-we.maxX});for(var Je=0;Je<K;Je++)for(var Xe=0;Xe<W;Xe++){var Fe=Te(Q[0]+pe*(Je+.5)/K,Q[1]+ge*(Xe+.5)/W),j=Math.pow(1-Math.abs(Fe)/q,ne)/2;Fe<0&&(j=1-j),j=Math.max(0,Math.min(255,Math.round(j*255))),fe[Xe*K+Je]=j}return fe;function Te(Ue,we){for(var et=1/0,Re=1/0,J=Ce.length;J--;){var F=Ce[J];if(F.maxX+Re<=Ue)break;if(Ue+Re>F.minX&&we-Re<F.maxY&&we+Re>F.minY){var G=v(Ue,we,F.x1,F.y1,F.x2,F.y2);G<et&&(et=G,Re=Math.sqrt(et))}}return be(Ue,we)&&(Re=-Re),Re}function be(Ue,we){for(var et=0,Re=Ce.length;Re--;){var J=Ce[Re];if(J.maxX<=Ue)break;var F=J.y1>we!=J.y2>we&&Ue<(J.x2-J.x1)*(we-J.y1)/(J.y2-J.y1)+J.x1;F&&(et+=J.y1<J.y2?1:-1)}return et!==0}}function y(K,W,V,Q,q,ne,fe,pe,ge,Ce){ne===void 0&&(ne=1),pe===void 0&&(pe=0),ge===void 0&&(ge=0),Ce===void 0&&(Ce=0),x(K,W,V,Q,q,ne,fe,null,pe,ge,Ce)}function x(K,W,V,Q,q,ne,fe,pe,ge,Ce,Je){ne===void 0&&(ne=1),ge===void 0&&(ge=0),Ce===void 0&&(Ce=0),Je===void 0&&(Je=0);for(var Xe=g(K,W,V,Q,q,ne),Fe=new Uint8Array(Xe.length*4),j=0;j<Xe.length;j++)Fe[j*4+Je]=Xe[j];f(fe,Fe,ge,Ce,K,W,1<<3-Je,pe)}function v(K,W,V,Q,q,ne){var fe=q-V,pe=ne-Q,ge=fe*fe+pe*pe,Ce=ge?Math.max(0,Math.min(1,((K-V)*fe+(W-Q)*pe)/ge)):0,Je=K-(V+Ce*fe),Xe=W-(Q+Ce*pe);return Je*Je+Xe*Xe}var A=Object.freeze({__proto__:null,generate:g,generateIntoCanvas:y,generateIntoFramebuffer:x}),w="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",S="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",M="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",b=new Float32Array([0,0,2,0,0,2]),R=null,P=!1,C={},B=new WeakMap;function H(K){if(!P&&!z(K))throw new Error("WebGL generation not supported")}function k(K,W,V,Q,q,ne,fe){if(ne===void 0&&(ne=1),fe===void 0&&(fe=null),!fe&&(fe=R,!fe)){var pe=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!pe)throw new Error("OffscreenCanvas or DOM canvas not supported");fe=R=pe.getContext("webgl",{depth:!1})}H(fe);var ge=new Uint8Array(K*W*4);u(fe,function(Fe){var j=Fe.gl,Te=Fe.withTexture,be=Fe.withTextureFramebuffer;Te("readable",function(Ue,we){j.texImage2D(j.TEXTURE_2D,0,j.RGBA,K,W,0,j.RGBA,j.UNSIGNED_BYTE,null),be(Ue,we,function(et){U(K,W,V,Q,q,ne,j,et,0,0,0),j.readPixels(0,0,K,W,j.RGBA,j.UNSIGNED_BYTE,ge)})})});for(var Ce=new Uint8Array(K*W),Je=0,Xe=0;Je<ge.length;Je+=4)Ce[Xe++]=ge[Je];return Ce}function $(K,W,V,Q,q,ne,fe,pe,ge,Ce){ne===void 0&&(ne=1),pe===void 0&&(pe=0),ge===void 0&&(ge=0),Ce===void 0&&(Ce=0),U(K,W,V,Q,q,ne,fe,null,pe,ge,Ce)}function U(K,W,V,Q,q,ne,fe,pe,ge,Ce,Je){ne===void 0&&(ne=1),ge===void 0&&(ge=0),Ce===void 0&&(Ce=0),Je===void 0&&(Je=0),H(fe);var Xe=[];s(V,function(Fe,j,Te,be){Xe.push(Fe,j,Te,be)}),Xe=new Float32Array(Xe),u(fe,function(Fe){var j=Fe.gl,Te=Fe.isWebGL2,be=Fe.getExtension,Ue=Fe.withProgram,we=Fe.withTexture,et=Fe.withTextureFramebuffer,Re=Fe.handleContextLoss;if(we("rawDistances",function(J,F){(K!==J._lastWidth||W!==J._lastHeight)&&j.texImage2D(j.TEXTURE_2D,0,j.RGBA,J._lastWidth=K,J._lastHeight=W,0,j.RGBA,j.UNSIGNED_BYTE,null),Ue("main",w,S,function(G){var de=G.setAttribute,le=G.setUniform,ye=!Te&&be("ANGLE_instanced_arrays"),Le=!Te&&be("EXT_blend_minmax");de("aUV",2,j.STATIC_DRAW,0,b),de("aLineSegment",4,j.DYNAMIC_DRAW,1,Xe),le.apply(void 0,["4f","uGlyphBounds"].concat(Q)),le("1f","uMaxDistance",q),le("1f","uExponent",ne),et(J,F,function(Ve){j.enable(j.BLEND),j.colorMask(!0,!0,!0,!0),j.viewport(0,0,K,W),j.scissor(0,0,K,W),j.blendFunc(j.ONE,j.ONE),j.blendEquationSeparate(j.FUNC_ADD,Te?j.MAX:Le.MAX_EXT),j.clear(j.COLOR_BUFFER_BIT),Te?j.drawArraysInstanced(j.TRIANGLES,0,3,Xe.length/4):ye.drawArraysInstancedANGLE(j.TRIANGLES,0,3,Xe.length/4)})}),Ue("post",o,M,function(G){G.setAttribute("aUV",2,j.STATIC_DRAW,0,b),G.setUniform("1i","tex",F),j.bindFramebuffer(j.FRAMEBUFFER,pe),j.disable(j.BLEND),j.colorMask(Je===0,Je===1,Je===2,Je===3),j.viewport(ge,Ce,K,W),j.scissor(ge,Ce,K,W),j.drawArrays(j.TRIANGLES,0,3)})}),j.isContextLost())throw Re(),new Error("webgl context lost")})}function z(K){var W=!K||K===R?C:K.canvas||K,V=B.get(W);if(V===void 0){P=!0;var Q=null;try{var q=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],ne=k(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,K);V=ne&&q.length===ne.length&&ne.every(function(fe,pe){return fe===q[pe]}),V||(Q="bad trial run results",console.info(q,ne))}catch(fe){V=!1,Q=fe.message}Q&&console.warn("WebGL SDF generation not supported:",Q),P=!1,B.set(W,V)}return V}var O=Object.freeze({__proto__:null,generate:k,generateIntoCanvas:$,generateIntoFramebuffer:U,isSupported:z});function ie(K,W,V,Q,q,ne){q===void 0&&(q=Math.max(Q[2]-Q[0],Q[3]-Q[1])/2),ne===void 0&&(ne=1);try{return k.apply(O,arguments)}catch(fe){return console.info("WebGL SDF generation failed, falling back to JS",fe),g.apply(A,arguments)}}function X(K,W,V,Q,q,ne,fe,pe,ge,Ce){q===void 0&&(q=Math.max(Q[2]-Q[0],Q[3]-Q[1])/2),ne===void 0&&(ne=1),pe===void 0&&(pe=0),ge===void 0&&(ge=0),Ce===void 0&&(Ce=0);try{return $.apply(O,arguments)}catch(Je){return console.info("WebGL SDF generation failed, falling back to JS",Je),y.apply(A,arguments)}}return e.forEachPathCommand=i,e.generate=ie,e.generateIntoCanvas=X,e.javascript=A,e.pathToLineSegments=s,e.webgl=O,e.webglUtils=m,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return n}function zZ(){var n=function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},r={},i={};r.L=1,i[1]="L",Object.keys(t).forEach(function(Re,J){r[Re]=1<<J+1,i[r[Re]]=Re}),Object.freeze(r);var s=r.LRI|r.RLI|r.FSI,o=r.L|r.R|r.AL,a=r.B|r.S|r.WS|r.ON|r.FSI|r.LRI|r.RLI|r.PDI,l=r.BN|r.RLE|r.LRE|r.RLO|r.LRO|r.PDF,c=r.S|r.WS|r.B|s|r.PDI|l,u=null;function f(){if(!u){u=new Map;var Re=function(F){if(t.hasOwnProperty(F)){var G=0;t[F].split(",").forEach(function(de){var le=de.split("+"),ye=le[0],Le=le[1];ye=parseInt(ye,36),Le=Le?parseInt(Le,36):0,u.set(G+=ye,r[F]);for(var Ve=0;Ve<Le;Ve++)u.set(++G,r[F])})}};for(var J in t)Re(J)}}function d(Re){return f(),u.get(Re.codePointAt(0))||r.L}function m(Re){return i[d(Re)]}var g={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function y(Re,J){var F=36,G=0,de=new Map,le=J&&new Map,ye;return Re.split(",").forEach(function Le(Ve){if(Ve.indexOf("+")!==-1)for(var Oe=+Ve;Oe--;)Le(ye);else{ye=Ve;var ze=Ve.split(">"),Ye=ze[0],Ie=ze[1];Ye=String.fromCodePoint(G+=parseInt(Ye,F)),Ie=String.fromCodePoint(G+=parseInt(Ie,F)),de.set(Ye,Ie),J&&le.set(Ie,Ye)}}),{map:de,reverseMap:le}}var x,v,A;function w(){if(!x){var Re=y(g.pairs,!0),J=Re.map,F=Re.reverseMap;x=J,v=F,A=y(g.canonical,!1).map}}function S(Re){return w(),x.get(Re)||null}function M(Re){return w(),v.get(Re)||null}function b(Re){return w(),A.get(Re)||null}var R=r.L,P=r.R,C=r.EN,B=r.ES,H=r.ET,k=r.AN,$=r.CS,U=r.B,z=r.S,O=r.ON,ie=r.BN,X=r.NSM,K=r.AL,W=r.LRO,V=r.RLO,Q=r.LRE,q=r.RLE,ne=r.PDF,fe=r.LRI,pe=r.RLI,ge=r.FSI,Ce=r.PDI;function Je(Re,J){for(var F=125,G=new Uint32Array(Re.length),de=0;de<Re.length;de++)G[de]=d(Re[de]);var le=new Map;function ye(Yr,Hi){var _r=G[Yr];G[Yr]=Hi,le.set(_r,le.get(_r)-1),_r&a&&le.set(a,le.get(a)-1),le.set(Hi,(le.get(Hi)||0)+1),Hi&a&&le.set(a,(le.get(a)||0)+1)}for(var Le=new Uint8Array(Re.length),Ve=new Map,Oe=[],ze=null,Ye=0;Ye<Re.length;Ye++)ze||Oe.push(ze={start:Ye,end:Re.length-1,level:J==="rtl"?1:J==="ltr"?0:Hh(Ye,!1)}),G[Ye]&U&&(ze.end=Ye,ze=null);for(var Ie=q|Q|V|W|s|Ce|ne|U,gt=function(Yr){return Yr+(Yr&1?1:2)},yt=function(Yr){return Yr+(Yr&1?2:1)},ot=0;ot<Oe.length;ot++){ze=Oe[ot];var Ze=[{_level:ze.level,_override:0,_isolate:0}],Ke=void 0,ae=0,De=0,rt=0;le.clear();for(var it=ze.start;it<=ze.end;it++){var ve=G[it];if(Ke=Ze[Ze.length-1],le.set(ve,(le.get(ve)||0)+1),ve&a&&le.set(a,(le.get(a)||0)+1),ve&Ie)if(ve&(q|Q)){Le[it]=Ke._level;var ce=(ve===q?yt:gt)(Ke._level);ce<=F&&!ae&&!De?Ze.push({_level:ce,_override:0,_isolate:0}):ae||De++}else if(ve&(V|W)){Le[it]=Ke._level;var at=(ve===V?yt:gt)(Ke._level);at<=F&&!ae&&!De?Ze.push({_level:at,_override:ve&V?P:R,_isolate:0}):ae||De++}else if(ve&s){ve&ge&&(ve=Hh(it+1,!0)===1?pe:fe),Le[it]=Ke._level,Ke._override&&ye(it,Ke._override);var $e=(ve===pe?yt:gt)(Ke._level);$e<=F&&ae===0&&De===0?(rt++,Ze.push({_level:$e,_override:0,_isolate:1,_isolInitIndex:it})):ae++}else if(ve&Ce){if(ae>0)ae--;else if(rt>0){for(De=0;!Ze[Ze.length-1]._isolate;)Ze.pop();var ct=Ze[Ze.length-1]._isolInitIndex;ct!=null&&(Ve.set(ct,it),Ve.set(it,ct)),Ze.pop(),rt--}Ke=Ze[Ze.length-1],Le[it]=Ke._level,Ke._override&&ye(it,Ke._override)}else ve&ne?(ae===0&&(De>0?De--:!Ke._isolate&&Ze.length>1&&(Ze.pop(),Ke=Ze[Ze.length-1])),Le[it]=Ke._level):ve&U&&(Le[it]=ze.level);else Le[it]=Ke._level,Ke._override&&ve!==ie&&ye(it,Ke._override)}for(var ft=[],Tt=null,mt=ze.start;mt<=ze.end;mt++){var Dt=G[mt];if(!(Dt&l)){var qt=Le[mt],Ft=Dt&s,ln=Dt===Ce;Tt&&qt===Tt._level?(Tt._end=mt,Tt._endsWithIsolInit=Ft):ft.push(Tt={_start:mt,_end:mt,_level:qt,_startsWithPDI:ln,_endsWithIsolInit:Ft})}}for(var zn=[],zr=0;zr<ft.length;zr++){var oi=ft[zr];if(!oi._startsWithPDI||oi._startsWithPDI&&!Ve.has(oi._start)){for(var xr=[Tt=oi],dr=void 0;Tt&&Tt._endsWithIsolInit&&(dr=Ve.get(Tt._end))!=null;)for(var Ot=zr+1;Ot<ft.length;Ot++)if(ft[Ot]._start===dr){xr.push(Tt=ft[Ot]);break}for(var nr=[],as=0;as<xr.length;as++)for(var D=xr[as],Z=D._start;Z<=D._end;Z++)nr.push(Z);for(var me=Le[nr[0]],L=ze.level,ee=nr[0]-1;ee>=0;ee--)if(!(G[ee]&l)){L=Le[ee];break}var re=nr[nr.length-1],he=Le[re],ue=ze.level;if(!(G[re]&s)){for(var Pe=re+1;Pe<=ze.end;Pe++)if(!(G[Pe]&l)){ue=Le[Pe];break}}zn.push({_seqIndices:nr,_sosType:Math.max(L,me)%2?P:R,_eosType:Math.max(ue,he)%2?P:R})}}for(var ke=0;ke<zn.length;ke++){var We=zn[ke],Ae=We._seqIndices,vt=We._sosType,nt=We._eosType,tt=Le[Ae[0]]&1?P:R;if(le.get(X))for(var Et=0;Et<Ae.length;Et++){var Pt=Ae[Et];if(G[Pt]&X){for(var Lt=vt,Vt=Et-1;Vt>=0;Vt--)if(!(G[Ae[Vt]]&l)){Lt=G[Ae[Vt]];break}ye(Pt,Lt&(s|Ce)?O:Lt)}}if(le.get(C))for(var xt=0;xt<Ae.length;xt++){var dt=Ae[xt];if(G[dt]&C)for(var Kt=xt-1;Kt>=-1;Kt--){var Ut=Kt===-1?vt:G[Ae[Kt]];if(Ut&o){Ut===K&&ye(dt,k);break}}}if(le.get(K))for(var kt=0;kt<Ae.length;kt++){var bn=Ae[kt];G[bn]&K&&ye(bn,P)}if(le.get(B)||le.get($))for(var Ln=1;Ln<Ae.length-1;Ln++){var Nn=Ae[Ln];if(G[Nn]&(B|$)){for(var en=0,$t=0,kn=Ln-1;kn>=0&&(en=G[Ae[kn]],!!(en&l));kn--);for(var Xt=Ln+1;Xt<Ae.length&&($t=G[Ae[Xt]],!!($t&l));Xt++);en===$t&&(G[Nn]===B?en===C:en&(C|k))&&ye(Nn,en)}}if(le.get(C))for(var Wt=0;Wt<Ae.length;Wt++){var Dn=Ae[Wt];if(G[Dn]&C){for(var ai=Wt-1;ai>=0&&G[Ae[ai]]&(H|l);ai--)ye(Ae[ai],C);for(Wt++;Wt<Ae.length&&G[Ae[Wt]]&(H|l|C);Wt++)G[Ae[Wt]]!==C&&ye(Ae[Wt],C)}}if(le.get(H)||le.get(B)||le.get($))for(var Ar=0;Ar<Ae.length;Ar++){var Ts=Ae[Ar];if(G[Ts]&(H|B|$)){ye(Ts,O);for(var Xa=Ar-1;Xa>=0&&G[Ae[Xa]]&l;Xa--)ye(Ae[Xa],O);for(var Ja=Ar+1;Ja<Ae.length&&G[Ae[Ja]]&l;Ja++)ye(Ae[Ja],O)}}if(le.get(C))for(var Ka=0,Iu=vt;Ka<Ae.length;Ka++){var uy=Ae[Ka],Wm=G[uy];Wm&C?Iu===R&&ye(uy,R):Wm&o&&(Iu=Wm)}if(le.get(a)){var Qa=P|C|k,kh=Qa|R,da=[];{for(var Yl=[],pa=0;pa<Ae.length;pa++)if(G[Ae[pa]]&a){var fn=Re[Ae[pa]],Xm=void 0;if(S(fn)!==null)if(Yl.length<63)Yl.push({char:fn,seqIndex:pa});else break;else if((Xm=M(fn))!==null)for(var ja=Yl.length-1;ja>=0;ja--){var Gh=Yl[ja].char;if(Gh===Xm||Gh===M(b(fn))||S(b(Gh))===fn){da.push([Yl[ja].seqIndex,pa]),Yl.length=ja;break}}}da.sort(function(Yr,Hi){return Yr[0]-Hi[0]})}for(var Jm=0;Jm<da.length;Jm++){for(var fy=da[Jm],rr=fy[0],Lu=fy[1],hy=!1,ki=0,Km=rr+1;Km<Lu;Km++){var Nu=Ae[Km];if(G[Nu]&kh){hy=!0;var Cs=G[Nu]&Qa?P:R;if(Cs===tt){ki=Cs;break}}}if(hy&&!ki){ki=vt;for(var Qm=rr-1;Qm>=0;Qm--){var dy=Ae[Qm];if(G[dy]&kh){var Rs=G[dy]&Qa?P:R;Rs!==tt?ki=Rs:ki=tt;break}}}if(ki){if(G[Ae[rr]]=G[Ae[Lu]]=ki,ki!==tt){for(var Gi=rr+1;Gi<Ae.length;Gi++)if(!(G[Ae[Gi]]&l)){d(Re[Ae[Gi]])&X&&(G[Ae[Gi]]=ki);break}}if(ki!==tt){for(var ma=Lu+1;ma<Ae.length;ma++)if(!(G[Ae[ma]]&l)){d(Re[Ae[ma]])&X&&(G[Ae[ma]]=ki);break}}}}for(var Ys=0;Ys<Ae.length;Ys++)if(G[Ae[Ys]]&a){for(var jm=Ys,Ym=Ys,ls=vt,Du=Ys-1;Du>=0;Du--)if(G[Ae[Du]]&l)jm=Du;else{ls=G[Ae[Du]]&Qa?P:R;break}for(var Uu=nt,Fu=Ys+1;Fu<Ae.length;Fu++)if(G[Ae[Fu]]&(a|l))Ym=Fu;else{Uu=G[Ae[Fu]]&Qa?P:R;break}for(var zi=jm;zi<=Ym;zi++)G[Ae[zi]]=ls===Uu?ls:tt;Ys=Ym}}}for(var jr=ze.start;jr<=ze.end;jr++){var zh=Le[jr],Co=G[jr];if(zh&1?Co&(R|C|k)&&Le[jr]++:Co&P?Le[jr]++:Co&(k|C)&&(Le[jr]+=2),Co&l&&(Le[jr]=jr===0?ze.level:Le[jr-1]),jr===ze.end||d(Re[jr])&(z|U))for(var Zl=jr;Zl>=0&&d(Re[Zl])&c;Zl--)Le[Zl]=ze.level}}return{levels:Le,paragraphs:Oe};function Hh(Yr,Hi){for(var _r=Yr;_r<Re.length;_r++){var wr=G[_r];if(wr&(P|K))return 1;if(wr&(U|R)||Hi&&wr===Ce)return 0;if(wr&s){var Bs=py(_r);_r=Bs===-1?Re.length:Bs}}return 0}function py(Yr){for(var Hi=1,_r=Yr+1;_r<Re.length;_r++){var wr=G[_r];if(wr&U)break;if(wr&Ce){if(--Hi===0)return _r}else wr&s&&Hi++}return-1}}var Xe="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",Fe;function j(){if(!Fe){var Re=y(Xe,!0),J=Re.map,F=Re.reverseMap;F.forEach(function(G,de){J.set(de,G)}),Fe=J}}function Te(Re){return j(),Fe.get(Re)||null}function be(Re,J,F,G){var de=Re.length;F=Math.max(0,F==null?0:+F),G=Math.min(de-1,G==null?de-1:+G);for(var le=new Map,ye=F;ye<=G;ye++)if(J[ye]&1){var Le=Te(Re[ye]);Le!==null&&le.set(ye,Le)}return le}function Ue(Re,J,F,G){var de=Re.length;F=Math.max(0,F==null?0:+F),G=Math.min(de-1,G==null?de-1:+G);var le=[];return J.paragraphs.forEach(function(ye){var Le=Math.max(F,ye.start),Ve=Math.min(G,ye.end);if(Le<Ve){for(var Oe=J.levels.slice(Le,Ve+1),ze=Ve;ze>=Le&&d(Re[ze])&c;ze--)Oe[ze]=ye.level;for(var Ye=ye.level,Ie=1/0,gt=0;gt<Oe.length;gt++){var yt=Oe[gt];yt>Ye&&(Ye=yt),yt<Ie&&(Ie=yt|1)}for(var ot=Ye;ot>=Ie;ot--)for(var Ze=0;Ze<Oe.length;Ze++)if(Oe[Ze]>=ot){for(var Ke=Ze;Ze+1<Oe.length&&Oe[Ze+1]>=ot;)Ze++;Ze>Ke&&le.push([Ke+Le,Ze+Le])}}}),le}function we(Re,J,F,G){var de=et(Re,J,F,G),le=[].concat(Re);return de.forEach(function(ye,Le){le[Le]=(J.levels[ye]&1?Te(Re[ye]):null)||Re[ye]}),le.join("")}function et(Re,J,F,G){for(var de=Ue(Re,J,F,G),le=[],ye=0;ye<Re.length;ye++)le[ye]=ye;return de.forEach(function(Le){for(var Ve=Le[0],Oe=Le[1],ze=le.slice(Ve,Oe+1),Ye=ze.length;Ye--;)le[Oe-Ye]=ze[Ye]}),le}return e.closingToOpeningBracket=M,e.getBidiCharType=d,e.getBidiCharTypeName=m,e.getCanonicalBracket=b,e.getEmbeddingLevels=Je,e.getMirroredCharacter=Te,e.getMirroredCharactersMap=be,e.getReorderSegments=Ue,e.getReorderedIndices=et,e.getReorderedString=we,e.openingToClosingBracket=S,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return n}const I4=/\bvoid\s+main\s*\(\s*\)\s*{/g;function xT(n){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function t(r,i){let s=Jt[i];return s?xT(s):r}return n.replace(e,t)}const ci=[];for(let n=0;n<256;n++)ci[n]=(n<16?"0":"")+n.toString(16);function HZ(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(ci[n&255]+ci[n>>8&255]+ci[n>>16&255]+ci[n>>24&255]+"-"+ci[e&255]+ci[e>>8&255]+"-"+ci[e>>16&15|64]+ci[e>>24&255]+"-"+ci[t&63|128]+ci[t>>8&255]+"-"+ci[t>>16&255]+ci[t>>24&255]+ci[r&255]+ci[r>>8&255]+ci[r>>16&255]+ci[r>>24&255]).toUpperCase()}const sf=Object.assign||function(){let n=arguments[0];for(let e=1,t=arguments.length;e<t;e++){let r=arguments[e];if(r)for(let i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])}return n},VZ=Date.now(),GN=new WeakMap,zN=new Map;let WZ=1e10;function AT(n,e){const t=QZ(e);let r=GN.get(n);if(r||GN.set(n,r=Object.create(null)),r[t])return new r[t];const i=`_onBeforeCompile${t}`,s=function(c,u){n.onBeforeCompile.call(this,c,u);const f=this.customProgramCacheKey()+"|"+c.vertexShader+"|"+c.fragmentShader;let d=zN[f];if(!d){const m=XZ(this,c,e,t);d=zN[f]=m}c.vertexShader=d.vertexShader,c.fragmentShader=d.fragmentShader,sf(c.uniforms,this.uniforms),e.timeUniform&&(c.uniforms[e.timeUniform]={get value(){return Date.now()-VZ}}),this[i]&&this[i](c)},o=function(){return a(e.chained?n:n.clone())},a=function(c){const u=Object.create(c,l);return Object.defineProperty(u,"baseMaterial",{value:n}),Object.defineProperty(u,"id",{value:WZ++}),u.uuid=HZ(),u.uniforms=sf({},c.uniforms,e.uniforms),u.defines=sf({},c.defines,e.defines),u.defines[`TROIKA_DERIVED_MATERIAL_${t}`]="",u.extensions=sf({},c.extensions,e.extensions),u._listeners=void 0,u},l={constructor:{value:o},isDerivedMaterial:{value:!0},type:{get:()=>n.type,set:c=>{n.type=c}},isDerivedFrom:{writable:!0,configurable:!0,value:function(c){const u=this.baseMaterial;return c===u||u.isDerivedMaterial&&u.isDerivedFrom(c)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return n.customProgramCacheKey()+"|"+t}},onBeforeCompile:{get(){return s},set(c){this[i]=c}},copy:{writable:!0,configurable:!0,value:function(c){return n.copy.call(this,c),!n.isShaderMaterial&&!n.isDerivedMaterial&&(sf(this.extensions,c.extensions),sf(this.defines,c.defines),sf(this.uniforms,P2.clone(c.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const c=new n.constructor;return a(c).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let c=this._depthMaterial;return c||(c=this._depthMaterial=AT(n.isDerivedMaterial?n.getDepthMaterial():new z_({depthPacking:S2}),e),c.defines.IS_DEPTH_MATERIAL="",c.uniforms=this.uniforms),c}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let c=this._distanceMaterial;return c||(c=this._distanceMaterial=AT(n.isDerivedMaterial?n.getDistanceMaterial():new H_,e),c.defines.IS_DISTANCE_MATERIAL="",c.uniforms=this.uniforms),c}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:c,_distanceMaterial:u}=this;c&&c.dispose(),u&&u.dispose(),n.dispose.call(this)}}};return r[t]=o,new o}function XZ(n,{vertexShader:e,fragmentShader:t},r,i){let{vertexDefs:s,vertexMainIntro:o,vertexMainOutro:a,vertexTransform:l,fragmentDefs:c,fragmentMainIntro:u,fragmentMainOutro:f,fragmentColorTransform:d,customRewriter:m,timeUniform:g}=r;if(s=s||"",o=o||"",a=a||"",c=c||"",u=u||"",f=f||"",(l||m)&&(e=xT(e)),(d||m)&&(t=t.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),t=xT(t)),m){let y=m({vertexShader:e,fragmentShader:t});e=y.vertexShader,t=y.fragmentShader}if(d){let y=[];t=t.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,x=>(y.push(x),"")),f=`${d}
${y.join(`
`)}
${f}`}if(g){const y=`
uniform float ${g};
`;s=y+s,c=y+c}return l&&(e=`vec3 troika_position_${i};
vec3 troika_normal_${i};
vec2 troika_uv_${i};
${e}
`,s=`${s}
void troikaVertexTransform${i}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${l}
}
`,o=`
troika_position_${i} = vec3(position);
troika_normal_${i} = vec3(normal);
troika_uv_${i} = vec2(uv);
troikaVertexTransform${i}(troika_position_${i}, troika_normal_${i}, troika_uv_${i});
${o}
`,e=e.replace(/\b(position|normal|uv)\b/g,(y,x,v,A)=>/\battribute\s+vec[23]\s+$/.test(A.substr(0,v))?x:`troika_${x}_${i}`),n.map&&n.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${i}`))),e=HN(e,i,s,o,a),t=HN(t,i,c,u,f),{vertexShader:e,fragmentShader:t}}function HN(n,e,t,r,i){return(r||i||t)&&(n=n.replace(I4,`
${t}
void troikaOrigMain${e}() {`),n+=`
void main() {
  ${r}
  troikaOrigMain${e}();
  ${i}
}`),n}function JZ(n,e){return n==="uniforms"?void 0:typeof e=="function"?e.toString():e}let KZ=0;const VN=new Map;function QZ(n){const e=JSON.stringify(n,JZ);let t=VN.get(e);return t==null&&VN.set(e,t=++KZ),t}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function jZ(){return typeof window>"u"&&(self.window=self),function(n){var e={parse:function(i){var s=e._bin,o=new Uint8Array(i);if(s.readASCII(o,0,4)=="ttcf"){var a=4;s.readUshort(o,a),a+=2,s.readUshort(o,a),a+=2;var l=s.readUint(o,a);a+=4;for(var c=[],u=0;u<l;u++){var f=s.readUint(o,a);a+=4,c.push(e._readFont(o,f))}return c}return[e._readFont(o,0)]},_readFont:function(i,s){var o=e._bin,a=s;o.readFixed(i,s),s+=4;var l=o.readUshort(i,s);s+=2,o.readUshort(i,s),s+=2,o.readUshort(i,s),s+=2,o.readUshort(i,s),s+=2;for(var c=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],u={_data:i,_offset:a},f={},d=0;d<l;d++){var m=o.readASCII(i,s,4);s+=4,o.readUint(i,s),s+=4;var g=o.readUint(i,s);s+=4;var y=o.readUint(i,s);s+=4,f[m]={offset:g,length:y}}for(d=0;d<c.length;d++){var x=c[d];f[x]&&(u[x.trim()]=e[x.trim()].parse(i,f[x].offset,f[x].length,u))}return u},_tabOffset:function(i,s,o){for(var a=e._bin,l=a.readUshort(i,o+4),c=o+12,u=0;u<l;u++){var f=a.readASCII(i,c,4);c+=4,a.readUint(i,c),c+=4;var d=a.readUint(i,c);if(c+=4,a.readUint(i,c),c+=4,f==s)return d}return 0}};e._bin={readFixed:function(i,s){return(i[s]<<8|i[s+1])+(i[s+2]<<8|i[s+3])/65540},readF2dot14:function(i,s){return e._bin.readShort(i,s)/16384},readInt:function(i,s){return e._bin._view(i).getInt32(s)},readInt8:function(i,s){return e._bin._view(i).getInt8(s)},readShort:function(i,s){return e._bin._view(i).getInt16(s)},readUshort:function(i,s){return e._bin._view(i).getUint16(s)},readUshorts:function(i,s,o){for(var a=[],l=0;l<o;l++)a.push(e._bin.readUshort(i,s+2*l));return a},readUint:function(i,s){return e._bin._view(i).getUint32(s)},readUint64:function(i,s){return 4294967296*e._bin.readUint(i,s)+e._bin.readUint(i,s+4)},readASCII:function(i,s,o){for(var a="",l=0;l<o;l++)a+=String.fromCharCode(i[s+l]);return a},readUnicode:function(i,s,o){for(var a="",l=0;l<o;l++){var c=i[s++]<<8|i[s++];a+=String.fromCharCode(c)}return a},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(i,s,o){var a=e._bin._tdec;return a&&s==0&&o==i.length?a.decode(i):e._bin.readASCII(i,s,o)},readBytes:function(i,s,o){for(var a=[],l=0;l<o;l++)a.push(i[s+l]);return a},readASCIIArray:function(i,s,o){for(var a=[],l=0;l<o;l++)a.push(String.fromCharCode(i[s+l]));return a},_view:function(i){return i._dataView||(i._dataView=i.buffer?new DataView(i.buffer,i.byteOffset,i.byteLength):new DataView(new Uint8Array(i).buffer))}},e._lctf={},e._lctf.parse=function(i,s,o,a,l){var c=e._bin,u={},f=s;c.readFixed(i,s),s+=4;var d=c.readUshort(i,s);s+=2;var m=c.readUshort(i,s);s+=2;var g=c.readUshort(i,s);return s+=2,u.scriptList=e._lctf.readScriptList(i,f+d),u.featureList=e._lctf.readFeatureList(i,f+m),u.lookupList=e._lctf.readLookupList(i,f+g,l),u},e._lctf.readLookupList=function(i,s,o){var a=e._bin,l=s,c=[],u=a.readUshort(i,s);s+=2;for(var f=0;f<u;f++){var d=a.readUshort(i,s);s+=2;var m=e._lctf.readLookupTable(i,l+d,o);c.push(m)}return c},e._lctf.readLookupTable=function(i,s,o){var a=e._bin,l=s,c={tabs:[]};c.ltype=a.readUshort(i,s),s+=2,c.flag=a.readUshort(i,s),s+=2;var u=a.readUshort(i,s);s+=2;for(var f=c.ltype,d=0;d<u;d++){var m=a.readUshort(i,s);s+=2;var g=o(i,f,l+m,c);c.tabs.push(g)}return c},e._lctf.numOfOnes=function(i){for(var s=0,o=0;o<32;o++)i>>>o&1&&s++;return s},e._lctf.readClassDef=function(i,s){var o=e._bin,a=[],l=o.readUshort(i,s);if(s+=2,l==1){var c=o.readUshort(i,s);s+=2;var u=o.readUshort(i,s);s+=2;for(var f=0;f<u;f++)a.push(c+f),a.push(c+f),a.push(o.readUshort(i,s)),s+=2}if(l==2){var d=o.readUshort(i,s);for(s+=2,f=0;f<d;f++)a.push(o.readUshort(i,s)),s+=2,a.push(o.readUshort(i,s)),s+=2,a.push(o.readUshort(i,s)),s+=2}return a},e._lctf.getInterval=function(i,s){for(var o=0;o<i.length;o+=3){var a=i[o],l=i[o+1];if(i[o+2],a<=s&&s<=l)return o}return-1},e._lctf.readCoverage=function(i,s){var o=e._bin,a={};a.fmt=o.readUshort(i,s),s+=2;var l=o.readUshort(i,s);return s+=2,a.fmt==1&&(a.tab=o.readUshorts(i,s,l)),a.fmt==2&&(a.tab=o.readUshorts(i,s,3*l)),a},e._lctf.coverageIndex=function(i,s){var o=i.tab;if(i.fmt==1)return o.indexOf(s);if(i.fmt==2){var a=e._lctf.getInterval(o,s);if(a!=-1)return o[a+2]+(s-o[a])}return-1},e._lctf.readFeatureList=function(i,s){var o=e._bin,a=s,l=[],c=o.readUshort(i,s);s+=2;for(var u=0;u<c;u++){var f=o.readASCII(i,s,4);s+=4;var d=o.readUshort(i,s);s+=2;var m=e._lctf.readFeatureTable(i,a+d);m.tag=f.trim(),l.push(m)}return l},e._lctf.readFeatureTable=function(i,s){var o=e._bin,a=s,l={},c=o.readUshort(i,s);s+=2,c>0&&(l.featureParams=a+c);var u=o.readUshort(i,s);s+=2,l.tab=[];for(var f=0;f<u;f++)l.tab.push(o.readUshort(i,s+2*f));return l},e._lctf.readScriptList=function(i,s){var o=e._bin,a=s,l={},c=o.readUshort(i,s);s+=2;for(var u=0;u<c;u++){var f=o.readASCII(i,s,4);s+=4;var d=o.readUshort(i,s);s+=2,l[f.trim()]=e._lctf.readScriptTable(i,a+d)}return l},e._lctf.readScriptTable=function(i,s){var o=e._bin,a=s,l={},c=o.readUshort(i,s);s+=2,c>0&&(l.default=e._lctf.readLangSysTable(i,a+c));var u=o.readUshort(i,s);s+=2;for(var f=0;f<u;f++){var d=o.readASCII(i,s,4);s+=4;var m=o.readUshort(i,s);s+=2,l[d.trim()]=e._lctf.readLangSysTable(i,a+m)}return l},e._lctf.readLangSysTable=function(i,s){var o=e._bin,a={};o.readUshort(i,s),s+=2,a.reqFeature=o.readUshort(i,s),s+=2;var l=o.readUshort(i,s);return s+=2,a.features=o.readUshorts(i,s,l),a},e.CFF={},e.CFF.parse=function(i,s,o){var a=e._bin;(i=new Uint8Array(i.buffer,s,o))[s=0],i[++s],i[++s],i[++s],s++;var l=[];s=e.CFF.readIndex(i,s,l);for(var c=[],u=0;u<l.length-1;u++)c.push(a.readASCII(i,s+l[u],l[u+1]-l[u]));s+=l[l.length-1];var f=[];s=e.CFF.readIndex(i,s,f);var d=[];for(u=0;u<f.length-1;u++)d.push(e.CFF.readDict(i,s+f[u],s+f[u+1]));s+=f[f.length-1];var m=d[0],g=[];s=e.CFF.readIndex(i,s,g);var y=[];for(u=0;u<g.length-1;u++)y.push(a.readASCII(i,s+g[u],g[u+1]-g[u]));if(s+=g[g.length-1],e.CFF.readSubrs(i,s,m),m.CharStrings){s=m.CharStrings,g=[],s=e.CFF.readIndex(i,s,g);var x=[];for(u=0;u<g.length-1;u++)x.push(a.readBytes(i,s+g[u],g[u+1]-g[u]));m.CharStrings=x}if(m.ROS){s=m.FDArray;var v=[];for(s=e.CFF.readIndex(i,s,v),m.FDArray=[],u=0;u<v.length-1;u++){var A=e.CFF.readDict(i,s+v[u],s+v[u+1]);e.CFF._readFDict(i,A,y),m.FDArray.push(A)}s+=v[v.length-1],s=m.FDSelect,m.FDSelect=[];var w=i[s];if(s++,w!=3)throw w;var S=a.readUshort(i,s);for(s+=2,u=0;u<S+1;u++)m.FDSelect.push(a.readUshort(i,s),i[s+2]),s+=3}return m.Encoding&&(m.Encoding=e.CFF.readEncoding(i,m.Encoding,m.CharStrings.length)),m.charset&&(m.charset=e.CFF.readCharset(i,m.charset,m.CharStrings.length)),e.CFF._readFDict(i,m,y),m},e.CFF._readFDict=function(i,s,o){var a;for(var l in s.Private&&(a=s.Private[1],s.Private=e.CFF.readDict(i,a,a+s.Private[0]),s.Private.Subrs&&e.CFF.readSubrs(i,a+s.Private.Subrs,s.Private)),s)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(l)!=-1&&(s[l]=o[s[l]-426+35])},e.CFF.readSubrs=function(i,s,o){var a=e._bin,l=[];s=e.CFF.readIndex(i,s,l);var c,u=l.length;c=u<1240?107:u<33900?1131:32768,o.Bias=c,o.Subrs=[];for(var f=0;f<l.length-1;f++)o.Subrs.push(a.readBytes(i,s+l[f],l[f+1]-l[f]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(i,s){for(var o=0;o<i.charset.length;o++)if(i.charset[o]==s)return o;return-1},e.CFF.glyphBySE=function(i,s){return s<0||s>255?-1:e.CFF.glyphByUnicode(i,e.CFF.tableSE[s])},e.CFF.readEncoding=function(i,s,o){e._bin;var a=[".notdef"],l=i[s];if(s++,l!=0)throw"error: unknown encoding format: "+l;var c=i[s];s++;for(var u=0;u<c;u++)a.push(i[s+u]);return a},e.CFF.readCharset=function(i,s,o){var a=e._bin,l=[".notdef"],c=i[s];if(s++,c==0)for(var u=0;u<o;u++){var f=a.readUshort(i,s);s+=2,l.push(f)}else{if(c!=1&&c!=2)throw"error: format: "+c;for(;l.length<o;){f=a.readUshort(i,s),s+=2;var d=0;for(c==1?(d=i[s],s++):(d=a.readUshort(i,s),s+=2),u=0;u<=d;u++)l.push(f),f++}}return l},e.CFF.readIndex=function(i,s,o){var a=e._bin,l=a.readUshort(i,s)+1,c=i[s+=2];if(s++,c==1)for(var u=0;u<l;u++)o.push(i[s+u]);else if(c==2)for(u=0;u<l;u++)o.push(a.readUshort(i,s+2*u));else if(c==3)for(u=0;u<l;u++)o.push(16777215&a.readUint(i,s+3*u-1));else if(l!=1)throw"unsupported offset size: "+c+", count: "+l;return(s+=l*c)-1},e.CFF.getCharString=function(i,s,o){var a=e._bin,l=i[s],c=i[s+1];i[s+2],i[s+3],i[s+4];var u=1,f=null,d=null;l<=20&&(f=l,u=1),l==12&&(f=100*l+c,u=2),21<=l&&l<=27&&(f=l,u=1),l==28&&(d=a.readShort(i,s+1),u=3),29<=l&&l<=31&&(f=l,u=1),32<=l&&l<=246&&(d=l-139,u=1),247<=l&&l<=250&&(d=256*(l-247)+c+108,u=2),251<=l&&l<=254&&(d=256*-(l-251)-c-108,u=2),l==255&&(d=a.readInt(i,s+1)/65535,u=5),o.val=d??"o"+f,o.size=u},e.CFF.readCharString=function(i,s,o){for(var a=s+o,l=e._bin,c=[];s<a;){var u=i[s],f=i[s+1];i[s+2],i[s+3],i[s+4];var d=1,m=null,g=null;u<=20&&(m=u,d=1),u==12&&(m=100*u+f,d=2),u!=19&&u!=20||(m=u,d=2),21<=u&&u<=27&&(m=u,d=1),u==28&&(g=l.readShort(i,s+1),d=3),29<=u&&u<=31&&(m=u,d=1),32<=u&&u<=246&&(g=u-139,d=1),247<=u&&u<=250&&(g=256*(u-247)+f+108,d=2),251<=u&&u<=254&&(g=256*-(u-251)-f-108,d=2),u==255&&(g=l.readInt(i,s+1)/65535,d=5),c.push(g??"o"+m),s+=d}return c},e.CFF.readDict=function(i,s,o){for(var a=e._bin,l={},c=[];s<o;){var u=i[s],f=i[s+1];i[s+2],i[s+3],i[s+4];var d=1,m=null,g=null;if(u==28&&(g=a.readShort(i,s+1),d=3),u==29&&(g=a.readInt(i,s+1),d=5),32<=u&&u<=246&&(g=u-139,d=1),247<=u&&u<=250&&(g=256*(u-247)+f+108,d=2),251<=u&&u<=254&&(g=256*-(u-251)-f-108,d=2),u==255)throw g=a.readInt(i,s+1)/65535,d=5,"unknown number";if(u==30){var y=[];for(d=1;;){var x=i[s+d];d++;var v=x>>4,A=15&x;if(v!=15&&y.push(v),A!=15&&y.push(A),A==15)break}for(var w="",S=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],M=0;M<y.length;M++)w+=S[y[M]];g=parseFloat(w)}u<=21&&(m=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][u],d=1,u==12&&(m=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][f],d=2)),m!=null?(l[m]=c.length==1?c[0]:c,c=[]):c.push(g),s+=d}return l},e.cmap={},e.cmap.parse=function(i,s,o){i=new Uint8Array(i.buffer,s,o),s=0;var a=e._bin,l={};a.readUshort(i,s),s+=2;var c=a.readUshort(i,s);s+=2;var u=[];l.tables=[];for(var f=0;f<c;f++){var d=a.readUshort(i,s);s+=2;var m=a.readUshort(i,s);s+=2;var g=a.readUint(i,s);s+=4;var y="p"+d+"e"+m,x=u.indexOf(g);if(x==-1){var v;x=l.tables.length,u.push(g);var A=a.readUshort(i,g);A==0?v=e.cmap.parse0(i,g):A==4?v=e.cmap.parse4(i,g):A==6?v=e.cmap.parse6(i,g):A==12?v=e.cmap.parse12(i,g):console.debug("unknown format: "+A,d,m,g),l.tables.push(v)}if(l[y]!=null)throw"multiple tables for one platform+encoding";l[y]=x}return l},e.cmap.parse0=function(i,s){var o=e._bin,a={};a.format=o.readUshort(i,s),s+=2;var l=o.readUshort(i,s);s+=2,o.readUshort(i,s),s+=2,a.map=[];for(var c=0;c<l-6;c++)a.map.push(i[s+c]);return a},e.cmap.parse4=function(i,s){var o=e._bin,a=s,l={};l.format=o.readUshort(i,s),s+=2;var c=o.readUshort(i,s);s+=2,o.readUshort(i,s),s+=2;var u=o.readUshort(i,s);s+=2;var f=u/2;l.searchRange=o.readUshort(i,s),s+=2,l.entrySelector=o.readUshort(i,s),s+=2,l.rangeShift=o.readUshort(i,s),s+=2,l.endCount=o.readUshorts(i,s,f),s+=2*f,s+=2,l.startCount=o.readUshorts(i,s,f),s+=2*f,l.idDelta=[];for(var d=0;d<f;d++)l.idDelta.push(o.readShort(i,s)),s+=2;for(l.idRangeOffset=o.readUshorts(i,s,f),s+=2*f,l.glyphIdArray=[];s<a+c;)l.glyphIdArray.push(o.readUshort(i,s)),s+=2;return l},e.cmap.parse6=function(i,s){var o=e._bin,a={};a.format=o.readUshort(i,s),s+=2,o.readUshort(i,s),s+=2,o.readUshort(i,s),s+=2,a.firstCode=o.readUshort(i,s),s+=2;var l=o.readUshort(i,s);s+=2,a.glyphIdArray=[];for(var c=0;c<l;c++)a.glyphIdArray.push(o.readUshort(i,s)),s+=2;return a},e.cmap.parse12=function(i,s){var o=e._bin,a={};a.format=o.readUshort(i,s),s+=2,s+=2,o.readUint(i,s),s+=4,o.readUint(i,s),s+=4;var l=o.readUint(i,s);s+=4,a.groups=[];for(var c=0;c<l;c++){var u=s+12*c,f=o.readUint(i,u+0),d=o.readUint(i,u+4),m=o.readUint(i,u+8);a.groups.push([f,d,m])}return a},e.glyf={},e.glyf.parse=function(i,s,o,a){for(var l=[],c=0;c<a.maxp.numGlyphs;c++)l.push(null);return l},e.glyf._parseGlyf=function(i,s){var o=e._bin,a=i._data,l=e._tabOffset(a,"glyf",i._offset)+i.loca[s];if(i.loca[s]==i.loca[s+1])return null;var c={};if(c.noc=o.readShort(a,l),l+=2,c.xMin=o.readShort(a,l),l+=2,c.yMin=o.readShort(a,l),l+=2,c.xMax=o.readShort(a,l),l+=2,c.yMax=o.readShort(a,l),l+=2,c.xMin>=c.xMax||c.yMin>=c.yMax)return null;if(c.noc>0){c.endPts=[];for(var u=0;u<c.noc;u++)c.endPts.push(o.readUshort(a,l)),l+=2;var f=o.readUshort(a,l);if(l+=2,a.length-l<f)return null;c.instructions=o.readBytes(a,l,f),l+=f;var d=c.endPts[c.noc-1]+1;for(c.flags=[],u=0;u<d;u++){var m=a[l];if(l++,c.flags.push(m),(8&m)!=0){var g=a[l];l++;for(var y=0;y<g;y++)c.flags.push(m),u++}}for(c.xs=[],u=0;u<d;u++){var x=(2&c.flags[u])!=0,v=(16&c.flags[u])!=0;x?(c.xs.push(v?a[l]:-a[l]),l++):v?c.xs.push(0):(c.xs.push(o.readShort(a,l)),l+=2)}for(c.ys=[],u=0;u<d;u++)x=(4&c.flags[u])!=0,v=(32&c.flags[u])!=0,x?(c.ys.push(v?a[l]:-a[l]),l++):v?c.ys.push(0):(c.ys.push(o.readShort(a,l)),l+=2);var A=0,w=0;for(u=0;u<d;u++)A+=c.xs[u],w+=c.ys[u],c.xs[u]=A,c.ys[u]=w}else{var S;c.parts=[];do{S=o.readUshort(a,l),l+=2;var M={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(c.parts.push(M),M.glyphIndex=o.readUshort(a,l),l+=2,1&S){var b=o.readShort(a,l);l+=2;var R=o.readShort(a,l);l+=2}else b=o.readInt8(a,l),l++,R=o.readInt8(a,l),l++;2&S?(M.m.tx=b,M.m.ty=R):(M.p1=b,M.p2=R),8&S?(M.m.a=M.m.d=o.readF2dot14(a,l),l+=2):64&S?(M.m.a=o.readF2dot14(a,l),l+=2,M.m.d=o.readF2dot14(a,l),l+=2):128&S&&(M.m.a=o.readF2dot14(a,l),l+=2,M.m.b=o.readF2dot14(a,l),l+=2,M.m.c=o.readF2dot14(a,l),l+=2,M.m.d=o.readF2dot14(a,l),l+=2)}while(32&S);if(256&S){var P=o.readUshort(a,l);for(l+=2,c.instr=[],u=0;u<P;u++)c.instr.push(a[l]),l++}}return c},e.GDEF={},e.GDEF.parse=function(i,s,o,a){var l=s;s+=4;var c=e._bin.readUshort(i,s);return{glyphClassDef:c===0?null:e._lctf.readClassDef(i,l+c)}},e.GPOS={},e.GPOS.parse=function(i,s,o,a){return e._lctf.parse(i,s,o,a,e.GPOS.subt)},e.GPOS.subt=function(i,s,o,a){var l=e._bin,c=o,u={};if(u.fmt=l.readUshort(i,o),o+=2,s==1||s==2||s==3||s==7||s==8&&u.fmt<=2){var f=l.readUshort(i,o);o+=2,u.coverage=e._lctf.readCoverage(i,f+c)}if(s==1&&u.fmt==1){var d=l.readUshort(i,o);o+=2,d!=0&&(u.pos=e.GPOS.readValueRecord(i,o,d))}else if(s==2&&u.fmt>=1&&u.fmt<=2){d=l.readUshort(i,o),o+=2;var m=l.readUshort(i,o);o+=2;var g=e._lctf.numOfOnes(d),y=e._lctf.numOfOnes(m);if(u.fmt==1){u.pairsets=[];var x=l.readUshort(i,o);o+=2;for(var v=0;v<x;v++){var A=c+l.readUshort(i,o);o+=2;var w=l.readUshort(i,A);A+=2;for(var S=[],M=0;M<w;M++){var b=l.readUshort(i,A);A+=2,d!=0&&(k=e.GPOS.readValueRecord(i,A,d),A+=2*g),m!=0&&($=e.GPOS.readValueRecord(i,A,m),A+=2*y),S.push({gid2:b,val1:k,val2:$})}u.pairsets.push(S)}}if(u.fmt==2){var R=l.readUshort(i,o);o+=2;var P=l.readUshort(i,o);o+=2;var C=l.readUshort(i,o);o+=2;var B=l.readUshort(i,o);for(o+=2,u.classDef1=e._lctf.readClassDef(i,c+R),u.classDef2=e._lctf.readClassDef(i,c+P),u.matrix=[],v=0;v<C;v++){var H=[];for(M=0;M<B;M++){var k=null,$=null;d!=0&&(k=e.GPOS.readValueRecord(i,o,d),o+=2*g),m!=0&&($=e.GPOS.readValueRecord(i,o,m),o+=2*y),H.push({val1:k,val2:$})}u.matrix.push(H)}}}else if(s==4&&u.fmt==1)u.markCoverage=e._lctf.readCoverage(i,l.readUshort(i,o)+c),u.baseCoverage=e._lctf.readCoverage(i,l.readUshort(i,o+2)+c),u.markClassCount=l.readUshort(i,o+4),u.markArray=e.GPOS.readMarkArray(i,l.readUshort(i,o+6)+c),u.baseArray=e.GPOS.readBaseArray(i,l.readUshort(i,o+8)+c,u.markClassCount);else if(s==6&&u.fmt==1)u.mark1Coverage=e._lctf.readCoverage(i,l.readUshort(i,o)+c),u.mark2Coverage=e._lctf.readCoverage(i,l.readUshort(i,o+2)+c),u.markClassCount=l.readUshort(i,o+4),u.mark1Array=e.GPOS.readMarkArray(i,l.readUshort(i,o+6)+c),u.mark2Array=e.GPOS.readBaseArray(i,l.readUshort(i,o+8)+c,u.markClassCount);else{if(s==9&&u.fmt==1){var U=l.readUshort(i,o);o+=2;var z=l.readUint(i,o);if(o+=4,a.ltype==9)a.ltype=U;else if(a.ltype!=U)throw"invalid extension substitution";return e.GPOS.subt(i,a.ltype,c+z)}console.debug("unsupported GPOS table LookupType",s,"format",u.fmt)}return u},e.GPOS.readValueRecord=function(i,s,o){var a=e._bin,l=[];return l.push(1&o?a.readShort(i,s):0),s+=1&o?2:0,l.push(2&o?a.readShort(i,s):0),s+=2&o?2:0,l.push(4&o?a.readShort(i,s):0),s+=4&o?2:0,l.push(8&o?a.readShort(i,s):0),s+=8&o?2:0,l},e.GPOS.readBaseArray=function(i,s,o){var a=e._bin,l=[],c=s,u=a.readUshort(i,s);s+=2;for(var f=0;f<u;f++){for(var d=[],m=0;m<o;m++)d.push(e.GPOS.readAnchorRecord(i,c+a.readUshort(i,s))),s+=2;l.push(d)}return l},e.GPOS.readMarkArray=function(i,s){var o=e._bin,a=[],l=s,c=o.readUshort(i,s);s+=2;for(var u=0;u<c;u++){var f=e.GPOS.readAnchorRecord(i,o.readUshort(i,s+2)+l);f.markClass=o.readUshort(i,s),a.push(f),s+=4}return a},e.GPOS.readAnchorRecord=function(i,s){var o=e._bin,a={};return a.fmt=o.readUshort(i,s),a.x=o.readShort(i,s+2),a.y=o.readShort(i,s+4),a},e.GSUB={},e.GSUB.parse=function(i,s,o,a){return e._lctf.parse(i,s,o,a,e.GSUB.subt)},e.GSUB.subt=function(i,s,o,a){var l=e._bin,c=o,u={};if(u.fmt=l.readUshort(i,o),o+=2,s!=1&&s!=2&&s!=4&&s!=5&&s!=6)return null;if(s==1||s==2||s==4||s==5&&u.fmt<=2||s==6&&u.fmt<=2){var f=l.readUshort(i,o);o+=2,u.coverage=e._lctf.readCoverage(i,c+f)}if(s==1&&u.fmt>=1&&u.fmt<=2){if(u.fmt==1)u.delta=l.readShort(i,o),o+=2;else if(u.fmt==2){var d=l.readUshort(i,o);o+=2,u.newg=l.readUshorts(i,o,d),o+=2*u.newg.length}}else if(s==2&&u.fmt==1){d=l.readUshort(i,o),o+=2,u.seqs=[];for(var m=0;m<d;m++){var g=l.readUshort(i,o)+c;o+=2;var y=l.readUshort(i,g);u.seqs.push(l.readUshorts(i,g+2,y))}}else if(s==4)for(u.vals=[],d=l.readUshort(i,o),o+=2,m=0;m<d;m++){var x=l.readUshort(i,o);o+=2,u.vals.push(e.GSUB.readLigatureSet(i,c+x))}else if(s==5&&u.fmt==2){if(u.fmt==2){var v=l.readUshort(i,o);o+=2,u.cDef=e._lctf.readClassDef(i,c+v),u.scset=[];var A=l.readUshort(i,o);for(o+=2,m=0;m<A;m++){var w=l.readUshort(i,o);o+=2,u.scset.push(w==0?null:e.GSUB.readSubClassSet(i,c+w))}}}else if(s==6&&u.fmt==3){if(u.fmt==3){for(m=0;m<3;m++){d=l.readUshort(i,o),o+=2;for(var S=[],M=0;M<d;M++)S.push(e._lctf.readCoverage(i,c+l.readUshort(i,o+2*M)));o+=2*d,m==0&&(u.backCvg=S),m==1&&(u.inptCvg=S),m==2&&(u.ahedCvg=S)}d=l.readUshort(i,o),o+=2,u.lookupRec=e.GSUB.readSubstLookupRecords(i,o,d)}}else{if(s==7&&u.fmt==1){var b=l.readUshort(i,o);o+=2;var R=l.readUint(i,o);if(o+=4,a.ltype==9)a.ltype=b;else if(a.ltype!=b)throw"invalid extension substitution";return e.GSUB.subt(i,a.ltype,c+R)}console.debug("unsupported GSUB table LookupType",s,"format",u.fmt)}return u},e.GSUB.readSubClassSet=function(i,s){var o=e._bin.readUshort,a=s,l=[],c=o(i,s);s+=2;for(var u=0;u<c;u++){var f=o(i,s);s+=2,l.push(e.GSUB.readSubClassRule(i,a+f))}return l},e.GSUB.readSubClassRule=function(i,s){var o=e._bin.readUshort,a={},l=o(i,s),c=o(i,s+=2);s+=2,a.input=[];for(var u=0;u<l-1;u++)a.input.push(o(i,s)),s+=2;return a.substLookupRecords=e.GSUB.readSubstLookupRecords(i,s,c),a},e.GSUB.readSubstLookupRecords=function(i,s,o){for(var a=e._bin.readUshort,l=[],c=0;c<o;c++)l.push(a(i,s),a(i,s+2)),s+=4;return l},e.GSUB.readChainSubClassSet=function(i,s){var o=e._bin,a=s,l=[],c=o.readUshort(i,s);s+=2;for(var u=0;u<c;u++){var f=o.readUshort(i,s);s+=2,l.push(e.GSUB.readChainSubClassRule(i,a+f))}return l},e.GSUB.readChainSubClassRule=function(i,s){for(var o=e._bin,a={},l=["backtrack","input","lookahead"],c=0;c<l.length;c++){var u=o.readUshort(i,s);s+=2,c==1&&u--,a[l[c]]=o.readUshorts(i,s,u),s+=2*a[l[c]].length}return u=o.readUshort(i,s),s+=2,a.subst=o.readUshorts(i,s,2*u),s+=2*a.subst.length,a},e.GSUB.readLigatureSet=function(i,s){var o=e._bin,a=s,l=[],c=o.readUshort(i,s);s+=2;for(var u=0;u<c;u++){var f=o.readUshort(i,s);s+=2,l.push(e.GSUB.readLigature(i,a+f))}return l},e.GSUB.readLigature=function(i,s){var o=e._bin,a={chain:[]};a.nglyph=o.readUshort(i,s),s+=2;var l=o.readUshort(i,s);s+=2;for(var c=0;c<l-1;c++)a.chain.push(o.readUshort(i,s)),s+=2;return a},e.head={},e.head.parse=function(i,s,o){var a=e._bin,l={};return a.readFixed(i,s),s+=4,l.fontRevision=a.readFixed(i,s),s+=4,a.readUint(i,s),s+=4,a.readUint(i,s),s+=4,l.flags=a.readUshort(i,s),s+=2,l.unitsPerEm=a.readUshort(i,s),s+=2,l.created=a.readUint64(i,s),s+=8,l.modified=a.readUint64(i,s),s+=8,l.xMin=a.readShort(i,s),s+=2,l.yMin=a.readShort(i,s),s+=2,l.xMax=a.readShort(i,s),s+=2,l.yMax=a.readShort(i,s),s+=2,l.macStyle=a.readUshort(i,s),s+=2,l.lowestRecPPEM=a.readUshort(i,s),s+=2,l.fontDirectionHint=a.readShort(i,s),s+=2,l.indexToLocFormat=a.readShort(i,s),s+=2,l.glyphDataFormat=a.readShort(i,s),s+=2,l},e.hhea={},e.hhea.parse=function(i,s,o){var a=e._bin,l={};return a.readFixed(i,s),s+=4,l.ascender=a.readShort(i,s),s+=2,l.descender=a.readShort(i,s),s+=2,l.lineGap=a.readShort(i,s),s+=2,l.advanceWidthMax=a.readUshort(i,s),s+=2,l.minLeftSideBearing=a.readShort(i,s),s+=2,l.minRightSideBearing=a.readShort(i,s),s+=2,l.xMaxExtent=a.readShort(i,s),s+=2,l.caretSlopeRise=a.readShort(i,s),s+=2,l.caretSlopeRun=a.readShort(i,s),s+=2,l.caretOffset=a.readShort(i,s),s+=2,s+=8,l.metricDataFormat=a.readShort(i,s),s+=2,l.numberOfHMetrics=a.readUshort(i,s),s+=2,l},e.hmtx={},e.hmtx.parse=function(i,s,o,a){for(var l=e._bin,c={aWidth:[],lsBearing:[]},u=0,f=0,d=0;d<a.maxp.numGlyphs;d++)d<a.hhea.numberOfHMetrics&&(u=l.readUshort(i,s),s+=2,f=l.readShort(i,s),s+=2),c.aWidth.push(u),c.lsBearing.push(f);return c},e.kern={},e.kern.parse=function(i,s,o,a){var l=e._bin,c=l.readUshort(i,s);if(s+=2,c==1)return e.kern.parseV1(i,s-2,o,a);var u=l.readUshort(i,s);s+=2;for(var f={glyph1:[],rval:[]},d=0;d<u;d++){s+=2,o=l.readUshort(i,s),s+=2;var m=l.readUshort(i,s);s+=2;var g=m>>>8;if((g&=15)!=0)throw"unknown kern table format: "+g;s=e.kern.readFormat0(i,s,f)}return f},e.kern.parseV1=function(i,s,o,a){var l=e._bin;l.readFixed(i,s),s+=4;var c=l.readUint(i,s);s+=4;for(var u={glyph1:[],rval:[]},f=0;f<c;f++){l.readUint(i,s),s+=4;var d=l.readUshort(i,s);s+=2,l.readUshort(i,s),s+=2;var m=d>>>8;if((m&=15)!=0)throw"unknown kern table format: "+m;s=e.kern.readFormat0(i,s,u)}return u},e.kern.readFormat0=function(i,s,o){var a=e._bin,l=-1,c=a.readUshort(i,s);s+=2,a.readUshort(i,s),s+=2,a.readUshort(i,s),s+=2,a.readUshort(i,s),s+=2;for(var u=0;u<c;u++){var f=a.readUshort(i,s);s+=2;var d=a.readUshort(i,s);s+=2;var m=a.readShort(i,s);s+=2,f!=l&&(o.glyph1.push(f),o.rval.push({glyph2:[],vals:[]}));var g=o.rval[o.rval.length-1];g.glyph2.push(d),g.vals.push(m),l=f}return s},e.loca={},e.loca.parse=function(i,s,o,a){var l=e._bin,c=[],u=a.head.indexToLocFormat,f=a.maxp.numGlyphs+1;if(u==0)for(var d=0;d<f;d++)c.push(l.readUshort(i,s+(d<<1))<<1);if(u==1)for(d=0;d<f;d++)c.push(l.readUint(i,s+(d<<2)));return c},e.maxp={},e.maxp.parse=function(i,s,o){var a=e._bin,l={},c=a.readUint(i,s);return s+=4,l.numGlyphs=a.readUshort(i,s),s+=2,c==65536&&(l.maxPoints=a.readUshort(i,s),s+=2,l.maxContours=a.readUshort(i,s),s+=2,l.maxCompositePoints=a.readUshort(i,s),s+=2,l.maxCompositeContours=a.readUshort(i,s),s+=2,l.maxZones=a.readUshort(i,s),s+=2,l.maxTwilightPoints=a.readUshort(i,s),s+=2,l.maxStorage=a.readUshort(i,s),s+=2,l.maxFunctionDefs=a.readUshort(i,s),s+=2,l.maxInstructionDefs=a.readUshort(i,s),s+=2,l.maxStackElements=a.readUshort(i,s),s+=2,l.maxSizeOfInstructions=a.readUshort(i,s),s+=2,l.maxComponentElements=a.readUshort(i,s),s+=2,l.maxComponentDepth=a.readUshort(i,s),s+=2),l},e.name={},e.name.parse=function(i,s,o){var a=e._bin,l={};a.readUshort(i,s),s+=2;var c=a.readUshort(i,s);s+=2,a.readUshort(i,s);for(var u,f=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],d=s+=2,m=0;m<c;m++){var g=a.readUshort(i,s);s+=2;var y=a.readUshort(i,s);s+=2;var x=a.readUshort(i,s);s+=2;var v=a.readUshort(i,s);s+=2;var A=a.readUshort(i,s);s+=2;var w=a.readUshort(i,s);s+=2;var S,M=f[v],b=d+12*c+w;if(g==0)S=a.readUnicode(i,b,A/2);else if(g==3&&y==0)S=a.readUnicode(i,b,A/2);else if(y==0)S=a.readASCII(i,b,A);else if(y==1)S=a.readUnicode(i,b,A/2);else if(y==3)S=a.readUnicode(i,b,A/2);else{if(g!=1)throw"unknown encoding "+y+", platformID: "+g;S=a.readASCII(i,b,A),console.debug("reading unknown MAC encoding "+y+" as ASCII")}var R="p"+g+","+x.toString(16);l[R]==null&&(l[R]={}),l[R][M!==void 0?M:v]=S,l[R]._lang=x}for(var P in l)if(l[P].postScriptName!=null&&l[P]._lang==1033)return l[P];for(var P in l)if(l[P].postScriptName!=null&&l[P]._lang==0)return l[P];for(var P in l)if(l[P].postScriptName!=null&&l[P]._lang==3084)return l[P];for(var P in l)if(l[P].postScriptName!=null)return l[P];for(var P in l){u=P;break}return console.debug("returning name table with languageID "+l[u]._lang),l[u]},e["OS/2"]={},e["OS/2"].parse=function(i,s,o){var a=e._bin.readUshort(i,s);s+=2;var l={};if(a==0)e["OS/2"].version0(i,s,l);else if(a==1)e["OS/2"].version1(i,s,l);else if(a==2||a==3||a==4)e["OS/2"].version2(i,s,l);else{if(a!=5)throw"unknown OS/2 table version: "+a;e["OS/2"].version5(i,s,l)}return l},e["OS/2"].version0=function(i,s,o){var a=e._bin;return o.xAvgCharWidth=a.readShort(i,s),s+=2,o.usWeightClass=a.readUshort(i,s),s+=2,o.usWidthClass=a.readUshort(i,s),s+=2,o.fsType=a.readUshort(i,s),s+=2,o.ySubscriptXSize=a.readShort(i,s),s+=2,o.ySubscriptYSize=a.readShort(i,s),s+=2,o.ySubscriptXOffset=a.readShort(i,s),s+=2,o.ySubscriptYOffset=a.readShort(i,s),s+=2,o.ySuperscriptXSize=a.readShort(i,s),s+=2,o.ySuperscriptYSize=a.readShort(i,s),s+=2,o.ySuperscriptXOffset=a.readShort(i,s),s+=2,o.ySuperscriptYOffset=a.readShort(i,s),s+=2,o.yStrikeoutSize=a.readShort(i,s),s+=2,o.yStrikeoutPosition=a.readShort(i,s),s+=2,o.sFamilyClass=a.readShort(i,s),s+=2,o.panose=a.readBytes(i,s,10),s+=10,o.ulUnicodeRange1=a.readUint(i,s),s+=4,o.ulUnicodeRange2=a.readUint(i,s),s+=4,o.ulUnicodeRange3=a.readUint(i,s),s+=4,o.ulUnicodeRange4=a.readUint(i,s),s+=4,o.achVendID=[a.readInt8(i,s),a.readInt8(i,s+1),a.readInt8(i,s+2),a.readInt8(i,s+3)],s+=4,o.fsSelection=a.readUshort(i,s),s+=2,o.usFirstCharIndex=a.readUshort(i,s),s+=2,o.usLastCharIndex=a.readUshort(i,s),s+=2,o.sTypoAscender=a.readShort(i,s),s+=2,o.sTypoDescender=a.readShort(i,s),s+=2,o.sTypoLineGap=a.readShort(i,s),s+=2,o.usWinAscent=a.readUshort(i,s),s+=2,o.usWinDescent=a.readUshort(i,s),s+=2},e["OS/2"].version1=function(i,s,o){var a=e._bin;return s=e["OS/2"].version0(i,s,o),o.ulCodePageRange1=a.readUint(i,s),s+=4,o.ulCodePageRange2=a.readUint(i,s),s+=4},e["OS/2"].version2=function(i,s,o){var a=e._bin;return s=e["OS/2"].version1(i,s,o),o.sxHeight=a.readShort(i,s),s+=2,o.sCapHeight=a.readShort(i,s),s+=2,o.usDefault=a.readUshort(i,s),s+=2,o.usBreak=a.readUshort(i,s),s+=2,o.usMaxContext=a.readUshort(i,s),s+=2},e["OS/2"].version5=function(i,s,o){var a=e._bin;return s=e["OS/2"].version2(i,s,o),o.usLowerOpticalPointSize=a.readUshort(i,s),s+=2,o.usUpperOpticalPointSize=a.readUshort(i,s),s+=2},e.post={},e.post.parse=function(i,s,o){var a=e._bin,l={};return l.version=a.readFixed(i,s),s+=4,l.italicAngle=a.readFixed(i,s),s+=4,l.underlinePosition=a.readShort(i,s),s+=2,l.underlineThickness=a.readShort(i,s),s+=2,l},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(i,s){var o=i.cmap,a=-1;if(o.p0e4!=null?a=o.p0e4:o.p3e1!=null?a=o.p3e1:o.p1e0!=null?a=o.p1e0:o.p0e3!=null&&(a=o.p0e3),a==-1)throw"no familiar platform and encoding!";var l=o.tables[a];if(l.format==0)return s>=l.map.length?0:l.map[s];if(l.format==4){for(var c=-1,u=0;u<l.endCount.length;u++)if(s<=l.endCount[u]){c=u;break}return c==-1||l.startCount[c]>s?0:65535&(l.idRangeOffset[c]!=0?l.glyphIdArray[s-l.startCount[c]+(l.idRangeOffset[c]>>1)-(l.idRangeOffset.length-c)]:s+l.idDelta[c])}if(l.format==12){if(s>l.groups[l.groups.length-1][1])return 0;for(u=0;u<l.groups.length;u++){var f=l.groups[u];if(f[0]<=s&&s<=f[1])return f[2]+(s-f[0])}return 0}throw"unknown cmap table format "+l.format},e.U.glyphToPath=function(i,s){var o={cmds:[],crds:[]};if(i.SVG&&i.SVG.entries[s]){var a=i.SVG.entries[s];return a==null?o:(typeof a=="string"&&(a=e.SVG.toPath(a),i.SVG.entries[s]=a),a)}if(i.CFF){var l={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:i.CFF.Private?i.CFF.Private.defaultWidthX:0,open:!1},c=i.CFF,u=i.CFF.Private;if(c.ROS){for(var f=0;c.FDSelect[f+2]<=s;)f+=2;u=c.FDArray[c.FDSelect[f+1]].Private}e.U._drawCFF(i.CFF.CharStrings[s],l,c,u,o)}else i.glyf&&e.U._drawGlyf(s,i,o);return o},e.U._drawGlyf=function(i,s,o){var a=s.glyf[i];a==null&&(a=s.glyf[i]=e.glyf._parseGlyf(s,i)),a!=null&&(a.noc>-1?e.U._simpleGlyph(a,o):e.U._compoGlyph(a,s,o))},e.U._simpleGlyph=function(i,s){for(var o=0;o<i.noc;o++){for(var a=o==0?0:i.endPts[o-1]+1,l=i.endPts[o],c=a;c<=l;c++){var u=c==a?l:c-1,f=c==l?a:c+1,d=1&i.flags[c],m=1&i.flags[u],g=1&i.flags[f],y=i.xs[c],x=i.ys[c];if(c==a)if(d){if(!m){e.U.P.moveTo(s,y,x);continue}e.U.P.moveTo(s,i.xs[u],i.ys[u])}else m?e.U.P.moveTo(s,i.xs[u],i.ys[u]):e.U.P.moveTo(s,(i.xs[u]+y)/2,(i.ys[u]+x)/2);d?m&&e.U.P.lineTo(s,y,x):g?e.U.P.qcurveTo(s,y,x,i.xs[f],i.ys[f]):e.U.P.qcurveTo(s,y,x,(y+i.xs[f])/2,(x+i.ys[f])/2)}e.U.P.closePath(s)}},e.U._compoGlyph=function(i,s,o){for(var a=0;a<i.parts.length;a++){var l={cmds:[],crds:[]},c=i.parts[a];e.U._drawGlyf(c.glyphIndex,s,l);for(var u=c.m,f=0;f<l.crds.length;f+=2){var d=l.crds[f],m=l.crds[f+1];o.crds.push(d*u.a+m*u.b+u.tx),o.crds.push(d*u.c+m*u.d+u.ty)}for(f=0;f<l.cmds.length;f++)o.cmds.push(l.cmds[f])}},e.U._getGlyphClass=function(i,s){var o=e._lctf.getInterval(s,i);return o==-1?0:s[o+2]},e.U._applySubs=function(i,s,o,a){for(var l=i.length-s-1,c=0;c<o.tabs.length;c++)if(o.tabs[c]!=null){var u,f=o.tabs[c];if(!f.coverage||(u=e._lctf.coverageIndex(f.coverage,i[s]))!=-1){if(o.ltype==1)i[s],f.fmt==1?i[s]=i[s]+f.delta:i[s]=f.newg[u];else if(o.ltype==4)for(var d=f.vals[u],m=0;m<d.length;m++){var g=d[m],y=g.chain.length;if(!(y>l)){for(var x=!0,v=0,A=0;A<y;A++){for(;i[s+v+(1+A)]==-1;)v++;g.chain[A]!=i[s+v+(1+A)]&&(x=!1)}if(x){for(i[s]=g.nglyph,A=0;A<y+v;A++)i[s+A+1]=-1;break}}}else if(o.ltype==5&&f.fmt==2)for(var w=e._lctf.getInterval(f.cDef,i[s]),S=f.cDef[w+2],M=f.scset[S],b=0;b<M.length;b++){var R=M[b],P=R.input;if(!(P.length>l)){for(x=!0,A=0;A<P.length;A++){var C=e._lctf.getInterval(f.cDef,i[s+1+A]);if(w==-1&&f.cDef[C+2]!=P[A]){x=!1;break}}if(x){var B=R.substLookupRecords;for(m=0;m<B.length;m+=2)B[m],B[m+1]}}}else if(o.ltype==6&&f.fmt==3){if(!e.U._glsCovered(i,f.backCvg,s-f.backCvg.length)||!e.U._glsCovered(i,f.inptCvg,s)||!e.U._glsCovered(i,f.ahedCvg,s+f.inptCvg.length))continue;var H=f.lookupRec;for(b=0;b<H.length;b+=2){w=H[b];var k=a[H[b+1]];e.U._applySubs(i,s+w,k,a)}}}}},e.U._glsCovered=function(i,s,o){for(var a=0;a<s.length;a++)if(e._lctf.coverageIndex(s[a],i[o+a])==-1)return!1;return!0},e.U.glyphsToPath=function(i,s,o){for(var a={cmds:[],crds:[]},l=0,c=0;c<s.length;c++){var u=s[c];if(u!=-1){for(var f=c<s.length-1&&s[c+1]!=-1?s[c+1]:0,d=e.U.glyphToPath(i,u),m=0;m<d.crds.length;m+=2)a.crds.push(d.crds[m]+l),a.crds.push(d.crds[m+1]);for(o&&a.cmds.push(o),m=0;m<d.cmds.length;m++)a.cmds.push(d.cmds[m]);o&&a.cmds.push("X"),l+=i.hmtx.aWidth[u],c<s.length-1&&(l+=e.U.getPairAdjustment(i,u,f))}}return a},e.U.P={},e.U.P.moveTo=function(i,s,o){i.cmds.push("M"),i.crds.push(s,o)},e.U.P.lineTo=function(i,s,o){i.cmds.push("L"),i.crds.push(s,o)},e.U.P.curveTo=function(i,s,o,a,l,c,u){i.cmds.push("C"),i.crds.push(s,o,a,l,c,u)},e.U.P.qcurveTo=function(i,s,o,a,l){i.cmds.push("Q"),i.crds.push(s,o,a,l)},e.U.P.closePath=function(i){i.cmds.push("Z")},e.U._drawCFF=function(i,s,o,a,l){for(var c=s.stack,u=s.nStems,f=s.haveWidth,d=s.width,m=s.open,g=0,y=s.x,x=s.y,v=0,A=0,w=0,S=0,M=0,b=0,R=0,P=0,C=0,B=0,H={val:0,size:0};g<i.length;){e.CFF.getCharString(i,g,H);var k=H.val;if(g+=H.size,k=="o1"||k=="o18")c.length%2!=0&&!f&&(d=c.shift()+a.nominalWidthX),u+=c.length>>1,c.length=0,f=!0;else if(k=="o3"||k=="o23")c.length%2!=0&&!f&&(d=c.shift()+a.nominalWidthX),u+=c.length>>1,c.length=0,f=!0;else if(k=="o4")c.length>1&&!f&&(d=c.shift()+a.nominalWidthX,f=!0),m&&e.U.P.closePath(l),x+=c.pop(),e.U.P.moveTo(l,y,x),m=!0;else if(k=="o5")for(;c.length>0;)y+=c.shift(),x+=c.shift(),e.U.P.lineTo(l,y,x);else if(k=="o6"||k=="o7")for(var $=c.length,U=k=="o6",z=0;z<$;z++){var O=c.shift();U?y+=O:x+=O,U=!U,e.U.P.lineTo(l,y,x)}else if(k=="o8"||k=="o24"){$=c.length;for(var ie=0;ie+6<=$;)v=y+c.shift(),A=x+c.shift(),w=v+c.shift(),S=A+c.shift(),y=w+c.shift(),x=S+c.shift(),e.U.P.curveTo(l,v,A,w,S,y,x),ie+=6;k=="o24"&&(y+=c.shift(),x+=c.shift(),e.U.P.lineTo(l,y,x))}else{if(k=="o11")break;if(k=="o1234"||k=="o1235"||k=="o1236"||k=="o1237")k=="o1234"&&(A=x,w=(v=y+c.shift())+c.shift(),B=S=A+c.shift(),b=S,P=x,y=(R=(M=(C=w+c.shift())+c.shift())+c.shift())+c.shift(),e.U.P.curveTo(l,v,A,w,S,C,B),e.U.P.curveTo(l,M,b,R,P,y,x)),k=="o1235"&&(v=y+c.shift(),A=x+c.shift(),w=v+c.shift(),S=A+c.shift(),C=w+c.shift(),B=S+c.shift(),M=C+c.shift(),b=B+c.shift(),R=M+c.shift(),P=b+c.shift(),y=R+c.shift(),x=P+c.shift(),c.shift(),e.U.P.curveTo(l,v,A,w,S,C,B),e.U.P.curveTo(l,M,b,R,P,y,x)),k=="o1236"&&(v=y+c.shift(),A=x+c.shift(),w=v+c.shift(),B=S=A+c.shift(),b=S,R=(M=(C=w+c.shift())+c.shift())+c.shift(),P=b+c.shift(),y=R+c.shift(),e.U.P.curveTo(l,v,A,w,S,C,B),e.U.P.curveTo(l,M,b,R,P,y,x)),k=="o1237"&&(v=y+c.shift(),A=x+c.shift(),w=v+c.shift(),S=A+c.shift(),C=w+c.shift(),B=S+c.shift(),M=C+c.shift(),b=B+c.shift(),R=M+c.shift(),P=b+c.shift(),Math.abs(R-y)>Math.abs(P-x)?y=R+c.shift():x=P+c.shift(),e.U.P.curveTo(l,v,A,w,S,C,B),e.U.P.curveTo(l,M,b,R,P,y,x));else if(k=="o14"){if(c.length>0&&!f&&(d=c.shift()+o.nominalWidthX,f=!0),c.length==4){var X=c.shift(),K=c.shift(),W=c.shift(),V=c.shift(),Q=e.CFF.glyphBySE(o,W),q=e.CFF.glyphBySE(o,V);e.U._drawCFF(o.CharStrings[Q],s,o,a,l),s.x=X,s.y=K,e.U._drawCFF(o.CharStrings[q],s,o,a,l)}m&&(e.U.P.closePath(l),m=!1)}else if(k=="o19"||k=="o20")c.length%2!=0&&!f&&(d=c.shift()+a.nominalWidthX),u+=c.length>>1,c.length=0,f=!0,g+=u+7>>3;else if(k=="o21")c.length>2&&!f&&(d=c.shift()+a.nominalWidthX,f=!0),x+=c.pop(),y+=c.pop(),m&&e.U.P.closePath(l),e.U.P.moveTo(l,y,x),m=!0;else if(k=="o22")c.length>1&&!f&&(d=c.shift()+a.nominalWidthX,f=!0),y+=c.pop(),m&&e.U.P.closePath(l),e.U.P.moveTo(l,y,x),m=!0;else if(k=="o25"){for(;c.length>6;)y+=c.shift(),x+=c.shift(),e.U.P.lineTo(l,y,x);v=y+c.shift(),A=x+c.shift(),w=v+c.shift(),S=A+c.shift(),y=w+c.shift(),x=S+c.shift(),e.U.P.curveTo(l,v,A,w,S,y,x)}else if(k=="o26")for(c.length%2&&(y+=c.shift());c.length>0;)v=y,A=x+c.shift(),y=w=v+c.shift(),x=(S=A+c.shift())+c.shift(),e.U.P.curveTo(l,v,A,w,S,y,x);else if(k=="o27")for(c.length%2&&(x+=c.shift());c.length>0;)A=x,w=(v=y+c.shift())+c.shift(),S=A+c.shift(),y=w+c.shift(),x=S,e.U.P.curveTo(l,v,A,w,S,y,x);else if(k=="o10"||k=="o29"){var ne=k=="o10"?a:o;if(c.length==0)console.debug("error: empty stack");else{var fe=c.pop(),pe=ne.Subrs[fe+ne.Bias];s.x=y,s.y=x,s.nStems=u,s.haveWidth=f,s.width=d,s.open=m,e.U._drawCFF(pe,s,o,a,l),y=s.x,x=s.y,u=s.nStems,f=s.haveWidth,d=s.width,m=s.open}}else if(k=="o30"||k=="o31"){var ge=c.length,Ce=(ie=0,k=="o31");for(ie+=ge-($=-3&ge);ie<$;)Ce?(A=x,w=(v=y+c.shift())+c.shift(),x=(S=A+c.shift())+c.shift(),$-ie==5?(y=w+c.shift(),ie++):y=w,Ce=!1):(v=y,A=x+c.shift(),w=v+c.shift(),S=A+c.shift(),y=w+c.shift(),$-ie==5?(x=S+c.shift(),ie++):x=S,Ce=!0),e.U.P.curveTo(l,v,A,w,S,y,x),ie+=4}else{if((k+"").charAt(0)=="o")throw console.debug("Unknown operation: "+k,i),k;c.push(k)}}}s.x=y,s.y=x,s.nStems=u,s.haveWidth=f,s.width=d,s.open=m};var t=e,r={Typr:t};return n.Typr=t,n.default=r,Object.defineProperty(n,"__esModule",{value:!0}),n}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function YZ(){return function(n){var e=Uint8Array,t=Uint16Array,r=Uint32Array,i=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),s=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(k,$){for(var U=new t(31),z=0;z<31;++z)U[z]=$+=1<<k[z-1];var O=new r(U[30]);for(z=1;z<30;++z)for(var ie=U[z];ie<U[z+1];++ie)O[ie]=ie-U[z]<<5|z;return[U,O]},l=a(i,2),c=l[0],u=l[1];c[28]=258,u[258]=28;for(var f=a(s,0)[0],d=new t(32768),m=0;m<32768;++m){var g=(43690&m)>>>1|(21845&m)<<1;g=(61680&(g=(52428&g)>>>2|(13107&g)<<2))>>>4|(3855&g)<<4,d[m]=((65280&g)>>>8|(255&g)<<8)>>>1}var y=function(k,$,U){for(var z=k.length,O=0,ie=new t($);O<z;++O)++ie[k[O]-1];var X,K=new t($);for(O=0;O<$;++O)K[O]=K[O-1]+ie[O-1]<<1;if(U){X=new t(1<<$);var W=15-$;for(O=0;O<z;++O)if(k[O])for(var V=O<<4|k[O],Q=$-k[O],q=K[k[O]-1]++<<Q,ne=q|(1<<Q)-1;q<=ne;++q)X[d[q]>>>W]=V}else for(X=new t(z),O=0;O<z;++O)k[O]&&(X[O]=d[K[k[O]-1]++]>>>15-k[O]);return X},x=new e(288);for(m=0;m<144;++m)x[m]=8;for(m=144;m<256;++m)x[m]=9;for(m=256;m<280;++m)x[m]=7;for(m=280;m<288;++m)x[m]=8;var v=new e(32);for(m=0;m<32;++m)v[m]=5;var A=y(x,9,1),w=y(v,5,1),S=function(k){for(var $=k[0],U=1;U<k.length;++U)k[U]>$&&($=k[U]);return $},M=function(k,$,U){var z=$/8|0;return(k[z]|k[z+1]<<8)>>(7&$)&U},b=function(k,$){var U=$/8|0;return(k[U]|k[U+1]<<8|k[U+2]<<16)>>(7&$)},R=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],P=function(k,$,U){var z=new Error($||R[k]);if(z.code=k,Error.captureStackTrace&&Error.captureStackTrace(z,P),!U)throw z;return z},C=function(k,$,U){var z=k.length;if(!z||U&&!U.l&&z<5)return $||new e(0);var O=!$||U,ie=!U||U.i;U||(U={}),$||($=new e(3*z));var X,K=function(Ke){var ae=$.length;if(Ke>ae){var De=new e(Math.max(2*ae,Ke));De.set($),$=De}},W=U.f||0,V=U.p||0,Q=U.b||0,q=U.l,ne=U.d,fe=U.m,pe=U.n,ge=8*z;do{if(!q){U.f=W=M(k,V,1);var Ce=M(k,V+1,3);if(V+=3,!Ce){var Je=k[(F=((X=V)/8|0)+(7&X&&1)+4)-4]|k[F-3]<<8,Xe=F+Je;if(Xe>z){ie&&P(0);break}O&&K(Q+Je),$.set(k.subarray(F,Xe),Q),U.b=Q+=Je,U.p=V=8*Xe;continue}if(Ce==1)q=A,ne=w,fe=9,pe=5;else if(Ce==2){var Fe=M(k,V,31)+257,j=M(k,V+10,15)+4,Te=Fe+M(k,V+5,31)+1;V+=14;for(var be=new e(Te),Ue=new e(19),we=0;we<j;++we)Ue[o[we]]=M(k,V+3*we,7);V+=3*j;var et=S(Ue),Re=(1<<et)-1,J=y(Ue,et,1);for(we=0;we<Te;){var F,G=J[M(k,V,Re)];if(V+=15&G,(F=G>>>4)<16)be[we++]=F;else{var de=0,le=0;for(F==16?(le=3+M(k,V,3),V+=2,de=be[we-1]):F==17?(le=3+M(k,V,7),V+=3):F==18&&(le=11+M(k,V,127),V+=7);le--;)be[we++]=de}}var ye=be.subarray(0,Fe),Le=be.subarray(Fe);fe=S(ye),pe=S(Le),q=y(ye,fe,1),ne=y(Le,pe,1)}else P(1);if(V>ge){ie&&P(0);break}}O&&K(Q+131072);for(var Ve=(1<<fe)-1,Oe=(1<<pe)-1,ze=V;;ze=V){var Ye=(de=q[b(k,V)&Ve])>>>4;if((V+=15&de)>ge){ie&&P(0);break}if(de||P(2),Ye<256)$[Q++]=Ye;else{if(Ye==256){ze=V,q=null;break}var Ie=Ye-254;if(Ye>264){var gt=i[we=Ye-257];Ie=M(k,V,(1<<gt)-1)+c[we],V+=gt}var yt=ne[b(k,V)&Oe],ot=yt>>>4;if(yt||P(3),V+=15&yt,Le=f[ot],ot>3&&(gt=s[ot],Le+=b(k,V)&(1<<gt)-1,V+=gt),V>ge){ie&&P(0);break}O&&K(Q+131072);for(var Ze=Q+Ie;Q<Ze;Q+=4)$[Q]=$[Q-Le],$[Q+1]=$[Q+1-Le],$[Q+2]=$[Q+2-Le],$[Q+3]=$[Q+3-Le];Q=Ze}}U.l=q,U.p=ze,U.b=Q,q&&(W=1,U.m=fe,U.d=ne,U.n=pe)}while(!W);return Q==$.length?$:function(Ke,ae,De){(ae==null||ae<0)&&(ae=0),(De==null||De>Ke.length)&&(De=Ke.length);var rt=new(Ke instanceof t?t:Ke instanceof r?r:e)(De-ae);return rt.set(Ke.subarray(ae,De)),rt}($,0,Q)},B=new e(0),H=typeof TextDecoder<"u"&&new TextDecoder;try{H.decode(B,{stream:!0})}catch{}return n.convert_streams=function(k){var $=new DataView(k),U=0;function z(){var Fe=$.getUint16(U);return U+=2,Fe}function O(){var Fe=$.getUint32(U);return U+=4,Fe}function ie(Fe){Je.setUint16(Xe,Fe),Xe+=2}function X(Fe){Je.setUint32(Xe,Fe),Xe+=4}for(var K={signature:O(),flavor:O(),length:O(),numTables:z(),reserved:z(),totalSfntSize:O(),majorVersion:z(),minorVersion:z(),metaOffset:O(),metaLength:O(),metaOrigLength:O(),privOffset:O(),privLength:O()},W=0;Math.pow(2,W)<=K.numTables;)W++;W--;for(var V=16*Math.pow(2,W),Q=16*K.numTables-V,q=12,ne=[],fe=0;fe<K.numTables;fe++)ne.push({tag:O(),offset:O(),compLength:O(),origLength:O(),origChecksum:O()}),q+=16;var pe,ge=new Uint8Array(12+16*ne.length+ne.reduce(function(Fe,j){return Fe+j.origLength+4},0)),Ce=ge.buffer,Je=new DataView(Ce),Xe=0;return X(K.flavor),ie(K.numTables),ie(V),ie(W),ie(Q),ne.forEach(function(Fe){X(Fe.tag),X(Fe.origChecksum),X(q),X(Fe.origLength),Fe.outOffset=q,(q+=Fe.origLength)%4!=0&&(q+=4-q%4)}),ne.forEach(function(Fe){var j,Te=k.slice(Fe.offset,Fe.offset+Fe.compLength);if(Fe.compLength!=Fe.origLength){var be=new Uint8Array(Fe.origLength);j=new Uint8Array(Te,2),C(j,be)}else be=new Uint8Array(Te);ge.set(be,Fe.outOffset);var Ue=0;(q=Fe.outOffset+Fe.origLength)%4!=0&&(Ue=4-q%4),ge.set(new Uint8Array(Ue).buffer,Fe.outOffset+Fe.origLength),pe=q+Ue}),Ce.slice(0,pe)},Object.defineProperty(n,"__esModule",{value:!0}),n}({}).convert_streams}function ZZ(n,e){const t={M:2,L:2,Q:4,C:6,Z:0},r={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},i=1,s=2,o=4,a=8,l=16,c=32;let u;function f(R){if(!u){const P={R:s,L:i,D:o,C:l,U:c,T:a};u=new Map;for(let C in r){let B=0;r[C].split(",").forEach(H=>{let[k,$]=H.split("+");k=parseInt(k,36),$=$?parseInt($,36):0,u.set(B+=k,P[C]);for(let U=$;U--;)u.set(++B,P[C])})}}return u.get(R)||c}const d=1,m=2,g=3,y=4,x=[null,"isol","init","fina","medi"];function v(R){const P=new Uint8Array(R.length);let C=c,B=d,H=-1;for(let k=0;k<R.length;k++){const $=R.codePointAt(k);let U=f($)|0,z=d;U&a||(C&(i|o|l)?U&(s|o|l)?(z=g,(B===d||B===g)&&P[H]++):U&(i|c)&&(B===m||B===y)&&P[H]--:C&(s|c)&&(B===m||B===y)&&P[H]--,B=P[k]=z,C=U,H=k,$>65535&&k++)}return P}function A(R,P){const C=[];for(let H=0;H<P.length;H++){const k=P.codePointAt(H);k>65535&&H++,C.push(n.U.codeToGlyph(R,k))}const B=R.GSUB;if(B){const{lookupList:H,featureList:k}=B;let $;const U=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,z=[];k.forEach(O=>{if(U.test(O.tag))for(let ie=0;ie<O.tab.length;ie++){if(z[O.tab[ie]])continue;z[O.tab[ie]]=!0;const X=H[O.tab[ie]],K=/^(isol|init|fina|medi)$/.test(O.tag);K&&!$&&($=v(P));for(let W=0;W<C.length;W++)(!$||!K||x[$[W]]===O.tag)&&n.U._applySubs(C,W,X,H)}})}return C}function w(R,P){const C=new Int16Array(P.length*3);let B=0;for(;B<P.length;B++){const U=P[B];if(U===-1)continue;C[B*3+2]=R.hmtx.aWidth[U];const z=R.GPOS;if(z){const O=z.lookupList;for(let ie=0;ie<O.length;ie++){const X=O[ie];for(let K=0;K<X.tabs.length;K++){const W=X.tabs[K];if(X.ltype===1){if(n._lctf.coverageIndex(W.coverage,U)!==-1&&W.pos){$(W.pos,B);break}}else if(X.ltype===2){let V=null,Q=H();if(Q!==-1){const q=n._lctf.coverageIndex(W.coverage,P[Q]);if(q!==-1){if(W.fmt===1){const ne=W.pairsets[q];for(let fe=0;fe<ne.length;fe++)ne[fe].gid2===U&&(V=ne[fe])}else if(W.fmt===2){const ne=n.U._getGlyphClass(P[Q],W.classDef1),fe=n.U._getGlyphClass(U,W.classDef2);V=W.matrix[ne][fe]}if(V){V.val1&&$(V.val1,Q),V.val2&&$(V.val2,B);break}}}}else if(X.ltype===4){const V=n._lctf.coverageIndex(W.markCoverage,U);if(V!==-1){const Q=H(k),q=Q===-1?-1:n._lctf.coverageIndex(W.baseCoverage,P[Q]);if(q!==-1){const ne=W.markArray[V],fe=W.baseArray[q][ne.markClass];C[B*3]=fe.x-ne.x+C[Q*3]-C[Q*3+2],C[B*3+1]=fe.y-ne.y+C[Q*3+1];break}}}else if(X.ltype===6){const V=n._lctf.coverageIndex(W.mark1Coverage,U);if(V!==-1){const Q=H();if(Q!==-1){const q=P[Q];if(S(R,q)===3){const ne=n._lctf.coverageIndex(W.mark2Coverage,q);if(ne!==-1){const fe=W.mark1Array[V],pe=W.mark2Array[ne][fe.markClass];C[B*3]=pe.x-fe.x+C[Q*3]-C[Q*3+2],C[B*3+1]=pe.y-fe.y+C[Q*3+1];break}}}}}}}}else if(R.kern&&!R.cff){const O=H();if(O!==-1){const ie=R.kern.glyph1.indexOf(P[O]);if(ie!==-1){const X=R.kern.rval[ie].glyph2.indexOf(U);X!==-1&&(C[O*3+2]+=R.kern.rval[ie].vals[X])}}}}return C;function H(U){for(let z=B-1;z>=0;z--)if(P[z]!==-1&&(!U||U(P[z])))return z;return-1}function k(U){return S(R,U)===1}function $(U,z){for(let O=0;O<3;O++)C[z*3+O]+=U[O]||0}}function S(R,P){const C=R.GDEF&&R.GDEF.glyphClassDef;return C?n.U._getGlyphClass(P,C):0}function M(...R){for(let P=0;P<R.length;P++)if(typeof R[P]=="number")return R[P]}function b(R){const P=Object.create(null),C=R["OS/2"],B=R.hhea,H=R.head.unitsPerEm,k=M(C&&C.sTypoAscender,B&&B.ascender,H),$={unitsPerEm:H,ascender:k,descender:M(C&&C.sTypoDescender,B&&B.descender,0),capHeight:M(C&&C.sCapHeight,k),xHeight:M(C&&C.sxHeight,k),lineGap:M(C&&C.sTypoLineGap,B&&B.lineGap),supportsCodePoint(U){return n.U.codeToGlyph(R,U)>0},forEachGlyph(U,z,O,ie){let X=0;const K=1/$.unitsPerEm*z,W=A(R,U);let V=0;const Q=w(R,W);return W.forEach((q,ne)=>{if(q!==-1){let fe=P[q];if(!fe){const{cmds:pe,crds:ge}=n.U.glyphToPath(R,q);let Ce="",Je=0;for(let be=0,Ue=pe.length;be<Ue;be++){const we=t[pe[be]];Ce+=pe[be];for(let et=1;et<=we;et++)Ce+=(et>1?",":"")+ge[Je++]}let Xe,Fe,j,Te;if(ge.length){Xe=Fe=1/0,j=Te=-1/0;for(let be=0,Ue=ge.length;be<Ue;be+=2){let we=ge[be],et=ge[be+1];we<Xe&&(Xe=we),et<Fe&&(Fe=et),we>j&&(j=we),et>Te&&(Te=et)}}else Xe=j=Fe=Te=0;fe=P[q]={index:q,advanceWidth:R.hmtx.aWidth[q],xMin:Xe,yMin:Fe,xMax:j,yMax:Te,path:Ce}}ie.call(null,fe,X+Q[ne*3]*K,Q[ne*3+1]*K,V),X+=Q[ne*3+2]*K,O&&(X+=O*z)}V+=U.codePointAt(V)>65535?2:1}),X}};return $}return function(P){const C=new Uint8Array(P,0,4),B=n._bin.readASCII(C,0,4);if(B==="wOFF")P=e(P);else if(B==="wOF2")throw new Error("woff2 fonts not supported");return b(n.parse(P)[0])}}const qZ=Gm({name:"Typr Font Parser",dependencies:[jZ,YZ,ZZ],init(n,e,t){const r=n(),i=e();return t(r,i)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function $Z(){return function(n){var e=function(){this.buckets=new Map};e.prototype.add=function(w){var S=w>>5;this.buckets.set(S,(this.buckets.get(S)||0)|1<<(31&w))},e.prototype.has=function(w){var S=this.buckets.get(w>>5);return S!==void 0&&(S&1<<(31&w))!=0},e.prototype.serialize=function(){var w=[];return this.buckets.forEach(function(S,M){w.push((+M).toString(36)+":"+S.toString(36))}),w.join(",")},e.prototype.deserialize=function(w){var S=this;this.buckets.clear(),w.split(",").forEach(function(M){var b=M.split(":");S.buckets.set(parseInt(b[0],36),parseInt(b[1],36))})};var t=Math.pow(2,8),r=t-1,i=~r;function s(w){var S=function(b){return b&i}(w).toString(16),M=function(b){return(b&i)+t-1}(w).toString(16);return"codepoint-index/plane"+(w>>16)+"/"+S+"-"+M+".json"}function o(w,S){var M=w&r,b=S.codePointAt(M/6|0);return((b=(b||48)-48)&1<<M%6)!=0}function a(w,S){var M;(M=w,M.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(b){return b.split("-").map(function(R){return parseInt(R.trim(),16)})})).forEach(function(b){var R=b[0],P=b[1];P===void 0&&(P=R),S(R,P)})}function l(w,S){a(w,function(M,b){for(var R=M;R<=b;R++)S(R)})}var c={},u={},f=new WeakMap,d="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function m(w){var S=f.get(w);return S||(S=new e,l(w.ranges,function(M){return S.add(M)}),f.set(w,S)),S}var g,y=new Map;function x(w,S,M){return w[S]?S:w[M]?M:function(b){for(var R in b)return R}(w)}function v(w,S){var M=S;if(!w.includes(M)){M=1/0;for(var b=0;b<w.length;b++)Math.abs(w[b]-S)<Math.abs(M-S)&&(M=w[b])}return M}function A(w){return g||(g=new Set,l("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(S){g.add(S)})),g.has(w)}return n.CodePointSet=e,n.clearCache=function(){c={},u={}},n.getFontsForString=function(w,S){S===void 0&&(S={});var M,b=S.lang;b===void 0&&(b=/\p{Script=Hangul}/u.test(M=w)?"ko":/\p{Script=Hiragana}|\p{Script=Katakana}/u.test(M)?"ja":"en");var R=S.category;R===void 0&&(R="sans-serif");var P=S.style;P===void 0&&(P="normal");var C=S.weight;C===void 0&&(C=400);var B=(S.dataUrl||d).replace(/\/$/g,""),H=new Map,k=new Uint8Array(w.length),$={},U={},z=new Array(w.length),O=new Map,ie=!1;function X(V){var Q=y.get(V);return Q||(Q=fetch(B+"/"+V).then(function(q){if(!q.ok)throw new Error(q.statusText);return q.json().then(function(ne){if(!Array.isArray(ne)||ne[0]!==1)throw new Error("Incorrect schema version; need 1, got "+ne[0]);return ne[1]})}).catch(function(q){if(B!==d)return ie||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+B+'", trying default CDN. '+q.message),ie=!0),B=d,y.delete(V),X(V);throw q}),y.set(V,Q)),Q}for(var K=function(V){var Q=w.codePointAt(V),q=s(Q);z[V]=q,c[q]||O.has(q)||O.set(q,X(q).then(function(ne){c[q]=ne})),Q>65535&&(V++,W=V)},W=0;W<w.length;W++)K(W);return Promise.all(O.values()).then(function(){O.clear();for(var V=function(q){var ne=w.codePointAt(q),fe=null,pe=c[z[q]],ge=void 0;for(var Ce in pe){var Je=U[Ce];if(Je===void 0&&(Je=U[Ce]=new RegExp(Ce).test(b||"en")),Je){for(var Xe in ge=Ce,pe[Ce])if(o(ne,pe[Ce][Xe])){fe=Xe;break}break}}if(!fe){e:for(var Fe in pe)if(Fe!==ge){for(var j in pe[Fe])if(o(ne,pe[Fe][j])){fe=j;break e}}}fe||(console.debug("No font coverage for U+"+ne.toString(16)),fe="latin"),z[q]=fe,u[fe]||O.has(fe)||O.set(fe,X("font-meta/"+fe+".json").then(function(Te){u[fe]=Te})),ne>65535&&(q++,Q=q)},Q=0;Q<w.length;Q++)V(Q);return Promise.all(O.values())}).then(function(){for(var V,Q=null,q=0;q<w.length;q++){var ne=w.codePointAt(q);if(Q&&(A(ne)||m(Q).has(ne)))k[q]=k[q-1];else{Q=u[z[q]];var fe=$[Q.id];if(!fe){var pe=Q.typeforms,ge=x(pe,R,"sans-serif"),Ce=x(pe[ge],P,"normal"),Je=v((V=pe[ge])===null||V===void 0?void 0:V[Ce],C);fe=$[Q.id]=B+"/font-files/"+Q.id+"/"+ge+"."+Ce+"."+Je+".woff"}var Xe=H.get(fe);Xe==null&&(Xe=H.size,H.set(fe,Xe)),k[q]=Xe}ne>65535&&(q++,k[q]=k[q-1])}return{fontUrls:Array.from(H.keys()),chars:k}})},Object.defineProperty(n,"__esModule",{value:!0}),n}({})}function eq(n,e){const t=Object.create(null),r=Object.create(null);function i(o,a){const l=c=>{console.error(`Failure loading font ${o}`,c)};try{const c=new XMLHttpRequest;c.open("get",o,!0),c.responseType="arraybuffer",c.onload=function(){if(c.status>=400)l(new Error(c.statusText));else if(c.status>0)try{const u=n(c.response);u.src=o,a(u)}catch(u){l(u)}},c.onerror=l,c.send()}catch(c){l(c)}}function s(o,a){let l=t[o];l?a(l):r[o]?r[o].push(a):(r[o]=[a],i(o,c=>{c.src=o,t[o]=c,r[o].forEach(u=>u(c)),delete r[o]}))}return function(o,a,{lang:l,fonts:c=[],style:u="normal",weight:f="normal",unicodeFontsURL:d}={}){const m=new Uint8Array(o.length),g=[];o.length||A();const y=new Map,x=[];if(u!=="italic"&&(u="normal"),typeof f!="number"&&(f=f==="bold"?700:400),c&&!Array.isArray(c)&&(c=[c]),c=c.slice().filter(S=>!S.lang||S.lang.test(l)).reverse(),c.length){let R=0;(function P(C=0){for(let B=C,H=o.length;B<H;B++){const k=o.codePointAt(B);if(R===1&&g[m[B-1]].supportsCodePoint(k)||B>0&&/\s/.test(o[B]))m[B]=m[B-1],R===2&&(x[x.length-1][1]=B);else for(let $=m[B],U=c.length;$<=U;$++)if($===U){const z=R===2?x[x.length-1]:x[x.length]=[B,B];z[1]=B,R=2}else{m[B]=$;const{src:z,unicodeRange:O}=c[$];if(!O||w(k,O)){const ie=t[z];if(!ie){s(z,()=>{P(B)});return}if(ie.supportsCodePoint(k)){let X=y.get(ie);typeof X!="number"&&(X=g.length,g.push(ie),y.set(ie,X)),m[B]=X,R=1;break}}}k>65535&&B+1<H&&(m[B+1]=m[B],B++,R===2&&(x[x.length-1][1]=B))}v()})()}else x.push([0,o.length-1]),v();function v(){if(x.length){const S=x.map(M=>o.substring(M[0],M[1]+1)).join(`
`);e.getFontsForString(S,{lang:l||void 0,style:u,weight:f,dataUrl:d}).then(({fontUrls:M,chars:b})=>{const R=g.length;let P=0;x.forEach(B=>{for(let H=0,k=B[1]-B[0];H<=k;H++)m[B[0]+H]=b[P++]+R;P++});let C=0;M.forEach((B,H)=>{s(B,k=>{g[H+R]=k,++C===M.length&&A()})})})}else A()}function A(){a({chars:m,fonts:g})}function w(S,M){for(let b=0;b<M.length;b++){const[R,P=R]=M[b];if(R<=S&&S<=P)return!0}return!1}}}const tq=Gm({name:"FontResolver",dependencies:[eq,qZ,$Z],init(n,e,t){return n(e,t())}});function nq(n,e){const r=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,i="[^\\S\\u00A0]",s=new RegExp(`${i}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function o({text:g,lang:y,fonts:x,style:v,weight:A,preResolvedFonts:w,unicodeFontsURL:S},M){const b=({chars:R,fonts:P})=>{let C,B;const H=[];for(let k=0;k<R.length;k++)R[k]!==B?(B=R[k],H.push(C={start:k,end:k,fontObj:P[R[k]]})):C.end=k;M(H)};w?b(w):n(g,b,{lang:y,fonts:x,style:v,weight:A,unicodeFontsURL:S})}function a({text:g="",font:y,lang:x,sdfGlyphSize:v=64,fontSize:A=400,fontWeight:w=1,fontStyle:S="normal",letterSpacing:M=0,lineHeight:b="normal",maxWidth:R=1/0,direction:P,textAlign:C="left",textIndent:B=0,whiteSpace:H="normal",overflowWrap:k="normal",anchorX:$=0,anchorY:U=0,metricsOnly:z=!1,unicodeFontsURL:O,preResolvedFonts:ie=null,includeCaretPositions:X=!1,chunkedBoundsSize:K=8192,colorRanges:W=null},V){const Q=f(),q={fontLoad:0,typesetting:0};g.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),g=g.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),A=+A,M=+M,R=+R,b=b||"normal",B=+B,o({text:g,lang:x,style:S,weight:w,fonts:typeof y=="string"?[{src:y}]:y,unicodeFontsURL:O,preResolvedFonts:ie},ne=>{q.fontLoad=f()-Q;const fe=isFinite(R);let pe=null,ge=null,Ce=null,Je=null,Xe=null,Fe=null,j=null,Te=null,be=0,Ue=0,we=H!=="nowrap";const et=new Map,Re=f();let J=B,F=0,G=new d;const de=[G];ne.forEach(Oe=>{const{fontObj:ze}=Oe,{ascender:Ye,descender:Ie,unitsPerEm:gt,lineGap:yt,capHeight:ot,xHeight:Ze}=ze;let Ke=et.get(ze);if(!Ke){const ve=A/gt,ce=b==="normal"?(Ye-Ie+yt)*ve:b*A,at=(ce-(Ye-Ie)*ve)/2,$e=Math.min(ce,(Ye-Ie)*ve),ct=(Ye+Ie)/2*ve+$e/2;Ke={index:et.size,src:ze.src,fontObj:ze,fontSizeMult:ve,unitsPerEm:gt,ascender:Ye*ve,descender:Ie*ve,capHeight:ot*ve,xHeight:Ze*ve,lineHeight:ce,baseline:-at-Ye*ve,caretTop:ct,caretBottom:ct-$e},et.set(ze,Ke)}const{fontSizeMult:ae}=Ke,De=g.slice(Oe.start,Oe.end+1);let rt,it;ze.forEachGlyph(De,A,M,(ve,ce,at,$e)=>{ce+=F,$e+=Oe.start,rt=ce,it=ve;const ct=g.charAt($e),ft=ve.advanceWidth*ae,Tt=G.count;let mt;if("isEmpty"in ve||(ve.isWhitespace=!!ct&&new RegExp(i).test(ct),ve.canBreakAfter=!!ct&&s.test(ct),ve.isEmpty=ve.xMin===ve.xMax||ve.yMin===ve.yMax||r.test(ct)),!ve.isWhitespace&&!ve.isEmpty&&Ue++,we&&fe&&!ve.isWhitespace&&ce+ft+J>R&&Tt){if(G.glyphAt(Tt-1).glyphObj.canBreakAfter)mt=new d,J=-ce;else for(let qt=Tt;qt--;)if(qt===0&&k==="break-word"){mt=new d,J=-ce;break}else if(G.glyphAt(qt).glyphObj.canBreakAfter){mt=G.splitAt(qt+1);const Ft=mt.glyphAt(0).x;J-=Ft;for(let ln=mt.count;ln--;)mt.glyphAt(ln).x-=Ft;break}mt&&(G.isSoftWrapped=!0,G=mt,de.push(G),be=R)}let Dt=G.glyphAt(G.count);Dt.glyphObj=ve,Dt.x=ce+J,Dt.y=at,Dt.width=ft,Dt.charIndex=$e,Dt.fontData=Ke,ct===`
`&&(G=new d,de.push(G),J=-(ce+ft+M*A)+B)}),F=rt+it.advanceWidth*ae+M*A});let le=0;de.forEach(Oe=>{let ze=!0;for(let Ye=Oe.count;Ye--;){const Ie=Oe.glyphAt(Ye);ze&&!Ie.glyphObj.isWhitespace&&(Oe.width=Ie.x+Ie.width,Oe.width>be&&(be=Oe.width),ze=!1);let{lineHeight:gt,capHeight:yt,xHeight:ot,baseline:Ze}=Ie.fontData;gt>Oe.lineHeight&&(Oe.lineHeight=gt);const Ke=Ze-Oe.baseline;Ke<0&&(Oe.baseline+=Ke,Oe.cap+=Ke,Oe.ex+=Ke),Oe.cap=Math.max(Oe.cap,Oe.baseline+yt),Oe.ex=Math.max(Oe.ex,Oe.baseline+ot)}Oe.baseline-=le,Oe.cap-=le,Oe.ex-=le,le+=Oe.lineHeight});let ye=0,Le=0;if($&&(typeof $=="number"?ye=-$:typeof $=="string"&&(ye=-be*($==="left"?0:$==="center"?.5:$==="right"?1:c($)))),U&&(typeof U=="number"?Le=-U:typeof U=="string"&&(Le=U==="top"?0:U==="top-baseline"?-de[0].baseline:U==="top-cap"?-de[0].cap:U==="top-ex"?-de[0].ex:U==="middle"?le/2:U==="bottom"?le:U==="bottom-baseline"?-de[de.length-1].baseline:c(U)*le)),!z){const Oe=e.getEmbeddingLevels(g,P);pe=new Uint16Array(Ue),ge=new Uint8Array(Ue),Ce=new Float32Array(Ue*2),Je={},j=[1/0,1/0,-1/0,-1/0],Te=[],X&&(Fe=new Float32Array(g.length*4)),W&&(Xe=new Uint8Array(Ue*3));let ze=0,Ye=-1,Ie=-1,gt,yt;if(de.forEach((ot,Ze)=>{let{count:Ke,width:ae}=ot;if(Ke>0){let De=0;for(let $e=Ke;$e--&&ot.glyphAt($e).glyphObj.isWhitespace;)De++;let rt=0,it=0;if(C==="center")rt=(be-ae)/2;else if(C==="right")rt=be-ae;else if(C==="justify"&&ot.isSoftWrapped){let $e=0;for(let ct=Ke-De;ct--;)ot.glyphAt(ct).glyphObj.isWhitespace&&$e++;it=(be-ae)/$e}if(it||rt){let $e=0;for(let ct=0;ct<Ke;ct++){let ft=ot.glyphAt(ct);const Tt=ft.glyphObj;ft.x+=rt+$e,it!==0&&Tt.isWhitespace&&ct<Ke-De&&($e+=it,ft.width+=it)}}const ve=e.getReorderSegments(g,Oe,ot.glyphAt(0).charIndex,ot.glyphAt(ot.count-1).charIndex);for(let $e=0;$e<ve.length;$e++){const[ct,ft]=ve[$e];let Tt=1/0,mt=-1/0;for(let Dt=0;Dt<Ke;Dt++)if(ot.glyphAt(Dt).charIndex>=ct){let qt=Dt,Ft=Dt;for(;Ft<Ke;Ft++){let ln=ot.glyphAt(Ft);if(ln.charIndex>ft)break;Ft<Ke-De&&(Tt=Math.min(Tt,ln.x),mt=Math.max(mt,ln.x+ln.width))}for(let ln=qt;ln<Ft;ln++){const zn=ot.glyphAt(ln);zn.x=mt-(zn.x+zn.width-Tt)}break}}let ce;const at=$e=>ce=$e;for(let $e=0;$e<Ke;$e++){const ct=ot.glyphAt($e);ce=ct.glyphObj;const ft=ce.index,Tt=Oe.levels[ct.charIndex]&1;if(Tt){const mt=e.getMirroredCharacter(g[ct.charIndex]);mt&&ct.fontData.fontObj.forEachGlyph(mt,0,0,at)}if(X){const{charIndex:mt,fontData:Dt}=ct,qt=ct.x+ye,Ft=ct.x+ct.width+ye;Fe[mt*4]=Tt?Ft:qt,Fe[mt*4+1]=Tt?qt:Ft,Fe[mt*4+2]=ot.baseline+Dt.caretBottom+Le,Fe[mt*4+3]=ot.baseline+Dt.caretTop+Le;const ln=mt-Ye;ln>1&&u(Fe,Ye,ln),Ye=mt}if(W){const{charIndex:mt}=ct;for(;mt>Ie;)Ie++,W.hasOwnProperty(Ie)&&(yt=W[Ie])}if(!ce.isWhitespace&&!ce.isEmpty){const mt=ze++,{fontSizeMult:Dt,src:qt,index:Ft}=ct.fontData,ln=Je[qt]||(Je[qt]={});ln[ft]||(ln[ft]={path:ce.path,pathBounds:[ce.xMin,ce.yMin,ce.xMax,ce.yMax]});const zn=ct.x+ye,zr=ct.y+ot.baseline+Le;Ce[mt*2]=zn,Ce[mt*2+1]=zr;const oi=zn+ce.xMin*Dt,xr=zr+ce.yMin*Dt,dr=zn+ce.xMax*Dt,Ot=zr+ce.yMax*Dt;oi<j[0]&&(j[0]=oi),xr<j[1]&&(j[1]=xr),dr>j[2]&&(j[2]=dr),Ot>j[3]&&(j[3]=Ot),mt%K===0&&(gt={start:mt,end:mt,rect:[1/0,1/0,-1/0,-1/0]},Te.push(gt)),gt.end++;const nr=gt.rect;if(oi<nr[0]&&(nr[0]=oi),xr<nr[1]&&(nr[1]=xr),dr>nr[2]&&(nr[2]=dr),Ot>nr[3]&&(nr[3]=Ot),pe[mt]=ft,ge[mt]=Ft,W){const as=mt*3;Xe[as]=yt>>16&255,Xe[as+1]=yt>>8&255,Xe[as+2]=yt&255}}}}}),Fe){const ot=g.length-Ye;ot>1&&u(Fe,Ye,ot)}}const Ve=[];et.forEach(({index:Oe,src:ze,unitsPerEm:Ye,ascender:Ie,descender:gt,lineHeight:yt,capHeight:ot,xHeight:Ze})=>{Ve[Oe]={src:ze,unitsPerEm:Ye,ascender:Ie,descender:gt,lineHeight:yt,capHeight:ot,xHeight:Ze}}),q.typesetting=f()-Re,V({glyphIds:pe,glyphFontIndices:ge,glyphPositions:Ce,glyphData:Je,fontData:Ve,caretPositions:Fe,glyphColors:Xe,chunkedBounds:Te,fontSize:A,topBaseline:Le+de[0].baseline,blockBounds:[ye,Le-le,ye+be,Le],visibleBounds:j,timings:q})})}function l(g,y){a({...g,metricsOnly:!0},x=>{const[v,A,w,S]=x.blockBounds;y({width:w-v,height:S-A})})}function c(g){let y=g.match(/^([\d.]+)%$/),x=y?parseFloat(y[1]):NaN;return isNaN(x)?0:x/100}function u(g,y,x){const v=g[y*4],A=g[y*4+1],w=g[y*4+2],S=g[y*4+3],M=(A-v)/x;for(let b=0;b<x;b++){const R=(y+b)*4;g[R]=v+M*b,g[R+1]=v+M*(b+1),g[R+2]=w,g[R+3]=S}}function f(){return(self.performance||Date).now()}function d(){this.data=[]}const m=["glyphObj","x","y","width","charIndex","fontData"];return d.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/m.length)},glyphAt(g){let y=d.flyweight;return y.data=this.data,y.index=g,y},splitAt(g){let y=new d;return y.data=this.data.splice(g*m.length),y}},d.flyweight=m.reduce((g,y,x,v)=>(Object.defineProperty(g,y,{get(){return this.data[this.index*m.length+x]},set(A){this.data[this.index*m.length+x]=A}}),g),{data:null,index:0}),{typeset:a,measure:l}}const hh=()=>(self.performance||Date).now(),fw=P4();let WN;function rq(n,e,t,r,i,s,o,a,l,c,u=!0){return u?sq(n,e,t,r,i,s,o,a,l,c).then(null,f=>(WN||(console.warn("WebGL SDF generation failed, falling back to JS",f),WN=!0),JN(n,e,t,r,i,s,o,a,l,c))):JN(n,e,t,r,i,s,o,a,l,c)}const q1=[],iq=5;let _T=0;function L4(){const n=hh();for(;q1.length&&hh()-n<iq;)q1.shift()();_T=q1.length?setTimeout(L4,0):0}const sq=(...n)=>new Promise((e,t)=>{q1.push(()=>{const r=hh();try{fw.webgl.generateIntoCanvas(...n),e({timing:hh()-r})}catch(i){t(i)}}),_T||(_T=setTimeout(L4,0))}),oq=4,aq=2e3,XN={};let lq=0;function JN(n,e,t,r,i,s,o,a,l,c){const u="TroikaTextSDFGenerator_JS_"+lq++%oq;let f=XN[u];return f||(f=XN[u]={workerModule:Gm({name:u,workerId:u,dependencies:[P4,hh],init(d,m){const g=d().javascript.generate;return function(...y){const x=m();return{textureData:g(...y),timing:m()-x}}},getTransferables(d){return[d.textureData.buffer]}}),requests:0,idleTimer:null}),f.requests++,clearTimeout(f.idleTimer),f.workerModule(n,e,t,r,i,s).then(({textureData:d,timing:m})=>{const g=hh(),y=new Uint8Array(d.length*4);for(let x=0;x<d.length;x++)y[x*4+c]=d[x];return fw.webglUtils.renderImageData(o,y,a,l,n,e,1<<3-c),m+=hh()-g,--f.requests===0&&(f.idleTimer=setTimeout(()=>{kZ(u)},aq)),{timing:m}})}function cq(n){n._warm||(fw.webgl.isSupported(n),n._warm=!0)}const uq=fw.webglUtils.resizeWebGLCanvasWithoutClearing,Rd={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048,useWorker:!0},fq=new ht;function wd(){return(self.performance||Date).now()}const KN=Object.create(null);function N4(n,e){n=pq({},n);const t=wd(),{defaultFontURL:r}=Rd,i=[];if(r&&i.push({label:"default",src:QN(r)}),n.font&&i.push({label:"user",src:QN(n.font)}),n.font=i,n.text=""+n.text,n.sdfGlyphSize=n.sdfGlyphSize||Rd.sdfGlyphSize,n.unicodeFontsURL=n.unicodeFontsURL||Rd.unicodeFontsURL,n.colorRanges!=null){let m={};for(let g in n.colorRanges)if(n.colorRanges.hasOwnProperty(g)){let y=n.colorRanges[g];typeof y!="number"&&(y=fq.set(y).getHex()),m[g]=y}n.colorRanges=m}Object.freeze(n);const{textureWidth:s,sdfExponent:o}=Rd,{sdfGlyphSize:a}=n,l=s/a*4;let c=KN[a];if(!c){const m=document.createElement("canvas");m.width=s,m.height=a*256/l,c=KN[a]={glyphCount:0,sdfGlyphSize:a,sdfCanvas:m,sdfTexture:new Sn(m,void 0,void 0,void 0,un,un),contextLost:!1,glyphsByFont:new Map},c.sdfTexture.generateMipmaps=!1,hq(c)}const{sdfTexture:u,sdfCanvas:f}=c;F4(n).then(m=>{const{glyphIds:g,glyphFontIndices:y,fontData:x,glyphPositions:v,fontSize:A,timings:w}=m,S=[],M=new Float32Array(g.length*4);let b=0,R=0;const P=wd(),C=x.map(U=>{let z=c.glyphsByFont.get(U.src);return z||c.glyphsByFont.set(U.src,z=new Map),z});g.forEach((U,z)=>{const O=y[z],{src:ie,unitsPerEm:X}=x[O];let K=C[O].get(U);if(!K){const{path:ne,pathBounds:fe}=m.glyphData[ie][U],pe=Math.max(fe[2]-fe[0],fe[3]-fe[1])/a*(Rd.sdfMargin*a+.5),ge=c.glyphCount++,Ce=[fe[0]-pe,fe[1]-pe,fe[2]+pe,fe[3]+pe];C[O].set(U,K={path:ne,atlasIndex:ge,sdfViewBox:Ce}),S.push(K)}const{sdfViewBox:W}=K,V=v[R++],Q=v[R++],q=A/X;M[b++]=V+W[0]*q,M[b++]=Q+W[1]*q,M[b++]=V+W[2]*q,M[b++]=Q+W[3]*q,g[z]=K.atlasIndex}),w.quads=(w.quads||0)+(wd()-P);const B=wd();w.sdf={};const H=f.height,k=Math.ceil(c.glyphCount/l),$=Math.pow(2,Math.ceil(Math.log2(k*a)));$>H&&(console.info(`Increasing SDF texture size ${H}->${$}`),uq(f,s,$),u.dispose()),Promise.all(S.map(U=>D4(U,c,n.gpuAccelerateSDF).then(({timing:z})=>{w.sdf[U.atlasIndex]=z}))).then(()=>{S.length&&!c.contextLost&&(U4(c),u.needsUpdate=!0),w.sdfTotal=wd()-B,w.total=wd()-t,e(Object.freeze({parameters:n,sdfTexture:u,sdfGlyphSize:a,sdfExponent:o,glyphBounds:M,glyphAtlasIndices:g,glyphColors:m.glyphColors,caretPositions:m.caretPositions,chunkedBounds:m.chunkedBounds,ascender:m.ascender,descender:m.descender,lineHeight:m.lineHeight,capHeight:m.capHeight,xHeight:m.xHeight,topBaseline:m.topBaseline,blockBounds:m.blockBounds,visibleBounds:m.visibleBounds,timings:m.timings}))})}),Promise.resolve().then(()=>{c.contextLost||cq(f)})}function D4({path:n,atlasIndex:e,sdfViewBox:t},{sdfGlyphSize:r,sdfCanvas:i,contextLost:s},o){if(s)return Promise.resolve({timing:-1});const{textureWidth:a,sdfExponent:l}=Rd,c=Math.max(t[2]-t[0],t[3]-t[1]),u=Math.floor(e/4),f=u%(a/r)*r,d=Math.floor(u/(a/r))*r,m=e%4;return rq(r,r,n,t,c,l,i,f,d,m,o)}function hq(n){const e=n.sdfCanvas;e.addEventListener("webglcontextlost",t=>{console.log("Context Lost",t),t.preventDefault(),n.contextLost=!0}),e.addEventListener("webglcontextrestored",t=>{console.log("Context Restored",t),n.contextLost=!1;const r=[];n.glyphsByFont.forEach(i=>{i.forEach(s=>{r.push(D4(s,n,!0))})}),Promise.all(r).then(()=>{U4(n),n.sdfTexture.needsUpdate=!0})})}function dq({font:n,characters:e,sdfGlyphSize:t},r){let i=Array.isArray(e)?e.join(`
`):""+e;N4({font:n,sdfGlyphSize:t,text:i},r)}function pq(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}let p1;function QN(n){return p1||(p1=typeof document>"u"?{}:document.createElement("a")),p1.href=n,p1.href}function U4(n){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:t}=n,{width:r,height:i}=e,s=n.sdfCanvas.getContext("webgl");let o=t.image.data;(!o||o.length!==r*i*4)&&(o=new Uint8Array(r*i*4),t.image={width:r,height:i,data:o},t.flipY=!1,t.isDataTexture=!0),s.readPixels(0,0,r,i,s.RGBA,s.UNSIGNED_BYTE,o)}}const mq=Gm({name:"Typesetter",dependencies:[nq,tq,zZ],init(n,e,t){return n(e,t())}}),F4=Gm({name:"Typesetter",dependencies:[mq],init(n){return function(e){return new Promise(t=>{n.typeset(e,t)})}},getTransferables(n){const e=[];for(let t in n)n[t]&&n[t].buffer&&e.push(n[t].buffer);return e}});F4.onMainThread;const jN={};function gq(n){let e=jN[n];return e||(e=jN[n]=new Wa(1,1,n,n).translate(.5,.5,0)),e}const vq="aTroikaGlyphBounds",YN="aTroikaGlyphIndex",yq="aTroikaGlyphColor";class xq extends eR{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new si,this.boundingBox=new Br}computeBoundingSphere(){}computeBoundingBox(){}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let t=gq(e);["position","normal","uv"].forEach(r=>{this.attributes[r]=t.attributes[r].clone()}),this.setIndex(t.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,t,r,i,s){this.updateAttributeData(vq,e,4),this.updateAttributeData(YN,t,1),this.updateAttributeData(yq,s,3),this._blockBounds=r,this._chunkedBounds=i,this.instanceCount=t.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:t,boundingBox:r}=this;if(t){const{PI:i,floor:s,min:o,max:a,sin:l,cos:c}=Math,u=i/2,f=i*2,d=Math.abs(t),m=e[0]/d,g=e[2]/d,y=s((m+u)/f)!==s((g+u)/f)?-d:o(l(m)*d,l(g)*d),x=s((m-u)/f)!==s((g-u)/f)?d:a(l(m)*d,l(g)*d),v=s((m+i)/f)!==s((g+i)/f)?d*2:a(d-c(m)*d,d-c(g)*d);r.min.set(y,e[1],t<0?-v:0),r.max.set(x,e[3],t<0?0:v)}else r.min.set(e[0],e[1],0),r.max.set(e[2],e[3],0);r.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let t=this.getAttribute(YN).count,r=this._chunkedBounds;if(r)for(let i=r.length;i--;){t=r[i].end;let s=r[i].rect;if(s[1]<e.w&&s[3]>e.y&&s[0]<e.z&&s[2]>e.x)break}this.instanceCount=t}updateAttributeData(e,t,r){const i=this.getAttribute(e);t?i&&i.array.length===t.length?(i.array.set(t),i.needsUpdate=!0):(this.setAttribute(e,new Au(t,r)),delete this._maxInstanceCount,this.dispose()):i&&this.deleteAttribute(e)}}const Aq=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,_q=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,wq=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,Eq=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function Sq(n){const e=AT(n,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Ge},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new wn(0,0,0,0)},uTroikaClipRect:{value:new wn(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Ge},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new ht},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new tn},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:Aq,vertexTransform:_q,fragmentDefs:wq,fragmentColorTransform:Eq,customRewriter({vertexShader:t,fragmentShader:r}){let i=/\buniform\s+vec3\s+diffuse\b/;return i.test(r)&&(r=r.replace(i,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),i.test(t)||(t=t.replace(I4,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:t,fragmentShader:r}}});return e.transparent=!0,e.forceSinglePass=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const pR=new Ni({color:16777215,side:di,transparent:!0}),ZN=8421504,qN=new Bt,m1=new Y,qS=new Y,Gg=[],bq=new Y,$S="+x+y";function $N(n){return Array.isArray(n)?n[0]:n}let O4=()=>{const n=new On(new Wa(1,1),pR);return O4=()=>n,n},k4=()=>{const n=new On(new Wa(1,1,32,1),pR);return k4=()=>n,n};const Mq={type:"syncstart"},Tq={type:"synccomplete"},G4=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],Cq=G4.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let z4=class extends On{constructor(){const e=new xq;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=ZN,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=$S,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(Mq),N4({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},t=>{this._isSyncing=!1,this._textRenderInfo=t,this.geometry.updateGlyphs(t.glyphBounds,t.glyphAtlasIndices,t.blockBounds,t.chunkedBounds,t.glyphColors);const r=this._queuedSyncs;r&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{r.forEach(i=>i&&i())})),this.dispatchEvent(Tq),e&&e()})))}onBeforeRender(e,t,r,i,s,o){this.sync(),s.isTroikaTextMaterial&&this._prepareForRender(s)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(e){return Sq(e)}get material(){let e=this._derivedMaterial;const t=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=pR.clone());if((!e||!e.isDerivedFrom(t))&&(e=this._derivedMaterial=this.createDerivedMaterial(t),t.addEventListener("dispose",function r(){t.removeEventListener("dispose",r),e.dispose()})),this.hasOutline()){let r=e._outlineMtl;return r||(r=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),r.isTextOutlineMaterial=!0,r.depthWrite=!1,r.map=null,e.addEventListener("dispose",function i(){e.removeEventListener("dispose",i),r.dispose()})),[r,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return $N(this.material).getDepthMaterial()}set customDepthMaterial(e){}get customDistanceMaterial(){return $N(this.material).getDistanceMaterial()}set customDistanceMaterial(e){}_prepareForRender(e){const t=e.isTextOutlineMaterial,r=e.uniforms,i=this.textRenderInfo;if(i){const{sdfTexture:a,blockBounds:l}=i;r.uTroikaSDFTexture.value=a,r.uTroikaSDFTextureSize.value.set(a.image.width,a.image.height),r.uTroikaSDFGlyphSize.value=i.sdfGlyphSize,r.uTroikaSDFExponent.value=i.sdfExponent,r.uTroikaTotalBounds.value.fromArray(l),r.uTroikaUseGlyphColors.value=!t&&!!i.glyphColors;let c=0,u=0,f=0,d,m,g,y=0,x=0;if(t){let{outlineWidth:A,outlineOffsetX:w,outlineOffsetY:S,outlineBlur:M,outlineOpacity:b}=this;c=this._parsePercent(A)||0,u=Math.max(0,this._parsePercent(M)||0),d=b,y=this._parsePercent(w)||0,x=this._parsePercent(S)||0}else f=Math.max(0,this._parsePercent(this.strokeWidth)||0),f&&(g=this.strokeColor,r.uTroikaStrokeColor.value.set(g??ZN),m=this.strokeOpacity,m==null&&(m=1)),d=this.fillOpacity;r.uTroikaEdgeOffset.value=c,r.uTroikaPositionOffset.value.set(y,x),r.uTroikaBlurRadius.value=u,r.uTroikaStrokeWidth.value=f,r.uTroikaStrokeOpacity.value=m,r.uTroikaFillOpacity.value=d??1,r.uTroikaCurveRadius.value=this.curveRadius||0;let v=this.clipRect;if(v&&Array.isArray(v)&&v.length===4)r.uTroikaClipRect.value.fromArray(v);else{const A=(this.fontSize||.1)*100;r.uTroikaClipRect.value.set(l[0]-A,l[1]-A,l[2]+A,l[3]+A)}this.geometry.applyClipRect(r.uTroikaClipRect.value)}r.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const s=t?this.outlineColor||0:this.color;if(s==null)delete e.color;else{const a=e.hasOwnProperty("color")?e.color:e.color=new ht;(s!==a._input||typeof s=="object")&&a.set(a._input=s)}let o=this.orientation||$S;if(o!==e._orientation){let a=r.uTroikaOrient.value;o=o.replace(/[^-+xyz]/g,"");let l=o!==$S&&o.match(/^([-+])([xyz])([-+])([xyz])$/);if(l){let[,c,u,f,d]=l;m1.set(0,0,0)[u]=c==="-"?1:-1,qS.set(0,0,0)[d]=f==="-"?-1:1,qN.lookAt(bq,m1.cross(qS),qS),a.setFromMatrix4(qN)}else a.identity();e._orientation=o}}_parsePercent(e){if(typeof e=="string"){let t=e.match(/^(-?[\d.]+)%$/),r=t?parseFloat(t[1]):NaN;e=(isNaN(r)?0:r/100)*this.fontSize}return e}localPositionToTextCoords(e,t=new Ge){t.copy(e);const r=this.curveRadius;return r&&(t.x=Math.atan2(e.x,Math.abs(r)-Math.abs(e.z))*Math.abs(r)),t}worldPositionToTextCoords(e,t=new Ge){return m1.copy(e),this.localPositionToTextCoords(this.worldToLocal(m1),t)}raycast(e,t){const{textRenderInfo:r,curveRadius:i}=this;if(r){const s=r.blockBounds,o=i?k4():O4(),a=o.geometry,{position:l,uv:c}=a.attributes;for(let u=0;u<c.count;u++){let f=s[0]+c.getX(u)*(s[2]-s[0]);const d=s[1]+c.getY(u)*(s[3]-s[1]);let m=0;i&&(m=i-Math.cos(f/i)*i,f=Math.sin(f/i)*i),l.setXYZ(u,f,d,m)}a.boundingSphere=this.geometry.boundingSphere,a.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,Gg.length=0,o.raycast(e,Gg);for(let u=0;u<Gg.length;u++)Gg[u].object=this,t.push(Gg[u])}}copy(e){const t=this.geometry;return super.copy(e),this.geometry=t,Cq.forEach(r=>{this[r]=e[r]}),this}clone(){return new this.constructor().copy(this)}};G4.forEach(n=>{const e="_private_"+n;Object.defineProperty(z4.prototype,n,{get(){return this[e]},set(t){t!==this[e]&&(this[e]=t,this._needsSync=!0)}})});new Br;new ht;const Bd=te.forwardRef(({sdfGlyphSize:n=64,anchorX:e="center",anchorY:t="middle",font:r,fontSize:i=1,children:s,characters:o,onSync:a,...l},c)=>{const u=$n(({invalidate:g})=>g),[f]=te.useState(()=>new z4),[d,m]=te.useMemo(()=>{const g=[];let y="";return te.Children.forEach(s,x=>{typeof x=="string"||typeof x=="number"?y+=x:g.push(x)}),[g,y]},[s]);return qk(()=>new Promise(g=>dq({font:r,characters:o},g)),["troika-text",r,o]),te.useLayoutEffect(()=>void f.sync(()=>{u(),a&&a(f)})),te.useEffect(()=>()=>f.dispose(),[f]),te.createElement("primitive",oa({object:f,ref:c,font:r,text:m,anchorX:e,anchorY:t,fontSize:i,sdfGlyphSize:n},l),d)});let g1=null,H4="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function V4(n=!0,e=!0,t){return r=>{t&&t(r),n&&(g1||(g1=new _Z),g1.setDecoderPath(typeof n=="string"?n:H4),r.setDRACOLoader(g1)),e&&r.setMeshoptDecoder(typeof YS=="function"?YS():YS)}}const To=(n,e,t,r)=>Xl(dR,n,V4(e,t,r));To.preload=(n,e,t,r)=>Xl.preload(dR,n,V4(e,t,r));To.clear=n=>Xl.clear(dR,n);To.setDecoderPath=n=>{H4=n};const Rq=te.forwardRef(({makeDefault:n,camera:e,regress:t,domElement:r,enableDamping:i=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:l,...c},u)=>{const f=$n(b=>b.invalidate),d=$n(b=>b.camera),m=$n(b=>b.gl),g=$n(b=>b.events),y=$n(b=>b.setEvents),x=$n(b=>b.set),v=$n(b=>b.get),A=$n(b=>b.performance),w=e||d,S=r||g.connected||m.domElement,M=te.useMemo(()=>new FY(w),[w]);return fa(()=>{M.enabled&&M.update()},-1),te.useEffect(()=>(s&&M.connect(s===!0?S:s),M.connect(S),()=>void M.dispose()),[s,S,t,M,f]),te.useEffect(()=>{const b=C=>{f(),t&&A.regress(),o&&o(C)},R=C=>{a&&a(C)},P=C=>{l&&l(C)};return M.addEventListener("change",b),M.addEventListener("start",R),M.addEventListener("end",P),()=>{M.removeEventListener("start",R),M.removeEventListener("end",P),M.removeEventListener("change",b)}},[o,a,l,M,f,y]),te.useEffect(()=>{if(n){const b=v().controls;return x({controls:M}),()=>x({controls:b})}},[n,M]),te.createElement("primitive",oa({ref:u,object:M,enableDamping:i},c))});function Bq(n,e){const t=te.useRef(),[r]=te.useState(()=>e?e instanceof gn?{current:e}:e:t),[i]=te.useState(()=>new sR(void 0));te.useLayoutEffect(()=>{e&&(r.current=e instanceof gn?e:e.current),i._root=r.current});const s=te.useRef({}),o=te.useMemo(()=>{const a={};return n.forEach(l=>Object.defineProperty(a,l.name,{enumerable:!0,get(){if(r.current)return s.current[l.name]||(s.current[l.name]=i.clipAction(l,r.current))},configurable:!0})),{ref:r,clips:n,actions:a,names:n.map(l=>l.name),mixer:i}},[n]);return fa((a,l)=>i.update(l)),te.useEffect(()=>{const a=r.current;return()=>{s.current={},i.stopAllAction(),Object.values(o.actions).forEach(l=>{a&&i.uncacheAction(l,a)})}},[n]),o}var W4={exports:{}},Pq="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Iq=Pq,Lq=Iq;function X4(){}function J4(){}J4.resetWarningCache=X4;var Nq=function(){function n(r,i,s,o,a,l){if(l!==Lq){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:J4,resetWarningCache:X4};return t.PropTypes=t,t};W4.exports=Nq();var Dq=W4.exports;const zg=dC(Dq);zg.func.isRequired,zg.arrayOf(zg.oneOfType([zg.element,zg.func])).isRequired;const e3=(n,e)=>{"updateRanges"in n?n.updateRanges[0]=e:n.updateRange=e},Uq=3e3,Fq=3001;function Oq(n){return typeof n=="function"}const t3=new Bt,n3=new Bt,v1=[],Hg=new On;class kq extends Da{constructor(){super(),this.color=new ht("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var e;return(e=this.instance.current)==null?void 0:e.geometry}raycast(e,t){const r=this.instance.current;if(!r||!r.geometry||!r.material)return;Hg.geometry=r.geometry;const i=r.matrixWorld,s=r.userData.instances.indexOf(this.instanceKey);if(!(s===-1||s>r.count)){r.getMatrixAt(s,t3),n3.multiplyMatrices(i,t3),Hg.matrixWorld=n3,r.material instanceof ur?Hg.material.side=r.material.side:Hg.material.side=r.material[0].side,Hg.raycast(e,v1);for(let o=0,a=v1.length;o<a;o++){const l=v1[o];l.instanceId=s,l.object=this,t.push(l)}v1.length=0}}}const K4=te.createContext(null),r3=new Bt,i3=new Bt,Gq=new Bt,s3=new Y,o3=new Rr,a3=new Y,zq=n=>n.isInstancedBufferAttribute,Q4=te.forwardRef(({context:n,children:e,...t},r)=>{te.useMemo(()=>uw({PositionMesh:kq}),[]);const i=te.useRef();te.useImperativeHandle(r,()=>i.current,[]);const{subscribe:s,getParent:o}=te.useContext(n||K4);return te.useLayoutEffect(()=>s(i),[]),te.createElement("positionMesh",oa({instance:o(),instanceKey:i,ref:i},t),e)}),Hq=te.forwardRef(({context:n,children:e,range:t,limit:r=1e3,frames:i=1/0,...s},o)=>{const[{localContext:a,instance:l}]=te.useState(()=>{const A=te.createContext(null);return{localContext:A,instance:te.forwardRef((w,S)=>te.createElement(Q4,oa({context:A},w,{ref:S})))}}),c=te.useRef(null);te.useImperativeHandle(o,()=>c.current,[]);const[u,f]=te.useState([]),[[d,m]]=te.useState(()=>{const A=new Float32Array(r*16);for(let w=0;w<r;w++)Gq.identity().toArray(A,w*16);return[A,new Float32Array([...new Array(r*3)].map(()=>1))]});te.useEffect(()=>{c.current.instanceMatrix.needsUpdate=!0});let g=0,y=0;const x=te.useRef([]);te.useLayoutEffect(()=>{x.current=Object.entries(c.current.geometry.attributes).filter(([A,w])=>zq(w))}),fa(()=>{if(i===1/0||g<i){c.current.updateMatrix(),c.current.updateMatrixWorld(),r3.copy(c.current.matrixWorld).invert(),y=Math.min(r,t!==void 0?t:r,u.length),c.current.count=y,e3(c.current.instanceMatrix,{offset:0,count:y*16}),e3(c.current.instanceColor,{offset:0,count:y*3});for(let A=0;A<u.length;A++){const w=u[A].current;w.matrixWorld.decompose(s3,o3,a3),i3.compose(s3,o3,a3).premultiply(r3),i3.toArray(d,A*16),c.current.instanceMatrix.needsUpdate=!0,w.color.toArray(m,A*3),c.current.instanceColor.needsUpdate=!0}g++}});const v=te.useMemo(()=>({getParent:()=>c,subscribe:A=>(f(w=>[...w,A]),()=>f(w=>w.filter(S=>S.current!==A.current)))}),[]);return te.createElement("instancedMesh",oa({userData:{instances:u,limit:r,frames:i},matrixAutoUpdate:!1,ref:c,args:[null,null,0],raycast:()=>null},s),te.createElement("instancedBufferAttribute",{attach:"instanceMatrix",count:d.length/16,array:d,itemSize:16,usage:qM}),te.createElement("instancedBufferAttribute",{attach:"instanceColor",count:m.length/3,array:m,itemSize:3,usage:qM}),Oq(e)?te.createElement(a.Provider,{value:v},e(l)):n?te.createElement(n.Provider,{value:v},e):te.createElement(K4.Provider,{value:v},e))}),Vq=({focus:n=0,size:e=25,samples:t=10}={})=>`
#define PENUMBRA_FILTER_SIZE float(${e})
#define RGB_NOISE_FUNCTION(uv) (randRGB(uv))
vec3 randRGB(vec2 uv) {
  return vec3(
    fract(sin(dot(uv, vec2(12.75613, 38.12123))) * 13234.76575),
    fract(sin(dot(uv, vec2(19.45531, 58.46547))) * 43678.23431),
    fract(sin(dot(uv, vec2(23.67817, 78.23121))) * 93567.23423)
  );
}

vec3 lowPassRandRGB(vec2 uv) {
  // 3x3 convolution (average)
  // can be implemented as separable with an extra buffer for a total of 6 samples instead of 9
  vec3 result = vec3(0);
  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, -1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0,  0.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(-1.0, +1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, -1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0,  0.0));
  result += RGB_NOISE_FUNCTION(uv + vec2( 0.0, +1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, -1.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0,  0.0));
  result += RGB_NOISE_FUNCTION(uv + vec2(+1.0, +1.0));
  result *= 0.111111111; // 1.0 / 9.0
  return result;
}
vec3 highPassRandRGB(vec2 uv) {
  // by subtracting the low-pass signal from the original signal, we're being left with the high-pass signal
  // hp(x) = x - lp(x)
  return RGB_NOISE_FUNCTION(uv) - lowPassRandRGB(uv) + 0.5;
}


vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}
float penumbraSize( const in float zReceiver, const in float zBlocker ) { // Parallel plane estimation
  return (zReceiver - zBlocker) / zBlocker;
}
float findBlocker(sampler2D shadowMap, vec2 uv, float compare, float angle) {
  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);
  float blockerDepthSum = float(${n});
  float blockers = 0.0;

  int j = 0;
  vec2 offset = vec2(0.);
  float depth = 0.;

  #pragma unroll_loop_start
  for(int i = 0; i < ${t}; i ++) {
    offset = (vogelDiskSample(j, ${t}, angle) * texelSize) * 2.0 * PENUMBRA_FILTER_SIZE;
    depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset));
    if (depth < compare) {
      blockerDepthSum += depth;
      blockers++;
    }
    j++;
  }
  #pragma unroll_loop_end

  if (blockers > 0.0) {
    return blockerDepthSum / blockers;
  }
  return -1.0;
}

        
float vogelFilter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius, float angle) {
  float texelSize = 1.0 / float(textureSize(shadowMap, 0).x);
  float shadow = 0.0f;
  int j = 0;
  vec2 vogelSample = vec2(0.0);
  vec2 offset = vec2(0.0);
  #pragma unroll_loop_start
  for (int i = 0; i < ${t}; i++) {
    vogelSample = vogelDiskSample(j, ${t}, angle) * texelSize;
    offset = vogelSample * (1.0 + filterRadius * float(${e}));
    shadow += step( zReceiver, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    j++;
  }
  #pragma unroll_loop_end
  return shadow * 1.0 / ${t}.0;
}

float PCSS (sampler2D shadowMap, vec4 coords) {
  vec2 uv = coords.xy;
  float zReceiver = coords.z; // Assumed to be eye-space z in this code
  float angle = highPassRandRGB(gl_FragCoord.xy).r * PI2;
  float avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver, angle);
  if (avgBlockerDepth == -1.0) {
    return 1.0;
  }
  float penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);
  return vogelFilter(shadowMap, uv, zReceiver, 1.25 * penumbraRatio, angle);
}`;function l3(n,e,t){e.traverse(r=>{r.material&&(n.properties.remove(r.material),r.material.dispose==null||r.material.dispose())}),n.info.programs.length=0,n.compile(e,t)}function Wq({focus:n=0,samples:e=10,size:t=25}){const r=$n(o=>o.gl),i=$n(o=>o.scene),s=$n(o=>o.camera);return te.useEffect(()=>{const o=Jt.shadowmap_pars_fragment;return Jt.shadowmap_pars_fragment=Jt.shadowmap_pars_fragment.replace("#ifdef USE_SHADOWMAP",`#ifdef USE_SHADOWMAP
`+Vq({size:t,samples:e,focus:n})).replace("#if defined( SHADOWMAP_TYPE_PCF )",`
return PCSS(shadowMap, shadowCoord);
#if defined( SHADOWMAP_TYPE_PCF )`),l3(r,i,s),()=>{Jt.shadowmap_pars_fragment=o,l3(r,i,s)}},[n,t,e]),null}const j4=(n,e,t)=>{let r;switch(n){case Gr:r=new Uint8ClampedArray(e*t*4);break;case Jr:r=new Uint16Array(e*t*4);break;case qo:r=new Uint32Array(e*t*4);break;case f2:r=new Int8Array(e*t*4);break;case h2:r=new Int16Array(e*t*4);break;case D_:r=new Int32Array(e*t*4);break;case Cr:r=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return r};let y1;const Xq=(n,e,t,r)=>{if(y1!==void 0)return y1;const i=new hr(1,1,r);e.setRenderTarget(i);const s=new On(new Wa,new Ni({color:16777215}));e.render(s,t),e.setRenderTarget(null);const o=j4(n,i.width,i.height);return e.readRenderTargetPixels(i,0,0,i.width,i.height,o),i.dispose(),s.geometry.dispose(),s.material.dispose(),y1=o[0]!==0,y1};class mR{constructor(e){Ee(this,"_renderer");Ee(this,"_rendererIsDisposable",!1);Ee(this,"_material");Ee(this,"_scene");Ee(this,"_camera");Ee(this,"_quad");Ee(this,"_renderTarget");Ee(this,"_width");Ee(this,"_height");Ee(this,"_type");Ee(this,"_colorSpace");Ee(this,"_supportsReadPixels",!0);Ee(this,"render",()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)});var r,i,s,o,a,l,c,u,f,d,m,g,y,x,v,A;this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const t={format:Ur,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((r=e.renderTargetOptions)==null?void 0:r.anisotropy)!==void 0?(i=e.renderTargetOptions)==null?void 0:i.anisotropy:1,generateMipmaps:((s=e.renderTargetOptions)==null?void 0:s.generateMipmaps)!==void 0?(o=e.renderTargetOptions)==null?void 0:o.generateMipmaps:!1,magFilter:((a=e.renderTargetOptions)==null?void 0:a.magFilter)!==void 0?(l=e.renderTargetOptions)==null?void 0:l.magFilter:un,minFilter:((c=e.renderTargetOptions)==null?void 0:c.minFilter)!==void 0?(u=e.renderTargetOptions)==null?void 0:u.minFilter:un,samples:((f=e.renderTargetOptions)==null?void 0:f.samples)!==void 0?(d=e.renderTargetOptions)==null?void 0:d.samples:void 0,wrapS:((m=e.renderTargetOptions)==null?void 0:m.wrapS)!==void 0?(g=e.renderTargetOptions)==null?void 0:g.wrapS:Qn,wrapT:((y=e.renderTargetOptions)==null?void 0:y.wrapT)!==void 0?(x=e.renderTargetOptions)==null?void 0:x.wrapT:Qn};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=mR.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new yu,this._camera=new ra,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!Xq(this._type,this._renderer,this._camera,t)){let w;switch(this._type){case Jr:w=this._renderer.extensions.has("EXT_color_buffer_float")?Cr:void 0;break}w!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Cr}`),this._type=w):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new On(new Wa,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new hr(this.width,this.height,t),this._renderTarget.texture.mapping=((v=e.renderTargetOptions)==null?void 0:v.mapping)!==void 0?(A=e.renderTargetOptions)==null?void 0:A.mapping:pu}static instantiateRenderer(){const e=new V_;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=j4(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new au(this.toArray(),this.width,this.height,Ur,this._type,(e==null?void 0:e.mapping)||pu,(e==null?void 0:e.wrapS)||Qn,(e==null?void 0:e.wrapT)||Qn,(e==null?void 0:e.magFilter)||un,(e==null?void 0:e.minFilter)||un,(e==null?void 0:e.anisotropy)||1,is);return t.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof Pr&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof Sn&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof Sn&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class Y4 extends Error{}class Z4 extends Error{}const Vg=(n,e,t)=>{const r=new RegExp(`${e}="([^"]*)"`,"i").exec(n);if(r)return r[1];const i=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(n);if(i){const s=i[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return s&&s.length===3?s.map(o=>o.replace(/<\/?rdf:li>/g,"")):i[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},Jq=n=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(n):e=n.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const r=e.indexOf("x:xmpmeta>",t),i=e.slice(t,r+10);try{const s=Vg(i,"hdrgm:GainMapMin","0"),o=Vg(i,"hdrgm:GainMapMax"),a=Vg(i,"hdrgm:Gamma","1"),l=Vg(i,"hdrgm:OffsetSDR","0.015625"),c=Vg(i,"hdrgm:OffsetHDR","0.015625"),u=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(i),f=u?u[1]:"0",d=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(i);if(!d)throw new Error("Incomplete gainmap metadata");const m=d[1];return{gainMapMin:Array.isArray(s)?s.map(g=>parseFloat(g)):[parseFloat(s),parseFloat(s),parseFloat(s)],gainMapMax:Array.isArray(o)?o.map(g=>parseFloat(g)):[parseFloat(o),parseFloat(o),parseFloat(o)],gamma:Array.isArray(a)?a.map(g=>parseFloat(g)):[parseFloat(a),parseFloat(a),parseFloat(a)],offsetSdr:Array.isArray(l)?l.map(g=>parseFloat(g)):[parseFloat(l),parseFloat(l),parseFloat(l)],offsetHdr:Array.isArray(c)?c.map(g=>parseFloat(g)):[parseFloat(c),parseFloat(c),parseFloat(c)],hdrCapacityMin:parseFloat(f),hdrCapacityMax:parseFloat(m)}}catch{}t=e.indexOf("<x:xmpmeta",r)}};class Kq{constructor(e){Ee(this,"options");this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,r)=>{const i=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){r(new Error("Not a valid jpeg"));return}const o=s.byteLength;let a=2,l=0,c;for(;a<o;){if(++l>250){r(new Error(`Found no marker after ${l} loops `));return}if(s.getUint8(a)!==255){r(new Error(`Not a valid marker at offset 0x${a.toString(16)}, found: 0x${s.getUint8(a).toString(16)}`));return}if(c=s.getUint8(a+1),i&&console.log(`Marker: ${c.toString(16)}`),c===226){i&&console.log("Found APP2 marker (0xffe2)");const u=a+4;if(s.getUint32(u)===1297106432){const f=u+4;let d;if(s.getUint16(f)===18761)d=!1;else if(s.getUint16(f)===19789)d=!0;else{r(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(f+2,!d)!==42){r(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const m=s.getUint32(f+4,!d);if(m<8){r(new Error("Not valid TIFF data! (First offset less than 8)"));return}const g=f+m,y=s.getUint16(g,!d),x=g+2;let v=0;for(let M=x;M<x+12*y;M+=12)s.getUint16(M,!d)===45057&&(v=s.getUint32(M+8,!d));const A=4,w=g+2+y*12+A,S=[];for(let M=w;M<w+v*16;M+=16){const b={MPType:s.getUint32(M,!d),size:s.getUint32(M+4,!d),dataOffset:s.getUint32(M+8,!d),dependantImages:s.getUint32(M+12,!d),start:-1,end:-1,isFII:!1};b.dataOffset?(b.start=f+b.dataOffset,b.isFII=!1):(b.start=0,b.isFII=!0),b.end=b.start+b.size,S.push(b)}if(this.options.extractNonFII&&S.length){const M=new Blob([s]),b=[];for(const R of S){if(R.isFII&&!this.options.extractFII)continue;const P=M.slice(R.start,R.end+1,"image/jpeg");b.push(P)}t(b)}}}a+=2+s.getUint16(a+2)}})}}const Qq=async n=>{const e=Jq(n);if(!e)throw new Z4("Gain map XMP metadata not found");const r=await new Kq({extractFII:!0,extractNonFII:!0}).extract(n);if(r.length!==2)throw new Y4("Gain map recovery image not found");return{sdr:new Uint8Array(await r[0].arrayBuffer()),gainMap:new Uint8Array(await r[1].arrayBuffer()),metadata:e}},c3=n=>new Promise((e,t)=>{const r=document.createElement("img");r.onload=()=>{e(r)},r.onerror=i=>{t(i)},r.src=URL.createObjectURL(n)});class jq extends Ai{constructor(t,r){super(r);Ee(this,"_renderer");Ee(this,"_renderTargetOptions");Ee(this,"_internalLoadingManager");Ee(this,"_config");this._config=t,t.renderer&&(this._renderer=t.renderer),this._internalLoadingManager=new lw}setRenderer(t){return this._renderer=t,this}setRenderTargetOptions(t){return this._renderTargetOptions=t,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const t=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Sn,sdr:new Sn});return this._config.createQuadRenderer({width:16,height:16,type:Jr,colorSpace:is,material:t,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(t,r,i){const s=r?new Blob([r],{type:"image/jpeg"}):void 0,o=new Blob([t],{type:"image/jpeg"});let a,l,c=!1;if(typeof createImageBitmap>"u"){const u=await Promise.all([s?c3(s):Promise.resolve(void 0),c3(o)]);l=u[0],a=u[1],c=i==="flipY"}else{const u=await Promise.all([s?createImageBitmap(s,{imageOrientation:i||"flipY"}):Promise.resolve(void 0),createImageBitmap(o,{imageOrientation:i||"flipY"})]);l=u[0],a=u[1]}return{sdrImage:a,gainMapImage:l,needsFlip:c}}createTextures(t,r,i){const s=new Sn(r||new ImageData(2,2),pu,Qn,Qn,un,bM,Ur,Gr,1,is);s.flipY=i,s.needsUpdate=!0;const o=new Sn(t,pu,Qn,Qn,un,bM,Ur,Gr,1,mn);return o.flipY=i,o.needsUpdate=!0,{gainMap:s,sdr:o}}updateQuadRenderer(t,r,i,s,o){t.width=r.width,t.height=r.height,t.material.gainMap=i,t.material.sdr=s,t.material.gainMapMin=o.gainMapMin,t.material.gainMapMax=o.gainMapMax,t.material.offsetHdr=o.offsetHdr,t.material.offsetSdr=o.offsetSdr,t.material.gamma=o.gamma,t.material.hdrCapacityMin=o.hdrCapacityMin,t.material.hdrCapacityMax=o.hdrCapacityMax,t.material.maxDisplayBoost=Math.pow(2,o.hdrCapacityMax),t.material.needsUpdate=!0}}const Yq=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,Zq=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class qq extends Pr{constructor({gamma:t,offsetHdr:r,offsetSdr:i,gainMapMin:s,gainMapMax:o,maxDisplayBoost:a,hdrCapacityMin:l,hdrCapacityMax:c,sdr:u,gainMap:f}){super({name:"GainMapDecoderMaterial",vertexShader:Yq,fragmentShader:Zq,uniforms:{sdr:{value:u},gainMap:{value:f},gamma:{value:new Y(1/t[0],1/t[1],1/t[2])},offsetHdr:{value:new Y().fromArray(r)},offsetSdr:{value:new Y().fromArray(i)},gainMapMin:{value:new Y().fromArray(s)},gainMapMax:{value:new Y().fromArray(o)},weightFactor:{value:(Math.log2(a)-l)/(c-l)}},blending:gi,depthTest:!1,depthWrite:!1});Ee(this,"_maxDisplayBoost");Ee(this,"_hdrCapacityMin");Ee(this,"_hdrCapacityMax");this._maxDisplayBoost=a,this._hdrCapacityMin=l,this._hdrCapacityMax=c,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(t){this.uniforms.sdr.value=t}get gainMap(){return this.uniforms.gainMap.value}set gainMap(t){this.uniforms.gainMap.value=t}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(t){this.uniforms.offsetHdr.value.fromArray(t)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(t){this.uniforms.offsetSdr.value.fromArray(t)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(t){this.uniforms.gainMapMin.value.fromArray(t)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(t){this.uniforms.gainMapMax.value.fromArray(t)}get gamma(){const t=this.uniforms.gamma.value;return[1/t.x,1/t.y,1/t.z]}set gamma(t){const r=this.uniforms.gamma.value;r.x=1/t[0],r.y=1/t[1],r.z=1/t[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(t){this._hdrCapacityMin=t,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(t){this._hdrCapacityMax=t,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(t){this._maxDisplayBoost=Math.max(1,Math.min(65504,t)),this.calculateWeight()}calculateWeight(){const t=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,t))}}class q4 extends jq{constructor(e,t){super({renderer:e,createMaterial:r=>new qq(r),createQuadRenderer:r=>new mR(r)},t)}async render(e,t,r,i){const{sdrImage:s,gainMapImage:o,needsFlip:a}=await this.processImages(r,i,"flipY"),{gainMap:l,sdr:c}=this.createTextures(s,o,a);this.updateQuadRenderer(e,s,l,c,t),e.render()}}class $q extends q4{load([e,t,r],i,s,o){const a=this.prepareQuadRenderer();let l,c,u;const f=async()=>{if(l&&c&&u){try{await this.render(a,u,l,c)}catch(C){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(r),typeof o=="function"&&o(C),a.disposeOnDemandRenderer();return}typeof i=="function"&&i(a),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(r),a.disposeOnDemandRenderer()}};let d=!0,m=0,g=0,y=!0,x=0,v=0,A=!0,w=0,S=0;const M=()=>{if(typeof s=="function"){const C=m+x+w,B=g+v+S,H=d&&y&&A;s(new ProgressEvent("progress",{lengthComputable:H,loaded:B,total:C}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(r);const b=new vi(this._internalLoadingManager);b.setResponseType("arraybuffer"),b.setRequestHeader(this.requestHeader),b.setPath(this.path),b.setWithCredentials(this.withCredentials),b.load(e,async C=>{if(typeof C=="string")throw new Error("Invalid sdr buffer");l=C,await f()},C=>{d=C.lengthComputable,g=C.loaded,m=C.total,M()},C=>{this.manager.itemError(e),typeof o=="function"&&o(C)});const R=new vi(this._internalLoadingManager);R.setResponseType("arraybuffer"),R.setRequestHeader(this.requestHeader),R.setPath(this.path),R.setWithCredentials(this.withCredentials),R.load(t,async C=>{if(typeof C=="string")throw new Error("Invalid gainmap buffer");c=C,await f()},C=>{y=C.lengthComputable,v=C.loaded,x=C.total,M()},C=>{this.manager.itemError(t),typeof o=="function"&&o(C)});const P=new vi(this._internalLoadingManager);return P.setRequestHeader(this.requestHeader),P.setPath(this.path),P.setWithCredentials(this.withCredentials),P.load(r,async C=>{if(typeof C!="string")throw new Error("Invalid metadata string");u=JSON.parse(C),await f()},C=>{A=C.lengthComputable,S=C.loaded,w=C.total,M()},C=>{this.manager.itemError(r),typeof o=="function"&&o(C)}),a}}class e$ extends q4{load(e,t,r,i){const s=this.prepareQuadRenderer(),o=new vi(this._internalLoadingManager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(this.withCredentials),this.manager.itemStart(e),o.load(e,async a=>{if(typeof a=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const l=new Uint8Array(a);let c,u,f;try{const d=await Qq(l);c=d.sdr,u=d.gainMap,f=d.metadata}catch(d){if(d instanceof Z4||d instanceof Y4)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),f={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},c=l;else throw d}try{await this.render(s,f,c.buffer,u==null?void 0:u.buffer)}catch(d){this.manager.itemError(e),typeof i=="function"&&i(d),s.disposeOnDemandRenderer();return}typeof t=="function"&&t(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},r,a=>{this.manager.itemError(e),typeof i=="function"&&i(a)}),s}}const rv={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},$4="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",pp=n=>Array.isArray(n),gR=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function hw({files:n=gR,path:e="",preset:t=void 0,encoding:r=void 0,extensions:i}={}){let s=null,o=!1;t&&(vR(t),n=rv[t],e=$4),o=pp(n);const{extension:a,isCubemap:l}=yR(n);if(s=xR(a),!s)throw new Error("useEnvironment: Unrecognized file extension: "+n);const c=$n(m=>m.gl);te.useLayoutEffect(()=>{if(a!=="webp"&&a!=="jpg"&&a!=="jpeg")return;function m(){Xl.clear(s,o?[n]:n)}c.domElement.addEventListener("webglcontextlost",m,{once:!0})},[n,c.domElement]);const u=Xl(s,o?[n]:n,m=>{(a==="webp"||a==="jpg"||a==="jpeg")&&m.setRenderer(c),m.setPath==null||m.setPath(e),i&&i(m)});let f=o?u[0]:u;if(a==="jpg"||a==="jpeg"||a==="webp"){var d;f=(d=f.renderTarget)==null?void 0:d.texture}return f.mapping=l?za:ym,"colorSpace"in f?f.colorSpace=r??l?"srgb":"srgb-linear":f.encoding=r??l?Fq:Uq,f}const t$={files:gR,path:"",preset:void 0,extensions:void 0};hw.preload=n=>{const e={...t$,...n};let{files:t,path:r=""}=e;const{preset:i,extensions:s}=e;i&&(vR(i),t=rv[i],r=$4);const{extension:o}=yR(t);if(o==="webp"||o==="jpg"||o==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const a=xR(o);if(!a)throw new Error("useEnvironment: Unrecognized file extension: "+t);Xl.preload(a,pp(t)?[t]:t,l=>{l.setPath==null||l.setPath(r),s&&s(l)})};const n$={files:gR,preset:void 0};hw.clear=n=>{const e={...n$,...n};let{files:t}=e;const{preset:r}=e;r&&(vR(r),t=rv[r]);const{extension:i}=yR(t),s=xR(i);if(!s)throw new Error("useEnvironment: Unrecognized file extension: "+t);Xl.clear(s,pp(t)?[t]:t)};function vR(n){if(!(n in rv))throw new Error("Preset must be one of: "+Object.keys(rv).join(", "))}function yR(n){var e;const t=pp(n)&&n.length===6,r=pp(n)&&n.length===3&&n.some(o=>o.endsWith("json")),i=pp(n)?n[0]:n;return{extension:t?"cube":r?"webp":i.startsWith("data:application/exr")?"exr":i.startsWith("data:application/hdr")?"hdr":i.startsWith("data:image/jpeg")?"jpg":(e=i.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:r}}function xR(n){return n==="cube"?Pk:n==="hdr"?xZ:n==="exr"?AZ:n==="jpg"||n==="jpeg"?e$:n==="webp"?$q:null}const r$=n=>n.current&&n.current.isScene,i$=n=>r$(n)?n.current:n;function AR(n,e,t,r,i={}){var s,o,a,l;i={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...i};const c=i$(e||t),u=c.background,f=c.environment,d={backgroundBlurriness:c.backgroundBlurriness,backgroundIntensity:c.backgroundIntensity,backgroundRotation:(s=(o=c.backgroundRotation)==null||o.clone==null?void 0:o.clone())!==null&&s!==void 0?s:[0,0,0],environmentIntensity:c.environmentIntensity,environmentRotation:(a=(l=c.environmentRotation)==null||l.clone==null?void 0:l.clone())!==null&&a!==void 0?a:[0,0,0]};return n!=="only"&&(c.environment=r),n&&(c.background=r),bc(c,i),()=>{n!=="only"&&(c.environment=f),n&&(c.background=u),bc(c,d)}}function _R({scene:n,background:e=!1,map:t,...r}){const i=$n(s=>s.scene);return te.useLayoutEffect(()=>{if(t)return AR(e,n,i,t,r)}),null}function eG({background:n=!1,scene:e,blur:t,backgroundBlurriness:r,backgroundIntensity:i,backgroundRotation:s,environmentIntensity:o,environmentRotation:a,...l}){const c=hw(l),u=$n(f=>f.scene);return te.useLayoutEffect(()=>AR(n,e,u,c,{backgroundBlurriness:t??r,backgroundIntensity:i,backgroundRotation:s,environmentIntensity:o,environmentRotation:a})),te.useEffect(()=>()=>{c.dispose()},[c]),null}function s$({children:n,near:e=.1,far:t=1e3,resolution:r=256,frames:i=1,map:s,background:o=!1,blur:a,backgroundBlurriness:l,backgroundIntensity:c,backgroundRotation:u,environmentIntensity:f,environmentRotation:d,scene:m,files:g,path:y,preset:x=void 0,extensions:v}){const A=$n(P=>P.gl),w=$n(P=>P.scene),S=te.useRef(null),[M]=te.useState(()=>new yu),b=te.useMemo(()=>{const P=new I2(r);return P.texture.type=Jr,P},[r]);te.useEffect(()=>()=>{b.dispose()},[b]),te.useLayoutEffect(()=>{if(i===1){const P=A.autoClear;A.autoClear=!0,S.current.update(A,M),A.autoClear=P}return AR(o,m,w,b.texture,{backgroundBlurriness:a??l,backgroundIntensity:c,backgroundRotation:u,environmentIntensity:f,environmentRotation:d})},[n,M,b.texture,m,w,o,i,A]);let R=1;return fa(()=>{if(i===1/0||R<i){const P=A.autoClear;A.autoClear=!0,S.current.update(A,M),A.autoClear=P,R++}}),te.createElement(te.Fragment,null,RQ(te.createElement(te.Fragment,null,n,te.createElement("cubeCamera",{ref:S,args:[e,t,b]}),g||x?te.createElement(eG,{background:!0,files:g,preset:x,path:y,extensions:v}):s?te.createElement(_R,{background:!0,map:s,extensions:v}):null),M))}function o$(n){var e,t,r,i;const s=hw(n),o=n.map||s;te.useMemo(()=>uw({GroundProjectedEnvImpl:bY}),[]),te.useEffect(()=>()=>{s.dispose()},[s]);const a=te.useMemo(()=>[o],[o]),l=(e=n.ground)==null?void 0:e.height,c=(t=n.ground)==null?void 0:t.radius,u=(r=(i=n.ground)==null?void 0:i.scale)!==null&&r!==void 0?r:1e3;return te.createElement(te.Fragment,null,te.createElement(_R,oa({},n,{map:o})),te.createElement("groundProjectedEnvImpl",{args:a,scale:u,height:l,radius:c}))}function a$(n){return n.ground?te.createElement(o$,n):n.map?te.createElement(_R,n):n.children?te.createElement(s$,n):te.createElement(eG,n)}const Va=Object.create(null);Va.open="0";Va.close="1";Va.ping="2";Va.pong="3";Va.message="4";Va.upgrade="5";Va.noop="6";const $1=Object.create(null);Object.keys(Va).forEach(n=>{$1[Va[n]]=n});const wT={type:"error",data:"parser error"},tG=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",nG=typeof ArrayBuffer=="function",rG=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,wR=({type:n,data:e},t,r)=>tG&&e instanceof Blob?t?r(e):u3(e,r):nG&&(e instanceof ArrayBuffer||rG(e))?t?r(e):u3(new Blob([e]),r):r(Va[n]+(e||"")),u3=(n,e)=>{const t=new FileReader;return t.onload=function(){const r=t.result.split(",")[1];e("b"+(r||""))},t.readAsDataURL(n)};function f3(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let eb;function l$(n,e){if(tG&&n.data instanceof Blob)return n.data.arrayBuffer().then(f3).then(e);if(nG&&(n.data instanceof ArrayBuffer||rG(n.data)))return e(f3(n.data));wR(n,!1,t=>{eb||(eb=new TextEncoder),e(eb.encode(t))})}const h3="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e0=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<h3.length;n++)e0[h3.charCodeAt(n)]=n;const c$=n=>{let e=n.length*.75,t=n.length,r,i=0,s,o,a,l;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);const c=new ArrayBuffer(e),u=new Uint8Array(c);for(r=0;r<t;r+=4)s=e0[n.charCodeAt(r)],o=e0[n.charCodeAt(r+1)],a=e0[n.charCodeAt(r+2)],l=e0[n.charCodeAt(r+3)],u[i++]=s<<2|o>>4,u[i++]=(o&15)<<4|a>>2,u[i++]=(a&3)<<6|l&63;return c},u$=typeof ArrayBuffer=="function",ER=(n,e)=>{if(typeof n!="string")return{type:"message",data:iG(n,e)};const t=n.charAt(0);return t==="b"?{type:"message",data:f$(n.substring(1),e)}:$1[t]?n.length>1?{type:$1[t],data:n.substring(1)}:{type:$1[t]}:wT},f$=(n,e)=>{if(u$){const t=c$(n);return iG(t,e)}else return{base64:!0,data:n}},iG=(n,e)=>{switch(e){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},sG=String.fromCharCode(30),h$=(n,e)=>{const t=n.length,r=new Array(t);let i=0;n.forEach((s,o)=>{wR(s,!1,a=>{r[o]=a,++i===t&&e(r.join(sG))})})},d$=(n,e)=>{const t=n.split(sG),r=[];for(let i=0;i<t.length;i++){const s=ER(t[i],e);if(r.push(s),s.type==="error")break}return r};function p$(){return new TransformStream({transform(n,e){l$(n,t=>{const r=t.length;let i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);const s=new DataView(i.buffer);s.setUint8(0,126),s.setUint16(1,r)}else{i=new Uint8Array(9);const s=new DataView(i.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(r))}n.data&&typeof n.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(t)})}})}let tb;function x1(n){return n.reduce((e,t)=>e+t.length,0)}function A1(n,e){if(n[0].length===e)return n.shift();const t=new Uint8Array(e);let r=0;for(let i=0;i<e;i++)t[i]=n[0][r++],r===n[0].length&&(n.shift(),r=0);return n.length&&r<n[0].length&&(n[0]=n[0].slice(r)),t}function m$(n,e){tb||(tb=new TextDecoder);const t=[];let r=0,i=-1,s=!1;return new TransformStream({transform(o,a){for(t.push(o);;){if(r===0){if(x1(t)<1)break;const l=A1(t,1);s=(l[0]&128)===128,i=l[0]&127,i<126?r=3:i===126?r=1:r=2}else if(r===1){if(x1(t)<2)break;const l=A1(t,2);i=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),r=3}else if(r===2){if(x1(t)<8)break;const l=A1(t,8),c=new DataView(l.buffer,l.byteOffset,l.length),u=c.getUint32(0);if(u>Math.pow(2,53-32)-1){a.enqueue(wT);break}i=u*Math.pow(2,32)+c.getUint32(4),r=3}else{if(x1(t)<i)break;const l=A1(t,i);a.enqueue(ER(s?l:tb.decode(l),e)),r=0}if(i===0||i>n){a.enqueue(wT);break}}}})}const oG=4;function Or(n){if(n)return g$(n)}function g$(n){for(var e in Or.prototype)n[e]=Or.prototype[e];return n}Or.prototype.on=Or.prototype.addEventListener=function(n,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(e),this};Or.prototype.once=function(n,e){function t(){this.off(n,t),e.apply(this,arguments)}return t.fn=e,this.on(n,t),this};Or.prototype.off=Or.prototype.removeListener=Or.prototype.removeAllListeners=Or.prototype.removeEventListener=function(n,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+n];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var r,i=0;i<t.length;i++)if(r=t[i],r===e||r.fn===e){t.splice(i,1);break}return t.length===0&&delete this._callbacks["$"+n],this};Or.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+n],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(t){t=t.slice(0);for(var r=0,i=t.length;r<i;++r)t[r].apply(this,e)}return this};Or.prototype.emitReserved=Or.prototype.emit;Or.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};Or.prototype.hasListeners=function(n){return!!this.listeners(n).length};const dw=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0))(),xo=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())(),v$="arraybuffer";function aG(n,...e){return e.reduce((t,r)=>(n.hasOwnProperty(r)&&(t[r]=n[r]),t),{})}const y$=xo.setTimeout,x$=xo.clearTimeout;function pw(n,e){e.useNativeTimers?(n.setTimeoutFn=y$.bind(xo),n.clearTimeoutFn=x$.bind(xo)):(n.setTimeoutFn=xo.setTimeout.bind(xo),n.clearTimeoutFn=xo.clearTimeout.bind(xo))}const A$=1.33;function _$(n){return typeof n=="string"?w$(n):Math.ceil((n.byteLength||n.size)*A$)}function w$(n){let e=0,t=0;for(let r=0,i=n.length;r<i;r++)e=n.charCodeAt(r),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(r++,t+=4);return t}function lG(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function E$(n){let e="";for(let t in n)n.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(n[t]));return e}function S$(n){let e={},t=n.split("&");for(let r=0,i=t.length;r<i;r++){let s=t[r].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}class b$ extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class SR extends Or{constructor(e){super(),this.writable=!1,pw(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,r){return super.emitReserved("error",new b$(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=ER(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=E$(e);return t.length?"?"+t:""}}class M$ extends SR{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let r=0;this._polling&&(r++,this.once("pollComplete",function(){--r||t()})),this.writable||(r++,this.once("drain",function(){--r||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};d$(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,h$(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=lG()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let cG=!1;try{cG=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const T$=cG;function C$(){}class R$ extends M${constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let r=location.port;r||(r=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||r!==e.port}}doWrite(e,t){const r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(i,s)=>{this.onError("xhr post error",i,s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,r)=>{this.onError("xhr poll error",t,r)}),this.pollXhr=e}}let mp=class eA extends Or{constructor(e,t,r){super(),this.createRequest=e,pw(this,r),this._opts=r,this._method=r.method||"GET",this._uri=t,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var e;const t=aG(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const r=this._xhr=this.createRequest(t);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let i in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(i)&&r.setRequestHeader(i,this._opts.extraHeaders[i])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var i;r.readyState===3&&((i=this._opts.cookieJar)===null||i===void 0||i.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(i){this.setTimeoutFn(()=>{this._onError(i)},0);return}typeof document<"u"&&(this._index=eA.requestsCount++,eA.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=C$,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete eA.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};mp.requestsCount=0;mp.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",d3);else if(typeof addEventListener=="function"){const n="onpagehide"in xo?"pagehide":"unload";addEventListener(n,d3,!1)}}function d3(){for(let n in mp.requests)mp.requests.hasOwnProperty(n)&&mp.requests[n].abort()}const B$=function(){const n=uG({xdomain:!1});return n&&n.responseType!==null}();class P$ extends R${constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=B$&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new mp(uG,this.uri(),e)}}function uG(n){const e=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||T$))return new XMLHttpRequest}catch{}if(!e)try{return new xo[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const fG=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class I$ extends SR{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,r=fG?{}:aG(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],i=t===e.length-1;wR(r,this.supportsBinary,s=>{try{this.doWrite(r,s)}catch{}i&&dw(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=lG()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const nb=xo.WebSocket||xo.MozWebSocket;class L$ extends I${createSocket(e,t,r){return fG?new nb(e,t,r):t?new nb(e,t):new nb(e)}doWrite(e,t){this.ws.send(t)}}class N$ extends SR{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=m$(Number.MAX_SAFE_INTEGER,this.socket.binaryType),r=e.readable.pipeThrough(t).getReader(),i=p$();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();const s=()=>{r.read().then(({done:a,value:l})=>{a||(this.onPacket(l),s())}).catch(a=>{})};s();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const r=e[t],i=t===e.length-1;this._writer.write(r).then(()=>{i&&dw(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const D$={websocket:L$,webtransport:N$,polling:P$},U$=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,F$=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ET(n){if(n.length>8e3)throw"URI too long";const e=n,t=n.indexOf("["),r=n.indexOf("]");t!=-1&&r!=-1&&(n=n.substring(0,t)+n.substring(t,r).replace(/:/g,";")+n.substring(r,n.length));let i=U$.exec(n||""),s={},o=14;for(;o--;)s[F$[o]]=i[o]||"";return t!=-1&&r!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=O$(s,s.path),s.queryKey=k$(s,s.query),s}function O$(n,e){const t=/\/{2,9}/g,r=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&r.splice(0,1),e.slice(-1)=="/"&&r.splice(r.length-1,1),r}function k$(n,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,s){i&&(t[i]=s)}),t}const ST=typeof addEventListener=="function"&&typeof removeEventListener=="function",tA=[];ST&&addEventListener("offline",()=>{tA.forEach(n=>n())},!1);class cu extends Or{constructor(e,t){if(super(),this.binaryType=v$,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const r=ET(e);t.hostname=r.host,t.secure=r.protocol==="https"||r.protocol==="wss",t.port=r.port,r.query&&(t.query=r.query)}else t.host&&(t.hostname=ET(t.host).host);pw(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(r=>{const i=r.prototype.name;this.transports.push(i),this._transportsByName[i]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=S$(this.opts.query)),ST&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},tA.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=oG,t.transport=e,this.id&&(t.sid=this.id);const r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&cu.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",cu.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let r=0;r<this.writeBuffer.length;r++){const i=this.writeBuffer[r].data;if(i&&(t+=_$(i)),r>0&&t>this._maxPayload)return this.writeBuffer.slice(0,r);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,dw(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,r){return this._sendPacket("message",e,t,r),this}send(e,t,r){return this._sendPacket("message",e,t,r),this}_sendPacket(e,t,r,i){if(typeof t=="function"&&(i=t,t=void 0),typeof r=="function"&&(i=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const s={type:e,data:t,options:r};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(cu.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),ST&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const r=tA.indexOf(this._offlineEventListener);r!==-1&&tA.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}cu.protocol=oG;class G$ extends cu{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),r=!1;cu.priorWebsocketSuccess=!1;const i=()=>{r||(t.send([{type:"ping",data:"probe"}]),t.once("packet",f=>{if(!r)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;cu.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(u(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const d=new Error("probe error");d.transport=t.name,this.emitReserved("upgradeError",d)}}))};function s(){r||(r=!0,u(),t.close(),t=null)}const o=f=>{const d=new Error("probe error: "+f);d.transport=t.name,s(),this.emitReserved("upgradeError",d)};function a(){o("transport closed")}function l(){o("socket closed")}function c(f){t&&f.name!==t.name&&s()}const u=()=>{t.removeListener("open",i),t.removeListener("error",o),t.removeListener("close",a),this.off("close",l),this.off("upgrading",c)};t.once("open",i),t.once("error",o),t.once("close",a),this.once("close",l),this.once("upgrading",c),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{r||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let r=0;r<e.length;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}}let z$=class extends G${constructor(e,t={}){const r=typeof e=="object"?e:t;(!r.transports||r.transports&&typeof r.transports[0]=="string")&&(r.transports=(r.transports||["polling","websocket","webtransport"]).map(i=>D$[i]).filter(i=>!!i)),super(e,r)}};function H$(n,e="",t){let r=n;t=t||typeof location<"u"&&location,n==null&&(n=t.protocol+"//"+t.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=t.protocol+n:n=t.host+n),/^(https?|wss?):\/\//.test(n)||(typeof t<"u"?n=t.protocol+"//"+n:n="https://"+n),r=ET(n)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const s=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+s+":"+r.port+e,r.href=r.protocol+"://"+s+(t&&t.port===r.port?"":":"+r.port),r}const V$=typeof ArrayBuffer=="function",W$=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,hG=Object.prototype.toString,X$=typeof Blob=="function"||typeof Blob<"u"&&hG.call(Blob)==="[object BlobConstructor]",J$=typeof File=="function"||typeof File<"u"&&hG.call(File)==="[object FileConstructor]";function bR(n){return V$&&(n instanceof ArrayBuffer||W$(n))||X$&&n instanceof Blob||J$&&n instanceof File}function nA(n,e){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let t=0,r=n.length;t<r;t++)if(nA(n[t]))return!0;return!1}if(bR(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return nA(n.toJSON(),!0);for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&nA(n[t]))return!0;return!1}function K$(n){const e=[],t=n.data,r=n;return r.data=bT(t,e),r.attachments=e.length,{packet:r,buffers:e}}function bT(n,e){if(!n)return n;if(bR(n)){const t={_placeholder:!0,num:e.length};return e.push(n),t}else if(Array.isArray(n)){const t=new Array(n.length);for(let r=0;r<n.length;r++)t[r]=bT(n[r],e);return t}else if(typeof n=="object"&&!(n instanceof Date)){const t={};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=bT(n[r],e));return t}return n}function Q$(n,e){return n.data=MT(n.data,e),delete n.attachments,n}function MT(n,e){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<e.length)return e[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let t=0;t<n.length;t++)n[t]=MT(n[t],e);else if(typeof n=="object")for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(n[t]=MT(n[t],e));return n}const dG=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],j$=5;var on;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(on||(on={}));class Y${constructor(e){this.replacer=e}encode(e){return(e.type===on.EVENT||e.type===on.ACK)&&nA(e)?this.encodeAsBinary({type:e.type===on.EVENT?on.BINARY_EVENT:on.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===on.BINARY_EVENT||e.type===on.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=K$(e),r=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(r),i}}class MR extends Or{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const r=t.type===on.BINARY_EVENT;r||t.type===on.BINARY_ACK?(t.type=r?on.EVENT:on.ACK,this.reconstructor=new Z$(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(bR(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const r={type:Number(e.charAt(0))};if(on[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===on.BINARY_EVENT||r.type===on.BINARY_ACK){const s=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const o=e.substring(s,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");r.attachments=Number(o)}if(e.charAt(t+1)==="/"){const s=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););r.nsp=e.substring(s,t)}else r.nsp="/";const i=e.charAt(t+1);if(i!==""&&Number(i)==i){const s=t+1;for(;++t;){const o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}r.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){const s=this.tryParse(e.substr(t));if(MR.isPayloadValid(r.type,s))r.data=s;else throw new Error("invalid payload")}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case on.CONNECT:return KA(t);case on.DISCONNECT:return t===void 0;case on.CONNECT_ERROR:return typeof t=="string"||KA(t);case on.EVENT:case on.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&dG.indexOf(t[0])===-1);case on.ACK:case on.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Z${constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=Q$(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function q$(n){return typeof n=="string"}const $$=Number.isInteger||function(n){return typeof n=="number"&&isFinite(n)&&Math.floor(n)===n};function eee(n){return n===void 0||$$(n)}function KA(n){return Object.prototype.toString.call(n)==="[object Object]"}function tee(n,e){switch(n){case on.CONNECT:return e===void 0||KA(e);case on.DISCONNECT:return e===void 0;case on.EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&dG.indexOf(e[0])===-1);case on.ACK:return Array.isArray(e);case on.CONNECT_ERROR:return typeof e=="string"||KA(e);default:return!1}}function nee(n){return q$(n.nsp)&&eee(n.id)&&tee(n.type,n.data)}const ree=Object.freeze(Object.defineProperty({__proto__:null,Decoder:MR,Encoder:Y$,get PacketType(){return on},isPacketValid:nee,protocol:j$},Symbol.toStringTag,{value:"Module"}));function Ko(n,e,t){return n.on(e,t),function(){n.off(e,t)}}const iee=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class pG extends Or{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Ko(e,"open",this.onopen.bind(this)),Ko(e,"packet",this.onpacket.bind(this)),Ko(e,"error",this.onerror.bind(this)),Ko(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var r,i,s;if(iee.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const o={type:on.EVENT,data:t};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const u=this.ids++,f=t.pop();this._registerAckCallback(u,f),o.id=u}const a=(i=(r=this.io.engine)===null||r===void 0?void 0:r.transport)===null||i===void 0?void 0:i.writable,l=this.connected&&!(!((s=this.io.engine)===null||s===void 0)&&s._hasPingExpired());return this.flags.volatile&&!a||(l?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(e,t){var r;const i=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(i===void 0){this.acks[e]=t;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);t.call(this,new Error("operation has timed out"))},i),o=(...a)=>{this.io.clearTimeoutFn(s),t.apply(this,a)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((r,i)=>{const s=(o,a)=>o?i(o):r(a);s.withError=!0,t.push(s),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...s)=>(this._queue[0],i!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(i)):(this._queue.shift(),t&&t(null,...s)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:on.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(r=>String(r.id)===e)){const r=this.acks[e];delete this.acks[e],r.withError&&r.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case on.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case on.EVENT:case on.BINARY_EVENT:this.onevent(e);break;case on.ACK:case on.BINARY_ACK:this.onack(e);break;case on.DISCONNECT:this.ondisconnect();break;case on.CONNECT_ERROR:this.destroy();const r=new Error(e.data.message);r.data=e.data.data,this.emitReserved("connect_error",r);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const r of t)r.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let r=!1;return function(...i){r||(r=!0,t.packet({type:on.ACK,id:e,data:i}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:on.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const r of t)r.apply(this,e.data)}}}function zm(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}zm.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*n);n=Math.floor(e*10)&1?n+t:n-t}return Math.min(n,this.max)|0};zm.prototype.reset=function(){this.attempts=0};zm.prototype.setMin=function(n){this.ms=n};zm.prototype.setMax=function(n){this.max=n};zm.prototype.setJitter=function(n){this.jitter=n};class TT extends Or{constructor(e,t){var r;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,pw(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((r=t.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new zm({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||ree;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new z$(this.uri,this.opts);const t=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const i=Ko(t,"open",function(){r.onopen(),e&&e()}),s=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},o=Ko(t,"error",s);if(this._timeout!==!1){const a=this._timeout,l=this.setTimeoutFn(()=>{i(),s(new Error("timeout")),t.close()},a);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Ko(e,"ping",this.onping.bind(this)),Ko(e,"data",this.ondata.bind(this)),Ko(e,"error",this.onerror.bind(this)),Ko(e,"close",this.onclose.bind(this)),Ko(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){dw(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new pG(this,e,t),this.nsps[e]=r),r}_destroy(e){const t=Object.keys(this.nsps);for(const r of t)if(this.nsps[r].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var r;this.cleanup(),(r=this.engine)===null||r===void 0||r.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},t);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Wg={};function rA(n,e){typeof n=="object"&&(e=n,n=void 0),e=e||{};const t=H$(n,e.path||"/socket.io"),r=t.source,i=t.id,s=t.path,o=Wg[i]&&s in Wg[i].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let l;return a?l=new TT(r,e):(Wg[i]||(Wg[i]=new TT(r,e)),l=Wg[i]),t.query&&!e.query&&(e.query=t.queryKey),l.socket(t.path,e)}Object.assign(rA,{Manager:TT,Socket:pG,io:rA,connect:rA});const mG=te.createContext(null);function see(){return typeof window>"u"?"":window.location.origin}function oee({children:n}){var $;const[e,t]=te.useState(null),[r,i]=te.useState(null),[s,o]=te.useState(null),[a,l]=te.useState([]),[c,u]=te.useState([]),[f,d]=te.useState(null),m=te.useRef(null),g=te.useRef(0),y=te.useRef(0),[x,v]=te.useState(null),[A,w]=te.useState(null),[S,M]=te.useState(null),[b,R]=te.useState(null),[P,C]=te.useState(null);te.useEffect(()=>{const U=see(),z=rA(`${U}/shooter`,{transports:["websocket"],reconnection:!0,reconnectionDelay:1e3});return m.current=z,z.on("connect",()=>{console.log("[ShooterClient] Connected to /shooter namespace")}),z.on("shooterState",O=>{t(O),o(null)}),z.on("shooterStatus",O=>{i(O),O.currentMatch&&w(O.currentMatch.id)}),z.on("shooterShot",O=>{const ie=g.current++;l(X=>[...X.slice(-12),{...O,_id:ie}])}),z.on("shooterHit",O=>{const ie=y.current++;u(X=>[...X.slice(-20),{...O,_id:ie}])}),z.on("shooterMatchEnd",O=>{o(O)}),z.on("shooterLobbyOpen",O=>{o(null),t(null),w(O.matchId),v(null),R(null)}),z.on("bettingPending",O=>{w(O.matchId),O.agentNames&&O.agentNames.length&&v({matchId:O.matchId,status:"pending",totalPool:"0",totalPoolMON:"0",agents:O.agentNames.map(ie=>({agentName:ie,pool:"0",poolMON:"0",percentage:0,multiplier:0,bettorCount:0})),bettorCount:0})}),z.on("bettingOpen",O=>{w(O.matchId),O.agentNames&&O.agentNames.length&&v({matchId:O.matchId,status:"open",totalPool:"0",totalPoolMON:"0",agents:O.agentNames.map(ie=>({agentName:ie,pool:"0",poolMON:"0",percentage:0,multiplier:0,bettorCount:0})),bettorCount:0})}),z.on("bettingAgentsUpdate",O=>{v(ie=>{if(!ie||ie.matchId!==O.matchId)return ie;const X=new Set(ie.agents.map(W=>W.agentName)),K=(O.agentNames||[]).filter(W=>!X.has(W)).map(W=>({agentName:W,pool:"0",poolMON:"0",percentage:0,multiplier:0,bettorCount:0}));return{...ie,agents:[...ie.agents,...K]}})}),z.on("bettingUpdate",O=>{v(O)}),z.on("betPlaced",O=>{M(O)}),z.on("bettingClosed",O=>{v(ie=>!ie||ie.matchId!==O.matchId?ie:{...ie,status:"closed"})}),z.on("bettingResolved",O=>{R(O),v(ie=>!ie||ie.matchId!==O.matchId?ie:{...ie,status:"resolved"})}),z.on("winningsDistributed",O=>{C(O)}),z.on("disconnect",()=>{console.log("[ShooterClient] Disconnected")}),()=>{z.disconnect(),m.current=null}},[]),te.useEffect(()=>{if(a.length===0)return;const U=setTimeout(()=>{l(z=>z.slice(Math.max(0,z.length-4)))},200);return()=>clearTimeout(U)},[a.length]),te.useEffect(()=>{if(c.length===0)return;const U=setTimeout(()=>{u(z=>z.slice(Math.max(0,z.length-5)))},800);return()=>clearTimeout(U)},[c.length]);const B=(e==null?void 0:e.phase)||(($=r==null?void 0:r.currentMatch)==null?void 0:$.phase),k={gameState:e,matchStatus:r,matchEnd:s,gamePhase:s?"ended":B==="active"?"playing":B==="countdown"?"countdown":"lobby",shots:a,hits:c,selectedBotId:f,setSelectedBotId:d,bettingStatus:x,setBettingStatus:v,currentMatchId:A,lastBetToast:S,bettingResolved:b,winningsDistributed:P,socketRef:m};return Me(mG.Provider,{value:k,children:n})}function Uh(){const n=te.useContext(mG);if(!n)throw new Error("useGameManager must be used within GameManagerProvider");return n}const aee="/claw-shooter/";function lee({playerCount:n,startsAt:e}){const[t,r]=te.useState(null);return te.useEffect(()=>{if(!e)return;const i=()=>{const o=Math.max(0,Math.ceil((e-Date.now())/1e3));r(o)};i();const s=setInterval(i,500);return()=>clearInterval(s)},[e]),je("div",{className:"fixed inset-0 z-20 flex flex-col items-center justify-center bg-black/60 backdrop-blur-sm",children:[Me("h1",{className:"text-3xl font-bold text-white mb-4",children:"Claw Shooter"}),t!=null&&t>0?je("p",{className:"text-white text-4xl font-black animate-pulse",children:[t,"s"]}):Me("p",{className:"text-white text-xl animate-pulse",children:"Starting..."}),je("p",{className:"text-white/50 text-sm mt-2",children:[n," agents ready"]})]})}function p3(n){const e=n??0;return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`}const cee=()=>{var l,c,u,f,d,m,g,y,x;const{gamePhase:n,matchEnd:e,matchStatus:t}=Uh(),r=typeof document<"u"?document.getElementById("game-view-center"):null,i=Me("button",{className:"absolute top-4 right-4 z-20 text-white p-2 rounded bg-black/40 hover:bg-black/60 border-2 border-white/50",onClick:v=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen(),v.currentTarget.blur()},title:"Toggle fullscreen",children:Me("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:Me("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"})})}),s=(e==null?void 0:e.finalRanking)??[],o=r&&QF.createPortal(je(sh,{children:[n==="playing"&&Me("div",{className:"absolute top-0 left-0 right-0 z-10 pointer-events-none flex justify-center pt-4",children:Me("div",{className:"bg-slate-800/95 text-white text-sm md:text-base font-bold rounded-lg px-4 py-2 border-2 border-white shadow-[4px_4px_0_black] text-center whitespace-nowrap",children:"Click a bot (or name in leaderboard) to follow  Left drag to orbit  Esc = free cam"})}),n==="ended"&&s.length>0&&Me("div",{className:"absolute inset-0 z-20 flex flex-col items-center justify-center bg-black/80 p-4 overflow-y-auto",children:Me("div",{className:"bg-slate-800 p-2 border-4 border-white shadow-[10px_10px_0_#facc15] max-w-sm w-full animate-float my-auto max-h-[90%] overflow-y-auto",children:je("div",{className:"bg-[#22d3ee] p-4 md:p-6 text-center border-2 border-white",children:[je("div",{className:"w-20 h-20 mx-auto mb-3 bg-white rounded-full flex items-center justify-center border-4 border-black animate-bounce overflow-hidden",children:[(l=s[0])!=null&&l.character||(c=s[0])!=null&&c.id?Me("img",{src:`${aee}skins/${s[0].character||s[0].id||"G_1"}.png`,alt:((u=s[0])==null?void 0:u.name)??"Winner",className:"w-full h-full object-contain",onError:v=>{v.target.style.display="none";const A=v.target.parentElement.querySelector(".winner-trophy");A&&A.classList.remove("hidden")}}):null,Me("svg",{className:`winner-trophy w-8 h-8 text-[#facc15] ${(f=s[0])!=null&&f.character||(d=s[0])!=null&&d.id?"hidden":""}`,fill:"currentColor",viewBox:"0 0 24 24",children:Me("path",{d:"M12 2l2.4 7.4h7.6l-6 4.6 2.3 7-6.3-4.6L5.7 21l2.3-7-6-4.6h7.6L12 2z"})})]}),Me("h2",{className:"text-3xl md:text-4xl neo-font text-white mb-1",style:{WebkitTextStroke:"2px black",textShadow:"3px 3px 0 black"},children:"WINNER!"}),Me("p",{className:"text-[10px] font-black uppercase text-black/80 mb-3",children:"Battle Royale  ranked by survival"}),Me("div",{className:"text-lg font-black text-black bg-white inline-block px-4 py-2 border-2 border-black shadow-[4px_4px_0_black] mb-3",children:((m=s[0])==null?void 0:m.name)??""}),Me("div",{className:"mb-4",children:je("div",{className:"bg-white p-2 border-2 border-black inline-block",children:[Me("div",{className:"text-[10px] font-black uppercase text-black",children:"Survival"}),Me("div",{className:"text-xl neo-font text-[#d946ef]",children:p3((g=s[0])==null?void 0:g.survivalTime)})]})}),je("table",{className:"winner-table",children:[Me("thead",{children:je("tr",{children:[Me("th",{children:"#"}),Me("th",{children:"Agent"}),Me("th",{children:"Survival"}),Me("th",{children:"K/D/KDA"})]})}),Me("tbody",{children:s.map(v=>je("tr",{className:v.rank===1?"highlight":"",children:[Me("td",{children:v.rank}),Me("td",{children:v.name}),Me("td",{children:p3(v.survivalTime)}),je("td",{children:[v.kills,"/",v.deaths," (",v.kills-v.deaths>=0?"+":"",v.kills-v.deaths,")"]})]},v.rank))})]}),Me("button",{className:"mt-4 w-full btn-neo btn-cyan",onClick:()=>window.location.reload(),children:"Watch Again"})]})})}),(n==="playing"||n==="ended"&&s.length>0)&&i]}),r),a=((y=t==null?void 0:t.currentMatch)==null?void 0:y.playerCount)??0;return je(sh,{children:[n==="lobby"&&je("div",{className:"fixed inset-0 z-20 flex flex-col items-center justify-center bg-black/70 backdrop-blur-sm",children:[Me("h1",{className:"text-3xl font-bold text-white mb-4",children:"Claw Shooter"}),Me("p",{className:"text-white/70 text-lg mb-2",children:"Waiting for agents to join..."}),je("p",{className:"text-white/50 text-sm",children:[a," player",a!==1?"s":""," in lobby. Match starts when 2+ agents join."]})]}),n==="countdown"&&Me(lee,{playerCount:a,startsAt:(x=t==null?void 0:t.currentMatch)==null?void 0:x.startsAt}),o]})},uee="6.16.0";function fee(n,e,t){const r=e.split("|").map(s=>s.trim());for(let s=0;s<r.length;s++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof n===e)return}const i=new Error(`invalid value for type ${e}`);throw i.code="INVALID_ARGUMENT",i.argument=`value.${t}`,i.value=n,i}async function Zi(n){const e=Object.keys(n);return(await Promise.all(e.map(r=>Promise.resolve(n[r])))).reduce((r,i,s)=>(r[e[s]]=i,r),{})}function Ht(n,e,t){for(let r in e){let i=e[r];const s=t?t[r]:null;s&&fee(i,s,r),Object.defineProperty(n,r,{enumerable:!0,value:i,writable:!1})}}function $d(n,e){if(n==null)return"null";if(e==null&&(e=new Set),typeof n=="object"){if(e.has(n))return"[Circular]";e.add(n)}if(Array.isArray(n))return"[ "+n.map(t=>$d(t,e)).join(", ")+" ]";if(n instanceof Uint8Array){const t="0123456789abcdef";let r="0x";for(let i=0;i<n.length;i++)r+=t[n[i]>>4],r+=t[n[i]&15];return r}if(typeof n=="object"&&typeof n.toJSON=="function")return $d(n.toJSON(),e);switch(typeof n){case"boolean":case"number":case"symbol":return n.toString();case"bigint":return BigInt(n).toString();case"string":return JSON.stringify(n);case"object":{const t=Object.keys(n);return t.sort(),"{ "+t.map(r=>`${$d(r,e)}: ${$d(n[r],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function pi(n,e){return n&&n.code===e}function TR(n){return pi(n,"CALL_EXCEPTION")}function qn(n,e,t){let r=n;{const s=[];if(t){if("message"in t||"code"in t||"name"in t)throw new Error(`value will overwrite populated values: ${$d(t)}`);for(const o in t){if(o==="shortMessage")continue;const a=t[o];s.push(o+"="+$d(a))}}s.push(`code=${e}`),s.push(`version=${uee}`),s.length&&(n+=" ("+s.join(", ")+")")}let i;switch(e){case"INVALID_ARGUMENT":i=new TypeError(n);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":i=new RangeError(n);break;default:i=new Error(n)}return Ht(i,{code:e}),t&&Object.assign(i,t),i.shortMessage==null&&Ht(i,{shortMessage:r}),i}function qe(n,e,t,r){if(!n)throw qn(e,t,r)}function xe(n,e,t,r){qe(n,e,"INVALID_ARGUMENT",{argument:t,value:r})}function gG(n,e,t){t==null&&(t=""),t&&(t=": "+t),qe(n>=e,"missing argument"+t,"MISSING_ARGUMENT",{count:n,expectedCount:e}),qe(n<=e,"too many arguments"+t,"UNEXPECTED_ARGUMENT",{count:n,expectedCount:e})}const hee=["NFD","NFC","NFKD","NFKC"].reduce((n,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"){const t=String.fromCharCode(233).normalize("NFD"),r=String.fromCharCode(101,769);if(t!==r)throw new Error("broken")}n.push(e)}catch{}return n},[]);function dee(n){qe(hee.indexOf(n)>=0,"platform missing String.prototype.normalize","UNSUPPORTED_OPERATION",{operation:"String.prototype.normalize",info:{form:n}})}function ry(n,e,t){if(t==null&&(t=""),n!==e){let r=t,i="new";t&&(r+=".",i+=" "+t),qe(!1,`private constructor; use ${r}from* methods`,"UNSUPPORTED_OPERATION",{operation:i})}}function vG(n,e,t){if(n instanceof Uint8Array)return t?new Uint8Array(n):n;if(typeof n=="string"&&n.length%2===0&&n.match(/^0x[0-9a-f]*$/i)){const r=new Uint8Array((n.length-2)/2);let i=2;for(let s=0;s<r.length;s++)r[s]=parseInt(n.substring(i,i+2),16),i+=2;return r}xe(!1,"invalid BytesLike value",e||"value",n)}function an(n,e){return vG(n,e,!1)}function $i(n,e){return vG(n,e,!0)}function Xn(n,e){return!(typeof n!="string"||!n.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&n.length!==2+2*e||e===!0&&n.length%2!==0)}function CR(n){return Xn(n,!0)||n instanceof Uint8Array}const m3="0123456789abcdef";function _t(n){const e=an(n);let t="0x";for(let r=0;r<e.length;r++){const i=e[r];t+=m3[(i&240)>>4]+m3[i&15]}return t}function tr(n){return"0x"+n.map(e=>_t(e).substring(2)).join("")}function gp(n){return Xn(n,!0)?(n.length-2)/2:an(n).length}function gr(n,e,t){const r=an(n);return t!=null&&t>r.length&&qe(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:r,length:r.length,offset:t}),_t(r.slice(e??0,t??r.length))}function yG(n,e,t){const r=an(n);qe(e>=r.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(r),length:e,offset:e+1});const i=new Uint8Array(e);return i.fill(0),t?i.set(r,e-r.length):i.set(r,0),_t(i)}function Jl(n,e){return yG(n,e,!0)}function xG(n,e){return yG(n,e,!1)}const iy=BigInt(0),Zo=BigInt(1),ep=9007199254740991;function QA(n,e){const t=mw(n,"value"),r=BigInt(Qt(e,"width"));if(qe(t>>r===iy,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:n}),t>>r-Zo){const i=(Zo<<r)-Zo;return-((~t&i)+Zo)}return t}function AG(n,e){let t=Mt(n,"value");const r=BigInt(Qt(e,"width")),i=Zo<<r-Zo;if(t<iy){t=-t,qe(t<=i,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:n});const s=(Zo<<r)-Zo;return(~t&s)+Zo}else qe(t<i,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:n});return t}function Nf(n,e){const t=mw(n,"value"),r=BigInt(Qt(e,"bits"));return t&(Zo<<r)-Zo}function Mt(n,e){switch(typeof n){case"bigint":return n;case"number":return xe(Number.isInteger(n),"underflow",e||"value",n),xe(n>=-ep&&n<=ep,"overflow",e||"value",n),BigInt(n);case"string":try{if(n==="")throw new Error("empty string");return n[0]==="-"&&n[1]!=="-"?-BigInt(n.substring(1)):BigInt(n)}catch(t){xe(!1,`invalid BigNumberish string: ${t.message}`,e||"value",n)}}xe(!1,"invalid BigNumberish value",e||"value",n)}function mw(n,e){const t=Mt(n,e);return qe(t>=iy,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:n}),t}const g3="0123456789abcdef";function gw(n){if(n instanceof Uint8Array){let e="0x0";for(const t of n)e+=g3[t>>4],e+=g3[t&15];return BigInt(e)}return Mt(n)}function Qt(n,e){switch(typeof n){case"bigint":return xe(n>=-ep&&n<=ep,"overflow",e||"value",n),Number(n);case"number":return xe(Number.isInteger(n),"underflow",e||"value",n),xe(n>=-ep&&n<=ep,"overflow",e||"value",n),n;case"string":try{if(n==="")throw new Error("empty string");return Qt(BigInt(n),e)}catch(t){xe(!1,`invalid numeric string: ${t.message}`,e||"value",n)}}xe(!1,"invalid numeric value",e||"value",n)}function pee(n){return Qt(gw(n))}function wu(n,e){const t=mw(n,"value");let r=t.toString(16);if(e==null)r.length%2&&(r="0"+r);else{const i=Qt(e,"width");if(i===0&&t===iy)return"0x";for(qe(i*2>=r.length,`value exceeds width (${i} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:n});r.length<i*2;)r="0"+r}return"0x"+r}function kr(n,e){const t=mw(n,"value");if(t===iy){const s=e!=null?Qt(e,"width"):0;return new Uint8Array(s)}let r=t.toString(16);if(r.length%2&&(r="0"+r),e!=null){const s=Qt(e,"width");for(;r.length<s*2;)r="00"+r;qe(s*2===r.length,`value exceeds width (${s} bytes)`,"NUMERIC_FAULT",{operation:"toBeArray",fault:"overflow",value:n})}const i=new Uint8Array(r.length/2);for(let s=0;s<i.length;s++){const o=s*2;i[s]=parseInt(r.substring(o,o+2),16)}return i}function Yo(n){let e=_t(CR(n)?n:kr(n)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const v3="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const y3=BigInt(58);function mee(n){const e=an(n);let t=gw(e),r="";for(;t;)r=v3[Number(t%y3)]+r,t/=y3;for(let i=0;i<e.length&&!e[i];i++)r=v3[0]+r;return r}function gee(n){n=atob(n);const e=new Uint8Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return an(e)}function vee(n){const e=an(n);let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}var Ap;class _G{constructor(e,t,r){Ee(this,"filter");Ee(this,"emitter");Be(this,Ap,void 0);oe(this,Ap,t),Ht(this,{emitter:e,filter:r})}async removeListener(){N(this,Ap)!=null&&await this.emitter.off(this.filter,N(this,Ap))}}Ap=new WeakMap;function yee(n,e,t,r,i){xe(!1,`invalid codepoint at offset ${e}; ${n}`,"bytes",t)}function wG(n,e,t,r,i){if(n==="BAD_PREFIX"||n==="UNEXPECTED_CONTINUE"){let s=0;for(let o=e+1;o<t.length&&t[o]>>6===2;o++)s++;return s}return n==="OVERRUN"?t.length-e-1:0}function xee(n,e,t,r,i){return n==="OVERLONG"?(xe(typeof i=="number","invalid bad code point for replacement","badCodepoint",i),r.push(i),0):(r.push(65533),wG(n,e,t))}const Aee=Object.freeze({error:yee,ignore:wG,replace:xee});function _ee(n,e){e==null&&(e=Aee.error);const t=an(n,"bytes"),r=[];let i=0;for(;i<t.length;){const s=t[i++];if(!(s>>7)){r.push(s);continue}let o=null,a=null;if((s&224)===192)o=1,a=127;else if((s&240)===224)o=2,a=2047;else if((s&248)===240)o=3,a=65535;else{(s&192)===128?i+=e("UNEXPECTED_CONTINUE",i-1,t,r):i+=e("BAD_PREFIX",i-1,t,r);continue}if(i-1+o>=t.length){i+=e("OVERRUN",i-1,t,r);continue}let l=s&(1<<8-o-1)-1;for(let c=0;c<o;c++){let u=t[i];if((u&192)!=128){i+=e("MISSING_CONTINUE",i,t,r),l=null;break}l=l<<6|u&63,i++}if(l!==null){if(l>1114111){i+=e("OUT_OF_RANGE",i-1-o,t,r,l);continue}if(l>=55296&&l<=57343){i+=e("UTF16_SURROGATE",i-1-o,t,r,l);continue}if(l<=a){i+=e("OVERLONG",i-1-o,t,r,l);continue}r.push(l)}}return r}function Ga(n,e){xe(typeof n=="string","invalid string value","str",n),e!=null&&(dee(e),n=n.normalize(e));let t=[];for(let r=0;r<n.length;r++){const i=n.charCodeAt(r);if(i<128)t.push(i);else if(i<2048)t.push(i>>6|192),t.push(i&63|128);else if((i&64512)==55296){r++;const s=n.charCodeAt(r);xe(r<n.length&&(s&64512)===56320,"invalid surrogate pair","str",n);const o=65536+((i&1023)<<10)+(s&1023);t.push(o>>18|240),t.push(o>>12&63|128),t.push(o>>6&63|128),t.push(o&63|128)}else t.push(i>>12|224),t.push(i>>6&63|128),t.push(i&63|128)}return new Uint8Array(t)}function wee(n){return n.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function jA(n,e){return wee(_ee(n,e))}function EG(n){async function e(t,r){qe(r==null||!r.cancelled,"request cancelled before sending","CANCELLED");const i=t.url.split(":")[0].toLowerCase();qe(i==="http"||i==="https",`unsupported protocol ${i}`,"UNSUPPORTED_OPERATION",{info:{protocol:i},operation:"request"}),qe(i==="https"||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let s=null;const o=new AbortController,a=setTimeout(()=>{s=qn("request timeout","TIMEOUT"),o.abort()},t.timeout);r&&r.addListener(()=>{s=qn("request cancelled","CANCELLED"),o.abort()});const l=Object.assign({},n,{method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:o.signal});let c;try{c=await fetch(t.url,l)}catch(m){throw clearTimeout(a),s||m}clearTimeout(a);const u={};c.headers.forEach((m,g)=>{u[g.toLowerCase()]=m});const f=await c.arrayBuffer(),d=f==null?null:new Uint8Array(f);return{statusCode:c.status,statusMessage:c.statusText,headers:u,body:d}}return e}const Eee=12,See=250;let x3=EG();const bee=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),Mee=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let rb=!1;async function SG(n,e){try{const t=n.match(bee);if(!t)throw new Error("invalid data");return new uu(200,"OK",{"content-type":t[1]||"text/plain"},t[2]?gee(t[3]):Cee(t[3]))}catch{return new uu(599,"BAD REQUEST (invalid data: URI)",{},null,new Eu(n))}}function bG(n){async function e(t,r){try{const i=t.match(Mee);if(!i)throw new Error("invalid link");return new Eu(`${n}${i[2]}`)}catch{return new uu(599,"BAD REQUEST (invalid IPFS URI)",{},null,new Eu(t))}}return e}const _1={data:SG,ipfs:bG("https://gateway.ipfs.io/ipfs/")},MG=new WeakMap;var Of,Bc;class Tee{constructor(e){Be(this,Of,void 0);Be(this,Bc,void 0);oe(this,Of,[]),oe(this,Bc,!1),MG.set(e,()=>{if(!N(this,Bc)){oe(this,Bc,!0);for(const t of N(this,Of))setTimeout(()=>{t()},0);oe(this,Of,[])}})}addListener(e){qe(!N(this,Bc),"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),N(this,Of).push(e)}get cancelled(){return N(this,Bc)}checkSignal(){qe(!this.cancelled,"cancelled","CANCELLED",{})}}Of=new WeakMap,Bc=new WeakMap;function w1(n){if(n==null)throw new Error("missing signal; should not happen");return n.checkSignal(),n}var _p,wp,ko,ml,Ep,Sp,ei,ks,gl,kf,Gf,zf,Ea,Go,Pc,Hf,t0;const l_=class l_{constructor(e){Be(this,Hf);Be(this,_p,void 0);Be(this,wp,void 0);Be(this,ko,void 0);Be(this,ml,void 0);Be(this,Ep,void 0);Be(this,Sp,void 0);Be(this,ei,void 0);Be(this,ks,void 0);Be(this,gl,void 0);Be(this,kf,void 0);Be(this,Gf,void 0);Be(this,zf,void 0);Be(this,Ea,void 0);Be(this,Go,void 0);Be(this,Pc,void 0);oe(this,Sp,String(e)),oe(this,_p,!1),oe(this,wp,!0),oe(this,ko,{}),oe(this,ml,""),oe(this,Ep,3e5),oe(this,Go,{slotInterval:See,maxAttempts:Eee}),oe(this,Pc,null)}get url(){return N(this,Sp)}set url(e){oe(this,Sp,String(e))}get body(){return N(this,ei)==null?null:new Uint8Array(N(this,ei))}set body(e){if(e==null)oe(this,ei,void 0),oe(this,ks,void 0);else if(typeof e=="string")oe(this,ei,Ga(e)),oe(this,ks,"text/plain");else if(e instanceof Uint8Array)oe(this,ei,e),oe(this,ks,"application/octet-stream");else if(typeof e=="object")oe(this,ei,Ga(JSON.stringify(e))),oe(this,ks,"application/json");else throw new Error("invalid body")}hasBody(){return N(this,ei)!=null}get method(){return N(this,ml)?N(this,ml):this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),oe(this,ml,String(e).toUpperCase())}get headers(){const e=Object.assign({},N(this,ko));return N(this,gl)&&(e.authorization=`Basic ${vee(Ga(N(this,gl)))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&N(this,ks)&&(e["content-type"]=N(this,ks)),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,t){N(this,ko)[String(e).toLowerCase()]=String(t)}clearHeaders(){oe(this,ko,{})}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let r=0;return{next:()=>{if(r<t.length){const i=t[r++];return{value:[i,e[i]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return N(this,gl)||null}setCredentials(e,t){xe(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),oe(this,gl,`${e}:${t}`)}get allowGzip(){return N(this,wp)}set allowGzip(e){oe(this,wp,!!e)}get allowInsecureAuthentication(){return!!N(this,_p)}set allowInsecureAuthentication(e){oe(this,_p,!!e)}get timeout(){return N(this,Ep)}set timeout(e){xe(e>=0,"timeout must be non-zero","timeout",e),oe(this,Ep,e)}get preflightFunc(){return N(this,kf)||null}set preflightFunc(e){oe(this,kf,e)}get processFunc(){return N(this,Gf)||null}set processFunc(e){oe(this,Gf,e)}get retryFunc(){return N(this,zf)||null}set retryFunc(e){oe(this,zf,e)}get getUrlFunc(){return N(this,Pc)||x3}set getUrlFunc(e){oe(this,Pc,e)}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${N(this,ei)?_t(N(this,ei)):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(N(this,Go).slotInterval=e.slotInterval),e.maxAttempts!=null&&(N(this,Go).maxAttempts=e.maxAttempts)}send(){return qe(N(this,Ea)==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),oe(this,Ea,new Tee(this)),st(this,Hf,t0).call(this,0,A3()+this.timeout,0,this,new uu(0,"",{},null,this))}cancel(){qe(N(this,Ea)!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=MG.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const t=this.url.split(":")[0].toLowerCase(),r=e.split(":")[0].toLowerCase();qe(this.method==="GET"&&(t!=="https"||r!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const i=new l_(e);return i.method="GET",i.allowGzip=this.allowGzip,i.timeout=this.timeout,oe(i,ko,Object.assign({},N(this,ko))),N(this,ei)&&oe(i,ei,new Uint8Array(N(this,ei))),oe(i,ks,N(this,ks)),i}clone(){const e=new l_(this.url);return oe(e,ml,N(this,ml)),N(this,ei)&&oe(e,ei,N(this,ei)),oe(e,ks,N(this,ks)),oe(e,ko,Object.assign({},N(this,ko))),oe(e,gl,N(this,gl)),this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),oe(e,kf,N(this,kf)),oe(e,Gf,N(this,Gf)),oe(e,zf,N(this,zf)),oe(e,Go,Object.assign({},N(this,Go))),oe(e,Pc,N(this,Pc)),e}static lockConfig(){rb=!0}static getGateway(e){return _1[e.toLowerCase()]||null}static registerGateway(e,t){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(rb)throw new Error("gateways locked");_1[e]=t}static registerGetUrl(e){if(rb)throw new Error("gateways locked");x3=e}static createGetUrlFunc(e){return EG(e)}static createDataGateway(){return SG}static createIpfsGatewayFunc(e){return bG(e)}};_p=new WeakMap,wp=new WeakMap,ko=new WeakMap,ml=new WeakMap,Ep=new WeakMap,Sp=new WeakMap,ei=new WeakMap,ks=new WeakMap,gl=new WeakMap,kf=new WeakMap,Gf=new WeakMap,zf=new WeakMap,Ea=new WeakMap,Go=new WeakMap,Pc=new WeakMap,Hf=new WeakSet,t0=async function(e,t,r,i,s){var u,f,d;if(e>=N(this,Go).maxAttempts)return s.makeServerError("exceeded maximum retry limit");qe(A3()<=t,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:i}),r>0&&await Ree(r);let o=this.clone();const a=(o.url.split(":")[0]||"").toLowerCase();if(a in _1){const m=await _1[a](o.url,w1(N(i,Ea)));if(m instanceof uu){let g=m;if(this.processFunc){w1(N(i,Ea));try{g=await this.processFunc(o,g)}catch(y){(y.throttle==null||typeof y.stall!="number")&&g.makeServerError("error in post-processing function",y).assertOk()}}return g}o=m}this.preflightFunc&&(o=await this.preflightFunc(o));const l=await this.getUrlFunc(o,w1(N(i,Ea)));let c=new uu(l.statusCode,l.statusMessage,l.headers,l.body,i);if(c.statusCode===301||c.statusCode===302){try{const m=c.headers.location||"";return st(u=o.redirect(m),Hf,t0).call(u,e+1,t,0,i,c)}catch{}return c}else if(c.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,c,e))){const m=c.headers["retry-after"];let g=N(this,Go).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof m=="string"&&m.match(/^[1-9][0-9]*$/)&&(g=parseInt(m)),st(f=o.clone(),Hf,t0).call(f,e+1,t,g,i,c)}if(this.processFunc){w1(N(i,Ea));try{c=await this.processFunc(o,c)}catch(m){(m.throttle==null||typeof m.stall!="number")&&c.makeServerError("error in post-processing function",m).assertOk();let g=N(this,Go).slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return m.stall>=0&&(g=m.stall),st(d=o.clone(),Hf,t0).call(d,e+1,t,g,i,c)}}return c};let Eu=l_;var mv,gv,vv,Gs,bp,Vf;const QR=class QR{constructor(e,t,r,i,s){Be(this,mv,void 0);Be(this,gv,void 0);Be(this,vv,void 0);Be(this,Gs,void 0);Be(this,bp,void 0);Be(this,Vf,void 0);oe(this,mv,e),oe(this,gv,t),oe(this,vv,Object.keys(r).reduce((o,a)=>(o[a.toLowerCase()]=String(r[a]),o),{})),oe(this,Gs,i==null?null:new Uint8Array(i)),oe(this,bp,s||null),oe(this,Vf,{message:""})}toString(){return`<FetchResponse status=${this.statusCode} body=${N(this,Gs)?_t(N(this,Gs)):"null"}>`}get statusCode(){return N(this,mv)}get statusMessage(){return N(this,gv)}get headers(){return Object.assign({},N(this,vv))}get body(){return N(this,Gs)==null?null:new Uint8Array(N(this,Gs))}get bodyText(){try{return N(this,Gs)==null?"":jA(N(this,Gs))}catch{qe(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{qe(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,t=Object.keys(e);let r=0;return{next:()=>{if(r<t.length){const i=t[r++];return{value:[i,e[i]],done:!1}}return{value:void 0,done:!0}}}}makeServerError(e,t){let r;e?r=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,r=`CLIENT ESCALATED SERVER ERROR (${e})`);const i=new QR(599,r,this.headers,this.body,N(this,bp)||void 0);return oe(i,Vf,{message:e,error:t}),i}throwThrottleError(e,t){t==null?t=-1:xe(Number.isInteger(t)&&t>=0,"invalid stall timeout","stall",t);const r=new Error(e||"throttling requests");throw Ht(r,{stall:t,throttle:!0}),r}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return N(this,Gs)!=null}get request(){return N(this,bp)}ok(){return N(this,Vf).message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:t}=N(this,Vf);e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let r=null;this.request&&(r=this.request.url);let i=null;try{N(this,Gs)&&(i=jA(N(this,Gs)))}catch{}qe(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:t,info:{requestUrl:r,responseBody:i,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}};mv=new WeakMap,gv=new WeakMap,vv=new WeakMap,Gs=new WeakMap,bp=new WeakMap,Vf=new WeakMap;let uu=QR;function A3(){return new Date().getTime()}function Cee(n){return Ga(n.replace(/%([0-9a-f][0-9a-f])/gi,(e,t)=>String.fromCharCode(parseInt(t,16))))}function Ree(n){return new Promise(e=>setTimeout(e,n))}const Bee=BigInt(-1),Do=BigInt(0),tp=BigInt(1),Pee=BigInt(5),Ed={};let vp="0000";for(;vp.length<80;)vp+=vp;function of(n){let e=vp;for(;e.length<n;)e+=e;return BigInt("1"+e.substring(0,n))}function Xg(n,e,t){const r=BigInt(e.width);if(e.signed){const i=tp<<r-tp;qe(t==null||n>=-i&&n<i,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:n}),n>Do?n=QA(Nf(n,r),r):n=-QA(Nf(-n,r),r)}else{const i=tp<<r;qe(t==null||n>=0&&n<i,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:n}),n=(n%i+i)%i&i-tp}return n}function ib(n){typeof n=="number"&&(n=`fixed128x${n}`);let e=!0,t=128,r=18;if(typeof n=="string"){if(n!=="fixed")if(n==="ufixed")e=!1;else{const s=n.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);xe(s,"invalid fixed format","format",n),e=s[1]!=="u",t=parseInt(s[2]),r=parseInt(s[3])}}else if(n){const s=n,o=(a,l,c)=>s[a]==null?c:(xe(typeof s[a]===l,"invalid fixed format ("+a+" not "+l+")","format."+a,s[a]),s[a]);e=o("signed","boolean",e),t=o("width","number",t),r=o("decimals","number",r)}xe(t%8===0,"invalid FixedNumber width (not byte aligned)","format.width",t),xe(r<=80,"invalid FixedNumber decimals (too large)","format.decimals",r);const i=(e?"":"u")+"fixed"+String(t)+"x"+String(r);return{signed:e,width:t,decimals:r,name:i}}function Iee(n,e){let t="";n<Do&&(t="-",n*=Bee);let r=n.toString();if(e===0)return t+r;for(;r.length<=e;)r=vp+r;const i=r.length-e;for(r=r.substring(0,i)+"."+r.substring(i);r[0]==="0"&&r[1]!==".";)r=r.substring(1);for(;r[r.length-1]==="0"&&r[r.length-2]!==".";)r=r.substring(0,r.length-1);return t+r}var zo,Un,Ki,vl,gf,Ho,al,yv,CT,xv,RT,Av,BT,_v,PT;const Mc=class Mc{constructor(e,t,r){Be(this,vl);Be(this,Ho);Be(this,yv);Be(this,xv);Be(this,Av);Be(this,_v);Ee(this,"format");Be(this,zo,void 0);Be(this,Un,void 0);Be(this,Ki,void 0);Ee(this,"_value");ry(e,Ed,"FixedNumber"),oe(this,Un,t),oe(this,zo,r);const i=Iee(t,r.decimals);Ht(this,{format:r.name,_value:i}),oe(this,Ki,of(r.decimals))}get signed(){return N(this,zo).signed}get width(){return N(this,zo).width}get decimals(){return N(this,zo).decimals}get value(){return N(this,Un)}addUnsafe(e){return st(this,yv,CT).call(this,e)}add(e){return st(this,yv,CT).call(this,e,"add")}subUnsafe(e){return st(this,xv,RT).call(this,e)}sub(e){return st(this,xv,RT).call(this,e,"sub")}mulUnsafe(e){return st(this,Av,BT).call(this,e)}mul(e){return st(this,Av,BT).call(this,e,"mul")}mulSignal(e){st(this,vl,gf).call(this,e);const t=N(this,Un)*N(e,Un);return qe(t%N(this,Ki)===Do,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),st(this,Ho,al).call(this,t/N(this,Ki),"mulSignal")}divUnsafe(e){return st(this,_v,PT).call(this,e)}div(e){return st(this,_v,PT).call(this,e,"div")}divSignal(e){qe(N(e,Un)!==Do,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),st(this,vl,gf).call(this,e);const t=N(this,Un)*N(this,Ki);return qe(t%N(e,Un)===Do,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),st(this,Ho,al).call(this,t/N(e,Un),"divSignal")}cmp(e){let t=this.value,r=e.value;const i=this.decimals-e.decimals;return i>0?r*=of(i):i<0&&(t*=of(-i)),t<r?-1:t>r?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=N(this,Un);return N(this,Un)<Do&&(e-=N(this,Ki)-tp),e=N(this,Un)/N(this,Ki)*N(this,Ki),st(this,Ho,al).call(this,e,"floor")}ceiling(){let e=N(this,Un);return N(this,Un)>Do&&(e+=N(this,Ki)-tp),e=N(this,Un)/N(this,Ki)*N(this,Ki),st(this,Ho,al).call(this,e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const t=this.decimals-e,r=Pee*of(t-1);let i=this.value+r;const s=of(t);return i=i/s*s,Xg(i,N(this,zo),"round"),new Mc(Ed,i,N(this,zo))}isZero(){return N(this,Un)===Do}isNegative(){return N(this,Un)<Do}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return Mc.fromString(this.toString(),e)}static fromValue(e,t,r){const i=t==null?0:Qt(t),s=ib(r);let o=Mt(e,"value");const a=i-s.decimals;if(a>0){const l=of(a);qe(o%l===Do,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=l}else a<0&&(o*=of(-a));return Xg(o,s,"fromValue"),new Mc(Ed,o,s)}static fromString(e,t){const r=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);xe(r&&r[2].length+r[3].length>0,"invalid FixedNumber string value","value",e);const i=ib(t);let s=r[2]||"0",o=r[3]||"";for(;o.length<i.decimals;)o+=vp;qe(o.substring(i.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,i.decimals);const a=BigInt(r[1]+s+o);return Xg(a,i,"fromString"),new Mc(Ed,a,i)}static fromBytes(e,t){let r=gw(an(e,"value"));const i=ib(t);return i.signed&&(r=QA(r,i.width)),Xg(r,i,"fromBytes"),new Mc(Ed,r,i)}};zo=new WeakMap,Un=new WeakMap,Ki=new WeakMap,vl=new WeakSet,gf=function(e){xe(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)},Ho=new WeakSet,al=function(e,t){return e=Xg(e,N(this,zo),t),new Mc(Ed,e,N(this,zo))},yv=new WeakSet,CT=function(e,t){return st(this,vl,gf).call(this,e),st(this,Ho,al).call(this,N(this,Un)+N(e,Un),t)},xv=new WeakSet,RT=function(e,t){return st(this,vl,gf).call(this,e),st(this,Ho,al).call(this,N(this,Un)-N(e,Un),t)},Av=new WeakSet,BT=function(e,t){return st(this,vl,gf).call(this,e),st(this,Ho,al).call(this,N(this,Un)*N(e,Un)/N(this,Ki),t)},_v=new WeakSet,PT=function(e,t){return qe(N(e,Un)!==Do,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),st(this,vl,gf).call(this,e),st(this,Ho,al).call(this,N(this,Un)*N(this,Ki)/N(e,Un),t)};let YA=Mc;function Lee(n){let e=n.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function _3(n,e,t){let r=0;for(let i=0;i<t;i++)r=r*256+n[e+i];return r}function w3(n,e,t,r){const i=[];for(;t<e+1+r;){const s=TG(n,t);i.push(s.result),t+=s.consumed,qe(t<=e+1+r,"child data too short","BUFFER_OVERRUN",{buffer:n,length:r,offset:e})}return{consumed:1+r,result:i}}function TG(n,e){qe(n.length!==0,"data too short","BUFFER_OVERRUN",{buffer:n,length:0,offset:1});const t=r=>{qe(r<=n.length,"data short segment too short","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:r})};if(n[e]>=248){const r=n[e]-247;t(e+1+r);const i=_3(n,e+1,r);return t(e+1+r+i),w3(n,e,e+1+r,r+i)}else if(n[e]>=192){const r=n[e]-192;return t(e+1+r),w3(n,e,e+1,r)}else if(n[e]>=184){const r=n[e]-183;t(e+1+r);const i=_3(n,e+1,r);t(e+1+r+i);const s=_t(n.slice(e+1+r,e+1+r+i));return{consumed:1+r+i,result:s}}else if(n[e]>=128){const r=n[e]-128;t(e+1+r);const i=_t(n.slice(e+1,e+1+r));return{consumed:1+r,result:i}}return{consumed:1,result:Lee(n[e])}}function sy(n){const e=an(n,"data"),t=TG(e,0);return xe(t.consumed===e.length,"unexpected junk after rlp payload","data",n),t.result}function E3(n){const e=[];for(;n;)e.unshift(n&255),n>>=8;return e}function CG(n){if(Array.isArray(n)){let r=[];if(n.forEach(function(s){r=r.concat(CG(s))}),r.length<=55)return r.unshift(192+r.length),r;const i=E3(r.length);return i.unshift(247+i.length),i.concat(r)}const e=Array.prototype.slice.call(an(n,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const t=E3(e.length);return t.unshift(183+t.length),t.concat(e)}const S3="0123456789abcdef";function Fl(n){let e="0x";for(const t of CG(n))e+=S3[t>>4],e+=S3[t&15];return e}const RG=["wei","kwei","mwei","gwei","szabo","finney","ether"];function BG(n,e){let t=18;if(typeof e=="string"){const r=RG.indexOf(e);xe(r>=0,"invalid unit","unit",e),t=3*r}else e!=null&&(t=Qt(e,"unit"));return YA.fromValue(n,t,{decimals:t,width:512}).toString()}function Nee(n,e){xe(typeof n=="string","value must be a string","value",n);let t=18;if(typeof e=="string"){const r=RG.indexOf(e);xe(r>=0,"invalid unit","unit",e),t=3*r}else e!=null&&(t=Qt(e,"unit"));return YA.fromString(n,{decimals:t,width:512}).value}function Dee(n){return BG(n,18)}function b3(n){return Nee(n,18)}const es=32,IT=new Uint8Array(es),Uee=["then"],E1={},PG=new WeakMap;function xf(n){return PG.get(n)}function M3(n,e){PG.set(n,e)}function Jg(n,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${n}`);throw t.error=e,t}function LT(n,e,t){return n.indexOf(null)>=0?e.map((r,i)=>r instanceof bm?LT(xf(r),r,t):r):n.reduce((r,i,s)=>{let o=e.getValue(i);return i in r||(t&&o instanceof bm&&(o=LT(xf(o),o,t)),r[i]=o),r},{})}var Mp;const np=class np extends Array{constructor(...t){const r=t[0];let i=t[1],s=(t[2]||[]).slice(),o=!0;r!==E1&&(i=t,s=[],o=!1);super(i.length);Be(this,Mp,void 0);i.forEach((c,u)=>{this[u]=c});const a=s.reduce((c,u)=>(typeof u=="string"&&c.set(u,(c.get(u)||0)+1),c),new Map);if(M3(this,Object.freeze(i.map((c,u)=>{const f=s[u];return f!=null&&a.get(f)===1?f:null}))),oe(this,Mp,[]),N(this,Mp)==null&&N(this,Mp),!o)return;Object.freeze(this);const l=new Proxy(this,{get:(c,u,f)=>{if(typeof u=="string"){if(u.match(/^[0-9]+$/)){const m=Qt(u,"%index");if(m<0||m>=this.length)throw new RangeError("out of result range");const g=c[m];return g instanceof Error&&Jg(`index ${m}`,g),g}if(Uee.indexOf(u)>=0)return Reflect.get(c,u,f);const d=c[u];if(d instanceof Function)return function(...m){return d.apply(this===f?c:this,m)};if(!(u in c))return c.getValue.apply(this===f?c:this,[u])}return Reflect.get(c,u,f)}});return M3(l,xf(this)),l}toArray(t){const r=[];return this.forEach((i,s)=>{i instanceof Error&&Jg(`index ${s}`,i),t&&i instanceof np&&(i=i.toArray(t)),r.push(i)}),r}toObject(t){const r=xf(this);return r.reduce((i,s,o)=>(qe(s!=null,`value at index ${o} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),LT(r,this,t)),{})}slice(t,r){t==null&&(t=0),t<0&&(t+=this.length,t<0&&(t=0)),r==null&&(r=this.length),r<0&&(r+=this.length,r<0&&(r=0)),r>this.length&&(r=this.length);const i=xf(this),s=[],o=[];for(let a=t;a<r;a++)s.push(this[a]),o.push(i[a]);return new np(E1,s,o)}filter(t,r){const i=xf(this),s=[],o=[];for(let a=0;a<this.length;a++){const l=this[a];l instanceof Error&&Jg(`index ${a}`,l),t.call(r,l,a,this)&&(s.push(l),o.push(i[a]))}return new np(E1,s,o)}map(t,r){const i=[];for(let s=0;s<this.length;s++){const o=this[s];o instanceof Error&&Jg(`index ${s}`,o),i.push(t.call(r,o,s,this))}return i}getValue(t){const r=xf(this).indexOf(t);if(r===-1)return;const i=this[r];return i instanceof Error&&Jg(`property ${JSON.stringify(t)}`,i.error),i}static fromItems(t,r){return new np(E1,t,r)}};Mp=new WeakMap;let bm=np;function T3(n){let e=kr(n);return qe(e.length<=es,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:es,offset:e.length}),e.length!==es&&(e=$i(tr([IT.slice(e.length%es),e]))),e}class jl{constructor(e,t,r,i){Ee(this,"name");Ee(this,"type");Ee(this,"localName");Ee(this,"dynamic");Ht(this,{name:e,type:t,localName:r,dynamic:i},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,t){xe(!1,e,this.localName,t)}}var yl,Wf,Tp,iA;class NT{constructor(){Be(this,Tp);Be(this,yl,void 0);Be(this,Wf,void 0);oe(this,yl,[]),oe(this,Wf,0)}get data(){return tr(N(this,yl))}get length(){return N(this,Wf)}appendWriter(e){return st(this,Tp,iA).call(this,$i(e.data))}writeBytes(e){let t=$i(e);const r=t.length%es;return r&&(t=$i(tr([t,IT.slice(r)]))),st(this,Tp,iA).call(this,t)}writeValue(e){return st(this,Tp,iA).call(this,T3(e))}writeUpdatableValue(){const e=N(this,yl).length;return N(this,yl).push(IT),oe(this,Wf,N(this,Wf)+es),t=>{N(this,yl)[e]=T3(t)}}}yl=new WeakMap,Wf=new WeakMap,Tp=new WeakSet,iA=function(e){return N(this,yl).push(e),oe(this,Wf,N(this,Wf)+e.length),e.length};var ds,zs,Xf,Jf,Ic,wv,UT,c_,IG;const jR=class jR{constructor(e,t,r){Be(this,wv);Be(this,c_);Ee(this,"allowLoose");Be(this,ds,void 0);Be(this,zs,void 0);Be(this,Xf,void 0);Be(this,Jf,void 0);Be(this,Ic,void 0);Ht(this,{allowLoose:!!t}),oe(this,ds,$i(e)),oe(this,Xf,0),oe(this,Jf,null),oe(this,Ic,r??1024),oe(this,zs,0)}get data(){return _t(N(this,ds))}get dataLength(){return N(this,ds).length}get consumed(){return N(this,zs)}get bytes(){return new Uint8Array(N(this,ds))}subReader(e){const t=new jR(N(this,ds).slice(N(this,zs)+e),this.allowLoose,N(this,Ic));return oe(t,Jf,this),t}readBytes(e,t){let r=st(this,c_,IG).call(this,0,e,!!t);return st(this,wv,UT).call(this,e),oe(this,zs,N(this,zs)+r.length),r.slice(0,e)}readValue(){return gw(this.readBytes(es))}readIndex(){return pee(this.readBytes(es))}};ds=new WeakMap,zs=new WeakMap,Xf=new WeakMap,Jf=new WeakMap,Ic=new WeakMap,wv=new WeakSet,UT=function(e){var t;if(N(this,Jf))return st(t=N(this,Jf),wv,UT).call(t,e);oe(this,Xf,N(this,Xf)+e),qe(N(this,Ic)<1||N(this,Xf)<=N(this,Ic)*this.dataLength,`compressed ABI data exceeds inflation ratio of ${N(this,Ic)} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:$i(N(this,ds)),offset:N(this,zs),length:e,info:{bytesRead:N(this,Xf),dataLength:this.dataLength}})},c_=new WeakSet,IG=function(e,t,r){let i=Math.ceil(t/es)*es;return N(this,zs)+i>N(this,ds).length&&(this.allowLoose&&r&&N(this,zs)+t<=N(this,ds).length?i=t:qe(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:$i(N(this,ds)),length:N(this,ds).length,offset:N(this,zs)+i})),N(this,ds).slice(N(this,zs),N(this,zs)+i)};let DT=jR;function ZA(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`Wrong positive integer: ${n}`)}function RR(n,...e){if(!(n instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(n.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${n.length}`)}function Fee(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");ZA(n.outputLen),ZA(n.blockLen)}function Mm(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function LG(n,e){RR(n);const t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}const sb=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const NG=n=>n instanceof Uint8Array,Oee=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4)),ob=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),Aa=(n,e)=>n<<32-e|n>>>e,kee=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!kee)throw new Error("Non little-endian hardware is not supported");function Gee(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function vw(n){if(typeof n=="string"&&(n=Gee(n)),!NG(n))throw new Error(`expected Uint8Array, got ${typeof n}`);return n}function zee(...n){const e=new Uint8Array(n.reduce((r,i)=>r+i.length,0));let t=0;return n.forEach(r=>{if(!NG(r))throw new Error("Uint8Array expected");e.set(r,t),t+=r.length}),e}class BR{clone(){return this._cloneInto()}}function PR(n){const e=r=>n().update(vw(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function Hee(n=32){if(sb&&typeof sb.getRandomValues=="function")return sb.getRandomValues(new Uint8Array(n));throw new Error("crypto.getRandomValues must be defined")}class DG extends BR{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Fee(e);const r=vw(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),s.fill(0)}update(e){return Mm(this),this.iHash.update(e),this}digestInto(e){Mm(this),RR(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const UG=(n,e,t)=>new DG(n,e).update(t).digest();UG.create=(n,e)=>new DG(n,e);function Vee(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(t>>i&s),a=Number(t&s),l=r?4:0,c=r?0:4;n.setUint32(e+l,o,r),n.setUint32(e+c,a,r)}class FG extends BR{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ob(this.buffer)}update(e){Mm(this);const{view:t,buffer:r,blockLen:i}=this;e=vw(e);const s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const l=ob(e);for(;i<=s-o;o+=i)this.process(l,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Mm(this),LG(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:i,isLE:s}=this;let{pos:o}=this;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(r,0),o=0);for(let f=o;f<i;f++)t[f]=0;Vee(r,i-8,BigInt(this.length*8),s),this.process(r,0);const a=ob(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=l/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<c;f++)a.setUint32(4*f,u[f],s)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:i,finished:s,destroyed:o,pos:a}=this;return e.length=i,e.pos=a,e.finished=s,e.destroyed=o,i%t&&e.buffer.set(r),e}}const Wee=(n,e,t)=>n&e^~n&t,Xee=(n,e,t)=>n&e^n&t^e&t,Jee=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),vc=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),yc=new Uint32Array(64);class Kee extends FG{constructor(){super(64,32,8,!1),this.A=vc[0]|0,this.B=vc[1]|0,this.C=vc[2]|0,this.D=vc[3]|0,this.E=vc[4]|0,this.F=vc[5]|0,this.G=vc[6]|0,this.H=vc[7]|0}get(){const{A:e,B:t,C:r,D:i,E:s,F:o,G:a,H:l}=this;return[e,t,r,i,s,o,a,l]}set(e,t,r,i,s,o,a,l){this.A=e|0,this.B=t|0,this.C=r|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=l|0}process(e,t){for(let f=0;f<16;f++,t+=4)yc[f]=e.getUint32(t,!1);for(let f=16;f<64;f++){const d=yc[f-15],m=yc[f-2],g=Aa(d,7)^Aa(d,18)^d>>>3,y=Aa(m,17)^Aa(m,19)^m>>>10;yc[f]=y+yc[f-7]+g+yc[f-16]|0}let{A:r,B:i,C:s,D:o,E:a,F:l,G:c,H:u}=this;for(let f=0;f<64;f++){const d=Aa(a,6)^Aa(a,11)^Aa(a,25),m=u+d+Wee(a,l,c)+Jee[f]+yc[f]|0,y=(Aa(r,2)^Aa(r,13)^Aa(r,22))+Xee(r,i,s)|0;u=c,c=l,l=a,a=o+m|0,o=s,s=i,i=r,r=m+y|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,l=l+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,i,s,o,a,l,c,u)}roundClean(){yc.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const OG=PR(()=>new Kee),S1=BigInt(2**32-1),FT=BigInt(32);function kG(n,e=!1){return e?{h:Number(n&S1),l:Number(n>>FT&S1)}:{h:Number(n>>FT&S1)|0,l:Number(n&S1)|0}}function GG(n,e=!1){let t=new Uint32Array(n.length),r=new Uint32Array(n.length);for(let i=0;i<n.length;i++){const{h:s,l:o}=kG(n[i],e);[t[i],r[i]]=[s,o]}return[t,r]}const Qee=(n,e)=>BigInt(n>>>0)<<FT|BigInt(e>>>0),jee=(n,e,t)=>n>>>t,Yee=(n,e,t)=>n<<32-t|e>>>t,Zee=(n,e,t)=>n>>>t|e<<32-t,qee=(n,e,t)=>n<<32-t|e>>>t,$ee=(n,e,t)=>n<<64-t|e>>>t-32,ete=(n,e,t)=>n>>>t-32|e<<64-t,tte=(n,e)=>e,nte=(n,e)=>n,zG=(n,e,t)=>n<<t|e>>>32-t,HG=(n,e,t)=>e<<t|n>>>32-t,VG=(n,e,t)=>e<<t-32|n>>>64-t,WG=(n,e,t)=>n<<t-32|e>>>64-t;function rte(n,e,t,r){const i=(e>>>0)+(r>>>0);return{h:n+t+(i/2**32|0)|0,l:i|0}}const ite=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),ste=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,ote=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),ate=(n,e,t,r,i)=>e+t+r+i+(n/2**32|0)|0,lte=(n,e,t,r,i)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),cte=(n,e,t,r,i,s)=>e+t+r+i+s+(n/2**32|0)|0,ute={fromBig:kG,split:GG,toBig:Qee,shrSH:jee,shrSL:Yee,rotrSH:Zee,rotrSL:qee,rotrBH:$ee,rotrBL:ete,rotr32H:tte,rotr32L:nte,rotlSH:zG,rotlSL:HG,rotlBH:VG,rotlBL:WG,add:rte,add3L:ite,add3H:ste,add4L:ote,add4H:ate,add5H:cte,add5L:lte},sn=ute,[fte,hte]=(()=>sn.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))))(),xc=new Uint32Array(80),Ac=new Uint32Array(80);class dte extends FG{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:i,Ch:s,Cl:o,Dh:a,Dl:l,Eh:c,El:u,Fh:f,Fl:d,Gh:m,Gl:g,Hh:y,Hl:x}=this;return[e,t,r,i,s,o,a,l,c,u,f,d,m,g,y,x]}set(e,t,r,i,s,o,a,l,c,u,f,d,m,g,y,x){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=l|0,this.Eh=c|0,this.El=u|0,this.Fh=f|0,this.Fl=d|0,this.Gh=m|0,this.Gl=g|0,this.Hh=y|0,this.Hl=x|0}process(e,t){for(let w=0;w<16;w++,t+=4)xc[w]=e.getUint32(t),Ac[w]=e.getUint32(t+=4);for(let w=16;w<80;w++){const S=xc[w-15]|0,M=Ac[w-15]|0,b=sn.rotrSH(S,M,1)^sn.rotrSH(S,M,8)^sn.shrSH(S,M,7),R=sn.rotrSL(S,M,1)^sn.rotrSL(S,M,8)^sn.shrSL(S,M,7),P=xc[w-2]|0,C=Ac[w-2]|0,B=sn.rotrSH(P,C,19)^sn.rotrBH(P,C,61)^sn.shrSH(P,C,6),H=sn.rotrSL(P,C,19)^sn.rotrBL(P,C,61)^sn.shrSL(P,C,6),k=sn.add4L(R,H,Ac[w-7],Ac[w-16]),$=sn.add4H(k,b,B,xc[w-7],xc[w-16]);xc[w]=$|0,Ac[w]=k|0}let{Ah:r,Al:i,Bh:s,Bl:o,Ch:a,Cl:l,Dh:c,Dl:u,Eh:f,El:d,Fh:m,Fl:g,Gh:y,Gl:x,Hh:v,Hl:A}=this;for(let w=0;w<80;w++){const S=sn.rotrSH(f,d,14)^sn.rotrSH(f,d,18)^sn.rotrBH(f,d,41),M=sn.rotrSL(f,d,14)^sn.rotrSL(f,d,18)^sn.rotrBL(f,d,41),b=f&m^~f&y,R=d&g^~d&x,P=sn.add5L(A,M,R,hte[w],Ac[w]),C=sn.add5H(P,v,S,b,fte[w],xc[w]),B=P|0,H=sn.rotrSH(r,i,28)^sn.rotrBH(r,i,34)^sn.rotrBH(r,i,39),k=sn.rotrSL(r,i,28)^sn.rotrBL(r,i,34)^sn.rotrBL(r,i,39),$=r&s^r&a^s&a,U=i&o^i&l^o&l;v=y|0,A=x|0,y=m|0,x=g|0,m=f|0,g=d|0,{h:f,l:d}=sn.add(c|0,u|0,C|0,B|0),c=a|0,u=l|0,a=s|0,l=o|0,s=r|0,o=i|0;const z=sn.add3L(B,k,U);r=sn.add3H(z,C,H,$),i=z|0}({h:r,l:i}=sn.add(this.Ah|0,this.Al|0,r|0,i|0)),{h:s,l:o}=sn.add(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l}=sn.add(this.Ch|0,this.Cl|0,a|0,l|0),{h:c,l:u}=sn.add(this.Dh|0,this.Dl|0,c|0,u|0),{h:f,l:d}=sn.add(this.Eh|0,this.El|0,f|0,d|0),{h:m,l:g}=sn.add(this.Fh|0,this.Fl|0,m|0,g|0),{h:y,l:x}=sn.add(this.Gh|0,this.Gl|0,y|0,x|0),{h:v,l:A}=sn.add(this.Hh|0,this.Hl|0,v|0,A|0),this.set(r,i,s,o,a,l,c,u,f,d,m,g,y,x,v,A)}roundClean(){xc.fill(0),Ac.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const pte=PR(()=>new dte);function mte(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const C3=mte();C3.crypto||C3.msCrypto;function gte(n){switch(n){case"sha256":return OG.create();case"sha512":return pte.create()}xe(!1,"invalid hashing algorithm name","algorithm",n)}const[XG,JG,KG]=[[],[],[]],vte=BigInt(0),Kg=BigInt(1),yte=BigInt(2),xte=BigInt(7),Ate=BigInt(256),_te=BigInt(113);for(let n=0,e=Kg,t=1,r=0;n<24;n++){[t,r]=[r,(2*t+3*r)%5],XG.push(2*(5*r+t)),JG.push((n+1)*(n+2)/2%64);let i=vte;for(let s=0;s<7;s++)e=(e<<Kg^(e>>xte)*_te)%Ate,e&yte&&(i^=Kg<<(Kg<<BigInt(s))-Kg);KG.push(i)}const[wte,Ete]=GG(KG,!0),R3=(n,e,t)=>t>32?VG(n,e,t):zG(n,e,t),B3=(n,e,t)=>t>32?WG(n,e,t):HG(n,e,t);function Ste(n,e=24){const t=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)t[o]=n[o]^n[o+10]^n[o+20]^n[o+30]^n[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,l=(o+2)%10,c=t[l],u=t[l+1],f=R3(c,u,1)^t[a],d=B3(c,u,1)^t[a+1];for(let m=0;m<50;m+=10)n[o+m]^=f,n[o+m+1]^=d}let i=n[2],s=n[3];for(let o=0;o<24;o++){const a=JG[o],l=R3(i,s,a),c=B3(i,s,a),u=XG[o];i=n[u],s=n[u+1],n[u]=l,n[u+1]=c}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=n[o+a];for(let a=0;a<10;a++)n[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}n[0]^=wte[r],n[1]^=Ete[r]}t.fill(0)}class IR extends BR{constructor(e,t,r,i=!1,s=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,ZA(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Oee(this.state)}keccak(){Ste(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){Mm(this);const{blockLen:t,state:r}=this;e=vw(e);const i=e.length;for(let s=0;s<i;){const o=Math.min(t-this.pos,i-s);for(let a=0;a<o;a++)r[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,t&128&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){Mm(this,!1),RR(e),this.finish();const t=this.state,{blockLen:r}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ZA(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(LG(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new IR(t,r,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=r,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}const bte=(n,e,t)=>PR(()=>new IR(e,n,t)),Mte=bte(1,136,256/8);let QG=!1;const jG=function(n){return Mte(n)};let YG=jG;function Fr(n){const e=an(n,"data");return _t(YG(e))}Fr._=jG;Fr.lock=function(){QG=!0};Fr.register=function(n){if(QG)throw new TypeError("keccak256 is locked");YG=n};Object.freeze(Fr);const ZG=function(n){return gte("sha256").update(n).digest()};let qG=ZG,$G=!1;function Hm(n){const e=an(n,"data");return _t(qG(e))}Hm._=ZG;Hm.lock=function(){$G=!0};Hm.register=function(n){if($G)throw new Error("sha256 is locked");qG=n};Object.freeze(Hm);Object.freeze(Hm);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ez=BigInt(0),yw=BigInt(1),Tte=BigInt(2),xw=n=>n instanceof Uint8Array,Cte=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function Tm(n){if(!xw(n))throw new Error("Uint8Array expected");let e="";for(let t=0;t<n.length;t++)e+=Cte[n[t]];return e}function tz(n){const e=n.toString(16);return e.length&1?`0${e}`:e}function LR(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":`0x${n}`)}function Cm(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);const e=n.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const t=new Uint8Array(e/2);for(let r=0;r<t.length;r++){const i=r*2,s=n.slice(i,i+2),o=Number.parseInt(s,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[r]=o}return t}function dh(n){return LR(Tm(n))}function NR(n){if(!xw(n))throw new Error("Uint8Array expected");return LR(Tm(Uint8Array.from(n).reverse()))}function Rm(n,e){return Cm(n.toString(16).padStart(e*2,"0"))}function DR(n,e){return Rm(n,e).reverse()}function Rte(n){return Cm(tz(n))}function Oo(n,e,t){let r;if(typeof e=="string")try{r=Cm(e)}catch(s){throw new Error(`${n} must be valid hex string, got "${e}". Cause: ${s}`)}else if(xw(e))r=Uint8Array.from(e);else throw new Error(`${n} must be hex string or Uint8Array`);const i=r.length;if(typeof t=="number"&&i!==t)throw new Error(`${n} expected ${t} bytes, got ${i}`);return r}function iv(...n){const e=new Uint8Array(n.reduce((r,i)=>r+i.length,0));let t=0;return n.forEach(r=>{if(!xw(r))throw new Error("Uint8Array expected");e.set(r,t),t+=r.length}),e}function Bte(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Pte(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function Ite(n){let e;for(e=0;n>ez;n>>=yw,e+=1);return e}function Lte(n,e){return n>>BigInt(e)&yw}const Nte=(n,e,t)=>n|(t?yw:ez)<<BigInt(e),UR=n=>(Tte<<BigInt(n-1))-yw,ab=n=>new Uint8Array(n),P3=n=>Uint8Array.from(n);function nz(n,e,t){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let r=ab(n),i=ab(n),s=0;const o=()=>{r.fill(1),i.fill(0),s=0},a=(...f)=>t(i,r,...f),l=(f=ab())=>{i=a(P3([0]),f),r=a(),f.length!==0&&(i=a(P3([1]),f),r=a())},c=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let f=0;const d=[];for(;f<e;){r=a();const m=r.slice();d.push(m),f+=r.length}return iv(...d)};return(f,d)=>{o(),l(f);let m;for(;!(m=d(c()));)l();return o(),m}}const Dte={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||n instanceof Uint8Array,isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,e)=>e.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function oy(n,e,t={}){const r=(i,s,o)=>{const a=Dte[s];if(typeof a!="function")throw new Error(`Invalid validator "${s}", expected function`);const l=n[i];if(!(o&&l===void 0)&&!a(l,n))throw new Error(`Invalid param ${String(i)}=${l} (${typeof l}), expected ${s}`)};for(const[i,s]of Object.entries(e))r(i,s,!1);for(const[i,s]of Object.entries(t))r(i,s,!0);return n}const Ute=Object.freeze(Object.defineProperty({__proto__:null,bitGet:Lte,bitLen:Ite,bitMask:UR,bitSet:Nte,bytesToHex:Tm,bytesToNumberBE:dh,bytesToNumberLE:NR,concatBytes:iv,createHmacDrbg:nz,ensureBytes:Oo,equalBytes:Bte,hexToBytes:Cm,hexToNumber:LR,numberToBytesBE:Rm,numberToBytesLE:DR,numberToHexUnpadded:tz,numberToVarBytesBE:Rte,utf8ToBytes:Pte,validateObject:oy},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ri=BigInt(0),Tr=BigInt(1),Af=BigInt(2),Fte=BigInt(3),OT=BigInt(4),I3=BigInt(5),L3=BigInt(8);BigInt(9);BigInt(16);function ms(n,e){const t=n%e;return t>=ri?t:e+t}function Ote(n,e,t){if(t<=ri||e<ri)throw new Error("Expected power/modulo > 0");if(t===Tr)return ri;let r=Tr;for(;e>ri;)e&Tr&&(r=r*n%t),n=n*n%t,e>>=Tr;return r}function so(n,e,t){let r=n;for(;e-- >ri;)r*=r,r%=t;return r}function kT(n,e){if(n===ri||e<=ri)throw new Error(`invert: expected positive integers, got n=${n} mod=${e}`);let t=ms(n,e),r=e,i=ri,s=Tr;for(;t!==ri;){const a=r/t,l=r%t,c=i-s*a;r=t,t=l,i=s,s=c}if(r!==Tr)throw new Error("invert: does not exist");return ms(i,e)}function kte(n){const e=(n-Tr)/Af;let t,r,i;for(t=n-Tr,r=0;t%Af===ri;t/=Af,r++);for(i=Af;i<n&&Ote(i,e,n)!==n-Tr;i++);if(r===1){const o=(n+Tr)/OT;return function(l,c){const u=l.pow(c,o);if(!l.eql(l.sqr(u),c))throw new Error("Cannot find square root");return u}}const s=(t+Tr)/Af;return function(a,l){if(a.pow(l,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let c=r,u=a.pow(a.mul(a.ONE,i),t),f=a.pow(l,s),d=a.pow(l,t);for(;!a.eql(d,a.ONE);){if(a.eql(d,a.ZERO))return a.ZERO;let m=1;for(let y=a.sqr(d);m<c&&!a.eql(y,a.ONE);m++)y=a.sqr(y);const g=a.pow(u,Tr<<BigInt(c-m-1));u=a.sqr(g),f=a.mul(f,g),d=a.mul(d,u),c=m}return f}}function Gte(n){if(n%OT===Fte){const e=(n+Tr)/OT;return function(r,i){const s=r.pow(i,e);if(!r.eql(r.sqr(s),i))throw new Error("Cannot find square root");return s}}if(n%L3===I3){const e=(n-I3)/L3;return function(r,i){const s=r.mul(i,Af),o=r.pow(s,e),a=r.mul(i,o),l=r.mul(r.mul(a,Af),o),c=r.mul(a,r.sub(l,r.ONE));if(!r.eql(r.sqr(c),i))throw new Error("Cannot find square root");return c}}return kte(n)}const zte=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Hte(n){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=zte.reduce((r,i)=>(r[i]="function",r),e);return oy(n,t)}function Vte(n,e,t){if(t<ri)throw new Error("Expected power > 0");if(t===ri)return n.ONE;if(t===Tr)return e;let r=n.ONE,i=e;for(;t>ri;)t&Tr&&(r=n.mul(r,i)),i=n.sqr(i),t>>=Tr;return r}function Wte(n,e){const t=new Array(e.length),r=e.reduce((s,o,a)=>n.is0(o)?s:(t[a]=s,n.mul(s,o)),n.ONE),i=n.inv(r);return e.reduceRight((s,o,a)=>n.is0(o)?s:(t[a]=n.mul(s,t[a]),n.mul(s,o)),i),t}function rz(n,e){const t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function Xte(n,e,t=!1,r={}){if(n<=ri)throw new Error(`Expected Field ORDER > 0, got ${n}`);const{nBitLength:i,nByteLength:s}=rz(n,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=Gte(n),a=Object.freeze({ORDER:n,BITS:i,BYTES:s,MASK:UR(i),ZERO:ri,ONE:Tr,create:l=>ms(l,n),isValid:l=>{if(typeof l!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof l}`);return ri<=l&&l<n},is0:l=>l===ri,isOdd:l=>(l&Tr)===Tr,neg:l=>ms(-l,n),eql:(l,c)=>l===c,sqr:l=>ms(l*l,n),add:(l,c)=>ms(l+c,n),sub:(l,c)=>ms(l-c,n),mul:(l,c)=>ms(l*c,n),pow:(l,c)=>Vte(a,l,c),div:(l,c)=>ms(l*kT(c,n),n),sqrN:l=>l*l,addN:(l,c)=>l+c,subN:(l,c)=>l-c,mulN:(l,c)=>l*c,inv:l=>kT(l,n),sqrt:r.sqrt||(l=>o(a,l)),invertBatch:l=>Wte(a,l),cmov:(l,c,u)=>u?c:l,toBytes:l=>t?DR(l,s):Rm(l,s),fromBytes:l=>{if(l.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${l.length}`);return t?NR(l):dh(l)}});return Object.freeze(a)}function iz(n){if(typeof n!="bigint")throw new Error("field order must be bigint");const e=n.toString(2).length;return Math.ceil(e/8)}function sz(n){const e=iz(n);return e+Math.ceil(e/2)}function Jte(n,e,t=!1){const r=n.length,i=iz(e),s=sz(e);if(r<16||r<s||r>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${r}`);const o=t?dh(n):NR(n),a=ms(o,e-Tr)+Tr;return t?DR(a,i):Rm(a,i)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Kte=BigInt(0),lb=BigInt(1);function Qte(n,e){const t=(i,s)=>{const o=s.negate();return i?o:s},r=i=>{const s=Math.ceil(e/i)+1,o=2**(i-1);return{windows:s,windowSize:o}};return{constTimeNegate:t,unsafeLadder(i,s){let o=n.ZERO,a=i;for(;s>Kte;)s&lb&&(o=o.add(a)),a=a.double(),s>>=lb;return o},precomputeWindow(i,s){const{windows:o,windowSize:a}=r(s),l=[];let c=i,u=c;for(let f=0;f<o;f++){u=c,l.push(u);for(let d=1;d<a;d++)u=u.add(c),l.push(u);c=u.double()}return l},wNAF(i,s,o){const{windows:a,windowSize:l}=r(i);let c=n.ZERO,u=n.BASE;const f=BigInt(2**i-1),d=2**i,m=BigInt(i);for(let g=0;g<a;g++){const y=g*l;let x=Number(o&f);o>>=m,x>l&&(x-=d,o+=lb);const v=y,A=y+Math.abs(x)-1,w=g%2!==0,S=x<0;x===0?u=u.add(t(w,s[v])):c=c.add(t(S,s[A]))}return{p:c,f:u}},wNAFCached(i,s,o,a){const l=i._WINDOW_SIZE||1;let c=s.get(i);return c||(c=this.precomputeWindow(i,l),l!==1&&s.set(i,a(c))),this.wNAF(l,c,o)}}}function oz(n){return Hte(n.Fp),oy(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...rz(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function jte(n){const e=oz(n);oy(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:t,Fp:r,a:i}=e;if(t){if(!r.eql(i,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:Yte,hexToBytes:Zte}=Ute,Df={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(n){const{Err:e}=Df;if(n.length<2||n[0]!==2)throw new e("Invalid signature integer tag");const t=n[1],r=n.subarray(2,t+2);if(!t||r.length!==t)throw new e("Invalid signature integer: wrong length");if(r[0]&128)throw new e("Invalid signature integer: negative");if(r[0]===0&&!(r[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Yte(r),l:n.subarray(t+2)}},toSig(n){const{Err:e}=Df,t=typeof n=="string"?Zte(n):n;if(!(t instanceof Uint8Array))throw new Error("ui8a expected");let r=t.length;if(r<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:i,l:s}=Df._parseInt(t.subarray(2)),{d:o,l:a}=Df._parseInt(s);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s:o}},hexFromSig(n){const e=c=>Number.parseInt(c[0],16)&8?"00"+c:c,t=c=>{const u=c.toString(16);return u.length&1?`0${u}`:u},r=e(t(n.s)),i=e(t(n.r)),s=r.length/2,o=i.length/2,a=t(s),l=t(o);return`30${t(o+s+4)}02${l}${i}02${a}${r}`}},Cl=BigInt(0),go=BigInt(1);BigInt(2);const N3=BigInt(3);BigInt(4);function qte(n){const e=jte(n),{Fp:t}=e,r=e.toBytes||((g,y,x)=>{const v=y.toAffine();return iv(Uint8Array.from([4]),t.toBytes(v.x),t.toBytes(v.y))}),i=e.fromBytes||(g=>{const y=g.subarray(1),x=t.fromBytes(y.subarray(0,t.BYTES)),v=t.fromBytes(y.subarray(t.BYTES,2*t.BYTES));return{x,y:v}});function s(g){const{a:y,b:x}=e,v=t.sqr(g),A=t.mul(v,g);return t.add(t.add(A,t.mul(g,y)),x)}if(!t.eql(t.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function o(g){return typeof g=="bigint"&&Cl<g&&g<e.n}function a(g){if(!o(g))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function l(g){const{allowedPrivateKeyLengths:y,nByteLength:x,wrapPrivateKey:v,n:A}=e;if(y&&typeof g!="bigint"){if(g instanceof Uint8Array&&(g=Tm(g)),typeof g!="string"||!y.includes(g.length))throw new Error("Invalid key");g=g.padStart(x*2,"0")}let w;try{w=typeof g=="bigint"?g:dh(Oo("private key",g,x))}catch{throw new Error(`private key must be ${x} bytes, hex or bigint, not ${typeof g}`)}return v&&(w=ms(w,A)),a(w),w}const c=new Map;function u(g){if(!(g instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(y,x,v){if(this.px=y,this.py=x,this.pz=v,y==null||!t.isValid(y))throw new Error("x required");if(x==null||!t.isValid(x))throw new Error("y required");if(v==null||!t.isValid(v))throw new Error("z required")}static fromAffine(y){const{x,y:v}=y||{};if(!y||!t.isValid(x)||!t.isValid(v))throw new Error("invalid affine point");if(y instanceof f)throw new Error("projective point not allowed");const A=w=>t.eql(w,t.ZERO);return A(x)&&A(v)?f.ZERO:new f(x,v,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(y){const x=t.invertBatch(y.map(v=>v.pz));return y.map((v,A)=>v.toAffine(x[A])).map(f.fromAffine)}static fromHex(y){const x=f.fromAffine(i(Oo("pointHex",y)));return x.assertValidity(),x}static fromPrivateKey(y){return f.BASE.multiply(l(y))}_setWindowSize(y){this._WINDOW_SIZE=y,c.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:y,y:x}=this.toAffine();if(!t.isValid(y)||!t.isValid(x))throw new Error("bad point: x or y not FE");const v=t.sqr(x),A=s(y);if(!t.eql(v,A))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y}=this.toAffine();if(t.isOdd)return!t.isOdd(y);throw new Error("Field doesn't support isOdd")}equals(y){u(y);const{px:x,py:v,pz:A}=this,{px:w,py:S,pz:M}=y,b=t.eql(t.mul(x,M),t.mul(w,A)),R=t.eql(t.mul(v,M),t.mul(S,A));return b&&R}negate(){return new f(this.px,t.neg(this.py),this.pz)}double(){const{a:y,b:x}=e,v=t.mul(x,N3),{px:A,py:w,pz:S}=this;let M=t.ZERO,b=t.ZERO,R=t.ZERO,P=t.mul(A,A),C=t.mul(w,w),B=t.mul(S,S),H=t.mul(A,w);return H=t.add(H,H),R=t.mul(A,S),R=t.add(R,R),M=t.mul(y,R),b=t.mul(v,B),b=t.add(M,b),M=t.sub(C,b),b=t.add(C,b),b=t.mul(M,b),M=t.mul(H,M),R=t.mul(v,R),B=t.mul(y,B),H=t.sub(P,B),H=t.mul(y,H),H=t.add(H,R),R=t.add(P,P),P=t.add(R,P),P=t.add(P,B),P=t.mul(P,H),b=t.add(b,P),B=t.mul(w,S),B=t.add(B,B),P=t.mul(B,H),M=t.sub(M,P),R=t.mul(B,C),R=t.add(R,R),R=t.add(R,R),new f(M,b,R)}add(y){u(y);const{px:x,py:v,pz:A}=this,{px:w,py:S,pz:M}=y;let b=t.ZERO,R=t.ZERO,P=t.ZERO;const C=e.a,B=t.mul(e.b,N3);let H=t.mul(x,w),k=t.mul(v,S),$=t.mul(A,M),U=t.add(x,v),z=t.add(w,S);U=t.mul(U,z),z=t.add(H,k),U=t.sub(U,z),z=t.add(x,A);let O=t.add(w,M);return z=t.mul(z,O),O=t.add(H,$),z=t.sub(z,O),O=t.add(v,A),b=t.add(S,M),O=t.mul(O,b),b=t.add(k,$),O=t.sub(O,b),P=t.mul(C,z),b=t.mul(B,$),P=t.add(b,P),b=t.sub(k,P),P=t.add(k,P),R=t.mul(b,P),k=t.add(H,H),k=t.add(k,H),$=t.mul(C,$),z=t.mul(B,z),k=t.add(k,$),$=t.sub(H,$),$=t.mul(C,$),z=t.add(z,$),H=t.mul(k,z),R=t.add(R,H),H=t.mul(O,z),b=t.mul(U,b),b=t.sub(b,H),H=t.mul(U,k),P=t.mul(O,P),P=t.add(P,H),new f(b,R,P)}subtract(y){return this.add(y.negate())}is0(){return this.equals(f.ZERO)}wNAF(y){return m.wNAFCached(this,c,y,x=>{const v=t.invertBatch(x.map(A=>A.pz));return x.map((A,w)=>A.toAffine(v[w])).map(f.fromAffine)})}multiplyUnsafe(y){const x=f.ZERO;if(y===Cl)return x;if(a(y),y===go)return this;const{endo:v}=e;if(!v)return m.unsafeLadder(this,y);let{k1neg:A,k1:w,k2neg:S,k2:M}=v.splitScalar(y),b=x,R=x,P=this;for(;w>Cl||M>Cl;)w&go&&(b=b.add(P)),M&go&&(R=R.add(P)),P=P.double(),w>>=go,M>>=go;return A&&(b=b.negate()),S&&(R=R.negate()),R=new f(t.mul(R.px,v.beta),R.py,R.pz),b.add(R)}multiply(y){a(y);let x=y,v,A;const{endo:w}=e;if(w){const{k1neg:S,k1:M,k2neg:b,k2:R}=w.splitScalar(x);let{p:P,f:C}=this.wNAF(M),{p:B,f:H}=this.wNAF(R);P=m.constTimeNegate(S,P),B=m.constTimeNegate(b,B),B=new f(t.mul(B.px,w.beta),B.py,B.pz),v=P.add(B),A=C.add(H)}else{const{p:S,f:M}=this.wNAF(x);v=S,A=M}return f.normalizeZ([v,A])[0]}multiplyAndAddUnsafe(y,x,v){const A=f.BASE,w=(M,b)=>b===Cl||b===go||!M.equals(A)?M.multiplyUnsafe(b):M.multiply(b),S=w(this,x).add(w(y,v));return S.is0()?void 0:S}toAffine(y){const{px:x,py:v,pz:A}=this,w=this.is0();y==null&&(y=w?t.ONE:t.inv(A));const S=t.mul(x,y),M=t.mul(v,y),b=t.mul(A,y);if(w)return{x:t.ZERO,y:t.ZERO};if(!t.eql(b,t.ONE))throw new Error("invZ was invalid");return{x:S,y:M}}isTorsionFree(){const{h:y,isTorsionFree:x}=e;if(y===go)return!0;if(x)return x(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:y,clearCofactor:x}=e;return y===go?this:x?x(f,this):this.multiplyUnsafe(e.h)}toRawBytes(y=!0){return this.assertValidity(),r(f,this,y)}toHex(y=!0){return Tm(this.toRawBytes(y))}}f.BASE=new f(e.Gx,e.Gy,t.ONE),f.ZERO=new f(t.ZERO,t.ONE,t.ZERO);const d=e.nBitLength,m=Qte(f,e.endo?Math.ceil(d/2):d);return{CURVE:e,ProjectivePoint:f,normPrivateKeyToScalar:l,weierstrassEquation:s,isWithinCurveOrder:o}}function $te(n){const e=oz(n);return oy(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function ene(n){const e=$te(n),{Fp:t,n:r}=e,i=t.BYTES+1,s=2*t.BYTES+1;function o(z){return Cl<z&&z<t.ORDER}function a(z){return ms(z,r)}function l(z){return kT(z,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:f,isWithinCurveOrder:d}=qte({...e,toBytes(z,O,ie){const X=O.toAffine(),K=t.toBytes(X.x),W=iv;return ie?W(Uint8Array.from([O.hasEvenY()?2:3]),K):W(Uint8Array.from([4]),K,t.toBytes(X.y))},fromBytes(z){const O=z.length,ie=z[0],X=z.subarray(1);if(O===i&&(ie===2||ie===3)){const K=dh(X);if(!o(K))throw new Error("Point is not on curve");const W=f(K);let V=t.sqrt(W);const Q=(V&go)===go;return(ie&1)===1!==Q&&(V=t.neg(V)),{x:K,y:V}}else if(O===s&&ie===4){const K=t.fromBytes(X.subarray(0,t.BYTES)),W=t.fromBytes(X.subarray(t.BYTES,2*t.BYTES));return{x:K,y:W}}else throw new Error(`Point of length ${O} was invalid. Expected ${i} compressed bytes or ${s} uncompressed bytes`)}}),m=z=>Tm(Rm(z,e.nByteLength));function g(z){const O=r>>go;return z>O}function y(z){return g(z)?a(-z):z}const x=(z,O,ie)=>dh(z.slice(O,ie));class v{constructor(O,ie,X){this.r=O,this.s=ie,this.recovery=X,this.assertValidity()}static fromCompact(O){const ie=e.nByteLength;return O=Oo("compactSignature",O,ie*2),new v(x(O,0,ie),x(O,ie,2*ie))}static fromDER(O){const{r:ie,s:X}=Df.toSig(Oo("DER",O));return new v(ie,X)}assertValidity(){if(!d(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!d(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(O){return new v(this.r,this.s,O)}recoverPublicKey(O){const{r:ie,s:X,recovery:K}=this,W=R(Oo("msgHash",O));if(K==null||![0,1,2,3].includes(K))throw new Error("recovery id invalid");const V=K===2||K===3?ie+e.n:ie;if(V>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const Q=K&1?"03":"02",q=c.fromHex(Q+m(V)),ne=l(V),fe=a(-W*ne),pe=a(X*ne),ge=c.BASE.multiplyAndAddUnsafe(q,fe,pe);if(!ge)throw new Error("point at infinify");return ge.assertValidity(),ge}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new v(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Cm(this.toDERHex())}toDERHex(){return Df.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Cm(this.toCompactHex())}toCompactHex(){return m(this.r)+m(this.s)}}const A={isValidPrivateKey(z){try{return u(z),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const z=sz(e.n);return Jte(e.randomBytes(z),e.n)},precompute(z=8,O=c.BASE){return O._setWindowSize(z),O.multiply(BigInt(3)),O}};function w(z,O=!0){return c.fromPrivateKey(z).toRawBytes(O)}function S(z){const O=z instanceof Uint8Array,ie=typeof z=="string",X=(O||ie)&&z.length;return O?X===i||X===s:ie?X===2*i||X===2*s:z instanceof c}function M(z,O,ie=!0){if(S(z))throw new Error("first arg must be private key");if(!S(O))throw new Error("second arg must be public key");return c.fromHex(O).multiply(u(z)).toRawBytes(ie)}const b=e.bits2int||function(z){const O=dh(z),ie=z.length*8-e.nBitLength;return ie>0?O>>BigInt(ie):O},R=e.bits2int_modN||function(z){return a(b(z))},P=UR(e.nBitLength);function C(z){if(typeof z!="bigint")throw new Error("bigint expected");if(!(Cl<=z&&z<P))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Rm(z,e.nByteLength)}function B(z,O,ie=H){if(["recovered","canonical"].some(Je=>Je in ie))throw new Error("sign() legacy options not supported");const{hash:X,randomBytes:K}=e;let{lowS:W,prehash:V,extraEntropy:Q}=ie;W==null&&(W=!0),z=Oo("msgHash",z),V&&(z=Oo("prehashed msgHash",X(z)));const q=R(z),ne=u(O),fe=[C(ne),C(q)];if(Q!=null){const Je=Q===!0?K(t.BYTES):Q;fe.push(Oo("extraEntropy",Je))}const pe=iv(...fe),ge=q;function Ce(Je){const Xe=b(Je);if(!d(Xe))return;const Fe=l(Xe),j=c.BASE.multiply(Xe).toAffine(),Te=a(j.x);if(Te===Cl)return;const be=a(Fe*a(ge+Te*ne));if(be===Cl)return;let Ue=(j.x===Te?0:2)|Number(j.y&go),we=be;return W&&g(be)&&(we=y(be),Ue^=1),new v(Te,we,Ue)}return{seed:pe,k2sig:Ce}}const H={lowS:e.lowS,prehash:!1},k={lowS:e.lowS,prehash:!1};function $(z,O,ie=H){const{seed:X,k2sig:K}=B(z,O,ie),W=e;return nz(W.hash.outputLen,W.nByteLength,W.hmac)(X,K)}c.BASE._setWindowSize(8);function U(z,O,ie,X=k){var j;const K=z;if(O=Oo("msgHash",O),ie=Oo("publicKey",ie),"strict"in X)throw new Error("options.strict was renamed to lowS");const{lowS:W,prehash:V}=X;let Q,q;try{if(typeof K=="string"||K instanceof Uint8Array)try{Q=v.fromDER(K)}catch(Te){if(!(Te instanceof Df.Err))throw Te;Q=v.fromCompact(K)}else if(typeof K=="object"&&typeof K.r=="bigint"&&typeof K.s=="bigint"){const{r:Te,s:be}=K;Q=new v(Te,be)}else throw new Error("PARSE");q=c.fromHex(ie)}catch(Te){if(Te.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(W&&Q.hasHighS())return!1;V&&(O=e.hash(O));const{r:ne,s:fe}=Q,pe=R(O),ge=l(fe),Ce=a(pe*ge),Je=a(ne*ge),Xe=(j=c.BASE.multiplyAndAddUnsafe(q,Ce,Je))==null?void 0:j.toAffine();return Xe?a(Xe.x)===ne:!1}return{CURVE:e,getPublicKey:w,getSharedSecret:M,sign:$,verify:U,ProjectivePoint:c,Signature:v,utils:A}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function tne(n){return{hash:n,hmac:(e,...t)=>UG(n,e,zee(...t)),randomBytes:Hee}}function nne(n,e){const t=r=>ene({...n,...tne(r)});return Object.freeze({...t(e),create:t})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const az=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),D3=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),rne=BigInt(1),GT=BigInt(2),U3=(n,e)=>(n+e/GT)/e;function ine(n){const e=az,t=BigInt(3),r=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),l=BigInt(88),c=n*n*n%e,u=c*c*n%e,f=so(u,t,e)*u%e,d=so(f,t,e)*u%e,m=so(d,GT,e)*c%e,g=so(m,i,e)*m%e,y=so(g,s,e)*g%e,x=so(y,a,e)*y%e,v=so(x,l,e)*x%e,A=so(v,a,e)*y%e,w=so(A,t,e)*u%e,S=so(w,o,e)*g%e,M=so(S,r,e)*c%e,b=so(M,GT,e);if(!zT.eql(zT.sqr(b),n))throw new Error("Cannot find square root");return b}const zT=Xte(az,void 0,void 0,{sqrt:ine}),wc=nne({a:BigInt(0),b:BigInt(7),Fp:zT,n:D3,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const e=D3,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-rne*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=t,o=BigInt("0x100000000000000000000000000000000"),a=U3(s*n,e),l=U3(-r*n,e);let c=ms(n-a*t-l*i,e),u=ms(-a*r-l*s,e);const f=c>o,d=u>o;if(f&&(c=e-c),d&&(u=e-u),c>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:f,k1:c,k2neg:d,k2:u}}}},OG);BigInt(0);wc.ProjectivePoint;const sv="0x0000000000000000000000000000000000000000",F3="0x0000000000000000000000000000000000000000000000000000000000000000",O3=BigInt(0),k3=BigInt(1),HT=BigInt(2),G3=BigInt(27),z3=BigInt(28),b1=BigInt(35),lz=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),sne=lz/HT,one=Symbol.for("nodejs.util.inspect.custom"),af={};function cb(n){return Jl(kr(n),32)}var Cp,Sa,Rp,Lc;const ao=class ao{constructor(e,t,r,i){Be(this,Cp,void 0);Be(this,Sa,void 0);Be(this,Rp,void 0);Be(this,Lc,void 0);ry(e,af,"Signature"),oe(this,Cp,t),oe(this,Sa,r),oe(this,Rp,i),oe(this,Lc,null)}get r(){return N(this,Cp)}set r(e){xe(gp(e)===32,"invalid r","value",e),oe(this,Cp,_t(e))}get s(){return xe(parseInt(N(this,Sa).substring(0,3))<8,"non-canonical s; use ._s","s",N(this,Sa)),N(this,Sa)}set s(e){xe(gp(e)===32,"invalid s","value",e),oe(this,Sa,_t(e))}get _s(){return N(this,Sa)}isValid(){return BigInt(N(this,Sa))<=sne}get v(){return N(this,Rp)}set v(e){const t=Qt(e,"value");xe(t===27||t===28,"invalid v","v",e),oe(this,Rp,t)}get networkV(){return N(this,Lc)}get legacyChainId(){const e=this.networkV;return e==null?null:ao.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=an(this.s);return this.yParity&&(e[0]|=128),_t(e)}get compactSerialized(){return tr([this.r,this.yParityAndS])}get serialized(){return tr([this.r,this.s,this.yParity?"0x1c":"0x1b"])}getCanonical(){if(this.isValid())return this;const e=lz-BigInt(this._s),t=55-this.v,r=new ao(af,this.r,cb(e),t);return this.networkV&&oe(r,Lc,this.networkV),r}clone(){const e=new ao(af,this.r,this._s,this.v);return this.networkV&&oe(e,Lc,this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this._s,v:this.v}}[one](){return this.toString()}toString(){return this.isValid()?`Signature { r: ${this.r}, s: ${this._s}, v: ${this.v} }`:`Signature { r: ${this.r}, s: ${this._s}, v: ${this.v}, valid: false }`}static getChainId(e){const t=Mt(e,"v");return t==G3||t==z3?O3:(xe(t>=b1,"invalid EIP-155 v","v",e),(t-b1)/HT)}static getChainIdV(e,t){return Mt(e)*HT+BigInt(35+t-27)}static getNormalizedV(e){const t=Mt(e);return t===O3||t===G3?27:t===k3||t===z3?28:(xe(t>=b1,"invalid v","v",e),t&k3?27:28)}static from(e){function t(c,u){xe(c,u,"signature",e)}if(e==null)return new ao(af,F3,F3,27);if(typeof e=="string"){const c=an(e,"signature");if(c.length===64){const u=_t(c.slice(0,32)),f=c.slice(32,64),d=f[0]&128?28:27;return f[0]&=127,new ao(af,u,_t(f),d)}if(c.length===65){const u=_t(c.slice(0,32)),f=_t(c.slice(32,64)),d=ao.getNormalizedV(c[64]);return new ao(af,u,f,d)}t(!1,"invalid raw signature length")}if(e instanceof ao)return e.clone();const r=e.r;t(r!=null,"missing r");const i=cb(r),s=function(c,u){if(c!=null)return cb(c);if(u!=null){t(Xn(u,32),"invalid yParityAndS");const f=an(u);return f[0]&=127,_t(f)}t(!1,"missing s")}(e.s,e.yParityAndS),{networkV:o,v:a}=function(c,u,f){if(c!=null){const d=Mt(c);return{networkV:d>=b1?d:void 0,v:ao.getNormalizedV(d)}}if(u!=null)return t(Xn(u,32),"invalid yParityAndS"),{v:an(u)[0]&128?28:27};if(f!=null){switch(Qt(f,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}t(!1,"invalid yParity")}t(!1,"missing v")}(e.v,e.yParityAndS,e.yParity),l=new ao(af,i,s,a);return o&&oe(l,Lc,o),t(e.yParity==null||Qt(e.yParity,"sig.yParity")===l.yParity,"yParity mismatch"),t(e.yParityAndS==null||e.yParityAndS===l.yParityAndS,"yParityAndS mismatch"),l}};Cp=new WeakMap,Sa=new WeakMap,Rp=new WeakMap,Lc=new WeakMap;let Ss=ao;var xl;const _f=class _f{constructor(e){Be(this,xl,void 0);xe(gp(e)===32,"invalid private key","privateKey","[REDACTED]"),oe(this,xl,_t(e))}get privateKey(){return N(this,xl)}get publicKey(){return _f.computePublicKey(N(this,xl))}get compressedPublicKey(){return _f.computePublicKey(N(this,xl),!0)}sign(e){xe(gp(e)===32,"invalid digest length","digest",e);const t=wc.sign($i(e),$i(N(this,xl)),{lowS:!0});return Ss.from({r:wu(t.r,32),s:wu(t.s,32),v:t.recovery?28:27})}computeSharedSecret(e){const t=_f.computePublicKey(e);return _t(wc.getSharedSecret($i(N(this,xl)),an(t),!1))}static computePublicKey(e,t){let r=an(e,"key");if(r.length===32){const s=wc.getPublicKey(r,!!t);return _t(s)}if(r.length===64){const s=new Uint8Array(65);s[0]=4,s.set(r,1),r=s}const i=wc.ProjectivePoint.fromHex(r);return _t(i.toRawBytes(t))}static recoverPublicKey(e,t){xe(gp(e)===32,"invalid digest length","digest",e);const r=Ss.from(t);let i=wc.Signature.fromCompact($i(tr([r.r,r.s])));i=i.addRecoveryBit(r.yParity);const s=i.recoverPublicKey($i(e));return xe(s!=null,"invalid signature for digest","signature",t),"0x"+s.toHex(!1)}static addPoints(e,t,r){const i=wc.ProjectivePoint.fromHex(_f.computePublicKey(e).substring(2)),s=wc.ProjectivePoint.fromHex(_f.computePublicKey(t).substring(2));return"0x"+i.add(s).toHex(!!r)}};xl=new WeakMap;let ov=_f;const ane=BigInt(0),lne=BigInt(36);function H3(n){n=n.toLowerCase();const e=n.substring(2).split(""),t=new Uint8Array(40);for(let i=0;i<40;i++)t[i]=e[i].charCodeAt(0);const r=an(Fr(t));for(let i=0;i<40;i+=2)r[i>>1]>>4>=8&&(e[i]=e[i].toUpperCase()),(r[i>>1]&15)>=8&&(e[i+1]=e[i+1].toUpperCase());return"0x"+e.join("")}const FR={};for(let n=0;n<10;n++)FR[String(n)]=String(n);for(let n=0;n<26;n++)FR[String.fromCharCode(65+n)]=String(10+n);const V3=15;function cne(n){n=n.toUpperCase(),n=n.substring(4)+n.substring(0,2)+"00";let e=n.split("").map(r=>FR[r]).join("");for(;e.length>=V3;){let r=e.substring(0,V3);e=parseInt(r,10)%97+e.substring(r.length)}let t=String(98-parseInt(e,10)%97);for(;t.length<2;)t="0"+t;return t}const une=function(){const n={};for(let e=0;e<36;e++){const t="0123456789abcdefghijklmnopqrstuvwxyz"[e];n[t]=BigInt(e)}return n}();function fne(n){n=n.toLowerCase();let e=ane;for(let t=0;t<n.length;t++)e=e*lne+une[n[t]];return e}function Bn(n){if(xe(typeof n=="string","invalid address","address",n),n.match(/^(0x)?[0-9a-fA-F]{40}$/)){n.startsWith("0x")||(n="0x"+n);const e=H3(n);return xe(!n.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===n,"bad address checksum","address",n),e}if(n.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){xe(n.substring(2,4)===cne(n),"bad icap checksum","address",n);let e=fne(n.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return H3("0x"+e)}xe(!1,"invalid address","address",n)}function hne(n){const e=Bn(n.from);let r=Mt(n.nonce,"tx.nonce").toString(16);return r==="0"?r="0x":r.length%2?r="0x0"+r:r="0x"+r,Bn(gr(Fr(Fl([e,r])),12))}function cz(n){return n&&typeof n.getAddress=="function"}async function ub(n,e){const t=await e;return(t==null||t==="0x0000000000000000000000000000000000000000")&&(qe(typeof n!="string","unconfigured name","UNCONFIGURED_NAME",{value:n}),xe(!1,"invalid AddressLike value; did not resolve to a value address","target",n)),Bn(t)}function ts(n,e){if(typeof n=="string")return n.match(/^0x[0-9a-f]{40}$/i)?Bn(n):(qe(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),ub(n,e.resolveName(n)));if(cz(n))return ub(n,n.getAddress());if(n&&typeof n.then=="function")return ub(n,n);xe(!1,"unsupported addressable value","target",n)}const ul={};function St(n,e){let t=!1;return e<0&&(t=!0,e*=-1),new Ui(ul,`${t?"":"u"}int${e}`,n,{signed:t,width:e})}function Cn(n,e){return new Ui(ul,`bytes${e||""}`,n,{size:e})}const W3=Symbol.for("_ethers_typed");var Kf;const fl=class fl{constructor(e,t,r,i){Ee(this,"type");Ee(this,"value");Be(this,Kf,void 0);Ee(this,"_typedSymbol");i==null&&(i=null),ry(ul,e,"Typed"),Ht(this,{_typedSymbol:W3,type:t,value:r}),oe(this,Kf,i),this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return N(this,Kf)}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return N(this,Kf)===!0?-1:N(this,Kf)===!1?this.value.length:null}static from(e,t){return new fl(ul,e,t)}static uint8(e){return St(e,8)}static uint16(e){return St(e,16)}static uint24(e){return St(e,24)}static uint32(e){return St(e,32)}static uint40(e){return St(e,40)}static uint48(e){return St(e,48)}static uint56(e){return St(e,56)}static uint64(e){return St(e,64)}static uint72(e){return St(e,72)}static uint80(e){return St(e,80)}static uint88(e){return St(e,88)}static uint96(e){return St(e,96)}static uint104(e){return St(e,104)}static uint112(e){return St(e,112)}static uint120(e){return St(e,120)}static uint128(e){return St(e,128)}static uint136(e){return St(e,136)}static uint144(e){return St(e,144)}static uint152(e){return St(e,152)}static uint160(e){return St(e,160)}static uint168(e){return St(e,168)}static uint176(e){return St(e,176)}static uint184(e){return St(e,184)}static uint192(e){return St(e,192)}static uint200(e){return St(e,200)}static uint208(e){return St(e,208)}static uint216(e){return St(e,216)}static uint224(e){return St(e,224)}static uint232(e){return St(e,232)}static uint240(e){return St(e,240)}static uint248(e){return St(e,248)}static uint256(e){return St(e,256)}static uint(e){return St(e,256)}static int8(e){return St(e,-8)}static int16(e){return St(e,-16)}static int24(e){return St(e,-24)}static int32(e){return St(e,-32)}static int40(e){return St(e,-40)}static int48(e){return St(e,-48)}static int56(e){return St(e,-56)}static int64(e){return St(e,-64)}static int72(e){return St(e,-72)}static int80(e){return St(e,-80)}static int88(e){return St(e,-88)}static int96(e){return St(e,-96)}static int104(e){return St(e,-104)}static int112(e){return St(e,-112)}static int120(e){return St(e,-120)}static int128(e){return St(e,-128)}static int136(e){return St(e,-136)}static int144(e){return St(e,-144)}static int152(e){return St(e,-152)}static int160(e){return St(e,-160)}static int168(e){return St(e,-168)}static int176(e){return St(e,-176)}static int184(e){return St(e,-184)}static int192(e){return St(e,-192)}static int200(e){return St(e,-200)}static int208(e){return St(e,-208)}static int216(e){return St(e,-216)}static int224(e){return St(e,-224)}static int232(e){return St(e,-232)}static int240(e){return St(e,-240)}static int248(e){return St(e,-248)}static int256(e){return St(e,-256)}static int(e){return St(e,-256)}static bytes1(e){return Cn(e,1)}static bytes2(e){return Cn(e,2)}static bytes3(e){return Cn(e,3)}static bytes4(e){return Cn(e,4)}static bytes5(e){return Cn(e,5)}static bytes6(e){return Cn(e,6)}static bytes7(e){return Cn(e,7)}static bytes8(e){return Cn(e,8)}static bytes9(e){return Cn(e,9)}static bytes10(e){return Cn(e,10)}static bytes11(e){return Cn(e,11)}static bytes12(e){return Cn(e,12)}static bytes13(e){return Cn(e,13)}static bytes14(e){return Cn(e,14)}static bytes15(e){return Cn(e,15)}static bytes16(e){return Cn(e,16)}static bytes17(e){return Cn(e,17)}static bytes18(e){return Cn(e,18)}static bytes19(e){return Cn(e,19)}static bytes20(e){return Cn(e,20)}static bytes21(e){return Cn(e,21)}static bytes22(e){return Cn(e,22)}static bytes23(e){return Cn(e,23)}static bytes24(e){return Cn(e,24)}static bytes25(e){return Cn(e,25)}static bytes26(e){return Cn(e,26)}static bytes27(e){return Cn(e,27)}static bytes28(e){return Cn(e,28)}static bytes29(e){return Cn(e,29)}static bytes30(e){return Cn(e,30)}static bytes31(e){return Cn(e,31)}static bytes32(e){return Cn(e,32)}static address(e){return new fl(ul,"address",e)}static bool(e){return new fl(ul,"bool",!!e)}static bytes(e){return new fl(ul,"bytes",e)}static string(e){return new fl(ul,"string",e)}static array(e,t){throw new Error("not implemented yet")}static tuple(e,t){throw new Error("not implemented yet")}static overrides(e){return new fl(ul,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===W3}static dereference(e,t){if(fl.isTyped(e)){if(e.type!==t)throw new Error(`invalid type: expecetd ${t}, got ${e.type}`);return e.value}return e}};Kf=new WeakMap;let Ui=fl;class dne extends jl{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){let r=Ui.dereference(t,"string");try{r=Bn(r)}catch(i){return this._throwError(i.message,t)}return e.writeValue(r)}decode(e){return Bn(wu(e.readValue(),20))}}class pne extends jl{constructor(t){super(t.name,t.type,"_",t.dynamic);Ee(this,"coder");this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,r){return this.coder.encode(t,r)}decode(t){return this.coder.decode(t)}}function uz(n,e,t){let r=[];if(Array.isArray(t))r=t;else if(t&&typeof t=="object"){let l={};r=e.map(c=>{const u=c.localName;return qe(u,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:c},value:t}),qe(!l[u],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:c},value:t}),l[u]=!0,t[u]})}else xe(!1,"invalid tuple value","tuple",t);xe(e.length===r.length,"types/value length mismatch","tuple",t);let i=new NT,s=new NT,o=[];e.forEach((l,c)=>{let u=r[c];if(l.dynamic){let f=s.length;l.encode(s,u);let d=i.writeUpdatableValue();o.push(m=>{d(m+f)})}else l.encode(i,u)}),o.forEach(l=>{l(i.length)});let a=n.appendWriter(i);return a+=n.appendWriter(s),a}function fz(n,e){let t=[],r=[],i=n.subReader(0);return e.forEach(s=>{let o=null;if(s.dynamic){let a=n.readIndex(),l=i.subReader(a);try{o=s.decode(l)}catch(c){if(pi(c,"BUFFER_OVERRUN"))throw c;o=c,o.baseType=s.name,o.name=s.localName,o.type=s.type}}else try{o=s.decode(n)}catch(a){if(pi(a,"BUFFER_OVERRUN"))throw a;o=a,o.baseType=s.name,o.name=s.localName,o.type=s.type}if(o==null)throw new Error("investigate");t.push(o),r.push(s.localName||null)}),bm.fromItems(t,r)}class mne extends jl{constructor(t,r,i){const s=t.type+"["+(r>=0?r:"")+"]",o=r===-1||t.dynamic;super("array",s,i,o);Ee(this,"coder");Ee(this,"length");Ht(this,{coder:t,length:r})}defaultValue(){const t=this.coder.defaultValue(),r=[];for(let i=0;i<this.length;i++)r.push(t);return r}encode(t,r){const i=Ui.dereference(r,"array");Array.isArray(i)||this._throwError("expected array value",i);let s=this.length;s===-1&&(s=i.length,t.writeValue(i.length)),gG(i.length,s,"coder array"+(this.localName?" "+this.localName:""));let o=[];for(let a=0;a<i.length;a++)o.push(this.coder);return uz(t,o,i)}decode(t){let r=this.length;r===-1&&(r=t.readIndex(),qe(r*es<=t.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:t.bytes,offset:r*es,length:t.dataLength}));let i=[];for(let s=0;s<r;s++)i.push(new pne(this.coder));return fz(t,i)}}class gne extends jl{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){const r=Ui.dereference(t,"bool");return e.writeValue(r?1:0)}decode(e){return!!e.readValue()}}class hz extends jl{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=$i(t);let r=e.writeValue(t.length);return r+=e.writeBytes(t),r}decode(e){return e.readBytes(e.readIndex(),!0)}}class vne extends hz{constructor(e){super("bytes",e)}decode(e){return _t(super.decode(e))}}class yne extends jl{constructor(t,r){let i="bytes"+String(t);super(i,i,r,!1);Ee(this,"size");Ht(this,{size:t},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,r){let i=$i(Ui.dereference(r,this.type));return i.length!==this.size&&this._throwError("incorrect data length",r),t.writeBytes(i)}decode(t){return _t(t.readBytes(this.size))}}const xne=new Uint8Array([]);class Ane extends jl{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return t!=null&&this._throwError("not null",t),e.writeBytes(xne)}decode(e){return e.readBytes(0),null}}const _ne=BigInt(0),wne=BigInt(1),Ene=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class Sne extends jl{constructor(t,r,i){const s=(r?"int":"uint")+t*8;super(s,s,i,!1);Ee(this,"size");Ee(this,"signed");Ht(this,{size:t,signed:r},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(t,r){let i=Mt(Ui.dereference(r,this.type)),s=Nf(Ene,es*8);if(this.signed){let o=Nf(s,this.size*8-1);(i>o||i<-(o+wne))&&this._throwError("value out-of-bounds",r),i=AG(i,8*es)}else(i<_ne||i>Nf(s,this.size*8))&&this._throwError("value out-of-bounds",r);return t.writeValue(i)}decode(t){let r=Nf(t.readValue(),this.size*8);return this.signed&&(r=QA(r,this.size*8)),r}}class bne extends hz{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,Ga(Ui.dereference(t,"string")))}decode(e){return jA(super.decode(e))}}class M1 extends jl{constructor(t,r){let i=!1;const s=[];t.forEach(a=>{a.dynamic&&(i=!0),s.push(a.type)});const o="tuple("+s.join(",")+")";super("tuple",o,r,i);Ee(this,"coders");Ht(this,{coders:Object.freeze(t.slice())})}defaultValue(){const t=[];this.coders.forEach(i=>{t.push(i.defaultValue())});const r=this.coders.reduce((i,s)=>{const o=s.localName;return o&&(i[o]||(i[o]=0),i[o]++),i},{});return this.coders.forEach((i,s)=>{let o=i.localName;!o||r[o]!==1||(o==="length"&&(o="_length"),t[o]==null&&(t[o]=t[s]))}),Object.freeze(t)}encode(t,r){const i=Ui.dereference(r,"tuple");return uz(t,this.coders,i)}decode(t){return fz(t,this.coders)}}function fb(n,e){return{address:Bn(n),storageKeys:e.map((t,r)=>(xe(Xn(t,32),"invalid slot",`storageKeys[${r}]`,t),t.toLowerCase()))}}function Fh(n){if(Array.isArray(n))return n.map((t,r)=>Array.isArray(t)?(xe(t.length===2,"invalid slot set",`value[${r}]`,t),fb(t[0],t[1])):(xe(t!=null&&typeof t=="object","invalid address-slot set","value",n),fb(t.address,t.storageKeys)));xe(n!=null&&typeof n=="object","invalid access list","value",n);const e=Object.keys(n).map(t=>{const r=n[t].reduce((i,s)=>(i[s]=!0,i),{});return fb(t,Object.keys(r).sort())});return e.sort((t,r)=>t.address.localeCompare(r.address)),e}function dz(n){return{address:Bn(n.address),nonce:Mt(n.nonce!=null?n.nonce:0),chainId:Mt(n.chainId!=null?n.chainId:0),signature:Ss.from(n.signature)}}function Mne(n){let e;return typeof n=="string"?e=ov.computePublicKey(n,!1):e=n.publicKey,Bn(Fr("0x"+e.substring(4)).substring(26))}function Tne(n,e){return Mne(ov.recoverPublicKey(n,e))}const ni=BigInt(0),Cne=BigInt(2),Rne=BigInt(27),Bne=BigInt(28),Pne=BigInt(35),Ine=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Lne=Symbol.for("nodejs.util.inspect.custom"),hb=4096*32,sA=128;function Nne(n){return{blobToKzgCommitment:r=>{if("computeBlobProof"in n){if("blobToKzgCommitment"in n&&typeof n.blobToKzgCommitment=="function")return an(n.blobToKzgCommitment(_t(r)))}else if("blobToKzgCommitment"in n&&typeof n.blobToKzgCommitment=="function")return an(n.blobToKzgCommitment(r));if("blobToKZGCommitment"in n&&typeof n.blobToKZGCommitment=="function")return an(n.blobToKZGCommitment(_t(r)));xe(!1,"unsupported KZG library","kzg",n)},computeBlobKzgProof:(r,i)=>{if("computeBlobProof"in n&&typeof n.computeBlobProof=="function")return an(n.computeBlobProof(_t(r),_t(i)));if("computeBlobKzgProof"in n&&typeof n.computeBlobKzgProof=="function")return n.computeBlobKzgProof(r,i);if("computeBlobKZGProof"in n&&typeof n.computeBlobKZGProof=="function")return an(n.computeBlobKZGProof(_t(r),_t(i)));xe(!1,"unsupported KZG library","kzg",n)}}}function X3(n,e){let t=n.toString(16);for(;t.length<2;)t="0"+t;return t+=Hm(e).substring(4),"0x"+t}function Vm(n){return n==="0x"?null:Bn(n)}function Aw(n,e){try{return Fh(n)}catch(t){xe(!1,t.message,e,n)}}function Dne(n,e){try{if(!Array.isArray(n))throw new Error("authorizationList: invalid array");const t=[];for(let r=0;r<n.length;r++){const i=n[r];if(!Array.isArray(i))throw new Error(`authorization[${r}]: invalid array`);if(i.length!==6)throw new Error(`authorization[${r}]: wrong length`);if(!i[1])throw new Error(`authorization[${r}]: null address`);t.push({address:Vm(i[1]),nonce:Fn(i[2],"nonce"),chainId:Fn(i[0],"chainId"),signature:Ss.from({yParity:Oh(i[3],"yParity"),r:Jl(i[4],32),s:Jl(i[5],32)})})}return t}catch(t){xe(!1,t.message,e,n)}}function Oh(n,e){return n==="0x"?0:Qt(n,e)}function Fn(n,e){if(n==="0x")return ni;const t=Mt(n,e);return xe(t<=Ine,"value exceeds uint size",e,t),t}function An(n,e){const t=Mt(n,"value"),r=kr(t);return xe(r.length<=32,"value too large",`tx.${e}`,t),r}function _w(n){return Fh(n).map(e=>[e.address,e.storageKeys])}function Une(n){return n.map(e=>[An(e.chainId,"chainId"),e.address,An(e.nonce,"nonce"),An(e.signature.yParity,"yParity"),kr(e.signature.r),kr(e.signature._s)])}function Fne(n,e){xe(Array.isArray(n),`invalid ${e}`,"value",n);for(let t=0;t<n.length;t++)xe(Xn(n[t],32),"invalid ${ param } hash",`value[${t}]`,n[t]);return n}function One(n){const e=sy(n);xe(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",n);const t={type:0,nonce:Oh(e[0],"nonce"),gasPrice:Fn(e[1],"gasPrice"),gasLimit:Fn(e[2],"gasLimit"),to:Vm(e[3]),value:Fn(e[4],"value"),data:_t(e[5]),chainId:ni};if(e.length===6)return t;const r=Fn(e[6],"v"),i=Fn(e[7],"r"),s=Fn(e[8],"s");if(i===ni&&s===ni)t.chainId=r;else{let o=(r-Pne)/Cne;o<ni&&(o=ni),t.chainId=o,xe(o!==ni||r===Rne||r===Bne,"non-canonical legacy v","v",e[6]),t.signature=Ss.from({r:Jl(e[7],32),s:Jl(e[8],32),v:r})}return t}function kne(n,e){const t=[An(n.nonce,"nonce"),An(n.gasPrice||0,"gasPrice"),An(n.gasLimit,"gasLimit"),n.to||"0x",An(n.value,"value"),n.data];let r=ni;if(n.chainId!=ni)r=Mt(n.chainId,"tx.chainId"),xe(!e||e.networkV==null||e.legacyChainId===r,"tx.chainId/sig.v mismatch","sig",e);else if(n.signature){const s=n.signature.legacyChainId;s!=null&&(r=s)}if(!e)return r!==ni&&(t.push(kr(r)),t.push("0x"),t.push("0x")),Fl(t);let i=BigInt(27+e.yParity);return r!==ni?i=Ss.getChainIdV(r,e.v):BigInt(e.v)!==i&&xe(!1,"tx.chainId/sig.v mismatch","sig",e),t.push(kr(i)),t.push(kr(e.r)),t.push(kr(e._s)),Fl(t)}function ww(n,e){let t;try{if(t=Oh(e[0],"yParity"),t!==0&&t!==1)throw new Error("bad yParity")}catch{xe(!1,"invalid yParity","yParity",e[0])}const r=Jl(e[1],32),i=Jl(e[2],32),s=Ss.from({r,s:i,yParity:t});n.signature=s}function Gne(n){const e=sy(an(n).slice(1));xe(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",_t(n));const t={type:2,chainId:Fn(e[0],"chainId"),nonce:Oh(e[1],"nonce"),maxPriorityFeePerGas:Fn(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Fn(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Fn(e[4],"gasLimit"),to:Vm(e[5]),value:Fn(e[6],"value"),data:_t(e[7]),accessList:Aw(e[8],"accessList")};return e.length===9||ww(t,e.slice(9)),t}function zne(n,e){const t=[An(n.chainId,"chainId"),An(n.nonce,"nonce"),An(n.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),An(n.maxFeePerGas||0,"maxFeePerGas"),An(n.gasLimit,"gasLimit"),n.to||"0x",An(n.value,"value"),n.data,_w(n.accessList||[])];return e&&(t.push(An(e.yParity,"yParity")),t.push(kr(e.r)),t.push(kr(e.s))),tr(["0x02",Fl(t)])}function Hne(n){const e=sy(an(n).slice(1));xe(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",_t(n));const t={type:1,chainId:Fn(e[0],"chainId"),nonce:Oh(e[1],"nonce"),gasPrice:Fn(e[2],"gasPrice"),gasLimit:Fn(e[3],"gasLimit"),to:Vm(e[4]),value:Fn(e[5],"value"),data:_t(e[6]),accessList:Aw(e[7],"accessList")};return e.length===8||ww(t,e.slice(8)),t}function Vne(n,e){const t=[An(n.chainId,"chainId"),An(n.nonce,"nonce"),An(n.gasPrice||0,"gasPrice"),An(n.gasLimit,"gasLimit"),n.to||"0x",An(n.value,"value"),n.data,_w(n.accessList||[])];return e&&(t.push(An(e.yParity,"recoveryParam")),t.push(kr(e.r)),t.push(kr(e.s))),tr(["0x01",Fl(t)])}function Wne(n){let e=sy(an(n).slice(1)),t="3",r=null,i=null;if(e.length===4&&Array.isArray(e[0])){t="3 (network format)";const o=e[1],a=e[2],l=e[3];xe(Array.isArray(o),"invalid network format: blobs not an array","fields[1]",o),xe(Array.isArray(a),"invalid network format: commitments not an array","fields[2]",a),xe(Array.isArray(l),"invalid network format: proofs not an array","fields[3]",l),xe(o.length===a.length,"invalid network format: blobs/commitments length mismatch","fields",e),xe(o.length===l.length,"invalid network format: blobs/proofs length mismatch","fields",e),i=[];for(let c=0;c<e[1].length;c++)i.push({data:o[c],commitment:a[c],proof:l[c]});e=e[0]}else if(e.length===5&&Array.isArray(e[0])){t="3 (EIP-7594 network format)",r=Qt(e[1]);const o=e[2],a=e[3],l=e[4];xe(r===1,`unsupported EIP-7594 network format version: ${r}`,"fields[1]",r),xe(Array.isArray(o),"invalid EIP-7594 network format: blobs not an array","fields[2]",o),xe(Array.isArray(a),"invalid EIP-7594 network format: commitments not an array","fields[3]",a),xe(Array.isArray(l),"invalid EIP-7594 network format: proofs not an array","fields[4]",l),xe(o.length===a.length,"invalid network format: blobs/commitments length mismatch","fields",e),xe(o.length*sA===l.length,"invalid network format: blobs/proofs length mismatch","fields",e),i=[];for(let c=0;c<o.length;c++){const u=[];for(let f=0;f<sA;f++)u.push(l[c*sA+f]);i.push({data:o[c],commitment:a[c],proof:tr(u)})}e=e[0]}xe(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${t}`,"data",_t(n));const s={type:3,chainId:Fn(e[0],"chainId"),nonce:Oh(e[1],"nonce"),maxPriorityFeePerGas:Fn(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Fn(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Fn(e[4],"gasLimit"),to:Vm(e[5]),value:Fn(e[6],"value"),data:_t(e[7]),accessList:Aw(e[8],"accessList"),maxFeePerBlobGas:Fn(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10],blobWrapperVersion:r};i&&(s.blobs=i),xe(s.to!=null,`invalid address for transaction type: ${t}`,"data",n),xe(Array.isArray(s.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",n);for(let o=0;o<s.blobVersionedHashes.length;o++)xe(Xn(s.blobVersionedHashes[o],32),`invalid blobVersionedHash at index ${o}: must be length 32`,"data",n);return e.length===11||ww(s,e.slice(11)),s}function Xne(n,e,t){const r=[An(n.chainId,"chainId"),An(n.nonce,"nonce"),An(n.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),An(n.maxFeePerGas||0,"maxFeePerGas"),An(n.gasLimit,"gasLimit"),n.to||sv,An(n.value,"value"),n.data,_w(n.accessList||[]),An(n.maxFeePerBlobGas||0,"maxFeePerBlobGas"),Fne(n.blobVersionedHashes||[],"blobVersionedHashes")];if(e&&(r.push(An(e.yParity,"yParity")),r.push(kr(e.r)),r.push(kr(e.s)),t)){if(n.blobWrapperVersion!=null){const i=kr(n.blobWrapperVersion),s=[];for(const{proof:o}of t){const a=an(o),l=a.length/sA;for(let c=0;c<a.length;c+=l)s.push(a.subarray(c,c+l))}return tr(["0x03",Fl([r,i,t.map(o=>o.data),t.map(o=>o.commitment),s])])}return tr(["0x03",Fl([r,t.map(i=>i.data),t.map(i=>i.commitment),t.map(i=>i.proof)])])}return tr(["0x03",Fl(r)])}function Jne(n){const e=sy(an(n).slice(1));xe(Array.isArray(e)&&(e.length===10||e.length===13),"invalid field count for transaction type: 4","data",_t(n));const t={type:4,chainId:Fn(e[0],"chainId"),nonce:Oh(e[1],"nonce"),maxPriorityFeePerGas:Fn(e[2],"maxPriorityFeePerGas"),maxFeePerGas:Fn(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:Fn(e[4],"gasLimit"),to:Vm(e[5]),value:Fn(e[6],"value"),data:_t(e[7]),accessList:Aw(e[8],"accessList"),authorizationList:Dne(e[9],"authorizationList")};return e.length===10||ww(t,e.slice(10)),t}function Kne(n,e){const t=[An(n.chainId,"chainId"),An(n.nonce,"nonce"),An(n.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),An(n.maxFeePerGas||0,"maxFeePerGas"),An(n.gasLimit,"gasLimit"),n.to||"0x",An(n.value,"value"),n.data,_w(n.accessList||[]),Une(n.authorizationList||[])];return e&&(t.push(An(e.yParity,"yParity")),t.push(kr(e.r)),t.push(kr(e.s))),tr(["0x04",Fl(t)])}var Vo,Bp,Pp,Ip,Lp,Np,Dp,Up,Fp,Op,kp,Gp,Qf,Nc,ba,Dc,zp,Hp,Vp,oA;const wa=class wa{constructor(){Be(this,Vp);Be(this,Vo,void 0);Be(this,Bp,void 0);Be(this,Pp,void 0);Be(this,Ip,void 0);Be(this,Lp,void 0);Be(this,Np,void 0);Be(this,Dp,void 0);Be(this,Up,void 0);Be(this,Fp,void 0);Be(this,Op,void 0);Be(this,kp,void 0);Be(this,Gp,void 0);Be(this,Qf,void 0);Be(this,Nc,void 0);Be(this,ba,void 0);Be(this,Dc,void 0);Be(this,zp,void 0);Be(this,Hp,void 0);oe(this,Vo,null),oe(this,Bp,null),oe(this,Ip,0),oe(this,Lp,ni),oe(this,Np,null),oe(this,Dp,null),oe(this,Up,null),oe(this,Pp,"0x"),oe(this,Fp,ni),oe(this,Op,ni),oe(this,kp,null),oe(this,Gp,null),oe(this,Qf,null),oe(this,Nc,null),oe(this,ba,null),oe(this,Dc,null),oe(this,zp,null),oe(this,Hp,null)}get type(){return N(this,Vo)}set type(e){switch(e){case null:oe(this,Vo,null);break;case 0:case"legacy":oe(this,Vo,0);break;case 1:case"berlin":case"eip-2930":oe(this,Vo,1);break;case 2:case"london":case"eip-1559":oe(this,Vo,2);break;case 3:case"cancun":case"eip-4844":oe(this,Vo,3);break;case 4:case"pectra":case"eip-7702":oe(this,Vo,4);break;default:xe(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const e=N(this,Bp);return e==null&&this.type===3?sv:e}set to(e){oe(this,Bp,e==null?null:Bn(e))}get nonce(){return N(this,Ip)}set nonce(e){oe(this,Ip,Qt(e,"value"))}get gasLimit(){return N(this,Lp)}set gasLimit(e){oe(this,Lp,Mt(e))}get gasPrice(){const e=N(this,Np);return e==null&&(this.type===0||this.type===1)?ni:e}set gasPrice(e){oe(this,Np,e==null?null:Mt(e,"gasPrice"))}get maxPriorityFeePerGas(){const e=N(this,Dp);return e??(this.type===2||this.type===3?ni:null)}set maxPriorityFeePerGas(e){oe(this,Dp,e==null?null:Mt(e,"maxPriorityFeePerGas"))}get maxFeePerGas(){const e=N(this,Up);return e??(this.type===2||this.type===3?ni:null)}set maxFeePerGas(e){oe(this,Up,e==null?null:Mt(e,"maxFeePerGas"))}get data(){return N(this,Pp)}set data(e){oe(this,Pp,_t(e))}get value(){return N(this,Fp)}set value(e){oe(this,Fp,Mt(e,"value"))}get chainId(){return N(this,Op)}set chainId(e){oe(this,Op,Mt(e))}get signature(){return N(this,kp)||null}set signature(e){oe(this,kp,e==null?null:Ss.from(e))}isValid(){const e=this.signature;if(e&&!e.isValid())return!1;const t=this.authorizationList;if(t){for(const r of t)if(!r.signature.isValid())return!1}return!0}get accessList(){const e=N(this,Gp)||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){oe(this,Gp,e==null?null:Fh(e))}get authorizationList(){const e=N(this,zp)||null;return e==null&&this.type===4?[]:e}set authorizationList(e){oe(this,zp,e==null?null:e.map(t=>dz(t)))}get maxFeePerBlobGas(){const e=N(this,Qf);return e==null&&this.type===3?ni:e}set maxFeePerBlobGas(e){oe(this,Qf,e==null?null:Mt(e,"maxFeePerBlobGas"))}get blobVersionedHashes(){let e=N(this,Nc);return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){xe(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let t=0;t<e.length;t++)xe(Xn(e[t],32),"invalid blobVersionedHash",`value[${t}]`,e[t])}oe(this,Nc,e)}get blobs(){return N(this,Dc)==null?null:N(this,Dc).map(e=>Object.assign({},e))}set blobs(e){if(e==null){oe(this,Dc,null);return}const t=[],r=[];for(let i=0;i<e.length;i++){const s=e[i];if(CR(s)){qe(N(this,ba),"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=an(s);if(xe(o.length<=hb,"blob is too large",`blobs[${i}]`,s),o.length!==hb){const c=new Uint8Array(hb);c.set(o),o=c}const a=N(this,ba).blobToKzgCommitment(o),l=_t(N(this,ba).computeBlobKzgProof(o,a));t.push({data:_t(o),commitment:_t(a),proof:l}),r.push(X3(1,a))}else{const o=_t(s.data),a=_t(s.commitment),l=_t(s.proof);t.push({data:o,commitment:a,proof:l}),r.push(X3(1,a))}}oe(this,Dc,t),oe(this,Nc,r)}get kzg(){return N(this,ba)}set kzg(e){e==null?oe(this,ba,null):oe(this,ba,Nne(e))}get blobWrapperVersion(){return N(this,Hp)}set blobWrapperVersion(e){oe(this,Hp,e)}get hash(){return this.signature==null?null:Fr(st(this,Vp,oA).call(this,!0,!1))}get unsignedHash(){return Fr(this.unsignedSerialized)}get from(){return this.signature==null?null:Tne(this.unsignedHash,this.signature.getCanonical())}get fromPublicKey(){return this.signature==null?null:ov.recoverPublicKey(this.unsignedHash,this.signature.getCanonical())}isSigned(){return this.signature!=null}get serialized(){return st(this,Vp,oA).call(this,!0,!0)}get unsignedSerialized(){return st(this,Vp,oA).call(this,!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,t=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,r=this.accessList!=null,i=N(this,Qf)!=null||N(this,Nc);this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&qe(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),qe(!t||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),qe(this.type!==0||!r,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const s=[];return this.type!=null?s.push(this.type):this.authorizationList&&this.authorizationList.length?s.push(4):t?s.push(2):e?(s.push(1),r||s.push(0)):r?(s.push(1),s.push(2)):(i&&this.to||(s.push(0),s.push(1),s.push(2)),s.push(3)),s.sort(),s}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return wa.from(this)}toJSON(){const e=t=>t==null?null:t.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}[Lne](){return this.toString()}toString(){const e=[],t=i=>{let s=this[i];typeof s=="string"&&(s=JSON.stringify(s)),e.push(`${i}: ${s}`)};this.type&&t("type"),t("to"),t("data"),t("nonce"),t("gasLimit"),t("value"),this.chainId!=null&&t("chainId"),this.signature&&(t("from"),e.push(`signature: ${this.signature.toString()}`));const r=this.authorizationList;if(r){const i=[];for(const s of r){const o=[];o.push(`address: ${JSON.stringify(s.address)}`),s.nonce!=null&&o.push(`nonce: ${s.nonce}`),s.chainId!=null&&o.push(`chainId: ${s.chainId}`),s.signature&&o.push(`signature: ${s.signature.toString()}`),i.push(`Authorization { ${o.join(", ")} }`)}e.push(`authorizations: [ ${i.join(", ")} ]`)}return`Transaction { ${e.join(", ")} }`}static from(e){if(e==null)return new wa;if(typeof e=="string"){const r=an(e);if(r[0]>=127)return wa.from(One(r));switch(r[0]){case 1:return wa.from(Hne(r));case 2:return wa.from(Gne(r));case 3:return wa.from(Wne(r));case 4:return wa.from(Jne(r))}qe(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const t=new wa;return e.type!=null&&(t.type=e.type),e.to!=null&&(t.to=e.to),e.nonce!=null&&(t.nonce=e.nonce),e.gasLimit!=null&&(t.gasLimit=e.gasLimit),e.gasPrice!=null&&(t.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(t.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(t.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(t.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(t.data=e.data),e.value!=null&&(t.value=e.value),e.chainId!=null&&(t.chainId=e.chainId),e.signature!=null&&(t.signature=Ss.from(e.signature)),e.accessList!=null&&(t.accessList=e.accessList),e.authorizationList!=null&&(t.authorizationList=e.authorizationList),e.blobVersionedHashes!=null&&(t.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(t.kzg=e.kzg),e.blobWrapperVersion!=null&&(t.blobWrapperVersion=e.blobWrapperVersion),e.blobs!=null&&(t.blobs=e.blobs),e.hash!=null&&(xe(t.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),xe(t.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(xe(t.isSigned(),"unsigned transaction cannot define '.from'","tx",e),xe(t.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),t}};Vo=new WeakMap,Bp=new WeakMap,Pp=new WeakMap,Ip=new WeakMap,Lp=new WeakMap,Np=new WeakMap,Dp=new WeakMap,Up=new WeakMap,Fp=new WeakMap,Op=new WeakMap,kp=new WeakMap,Gp=new WeakMap,Qf=new WeakMap,Nc=new WeakMap,ba=new WeakMap,Dc=new WeakMap,zp=new WeakMap,Hp=new WeakMap,Vp=new WeakSet,oA=function(e,t){qe(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const r=e?this.signature:null;switch(this.inferType()){case 0:return kne(this,r);case 1:return Vne(this,r);case 2:return zne(this,r);case 3:return Xne(this,r,t?this.blobs:null);case 4:return Kne(this,r)}qe(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})};let qA=wa;function Sh(n){return Fr(Ga(n))}var Qne="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const J3=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),K3=4;function jne(n){let e=0;function t(){return n[e++]<<8|n[e++]}let r=t(),i=1,s=[0,1];for(let M=1;M<r;M++)s.push(i+=t());let o=t(),a=e;e+=o;let l=0,c=0;function u(){return l==0&&(c=c<<8|n[e++],l=8),c>>--l&1}const f=31,d=2**f,m=d>>>1,g=m>>1,y=d-1;let x=0;for(let M=0;M<f;M++)x=x<<1|u();let v=[],A=0,w=d;for(;;){let M=Math.floor(((x-A+1)*i-1)/w),b=0,R=r;for(;R-b>1;){let B=b+R>>>1;M<s[B]?R=B:b=B}if(b==0)break;v.push(b);let P=A+Math.floor(w*s[b]/i),C=A+Math.floor(w*s[b+1]/i)-1;for(;!((P^C)&m);)x=x<<1&y|u(),P=P<<1&y,C=C<<1&y|1;for(;P&~C&g;)x=x&m|x<<1&y>>>1|u(),P=P<<1^m,C=(C^m)<<1|m|1;A=P,w=1+C-P}let S=r-4;return v.map(M=>{switch(M-S){case 3:return S+65792+(n[a++]<<16|n[a++]<<8|n[a++]);case 2:return S+256+(n[a++]<<8|n[a++]);case 1:return S+n[a++];default:return M-1}})}function Yne(n){let e=0;return()=>n[e++]}function pz(n){return Yne(jne(Zne(n)))}function Zne(n){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((i,s)=>e[i.charCodeAt(0)]=s);let t=n.length,r=new Uint8Array(6*t>>3);for(let i=0,s=0,o=0,a=0;i<t;i++)a=a<<6|e[n.charCodeAt(i)],o+=6,o>=8&&(r[s++]=a>>(o-=8));return r}function qne(n){return n&1?~n>>1:n>>1}function $ne(n,e){let t=Array(n);for(let r=0,i=0;r<n;r++)t[r]=i+=qne(e());return t}function av(n,e=0){let t=[];for(;;){let r=n(),i=n();if(!i)break;e+=r;for(let s=0;s<i;s++)t.push(e+s);e+=i+1}return t}function mz(n){return lv(()=>{let e=av(n);if(e.length)return e})}function gz(n){let e=[];for(;;){let t=n();if(t==0)break;e.push(ere(t,n))}for(;;){let t=n()-1;if(t<0)break;e.push(tre(t,n))}return e.flat()}function lv(n){let e=[];for(;;){let t=n(e.length);if(!t)break;e.push(t)}return e}function vz(n,e,t){let r=Array(n).fill().map(()=>[]);for(let i=0;i<e;i++)$ne(n,t).forEach((s,o)=>r[o].push(s));return r}function ere(n,e){let t=1+e(),r=e(),i=lv(e);return vz(i.length,1+n,e).flatMap((o,a)=>{let[l,...c]=o;return Array(i[a]).fill().map((u,f)=>{let d=f*r;return[l+f*t,c.map(m=>m+d)]})})}function tre(n,e){let t=1+e();return vz(t,1+n,e).map(i=>[i[0],i.slice(1)])}function nre(n){let e=[],t=av(n);return i(r([]),[]),e;function r(s){let o=n(),a=lv(()=>{let l=av(n).map(c=>t[c]);if(l.length)return r(l)});return{S:o,B:a,Q:s}}function i({S:s,B:o},a,l){if(!(s&4&&l===a[a.length-1])){s&2&&(l=a[a.length-1]),s&1&&e.push(a);for(let c of o)for(let u of c.Q)i(c,[...a,u],l)}}}function rre(n){return n.toString(16).toUpperCase().padStart(2,"0")}function yz(n){return`{${rre(n)}}`}function ire(n){let e=[];for(let t=0,r=n.length;t<r;){let i=n.codePointAt(t);t+=i<65536?1:2,e.push(i)}return e}function Bm(n){let t=n.length;if(t<4096)return String.fromCodePoint(...n);let r=[];for(let i=0;i<t;)r.push(String.fromCodePoint(...n.slice(i,i+=4096)));return r.join("")}function sre(n,e){let t=n.length,r=t-e.length;for(let i=0;r==0&&i<t;i++)r=n[i]-e[i];return r}var ore="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const cv=44032,$A=4352,e_=4449,t_=4519,xz=19,Az=21,Pm=28,n_=Az*Pm,are=xz*n_,lre=cv+are,cre=$A+xz,ure=e_+Az,fre=t_+Pm;function n0(n){return n>>24&255}function _z(n){return n&16777215}let VT,Q3,WT,aA;function hre(){let n=pz(ore);VT=new Map(mz(n).flatMap((e,t)=>e.map(r=>[r,t+1<<24]))),Q3=new Set(av(n)),WT=new Map,aA=new Map;for(let[e,t]of gz(n)){if(!Q3.has(e)&&t.length==2){let[r,i]=t,s=aA.get(r);s||(s=new Map,aA.set(r,s)),s.set(i,e)}WT.set(e,t.reverse())}}function wz(n){return n>=cv&&n<lre}function dre(n,e){if(n>=$A&&n<cre&&e>=e_&&e<ure)return cv+(n-$A)*n_+(e-e_)*Pm;if(wz(n)&&e>t_&&e<fre&&(n-cv)%Pm==0)return n+(e-t_);{let t=aA.get(n);return t&&(t=t.get(e),t)?t:-1}}function Ez(n){VT||hre();let e=[],t=[],r=!1;function i(s){let o=VT.get(s);o&&(r=!0,s|=o),e.push(s)}for(let s of n)for(;;){if(s<128)e.push(s);else if(wz(s)){let o=s-cv,a=o/n_|0,l=o%n_/Pm|0,c=o%Pm;i($A+a),i(e_+l),c>0&&i(t_+c)}else{let o=WT.get(s);o?t.push(...o):i(s)}if(!t.length)break;s=t.pop()}if(r&&e.length>1){let s=n0(e[0]);for(let o=1;o<e.length;o++){let a=n0(e[o]);if(a==0||s<=a){s=a;continue}let l=o-1;for(;;){let c=e[l+1];if(e[l+1]=e[l],e[l]=c,!l||(s=n0(e[--l]),s<=a))break}s=n0(e[o])}}return e}function pre(n){let e=[],t=[],r=-1,i=0;for(let s of n){let o=n0(s),a=_z(s);if(r==-1)o==0?r=a:e.push(a);else if(i>0&&i>=o)o==0?(e.push(r,...t),t.length=0,r=a):t.push(a),i=o;else{let l=dre(r,a);l>=0?r=l:i==0&&o==0?(e.push(r),r=a):(t.push(a),i=o)}}return r>=0&&e.push(r,...t),e}function Sz(n){return Ez(n).map(_z)}function mre(n){return pre(Ez(n))}const j3=45,bz=".",Mz=65039,Tz=1,r_=n=>Array.from(n);function uv(n,e){return n.P.has(e)||n.Q.has(e)}class gre extends Array{get is_emoji(){return!0}}let XT,Cz,Uf,JT,Rz,yp,db,Pd,vf,Y3,KT;function OR(){if(XT)return;let n=pz(Qne);const e=()=>av(n),t=()=>new Set(e()),r=(u,f)=>f.forEach(d=>u.add(d));XT=new Map(gz(n)),Cz=t(),Uf=e(),JT=new Set(e().map(u=>Uf[u])),Uf=new Set(Uf),Rz=t(),t();let i=mz(n),s=n();const o=()=>{let u=new Set;return e().forEach(f=>r(u,i[f])),r(u,e()),u};yp=lv(u=>{let f=lv(n).map(d=>d+96);if(f.length){let d=u>=s;f[0]-=32,f=Bm(f),d&&(f=`Restricted[${f}]`);let m=o(),g=o(),y=!n();return{N:f,P:m,Q:g,M:y,R:d}}}),db=t(),Pd=new Map;let a=e().concat(r_(db)).sort((u,f)=>u-f);a.forEach((u,f)=>{let d=n(),m=a[f]=d?a[f-d]:{V:[],M:new Map};m.V.push(u),db.has(u)||Pd.set(u,m)});for(let{V:u,M:f}of new Set(Pd.values())){let d=[];for(let g of u){let y=yp.filter(v=>uv(v,g)),x=d.find(({G:v})=>y.some(A=>v.has(A)));x||(x={G:new Set,V:[]},d.push(x)),x.V.push(g),r(x.G,y)}let m=d.flatMap(g=>r_(g.G));for(let{G:g,V:y}of d){let x=new Set(m.filter(v=>!g.has(v)));for(let v of y)f.set(v,x)}}vf=new Set;let l=new Set;const c=u=>vf.has(u)?l.add(u):vf.add(u);for(let u of yp){for(let f of u.P)c(f);for(let f of u.Q)c(f)}for(let u of vf)!Pd.has(u)&&!l.has(u)&&Pd.set(u,Tz);r(vf,Sz(vf)),Y3=nre(n).map(u=>gre.from(u)).sort(sre),KT=new Map;for(let u of Y3){let f=[KT];for(let d of u){let m=f.map(g=>{let y=g.get(d);return y||(y=new Map,g.set(d,y)),y});d===Mz?f.push(...m):f=m}for(let d of f)d.V=u}}function kR(n){return(Bz(n)?"":`${GR(Ew([n]))} `)+yz(n)}function GR(n){return`"${n}"`}function vre(n){if(n.length>=4&&n[2]==j3&&n[3]==j3)throw new Error(`invalid label extension: "${Bm(n.slice(0,4))}"`)}function yre(n){for(let t=n.lastIndexOf(95);t>0;)if(n[--t]!==95)throw new Error("underscore allowed only at start")}function xre(n){let e=n[0],t=J3.get(e);if(t)throw E0(`leading ${t}`);let r=n.length,i=-1;for(let s=1;s<r;s++){e=n[s];let o=J3.get(e);if(o){if(i==s)throw E0(`${t} + ${o}`);i=s+1,t=o}}if(i==r)throw E0(`trailing ${t}`)}function Ew(n,e=1/0,t=yz){let r=[];Are(n[0])&&r.push(""),n.length>e&&(e>>=1,n=[...n.slice(0,e),8230,...n.slice(-e)]);let i=0,s=n.length;for(let o=0;o<s;o++){let a=n[o];Bz(a)&&(r.push(Bm(n.slice(i,o))),r.push(t(a)),i=o+1)}return r.push(Bm(n.slice(i,s))),r.join("")}function Are(n){return OR(),Uf.has(n)}function Bz(n){return OR(),Rz.has(n)}function _re(n){return bre(wre(n,mre,Cre))}function wre(n,e,t){if(!n)return[];OR();let r=0;return n.split(bz).map(i=>{let s=ire(i),o={input:s,offset:r};r+=s.length+1;try{let a=o.tokens=Tre(s,e,t),l=a.length,c;if(!l)throw new Error("empty label");let u=o.output=a.flat();if(yre(u),!(o.emoji=l>1||a[0].is_emoji)&&u.every(d=>d<128))vre(u),c="ASCII";else{let d=a.flatMap(m=>m.is_emoji?[]:m);if(!d.length)c="Emoji";else{if(Uf.has(u[0]))throw E0("leading combining mark");for(let y=1;y<l;y++){let x=a[y];if(!x.is_emoji&&Uf.has(x[0]))throw E0(`emoji + combining mark: "${Bm(a[y-1])} + ${Ew([x[0]])}"`)}xre(u);let m=r_(new Set(d)),[g]=Sre(m);Mre(g,d),Ere(g,m),c=g.N}}o.type=c}catch(a){o.error=a}return o})}function Ere(n,e){let t,r=[];for(let i of e){let s=Pd.get(i);if(s===Tz)return;if(s){let o=s.M.get(i);if(t=t?t.filter(a=>o.has(a)):r_(o),!t.length)return}else r.push(i)}if(t){for(let i of t)if(r.every(s=>uv(i,s)))throw new Error(`whole-script confusable: ${n.N}/${i.N}`)}}function Sre(n){let e=yp;for(let t of n){let r=e.filter(i=>uv(i,t));if(!r.length)throw yp.some(i=>uv(i,t))?Iz(e[0],t):Pz(t);if(e=r,r.length==1)break}return e}function bre(n){return n.map(({input:e,error:t,output:r})=>{if(t){let i=t.message;throw new Error(n.length==1?i:`Invalid label ${GR(Ew(e,63))}: ${i}`)}return Bm(r)}).join(bz)}function Pz(n){return new Error(`disallowed character: ${kR(n)}`)}function Iz(n,e){let t=kR(e),r=yp.find(i=>i.P.has(e));return r&&(t=`${r.N} ${t}`),new Error(`illegal mixture: ${n.N} + ${t}`)}function E0(n){return new Error(`illegal placement: ${n}`)}function Mre(n,e){for(let t of e)if(!uv(n,t))throw Iz(n,t);if(n.M){let t=Sz(e);for(let r=1,i=t.length;r<i;r++)if(JT.has(t[r])){let s=r+1;for(let o;s<i&&JT.has(o=t[s]);s++)for(let a=r;a<s;a++)if(t[a]==o)throw new Error(`duplicate non-spacing marks: ${kR(o)}`);if(s-r>K3)throw new Error(`excessive non-spacing marks: ${GR(Ew(t.slice(r-1,s)))} (${s-r}/${K3})`);r=s}}}function Tre(n,e,t){let r=[],i=[];for(n=n.slice().reverse();n.length;){let s=Rre(n);if(s)i.length&&(r.push(e(i)),i=[]),r.push(t(s));else{let o=n.pop();if(vf.has(o))i.push(o);else{let a=XT.get(o);if(a)i.push(...a);else if(!Cz.has(o))throw Pz(o)}}}return i.length&&r.push(e(i)),r}function Cre(n){return n.filter(e=>e!=Mz)}function Rre(n,e){let t=KT,r,i=n.length;for(;i&&(t=t.get(n[--i]),!!t);){let{V:s}=t;s&&(r=s,e&&e.push(...n.slice(i).reverse()),n.length=i)}return r}const Lz=new Uint8Array(32);Lz.fill(0);function Z3(n){return xe(n.length!==0,"invalid ENS name; empty component","comp",n),n}function Nz(n){const e=Ga(Bre(n)),t=[];if(n.length===0)return t;let r=0;for(let i=0;i<e.length;i++)e[i]===46&&(t.push(Z3(e.slice(r,i))),r=i+1);return xe(r<e.length,"invalid ENS name; empty component","name",n),t.push(Z3(e.slice(r))),t}function Bre(n){try{if(n.length===0)throw new Error("empty label");return _re(n)}catch(e){xe(!1,`invalid ENS name (${e.message})`,"name",n)}}function QT(n){xe(typeof n=="string","invalid ENS name; not a string","name",n),xe(n.length,"invalid ENS name (empty label)","name",n);let e=Lz;const t=Nz(n);for(;t.length;)e=Fr(tr([e,Fr(t.pop())]));return _t(e)}function Pre(n,e){const t=e??63;return xe(t<=255,"DNS encoded label cannot exceed 255","length",t),_t(tr(Nz(n).map(r=>{xe(r.length<=t,`label ${JSON.stringify(n)} exceeds ${t} bytes`,"name",n);const i=new Uint8Array(r.length+1);return i.set(r,1),i[0]=i.length-1,i})))+"00"}const Dz=new Uint8Array(32);Dz.fill(0);const Ire=BigInt(-1),Uz=BigInt(0),Fz=BigInt(1),Lre=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Nre(n){const e=an(n),t=e.length%32;return t?tr([e,Dz.slice(t)]):_t(e)}const Dre=wu(Fz,32),Ure=wu(Uz,32),q3={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},pb=["name","version","chainId","verifyingContract","salt"];function $3(n){return function(e){return xe(typeof e=="string",`invalid domain value for ${JSON.stringify(n)}`,`domain.${n}`,e),e}}const Fre={name:$3("name"),version:$3("version"),chainId:function(n){const e=Mt(n,"domain.chainId");return xe(e>=0,"invalid chain ID","domain.chainId",n),Number.isSafeInteger(e)?Number(e):Yo(e)},verifyingContract:function(n){try{return Bn(n).toLowerCase()}catch{}xe(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",n)},salt:function(n){const e=an(n,"domain.salt");return xe(e.length===32,'invalid domain value "salt"',"domain.salt",n),_t(e)}};function mb(n){{const e=n.match(/^(u?)int(\d+)$/);if(e){const t=e[1]==="",r=parseInt(e[2]);xe(r%8===0&&r!==0&&r<=256&&e[2]===String(r),"invalid numeric width","type",n);const i=Nf(Lre,t?r-1:r),s=t?(i+Fz)*Ire:Uz;return function(o){const a=Mt(o,"value");return xe(a>=s&&a<=i,`value out-of-bounds for ${n}`,"value",a),wu(t?AG(a,256):a,32)}}}{const e=n.match(/^bytes(\d+)$/);if(e){const t=parseInt(e[1]);return xe(t!==0&&t<=32&&e[1]===String(t),"invalid bytes width","type",n),function(r){const i=an(r);return xe(i.length===t,`invalid length for ${n}`,"value",r),Nre(r)}}}switch(n){case"address":return function(e){return Jl(Bn(e),32)};case"bool":return function(e){return e?Dre:Ure};case"bytes":return function(e){return Fr(e)};case"string":return function(e){return Sh(e)}}return null}function eD(n,e){return`${n}(${e.map(({name:t,type:r})=>r+" "+t).join(",")})`}function T1(n){const e=n.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:n}}var Ev,Al,Wp,u_,Oz;const lo=class lo{constructor(e){Be(this,u_);Ee(this,"primaryType");Be(this,Ev,void 0);Be(this,Al,void 0);Be(this,Wp,void 0);oe(this,Al,new Map),oe(this,Wp,new Map);const t=new Map,r=new Map,i=new Map,s={};Object.keys(e).forEach(l=>{s[l]=e[l].map(({name:c,type:u})=>{let{base:f,index:d}=T1(u);return f==="int"&&!e.int&&(f="int256"),f==="uint"&&!e.uint&&(f="uint256"),{name:c,type:f+(d||"")}}),t.set(l,new Set),r.set(l,[]),i.set(l,new Set)}),oe(this,Ev,JSON.stringify(s));for(const l in s){const c=new Set;for(const u of s[l]){xe(!c.has(u.name),`duplicate variable name ${JSON.stringify(u.name)} in ${JSON.stringify(l)}`,"types",e),c.add(u.name);const f=T1(u.type).base;xe(f!==l,`circular type reference to ${JSON.stringify(f)}`,"types",e),!mb(f)&&(xe(r.has(f),`unknown type ${JSON.stringify(f)}`,"types",e),r.get(f).push(l),t.get(l).add(f))}}const o=Array.from(r.keys()).filter(l=>r.get(l).length===0);xe(o.length!==0,"missing primary type","types",e),xe(o.length===1,`ambiguous primary types or unused types: ${o.map(l=>JSON.stringify(l)).join(", ")}`,"types",e),Ht(this,{primaryType:o[0]});function a(l,c){xe(!c.has(l),`circular type reference to ${JSON.stringify(l)}`,"types",e),c.add(l);for(const u of t.get(l))if(r.has(u)){a(u,c);for(const f of c)i.get(f).add(u)}c.delete(l)}a(this.primaryType,new Set);for(const[l,c]of i){const u=Array.from(c);u.sort(),N(this,Al).set(l,eD(l,s[l])+u.map(f=>eD(f,s[f])).join(""))}}get types(){return JSON.parse(N(this,Ev))}getEncoder(e){let t=N(this,Wp).get(e);return t||(t=st(this,u_,Oz).call(this,e),N(this,Wp).set(e,t)),t}encodeType(e){const t=N(this,Al).get(e);return xe(t,`unknown type: ${JSON.stringify(e)}`,"name",e),t}encodeData(e,t){return this.getEncoder(e)(t)}hashStruct(e,t){return Fr(this.encodeData(e,t))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,t,r){if(mb(e))return r(e,t);const i=T1(e).array;if(i)return xe(i.count===-1||i.count===t.length,`array length mismatch; expected length ${i.count}`,"value",t),t.map(o=>this._visit(i.prefix,o,r));const s=this.types[e];if(s)return s.reduce((o,{name:a,type:l})=>(o[a]=this._visit(l,t[a],r),o),{});xe(!1,`unknown type: ${e}`,"type",e)}visit(e,t){return this._visit(this.primaryType,e,t)}static from(e){return new lo(e)}static getPrimaryType(e){return lo.from(e).primaryType}static hashStruct(e,t,r){return lo.from(t).hashStruct(e,r)}static hashDomain(e){const t=[];for(const r in e){if(e[r]==null)continue;const i=q3[r];xe(i,`invalid typed-data domain key: ${JSON.stringify(r)}`,"domain",e),t.push({name:r,type:i})}return t.sort((r,i)=>pb.indexOf(r.name)-pb.indexOf(i.name)),lo.hashStruct("EIP712Domain",{EIP712Domain:t},e)}static encode(e,t,r){return tr(["0x1901",lo.hashDomain(e),lo.from(t).hash(r)])}static hash(e,t,r){return Fr(lo.encode(e,t,r))}static async resolveNames(e,t,r,i){e=Object.assign({},e);for(const a in e)e[a]==null&&delete e[a];const s={};e.verifyingContract&&!Xn(e.verifyingContract,20)&&(s[e.verifyingContract]="0x");const o=lo.from(t);o.visit(r,(a,l)=>(a==="address"&&!Xn(l,20)&&(s[l]="0x"),l));for(const a in s)s[a]=await i(a);return e.verifyingContract&&s[e.verifyingContract]&&(e.verifyingContract=s[e.verifyingContract]),r=o.visit(r,(a,l)=>a==="address"&&s[l]?s[l]:l),{domain:e,value:r}}static getPayload(e,t,r){lo.hashDomain(e);const i={},s=[];pb.forEach(l=>{const c=e[l];c!=null&&(i[l]=Fre[l](c),s.push({name:l,type:q3[l]}))});const o=lo.from(t);t=o.types;const a=Object.assign({},t);return xe(a.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",t),a.EIP712Domain=s,o.encode(r),{types:a,domain:i,primaryType:o.primaryType,message:o.visit(r,(l,c)=>{if(l.match(/^bytes(\d*)/))return _t(an(c));if(l.match(/^u?int/))return Mt(c).toString();switch(l){case"address":return c.toLowerCase();case"bool":return!!c;case"string":return xe(typeof c=="string","invalid string","value",c),c}xe(!1,"unsupported type","type",l)})}}};Ev=new WeakMap,Al=new WeakMap,Wp=new WeakMap,u_=new WeakSet,Oz=function(e){{const i=mb(e);if(i)return i}const t=T1(e).array;if(t){const i=t.prefix,s=this.getEncoder(i);return o=>{xe(t.count===-1||t.count===o.length,`array length mismatch; expected length ${t.count}`,"value",o);let a=o.map(s);return N(this,Al).has(i)&&(a=a.map(Fr)),Fr(tr(a))}}const r=this.types[e];if(r){const i=Sh(N(this,Al).get(e));return s=>{const o=r.map(({name:a,type:l})=>{const c=this.getEncoder(l)(s[a]);return N(this,Al).has(l)?Fr(c):c});return o.unshift(i),tr(o)}}xe(!1,`unknown type: ${e}`,"type",e)};let i_=lo;function ns(n){const e=new Set;return n.forEach(t=>e.add(t)),Object.freeze(e)}const Ore="external public payable override",kre=ns(Ore.split(" ")),kz="constant external internal payable private public pure view override",Gre=ns(kz.split(" ")),Gz="constructor error event fallback function receive struct",zz=ns(Gz.split(" ")),Hz="calldata memory storage payable indexed",zre=ns(Hz.split(" ")),Hre="tuple returns",Vre=[Gz,Hz,Hre,kz].join(" "),Wre=ns(Vre.split(" ")),Xre={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},Jre=new RegExp("^(\\s*)"),Kre=new RegExp("^([0-9]+)"),Qre=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),Vz=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),Wz=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");var ui,Wo,Sv,jT;const f_=class f_{constructor(e){Be(this,Sv);Be(this,ui,void 0);Be(this,Wo,void 0);oe(this,ui,0),oe(this,Wo,e.slice())}get offset(){return N(this,ui)}get length(){return N(this,Wo).length-N(this,ui)}clone(){return new f_(N(this,Wo))}reset(){oe(this,ui,0)}popKeyword(e){const t=this.peek();if(t.type!=="KEYWORD"||!e.has(t.text))throw new Error(`expected keyword ${t.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const t=this.peek();throw new Error(`expected ${e}; got ${t.type} ${JSON.stringify(t.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=st(this,Sv,jT).call(this,N(this,ui)+1,e.match+1);return oe(this,ui,e.match+1),t}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const t=[];for(;N(this,ui)<e.match-1;){const r=this.peek().linkNext;t.push(st(this,Sv,jT).call(this,N(this,ui)+1,r)),oe(this,ui,r)}return oe(this,ui,e.match+1),t}peek(){if(N(this,ui)>=N(this,Wo).length)throw new Error("out-of-bounds");return N(this,Wo)[N(this,ui)]}peekKeyword(e){const t=this.peekType("KEYWORD");return t!=null&&e.has(t)?t:null}peekType(e){if(this.length===0)return null;const t=this.peek();return t.type===e?t.text:null}pop(){const e=this.peek();return pg(this,ui)._++,e}toString(){const e=[];for(let t=N(this,ui);t<N(this,Wo).length;t++){const r=N(this,Wo)[t];e.push(`${r.type}:${r.text}`)}return`<TokenString ${e.join(" ")}>`}};ui=new WeakMap,Wo=new WeakMap,Sv=new WeakSet,jT=function(e=0,t=0){return new f_(N(this,Wo).slice(e,t).map(r=>Object.freeze(Object.assign({},r,{match:r.match-e,linkBack:r.linkBack-e,linkNext:r.linkNext-e}))))};let aa=f_;function Pu(n){const e=[],t=o=>{const a=s<n.length?JSON.stringify(n[s]):"$EOI";throw new Error(`invalid token ${a} at ${s}: ${o}`)};let r=[],i=[],s=0;for(;s<n.length;){let o=n.substring(s),a=o.match(Jre);a&&(s+=a[1].length,o=n.substring(s));const l={depth:r.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:s,value:-1};e.push(l);let c=Xre[o[0]]||"";if(c){if(l.type=c,l.text=o[0],s++,c==="OPEN_PAREN")r.push(e.length-1),i.push(e.length-1);else if(c=="CLOSE_PAREN")r.length===0&&t("no matching open bracket"),l.match=r.pop(),e[l.match].match=e.length-1,l.depth--,l.linkBack=i.pop(),e[l.linkBack].linkNext=e.length-1;else if(c==="COMMA")l.linkBack=i.pop(),e[l.linkBack].linkNext=e.length-1,i.push(e.length-1);else if(c==="OPEN_BRACKET")l.type="BRACKET";else if(c==="CLOSE_BRACKET"){let u=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const f=e.pop().text;u=f+u,e[e.length-1].value=Qt(f)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=u}continue}if(a=o.match(Qre),a){if(l.text=a[1],s+=l.text.length,Wre.has(l.text)){l.type="KEYWORD";continue}if(l.text.match(Wz)){l.type="TYPE";continue}l.type="ID";continue}if(a=o.match(Kre),a){l.text=a[1],l.type="NUMBER",s+=l.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${s}`)}return new aa(e.map(o=>Object.freeze(o)))}function tD(n,e){let t=[];for(const r in e.keys())n.has(r)&&t.push(r);if(t.length>1)throw new Error(`conflicting types: ${t.join(", ")}`)}function Sw(n,e){if(e.peekKeyword(zz)){const t=e.pop().text;if(t!==n)throw new Error(`expected ${n}, got ${t}`)}return e.popType("ID")}function Kl(n,e){const t=new Set;for(;;){const r=n.peekType("KEYWORD");if(r==null||e&&!e.has(r))break;if(n.pop(),t.has(r))throw new Error(`duplicate keywords: ${JSON.stringify(r)}`);t.add(r)}return Object.freeze(t)}function Xz(n){let e=Kl(n,Gre);return tD(e,ns("constant payable nonpayable".split(" "))),tD(e,ns("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function Ol(n,e){return n.popParams().map(t=>yi.from(t,e))}function Jz(n){if(n.peekType("AT")){if(n.pop(),n.peekType("NUMBER"))return Mt(n.pop().text);throw new Error("invalid gas")}return null}function bh(n){if(n.length)throw new Error(`unexpected tokens at offset ${n.offset}: ${n.toString()}`)}const jre=new RegExp(/^(.*)\[([0-9]*)\]$/);function nD(n){const e=n.match(Wz);if(xe(e,"invalid type","type",n),n==="uint")return"uint256";if(n==="int")return"int256";if(e[2]){const t=parseInt(e[2]);xe(t!==0&&t<=32,"invalid bytes length","type",n)}else if(e[3]){const t=parseInt(e[3]);xe(t!==0&&t<=256&&t%8===0,"invalid numeric width","type",n)}return n}const ar={},bs=Symbol.for("_ethers_internal"),rD="_ParamTypeInternal",iD="_ErrorInternal",sD="_EventInternal",oD="_ConstructorInternal",aD="_FallbackInternal",lD="_FunctionInternal",cD="_StructInternal";var Xp,lA;const co=class co{constructor(e,t,r,i,s,o,a,l){Be(this,Xp);Ee(this,"name");Ee(this,"type");Ee(this,"baseType");Ee(this,"indexed");Ee(this,"components");Ee(this,"arrayLength");Ee(this,"arrayChildren");if(ry(e,ar,"ParamType"),Object.defineProperty(this,bs,{value:rD}),o&&(o=Object.freeze(o.slice())),i==="array"){if(a==null||l==null)throw new Error("")}else if(a!=null||l!=null)throw new Error("");if(i==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");Ht(this,{name:t,type:r,baseType:i,indexed:s,components:o,arrayLength:a,arrayChildren:l})}format(e){if(e==null&&(e="sighash"),e==="json"){const r=this.name||"";if(this.isArray()){const s=JSON.parse(this.arrayChildren.format("json"));return s.name=r,s.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(s)}const i={type:this.baseType==="tuple"?"tuple":this.type,name:r};return typeof this.indexed=="boolean"&&(i.indexed=this.indexed),this.isTuple()&&(i.components=this.components.map(s=>JSON.parse(s.format(e)))),JSON.stringify(i)}let t="";return this.isArray()?(t+=this.arrayChildren.format(e),t+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?t+="("+this.components.map(r=>r.format(e)).join(e==="full"?", ":",")+")":t+=this.type,e!=="sighash"&&(this.indexed===!0&&(t+=" indexed"),e==="full"&&this.name&&(t+=" "+this.name)),t}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,t){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const r=this;return e.map(i=>r.arrayChildren.walk(i,t))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const r=this;return e.map((i,s)=>r.components[s].walk(i,t))}return t(this.type,e)}async walkAsync(e,t){const r=[],i=[e];return st(this,Xp,lA).call(this,r,e,t,s=>{i[0]=s}),r.length&&await Promise.all(r),i[0]}static from(e,t){if(co.isParamType(e))return e;if(typeof e=="string")try{return co.from(Pu(e),t)}catch{xe(!1,"invalid param type","obj",e)}else if(e instanceof aa){let a="",l="",c=null;Kl(e,ns(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(l="tuple",c=e.popParams().map(y=>co.from(y)),a=`tuple(${c.map(y=>y.format()).join(",")})`):(a=nD(e.popType("TYPE")),l=a);let u=null,f=null;for(;e.length&&e.peekType("BRACKET");){const y=e.pop();u=new co(ar,"",a,l,null,c,f,u),f=y.value,a+=y.text,l="array",c=null}let d=null;if(Kl(e,zre).has("indexed")){if(!t)throw new Error("");d=!0}const g=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new co(ar,g,a,l,d,c,f,u)}const r=e.name;xe(!r||typeof r=="string"&&r.match(Vz),"invalid name","obj.name",r);let i=e.indexed;i!=null&&(xe(t,"parameter cannot be indexed","obj.indexed",e.indexed),i=!!i);let s=e.type,o=s.match(jre);if(o){const a=parseInt(o[2]||"-1"),l=co.from({type:o[1],components:e.components});return new co(ar,r||"",s,"array",i,null,a,l)}if(s==="tuple"||s.startsWith("tuple(")||s.startsWith("(")){const a=e.components!=null?e.components.map(c=>co.from(c)):null;return new co(ar,r||"",s,"tuple",i,a,null,null)}return s=nD(e.type),new co(ar,r||"",s,s,i,null,null,null)}static isParamType(e){return e&&e[bs]===rD}};Xp=new WeakSet,lA=function(e,t,r,i){if(this.isArray()){if(!Array.isArray(t))throw new Error("invalid array value");if(this.arrayLength!==-1&&t.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,a=t.slice();a.forEach((l,c)=>{var u;st(u=o,Xp,lA).call(u,e,l,r,f=>{a[c]=f})}),i(a);return}if(this.isTuple()){const o=this.components;let a;if(Array.isArray(t))a=t.slice();else{if(t==null||typeof t!="object")throw new Error("invalid tuple value");a=o.map(l=>{if(!l.name)throw new Error("cannot use object value with unnamed components");if(!(l.name in t))throw new Error(`missing value for component ${l.name}`);return t[l.name]})}if(a.length!==this.components.length)throw new Error("array is wrong length");a.forEach((l,c)=>{var u;st(u=o[c],Xp,lA).call(u,e,l,r,f=>{a[c]=f})}),i(a);return}const s=r(this.type,t);s.then?e.push(async function(){i(await s)}()):i(s)};let yi=co;class Mh{constructor(e,t,r){Ee(this,"type");Ee(this,"inputs");ry(e,ar,"Fragment"),r=Object.freeze(r.slice()),Ht(this,{type:t,inputs:r})}static from(e){if(typeof e=="string"){try{Mh.from(JSON.parse(e))}catch{}return Mh.from(Pu(e))}if(e instanceof aa)switch(e.peekKeyword(zz)){case"constructor":return Il.from(e);case"error":return ys.from(e);case"event":return La.from(e);case"fallback":case"receive":return pl.from(e);case"function":return Na.from(e);case"struct":return ph.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return Il.from(e);case"error":return ys.from(e);case"event":return La.from(e);case"fallback":case"receive":return pl.from(e);case"function":return Na.from(e);case"struct":return ph.from(e)}qe(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}xe(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return Il.isFragment(e)}static isError(e){return ys.isFragment(e)}static isEvent(e){return La.isFragment(e)}static isFunction(e){return Na.isFragment(e)}static isStruct(e){return ph.isFragment(e)}}class bw extends Mh{constructor(t,r,i,s){super(t,r,s);Ee(this,"name");xe(typeof i=="string"&&i.match(Vz),"invalid identifier","name",i),s=Object.freeze(s.slice()),Ht(this,{name:i})}}function fv(n,e){return"("+e.map(t=>t.format(n)).join(n==="full"?", ":",")+")"}class ys extends bw{constructor(e,t,r){super(e,"error",t,r),Object.defineProperty(this,bs,{value:iD})}get selector(){return Sh(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(r=>JSON.parse(r.format(e)))});const t=[];return e!=="sighash"&&t.push("error"),t.push(this.name+fv(e,this.inputs)),t.join(" ")}static from(e){if(ys.isFragment(e))return e;if(typeof e=="string")return ys.from(Pu(e));if(e instanceof aa){const t=Sw("error",e),r=Ol(e);return bh(e),new ys(ar,t,r)}return new ys(ar,e.name,e.inputs?e.inputs.map(yi.from):[])}static isFragment(e){return e&&e[bs]===iD}}class La extends bw{constructor(t,r,i,s){super(t,"event",r,i);Ee(this,"anonymous");Object.defineProperty(this,bs,{value:sD}),Ht(this,{anonymous:s})}get topicHash(){return Sh(this.format("sighash"))}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(i=>JSON.parse(i.format(t)))});const r=[];return t!=="sighash"&&r.push("event"),r.push(this.name+fv(t,this.inputs)),t!=="sighash"&&this.anonymous&&r.push("anonymous"),r.join(" ")}static getTopicHash(t,r){return r=(r||[]).map(s=>yi.from(s)),new La(ar,t,r,!1).topicHash}static from(t){if(La.isFragment(t))return t;if(typeof t=="string")try{return La.from(Pu(t))}catch{xe(!1,"invalid event fragment","obj",t)}else if(t instanceof aa){const r=Sw("event",t),i=Ol(t,!0),s=!!Kl(t,ns(["anonymous"])).has("anonymous");return bh(t),new La(ar,r,i,s)}return new La(ar,t.name,t.inputs?t.inputs.map(r=>yi.from(r,!0)):[],!!t.anonymous)}static isFragment(t){return t&&t[bs]===sD}}class Il extends Mh{constructor(t,r,i,s,o){super(t,r,i);Ee(this,"payable");Ee(this,"gas");Object.defineProperty(this,bs,{value:oD}),Ht(this,{payable:s,gas:o})}format(t){if(qe(t!=null&&t!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),t==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(i=>JSON.parse(i.format(t)))});const r=[`constructor${fv(t,this.inputs)}`];return this.payable&&r.push("payable"),this.gas!=null&&r.push(`@${this.gas.toString()}`),r.join(" ")}static from(t){if(Il.isFragment(t))return t;if(typeof t=="string")try{return Il.from(Pu(t))}catch{xe(!1,"invalid constuctor fragment","obj",t)}else if(t instanceof aa){Kl(t,ns(["constructor"]));const r=Ol(t),i=!!Kl(t,kre).has("payable"),s=Jz(t);return bh(t),new Il(ar,"constructor",r,i,s)}return new Il(ar,"constructor",t.inputs?t.inputs.map(yi.from):[],!!t.payable,t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[bs]===oD}}class pl extends Mh{constructor(t,r,i){super(t,"fallback",r);Ee(this,"payable");Object.defineProperty(this,bs,{value:aD}),Ht(this,{payable:i})}format(t){const r=this.inputs.length===0?"receive":"fallback";if(t==="json"){const i=this.payable?"payable":"nonpayable";return JSON.stringify({type:r,stateMutability:i})}return`${r}()${this.payable?" payable":""}`}static from(t){if(pl.isFragment(t))return t;if(typeof t=="string")try{return pl.from(Pu(t))}catch{xe(!1,"invalid fallback fragment","obj",t)}else if(t instanceof aa){const r=t.toString(),i=t.peekKeyword(ns(["fallback","receive"]));if(xe(i,"type must be fallback or receive","obj",r),t.popKeyword(ns(["fallback","receive"]))==="receive"){const l=Ol(t);return xe(l.length===0,"receive cannot have arguments","obj.inputs",l),Kl(t,ns(["payable"])),bh(t),new pl(ar,[],!0)}let o=Ol(t);o.length?xe(o.length===1&&o[0].type==="bytes","invalid fallback inputs","obj.inputs",o.map(l=>l.format("minimal")).join(", ")):o=[yi.from("bytes")];const a=Xz(t);if(xe(a==="nonpayable"||a==="payable","fallback cannot be constants","obj.stateMutability",a),Kl(t,ns(["returns"])).has("returns")){const l=Ol(t);xe(l.length===1&&l[0].type==="bytes","invalid fallback outputs","obj.outputs",l.map(c=>c.format("minimal")).join(", "))}return bh(t),new pl(ar,o,a==="payable")}if(t.type==="receive")return new pl(ar,[],!0);if(t.type==="fallback"){const r=[yi.from("bytes")],i=t.stateMutability==="payable";return new pl(ar,r,i)}xe(!1,"invalid fallback description","obj",t)}static isFragment(t){return t&&t[bs]===aD}}class Na extends bw{constructor(t,r,i,s,o,a){super(t,"function",r,s);Ee(this,"constant");Ee(this,"outputs");Ee(this,"stateMutability");Ee(this,"payable");Ee(this,"gas");Object.defineProperty(this,bs,{value:lD}),o=Object.freeze(o.slice()),Ht(this,{constant:i==="view"||i==="pure",gas:a,outputs:o,payable:i==="payable",stateMutability:i})}get selector(){return Sh(this.format("sighash")).substring(0,10)}format(t){if(t==null&&(t="sighash"),t==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(i=>JSON.parse(i.format(t))),outputs:this.outputs.map(i=>JSON.parse(i.format(t)))});const r=[];return t!=="sighash"&&r.push("function"),r.push(this.name+fv(t,this.inputs)),t!=="sighash"&&(this.stateMutability!=="nonpayable"&&r.push(this.stateMutability),this.outputs&&this.outputs.length&&(r.push("returns"),r.push(fv(t,this.outputs))),this.gas!=null&&r.push(`@${this.gas.toString()}`)),r.join(" ")}static getSelector(t,r){return r=(r||[]).map(s=>yi.from(s)),new Na(ar,t,"view",r,[],null).selector}static from(t){if(Na.isFragment(t))return t;if(typeof t=="string")try{return Na.from(Pu(t))}catch{xe(!1,"invalid function fragment","obj",t)}else if(t instanceof aa){const i=Sw("function",t),s=Ol(t),o=Xz(t);let a=[];Kl(t,ns(["returns"])).has("returns")&&(a=Ol(t));const l=Jz(t);return bh(t),new Na(ar,i,o,s,a,l)}let r=t.stateMutability;return r==null&&(r="payable",typeof t.constant=="boolean"?(r="view",t.constant||(r="payable",typeof t.payable=="boolean"&&!t.payable&&(r="nonpayable"))):typeof t.payable=="boolean"&&!t.payable&&(r="nonpayable")),new Na(ar,t.name,r,t.inputs?t.inputs.map(yi.from):[],t.outputs?t.outputs.map(yi.from):[],t.gas!=null?t.gas:null)}static isFragment(t){return t&&t[bs]===lD}}class ph extends bw{constructor(e,t,r){super(e,"struct",t,r),Object.defineProperty(this,bs,{value:cD})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return ph.from(Pu(e))}catch{xe(!1,"invalid struct fragment","obj",e)}else if(e instanceof aa){const t=Sw("struct",e),r=Ol(e);return bh(e),new ph(ar,t,r)}return new ph(ar,e.name,e.inputs?e.inputs.map(yi.from):[])}static isFragment(e){return e&&e[bs]===cD}}const ha=new Map;ha.set(0,"GENERIC_PANIC");ha.set(1,"ASSERT_FALSE");ha.set(17,"OVERFLOW");ha.set(18,"DIVIDE_BY_ZERO");ha.set(33,"ENUM_RANGE_ERROR");ha.set(34,"BAD_STORAGE_DATA");ha.set(49,"STACK_UNDERFLOW");ha.set(50,"ARRAY_RANGE_ERROR");ha.set(65,"OUT_OF_MEMORY");ha.set(81,"UNINITIALIZED_FUNCTION_CALL");const Yre=new RegExp(/^bytes([0-9]*)$/),Zre=new RegExp(/^(u?int)([0-9]*)$/);let gb=null,uD=1024;function qre(n,e,t,r){let i="missing revert data",s=null;const o=null;let a=null;if(t){i="execution reverted";const c=an(t);if(t=_t(t),c.length===0)i+=" (no data present; likely require(false) occurred",s="require(false)";else if(c.length%32!==4)i+=" (could not decode reason; invalid data length)";else if(_t(c.slice(0,4))==="0x08c379a0")try{s=r.decode(["string"],c.slice(4))[0],a={signature:"Error(string)",name:"Error",args:[s]},i+=`: ${JSON.stringify(s)}`}catch{i+=" (could not decode reason; invalid string data)"}else if(_t(c.slice(0,4))==="0x4e487b71")try{const u=Number(r.decode(["uint256"],c.slice(4))[0]);a={signature:"Panic(uint256)",name:"Panic",args:[u]},s=`Panic due to ${ha.get(u)||"UNKNOWN"}(${u})`,i+=`: ${s}`}catch{i+=" (could not decode panic code)"}else i+=" (unknown custom error)"}const l={to:e.to?Bn(e.to):null,data:e.data||"0x"};return e.from&&(l.from=Bn(e.from)),qn(i,"CALL_EXCEPTION",{action:n,data:t,reason:s,transaction:l,invocation:o,revert:a})}var Uc,Id;const h_=class h_{constructor(){Be(this,Uc)}getDefaultValue(e){const t=e.map(i=>st(this,Uc,Id).call(this,yi.from(i)));return new M1(t,"_").defaultValue()}encode(e,t){gG(t.length,e.length,"types/values length mismatch");const r=e.map(o=>st(this,Uc,Id).call(this,yi.from(o))),i=new M1(r,"_"),s=new NT;return i.encode(s,t),s.data}decode(e,t,r){const i=e.map(o=>st(this,Uc,Id).call(this,yi.from(o)));return new M1(i,"_").decode(new DT(t,r,uD))}static _setDefaultMaxInflation(e){xe(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),uD=e}static defaultAbiCoder(){return gb==null&&(gb=new h_),gb}static getBuiltinCallException(e,t,r){return qre(e,t,r,h_.defaultAbiCoder())}};Uc=new WeakSet,Id=function(e){if(e.isArray())return new mne(st(this,Uc,Id).call(this,e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new M1(e.components.map(r=>st(this,Uc,Id).call(this,r)),e.name);switch(e.baseType){case"address":return new dne(e.name);case"bool":return new gne(e.name);case"string":return new bne(e.name);case"bytes":return new vne(e.name);case"":return new Ane(e.name)}let t=e.type.match(Zre);if(t){let r=parseInt(t[2]||"256");return xe(r!==0&&r<=256&&r%8===0,"invalid "+t[1]+" bit length","param",e),new Sne(r/8,t[1]==="int",e.name)}if(t=e.type.match(Yre),t){let r=parseInt(t[1]);return xe(r!==0&&r<=32,"invalid bytes length","param",e),new yne(r,e.name)}xe(!1,"invalid type","type",e.type)};let hv=h_;function fD(n){const e=Ga(n);if(e.length>31)throw new Error("bytes32 string must be less than 32 bytes");return xG(e,32)}class $re{constructor(e,t,r){Ee(this,"fragment");Ee(this,"name");Ee(this,"signature");Ee(this,"topic");Ee(this,"args");const i=e.name,s=e.format();Ht(this,{fragment:e,name:i,signature:s,topic:t,args:r})}}class eie{constructor(e,t,r,i){Ee(this,"fragment");Ee(this,"name");Ee(this,"args");Ee(this,"signature");Ee(this,"selector");Ee(this,"value");const s=e.name,o=e.format();Ht(this,{fragment:e,name:s,args:r,signature:o,selector:t,value:i})}}class tie{constructor(e,t,r){Ee(this,"fragment");Ee(this,"name");Ee(this,"args");Ee(this,"signature");Ee(this,"selector");const i=e.name,s=e.format();Ht(this,{fragment:e,name:i,args:r,signature:s,selector:t})}}class hD{constructor(e){Ee(this,"hash");Ee(this,"_isIndexed");Ht(this,{hash:e,_isIndexed:!0})}static isIndexed(e){return!!(e&&e._isIndexed)}}const dD={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},pD={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:n=>`reverted with reason string ${JSON.stringify(n)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:n=>{let e="unknown panic code";return n>=0&&n<=255&&dD[n.toString()]&&(e=dD[n.toString()]),`reverted with panic code 0x${n.toString(16)} (${e})`}}};var Ma,Ta,Ca,Bi,Jp,cA,Kp,uA;const wf=class wf{constructor(e){Be(this,Jp);Be(this,Kp);Ee(this,"fragments");Ee(this,"deploy");Ee(this,"fallback");Ee(this,"receive");Be(this,Ma,void 0);Be(this,Ta,void 0);Be(this,Ca,void 0);Be(this,Bi,void 0);let t=[];typeof e=="string"?t=JSON.parse(e):t=e,oe(this,Ca,new Map),oe(this,Ma,new Map),oe(this,Ta,new Map);const r=[];for(const o of t)try{r.push(Mh.from(o))}catch(a){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,a.message)}Ht(this,{fragments:Object.freeze(r)});let i=null,s=!1;oe(this,Bi,this.getAbiCoder()),this.fragments.forEach((o,a)=>{let l;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}Ht(this,{deploy:o});return;case"fallback":o.inputs.length===0?s=!0:(xe(!i||o.payable!==i.payable,"conflicting fallback fragments",`fragments[${a}]`,o),i=o,s=i.payable);return;case"function":l=N(this,Ca);break;case"event":l=N(this,Ta);break;case"error":l=N(this,Ma);break;default:return}const c=o.format();l.has(c)||l.set(c,o)}),this.deploy||Ht(this,{deploy:Il.from("constructor()")}),Ht(this,{fallback:i,receive:s})}format(e){const t=e?"minimal":"full";return this.fragments.map(i=>i.format(t))}formatJson(){const e=this.fragments.map(t=>t.format("json"));return JSON.stringify(e.map(t=>JSON.parse(t)))}getAbiCoder(){return hv.defaultAbiCoder()}getFunctionName(e){const t=st(this,Jp,cA).call(this,e,null,!1);return xe(t,"no matching function","key",e),t.name}hasFunction(e){return!!st(this,Jp,cA).call(this,e,null,!1)}getFunction(e,t){return st(this,Jp,cA).call(this,e,t||null,!0)}forEachFunction(e){const t=Array.from(N(this,Ca).keys());t.sort((r,i)=>r.localeCompare(i));for(let r=0;r<t.length;r++){const i=t[r];e(N(this,Ca).get(i),r)}}getEventName(e){const t=st(this,Kp,uA).call(this,e,null,!1);return xe(t,"no matching event","key",e),t.name}hasEvent(e){return!!st(this,Kp,uA).call(this,e,null,!1)}getEvent(e,t){return st(this,Kp,uA).call(this,e,t||null,!0)}forEachEvent(e){const t=Array.from(N(this,Ta).keys());t.sort((r,i)=>r.localeCompare(i));for(let r=0;r<t.length;r++){const i=t[r];e(N(this,Ta).get(i),r)}}getError(e,t){if(Xn(e)){const i=e.toLowerCase();if(pD[i])return ys.from(pD[i].signature);for(const s of N(this,Ma).values())if(i===s.selector)return s;return null}if(e.indexOf("(")===-1){const i=[];for(const[s,o]of N(this,Ma))s.split("(")[0]===e&&i.push(o);if(i.length===0)return e==="Error"?ys.from("error Error(string)"):e==="Panic"?ys.from("error Panic(uint256)"):null;if(i.length>1){const s=i.map(o=>JSON.stringify(o.format())).join(", ");xe(!1,`ambiguous error description (i.e. ${s})`,"name",e)}return i[0]}if(e=ys.from(e).format(),e==="Error(string)")return ys.from("error Error(string)");if(e==="Panic(uint256)")return ys.from("error Panic(uint256)");const r=N(this,Ma).get(e);return r||null}forEachError(e){const t=Array.from(N(this,Ma).keys());t.sort((r,i)=>r.localeCompare(i));for(let r=0;r<t.length;r++){const i=t[r];e(N(this,Ma).get(i),r)}}_decodeParams(e,t){return N(this,Bi).decode(e,t)}_encodeParams(e,t){return N(this,Bi).encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){if(typeof e=="string"){const r=this.getError(e);xe(r,"unknown error","fragment",e),e=r}return xe(gr(t,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",t),this._decodeParams(e.inputs,gr(t,4))}encodeErrorResult(e,t){if(typeof e=="string"){const r=this.getError(e);xe(r,"unknown error","fragment",e),e=r}return tr([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionData(e,t){if(typeof e=="string"){const r=this.getFunction(e);xe(r,"unknown function","fragment",e),e=r}return xe(gr(t,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",t),this._decodeParams(e.inputs,gr(t,4))}encodeFunctionData(e,t){if(typeof e=="string"){const r=this.getFunction(e);xe(r,"unknown function","fragment",e),e=r}return tr([e.selector,this._encodeParams(e.inputs,t||[])])}decodeFunctionResult(e,t){if(typeof e=="string"){const s=this.getFunction(e);xe(s,"unknown function","fragment",e),e=s}let r="invalid length for result data";const i=$i(t);if(i.length%32===0)try{return N(this,Bi).decode(e.outputs,i)}catch{r="could not decode result data"}qe(!1,r,"BAD_DATA",{value:_t(i),info:{method:e.name,signature:e.format()}})}makeError(e,t){const r=an(e,"data"),i=hv.getBuiltinCallException("call",t,r),s="execution reverted (unknown custom error)";if(i.message.startsWith(s)){const a=_t(r.slice(0,4)),l=this.getError(a);if(l)try{const c=N(this,Bi).decode(l.inputs,r.slice(4));i.revert={name:l.name,signature:l.format(),args:c},i.reason=i.revert.signature,i.message=`execution reverted: ${i.reason}`}catch{i.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(t);return o&&(i.invocation={method:o.name,signature:o.signature,args:o.args}),i}encodeFunctionResult(e,t){if(typeof e=="string"){const r=this.getFunction(e);xe(r,"unknown function","fragment",e),e=r}return _t(N(this,Bi).encode(e.outputs,t||[]))}encodeFilterTopics(e,t){if(typeof e=="string"){const s=this.getEvent(e);xe(s,"unknown event","eventFragment",e),e=s}qe(t.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:t.length,expectedCount:e.inputs.length});const r=[];e.anonymous||r.push(e.topicHash);const i=(s,o)=>s.type==="string"?Sh(o):s.type==="bytes"?Fr(_t(o)):(s.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":s.type.match(/^u?int/)?o=wu(o):s.type.match(/^bytes/)?o=xG(o,32):s.type==="address"&&N(this,Bi).encode(["address"],[o]),Jl(_t(o),32));for(t.forEach((s,o)=>{const a=e.inputs[o];if(!a.indexed){xe(s==null,"cannot filter non-indexed parameters; must be null","contract."+a.name,s);return}s==null?r.push(null):a.baseType==="array"||a.baseType==="tuple"?xe(!1,"filtering with tuples or arrays not supported","contract."+a.name,s):Array.isArray(s)?r.push(s.map(l=>i(a,l))):r.push(i(a,s))});r.length&&r[r.length-1]===null;)r.pop();return r}encodeEventLog(e,t){if(typeof e=="string"){const o=this.getEvent(e);xe(o,"unknown event","eventFragment",e),e=o}const r=[],i=[],s=[];return e.anonymous||r.push(e.topicHash),xe(t.length===e.inputs.length,"event arguments/values mismatch","values",t),e.inputs.forEach((o,a)=>{const l=t[a];if(o.indexed)if(o.type==="string")r.push(Sh(l));else if(o.type==="bytes")r.push(Fr(l));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");r.push(N(this,Bi).encode([o.type],[l]))}else i.push(o),s.push(l)}),{data:N(this,Bi).encode(i,s),topics:r}}decodeEventLog(e,t,r){if(typeof e=="string"){const m=this.getEvent(e);xe(m,"unknown event","eventFragment",e),e=m}if(r!=null&&!e.anonymous){const m=e.topicHash;xe(Xn(r[0],32)&&r[0].toLowerCase()===m,"fragment/topic mismatch","topics[0]",r[0]),r=r.slice(1)}const i=[],s=[],o=[];e.inputs.forEach((m,g)=>{m.indexed?m.type==="string"||m.type==="bytes"||m.baseType==="tuple"||m.baseType==="array"?(i.push(yi.from({type:"bytes32",name:m.name})),o.push(!0)):(i.push(m),o.push(!1)):(s.push(m),o.push(!1))});const a=r!=null?N(this,Bi).decode(i,tr(r)):null,l=N(this,Bi).decode(s,t,!0),c=[],u=[];let f=0,d=0;return e.inputs.forEach((m,g)=>{let y=null;if(m.indexed)if(a==null)y=new hD(null);else if(o[g])y=new hD(a[d++]);else try{y=a[d++]}catch(x){y=x}else try{y=l[f++]}catch(x){y=x}c.push(y),u.push(m.name||null)}),bm.fromItems(c,u)}parseTransaction(e){const t=an(e.data,"tx.data"),r=Mt(e.value!=null?e.value:0,"tx.value"),i=this.getFunction(_t(t.slice(0,4)));if(!i)return null;const s=N(this,Bi).decode(i.inputs,t.slice(4));return new eie(i,i.selector,s,r)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new $re(t,t.topicHash,this.decodeEventLog(t,e.data,e.topics))}parseError(e){const t=_t(e),r=this.getError(gr(t,0,4));if(!r)return null;const i=N(this,Bi).decode(r.inputs,gr(t,4));return new tie(r,r.selector,i)}static from(e){return e instanceof wf?e:typeof e=="string"?new wf(JSON.parse(e)):typeof e.formatJson=="function"?new wf(e.formatJson()):typeof e.format=="function"?new wf(e.format("json")):new wf(e)}};Ma=new WeakMap,Ta=new WeakMap,Ca=new WeakMap,Bi=new WeakMap,Jp=new WeakSet,cA=function(e,t,r){if(Xn(e)){const s=e.toLowerCase();for(const o of N(this,Ca).values())if(s===o.selector)return o;return null}if(e.indexOf("(")===-1){const s=[];for(const[o,a]of N(this,Ca))o.split("(")[0]===e&&s.push(a);if(t){const o=t.length>0?t[t.length-1]:null;let a=t.length,l=!0;Ui.isTyped(o)&&o.type==="overrides"&&(l=!1,a--);for(let c=s.length-1;c>=0;c--){const u=s[c].inputs.length;u!==a&&(!l||u!==a-1)&&s.splice(c,1)}for(let c=s.length-1;c>=0;c--){const u=s[c].inputs;for(let f=0;f<t.length;f++)if(Ui.isTyped(t[f])){if(f>=u.length){if(t[f].type==="overrides")continue;s.splice(c,1);break}if(t[f].type!==u[f].baseType){s.splice(c,1);break}}}}if(s.length===1&&t&&t.length!==s[0].inputs.length){const o=t[t.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&s.splice(0,1)}if(s.length===0)return null;if(s.length>1&&r){const o=s.map(a=>JSON.stringify(a.format())).join(", ");xe(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return s[0]}const i=N(this,Ca).get(Na.from(e).format());return i||null},Kp=new WeakSet,uA=function(e,t,r){if(Xn(e)){const s=e.toLowerCase();for(const o of N(this,Ta).values())if(s===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const s=[];for(const[o,a]of N(this,Ta))o.split("(")[0]===e&&s.push(a);if(t){for(let o=s.length-1;o>=0;o--)s[o].inputs.length<t.length&&s.splice(o,1);for(let o=s.length-1;o>=0;o--){const a=s[o].inputs;for(let l=0;l<t.length;l++)if(Ui.isTyped(t[l])&&t[l].type!==a[l].baseType){s.splice(o,1);break}}}if(s.length===0)return null;if(s.length>1&&r){const o=s.map(a=>JSON.stringify(a.format())).join(", ");xe(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return s[0]}const i=N(this,Ta).get(La.from(e).format());return i||null};let YT=wf;const Kz=BigInt(0);function xp(n){return n??null}function br(n){return n==null?null:n.toString()}class mD{constructor(e,t,r){Ee(this,"gasPrice");Ee(this,"maxFeePerGas");Ee(this,"maxPriorityFeePerGas");Ht(this,{gasPrice:xp(e),maxFeePerGas:xp(t),maxPriorityFeePerGas:xp(r)})}toJSON(){const{gasPrice:e,maxFeePerGas:t,maxPriorityFeePerGas:r}=this;return{_type:"FeeData",gasPrice:br(e),maxFeePerGas:br(t),maxPriorityFeePerGas:br(r)}}}function s_(n){const e={};n.to&&(e.to=n.to),n.from&&(e.from=n.from),n.data&&(e.data=_t(n.data));const t="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const i of t)!(i in n)||n[i]==null||(e[i]=Mt(n[i],`request.${i}`));const r="type,nonce".split(/,/);for(const i of r)!(i in n)||n[i]==null||(e[i]=Qt(n[i],`request.${i}`));return n.accessList&&(e.accessList=Fh(n.accessList)),n.authorizationList&&(e.authorizationList=n.authorizationList.slice()),"blockTag"in n&&(e.blockTag=n.blockTag),"enableCcipRead"in n&&(e.enableCcipRead=!!n.enableCcipRead),"customData"in n&&(e.customData=n.customData),"blobVersionedHashes"in n&&n.blobVersionedHashes&&(e.blobVersionedHashes=n.blobVersionedHashes.slice()),"kzg"in n&&(e.kzg=n.kzg),"blobWrapperVersion"in n&&(e.blobWrapperVersion=n.blobWrapperVersion),"blobs"in n&&n.blobs&&(e.blobs=n.blobs.map(i=>CR(i)?_t(i):Object.assign({},i))),e}var _l;class nie{constructor(e,t){Ee(this,"provider");Ee(this,"number");Ee(this,"hash");Ee(this,"timestamp");Ee(this,"parentHash");Ee(this,"parentBeaconBlockRoot");Ee(this,"nonce");Ee(this,"difficulty");Ee(this,"gasLimit");Ee(this,"gasUsed");Ee(this,"stateRoot");Ee(this,"receiptsRoot");Ee(this,"blobGasUsed");Ee(this,"excessBlobGas");Ee(this,"miner");Ee(this,"prevRandao");Ee(this,"extraData");Ee(this,"baseFeePerGas");Be(this,_l,void 0);oe(this,_l,e.transactions.map(r=>typeof r!="string"?new dv(r,t):r)),Ht(this,{provider:t,hash:xp(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:xp(e.prevRandao),extraData:e.extraData,baseFeePerGas:xp(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return N(this,_l).map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=N(this,_l).slice();return e.length===0?[]:(qe(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:t,extraData:r,gasLimit:i,gasUsed:s,hash:o,miner:a,prevRandao:l,nonce:c,number:u,parentHash:f,parentBeaconBlockRoot:d,stateRoot:m,receiptsRoot:g,timestamp:y,transactions:x}=this;return{_type:"Block",baseFeePerGas:br(e),difficulty:br(t),extraData:r,gasLimit:br(i),gasUsed:br(s),blobGasUsed:br(this.blobGasUsed),excessBlobGas:br(this.excessBlobGas),hash:o,miner:a,prevRandao:l,nonce:c,number:u,parentHash:f,timestamp:y,parentBeaconBlockRoot:d,stateRoot:m,receiptsRoot:g,transactions:x}}[Symbol.iterator](){let e=0;const t=this.transactions;return{next:()=>e<this.length?{value:t[e++],done:!1}:{value:void 0,done:!0}}}get length(){return N(this,_l).length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let t;if(typeof e=="number")t=N(this,_l)[e];else{const r=e.toLowerCase();for(const i of N(this,_l))if(typeof i=="string"){if(i!==r)continue;t=i;break}else{if(i.hash!==r)continue;t=i;break}}if(t==null)throw new Error("no such tx");return typeof t=="string"?await this.provider.getTransaction(t):t}getPrefetchedTransaction(e){const t=this.prefetchedTransactions;if(typeof e=="number")return t[e];e=e.toLowerCase();for(const r of t)if(r.hash===e)return r;xe(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return rie(this)}}_l=new WeakMap;class ay{constructor(e,t){Ee(this,"provider");Ee(this,"transactionHash");Ee(this,"blockHash");Ee(this,"blockNumber");Ee(this,"removed");Ee(this,"address");Ee(this,"data");Ee(this,"topics");Ee(this,"index");Ee(this,"transactionIndex");this.provider=t;const r=Object.freeze(e.topics.slice());Ht(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:r,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:t,blockNumber:r,data:i,index:s,removed:o,topics:a,transactionHash:l,transactionIndex:c}=this;return{_type:"log",address:e,blockHash:t,blockNumber:r,data:i,index:s,removed:o,topics:a,transactionHash:l,transactionIndex:c}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return qe(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return qe(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return qe(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return iie(this)}}var bv;class Qz{constructor(e,t){Ee(this,"provider");Ee(this,"to");Ee(this,"from");Ee(this,"contractAddress");Ee(this,"hash");Ee(this,"index");Ee(this,"blockHash");Ee(this,"blockNumber");Ee(this,"logsBloom");Ee(this,"gasUsed");Ee(this,"blobGasUsed");Ee(this,"cumulativeGasUsed");Ee(this,"gasPrice");Ee(this,"blobGasPrice");Ee(this,"type");Ee(this,"status");Ee(this,"root");Be(this,bv,void 0);oe(this,bv,Object.freeze(e.logs.map(i=>new ay(i,t))));let r=Kz;e.effectiveGasPrice!=null?r=e.effectiveGasPrice:e.gasPrice!=null&&(r=e.gasPrice),Ht(this,{provider:t,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:r,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return N(this,bv)}toJSON(){const{to:e,from:t,contractAddress:r,hash:i,index:s,blockHash:o,blockNumber:a,logsBloom:l,logs:c,status:u,root:f}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:a,contractAddress:r,cumulativeGasUsed:br(this.cumulativeGasUsed),from:t,gasPrice:br(this.gasPrice),blobGasUsed:br(this.blobGasUsed),blobGasPrice:br(this.blobGasPrice),gasUsed:br(this.gasUsed),hash:i,index:s,logs:c,logsBloom:l,root:f,status:u,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return Yz(this)}reorderedEvent(e){return qe(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),jz(this,e)}}bv=new WeakMap;var Fc;const YR=class YR{constructor(e,t){Ee(this,"provider");Ee(this,"blockNumber");Ee(this,"blockHash");Ee(this,"index");Ee(this,"hash");Ee(this,"type");Ee(this,"to");Ee(this,"from");Ee(this,"nonce");Ee(this,"gasLimit");Ee(this,"gasPrice");Ee(this,"maxPriorityFeePerGas");Ee(this,"maxFeePerGas");Ee(this,"maxFeePerBlobGas");Ee(this,"data");Ee(this,"value");Ee(this,"chainId");Ee(this,"signature");Ee(this,"accessList");Ee(this,"blobVersionedHashes");Ee(this,"authorizationList");Be(this,Fc,void 0);this.provider=t,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,oe(this,Fc,-1)}toJSON(){const{blockNumber:e,blockHash:t,index:r,hash:i,type:s,to:o,from:a,nonce:l,data:c,signature:u,accessList:f,blobVersionedHashes:d}=this;return{_type:"TransactionResponse",accessList:f,blockNumber:e,blockHash:t,blobVersionedHashes:d,chainId:br(this.chainId),data:c,from:a,gasLimit:br(this.gasLimit),gasPrice:br(this.gasPrice),hash:i,maxFeePerGas:br(this.maxFeePerGas),maxPriorityFeePerGas:br(this.maxPriorityFeePerGas),maxFeePerBlobGas:br(this.maxFeePerBlobGas),nonce:l,signature:u,to:o,index:r,type:s,value:br(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const r=await this.getTransaction();r&&(e=r.blockNumber)}if(e==null)return null;const t=this.provider.getBlock(e);if(t==null)throw new Error("TODO");return t}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:t,blockNumber:r}=await Zi({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return t==null||t.blockNumber==null?0:r-t.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,t){const r=e??1,i=t??0;let s=N(this,Fc),o=-1,a=s===-1;const l=async()=>{if(a)return null;const{blockNumber:d,nonce:m}=await Zi({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(m<this.nonce){s=d;return}if(a)return null;const g=await this.getTransaction();if(!(g&&g.blockNumber!=null))for(o===-1&&(o=s-3,o<N(this,Fc)&&(o=N(this,Fc)));o<=d;){if(a)return null;const y=await this.provider.getBlock(o,!0);if(y==null)return;for(const x of y)if(x===this.hash)return;for(let x=0;x<y.length;x++){const v=await y.getTransaction(x);if(v.from===this.from&&v.nonce===this.nonce){if(a)return null;const A=await this.provider.getTransactionReceipt(v.hash);if(A==null||d-A.blockNumber+1<r)return;let w="replaced";v.data===this.data&&v.to===this.to&&v.value===this.value?w="repriced":v.data==="0x"&&v.from===v.to&&v.value===Kz&&(w="cancelled"),qe(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:w==="replaced"||w==="cancelled",reason:w,replacement:v.replaceableTransaction(s),hash:v.hash,receipt:A})}}o++}},c=d=>{if(d==null||d.status!==0)return d;qe(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:d.to,from:d.from,data:""},receipt:d})},u=await this.provider.getTransactionReceipt(this.hash);if(r===0)return c(u);if(u){if(r===1||await u.confirmations()>=r)return c(u)}else if(await l(),r===0)return null;return await new Promise((d,m)=>{const g=[],y=()=>{g.forEach(v=>v())};if(g.push(()=>{a=!0}),i>0){const v=setTimeout(()=>{y(),m(qn("wait for transaction timeout","TIMEOUT"))},i);g.push(()=>{clearTimeout(v)})}const x=async v=>{if(await v.confirmations()>=r){y();try{d(c(v))}catch(A){m(A)}}};if(g.push(()=>{this.provider.off(this.hash,x)}),this.provider.on(this.hash,x),s>=0){const v=async()=>{try{await l()}catch(A){if(pi(A,"TRANSACTION_REPLACED")){y(),m(A);return}}a||this.provider.once("block",v)};g.push(()=>{this.provider.off("block",v)}),this.provider.once("block",v)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return qe(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Yz(this)}reorderedEvent(e){return qe(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),qe(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),jz(this,e)}replaceableTransaction(e){xe(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const t=new YR(this,this.provider);return oe(t,Fc,e),t}};Fc=new WeakMap;let dv=YR;function rie(n){return{orphan:"drop-block",hash:n.hash,number:n.number}}function jz(n,e){return{orphan:"reorder-transaction",tx:n,other:e}}function Yz(n){return{orphan:"drop-transaction",tx:n}}function iie(n){return{orphan:"drop-log",log:{transactionHash:n.transactionHash,blockHash:n.blockHash,blockNumber:n.blockNumber,address:n.address,data:n.data,topics:Object.freeze(n.topics.slice()),index:n.index}}}class zR extends ay{constructor(t,r,i){super(t,t.provider);Ee(this,"interface");Ee(this,"fragment");Ee(this,"args");const s=r.decodeEventLog(i,t.data,t.topics);Ht(this,{args:s,fragment:i,interface:r})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class Zz extends ay{constructor(t,r){super(t,t.provider);Ee(this,"error");Ht(this,{error:r})}}var Qp;class sie extends Qz{constructor(t,r,i){super(i,r);Be(this,Qp,void 0);oe(this,Qp,t)}get logs(){return super.logs.map(t=>{const r=t.topics.length?N(this,Qp).getEvent(t.topics[0]):null;if(r)try{return new zR(t,N(this,Qp),r)}catch(i){return new Zz(t,i)}return t})}}Qp=new WeakMap;var Mv;class HR extends dv{constructor(t,r,i){super(i,r);Be(this,Mv,void 0);oe(this,Mv,t)}async wait(t,r){const i=await super.wait(t,r);return i==null?null:new sie(N(this,Mv),this.provider,i)}}Mv=new WeakMap;class qz extends _G{constructor(t,r,i,s){super(t,r,i);Ee(this,"log");Ht(this,{log:s})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class oie extends qz{constructor(e,t,r,i,s){super(e,t,r,new zR(s,e.interface,i));const o=e.interface.decodeEventLog(i,this.log.data,this.log.topics);Ht(this,{args:o,fragment:i})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const gD=BigInt(0);function $z(n){return n&&typeof n.call=="function"}function eH(n){return n&&typeof n.estimateGas=="function"}function Mw(n){return n&&typeof n.resolveName=="function"}function tH(n){return n&&typeof n.sendTransaction=="function"}function nH(n){if(n!=null){if(Mw(n))return n;if(n.provider)return n.provider}}var Tv;class aie{constructor(e,t,r){Be(this,Tv,void 0);Ee(this,"fragment");if(Ht(this,{fragment:t}),t.inputs.length<r.length)throw new Error("too many arguments");const i=Th(e.runner,"resolveName"),s=Mw(i)?i:null;oe(this,Tv,async function(){const o=await Promise.all(t.inputs.map((a,l)=>r[l]==null?null:a.walkAsync(r[l],(u,f)=>u==="address"?Array.isArray(f)?Promise.all(f.map(d=>ts(d,s))):ts(f,s):f)));return e.interface.encodeFilterTopics(t,o)}())}getTopicFilter(){return N(this,Tv)}}Tv=new WeakMap;function Th(n,e){return n==null?null:typeof n[e]=="function"?n:n.provider&&typeof n.provider[e]=="function"?n.provider:null}function Ff(n){return n==null?null:n.provider||null}async function rH(n,e){const t=Ui.dereference(n,"overrides");xe(typeof t=="object","invalid overrides parameter","overrides",n);const r=s_(t);return xe(r.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",r.to),xe(r.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",r.data),r.from&&(r.from=r.from),r}async function lie(n,e,t){const r=Th(n,"resolveName"),i=Mw(r)?r:null;return await Promise.all(e.map((s,o)=>s.walkAsync(t[o],(a,l)=>(l=Ui.dereference(l,a),a==="address"?ts(l,i):l))))}function cie(n){const e=async function(o){const a=await rH(o,["data"]);a.to=await n.getAddress(),a.from&&(a.from=await ts(a.from,nH(n.runner)));const l=n.interface,c=Mt(a.value||gD,"overrides.value")===gD,u=(a.data||"0x")==="0x";l.fallback&&!l.fallback.payable&&l.receive&&!u&&!c&&xe(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),xe(l.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data);const f=l.receive||l.fallback&&l.fallback.payable;return xe(f||c,"cannot send value to non-payable fallback","overrides.value",a.value),xe(l.fallback||u,"cannot send data to receive-only contract","overrides.data",a.data),a},t=async function(o){const a=Th(n.runner,"call");qe($z(a),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const l=await e(o);try{return await a.call(l)}catch(c){throw TR(c)&&c.data?n.interface.makeError(c.data,l):c}},r=async function(o){const a=n.runner;qe(tH(a),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const l=await a.sendTransaction(await e(o)),c=Ff(n.runner);return new HR(n.interface,c,l)},i=async function(o){const a=Th(n.runner,"estimateGas");return qe(eH(a),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await a.estimateGas(await e(o))},s=async o=>await r(o);return Ht(s,{_contract:n,estimateGas:i,populateTransaction:e,send:r,staticCall:t}),s}function uie(n,e){const t=function(...c){const u=n.interface.getFunction(e,c);return qe(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:c}}),u},r=async function(...c){const u=t(...c);let f={};if(u.inputs.length+1===c.length&&(f=await rH(c.pop()),f.from&&(f.from=await ts(f.from,nH(n.runner)))),u.inputs.length!==c.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const d=await lie(n.runner,u.inputs,c);return Object.assign({},f,await Zi({to:n.getAddress(),data:n.interface.encodeFunctionData(u,d)}))},i=async function(...c){const u=await a(...c);return u.length===1?u[0]:u},s=async function(...c){const u=n.runner;qe(tH(u),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const f=await u.sendTransaction(await r(...c)),d=Ff(n.runner);return new HR(n.interface,d,f)},o=async function(...c){const u=Th(n.runner,"estimateGas");return qe(eH(u),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await u.estimateGas(await r(...c))},a=async function(...c){const u=Th(n.runner,"call");qe($z(u),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const f=await r(...c);let d="0x";try{d=await u.call(f)}catch(g){throw TR(g)&&g.data?n.interface.makeError(g.data,f):g}const m=t(...c);return n.interface.decodeFunctionResult(m,d)},l=async(...c)=>t(...c).constant?await i(...c):await s(...c);return Ht(l,{name:n.interface.getFunctionName(e),_contract:n,_key:e,getFragment:t,estimateGas:o,populateTransaction:r,send:s,staticCall:i,staticCallResult:a}),Object.defineProperty(l,"fragment",{configurable:!1,enumerable:!0,get:()=>{const c=n.interface.getFunction(e);return qe(c,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),c}}),l}function fie(n,e){const t=function(...i){const s=n.interface.getEvent(e,i);return qe(s,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:i}}),s},r=function(...i){return new aie(n,t(...i),i)};return Ht(r,{name:n.interface.getEventName(e),_contract:n,_key:e,getFragment:t}),Object.defineProperty(r,"fragment",{configurable:!1,enumerable:!0,get:()=>{const i=n.interface.getEvent(e);return qe(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),i}}),r}const o_=Symbol.for("_ethersInternal_contract"),iH=new WeakMap;function hie(n,e){iH.set(n[o_],e)}function Os(n){return iH.get(n[o_])}function die(n){return n&&typeof n=="object"&&"getTopicFilter"in n&&typeof n.getTopicFilter=="function"&&n.fragment}async function VR(n,e){let t,r=null;if(Array.isArray(e)){const s=function(o){if(Xn(o,32))return o;const a=n.interface.getEvent(o);return xe(a,"unknown fragment","name",o),a.topicHash};t=e.map(o=>o==null?null:Array.isArray(o)?o.map(s):s(o))}else e==="*"?t=[null]:typeof e=="string"?Xn(e,32)?t=[e]:(r=n.interface.getEvent(e),xe(r,"unknown fragment","event",e),t=[r.topicHash]):die(e)?t=await e.getTopicFilter():"fragment"in e?(r=e.fragment,t=[r.topicHash]):xe(!1,"unknown event name","event",e);t=t.map(s=>{if(s==null)return null;if(Array.isArray(s)){const o=Array.from(new Set(s.map(a=>a.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return s.toLowerCase()});const i=t.map(s=>s==null?"null":Array.isArray(s)?s.join("|"):s).join("&");return{fragment:r,tag:i,topics:t}}async function r0(n,e){const{subs:t}=Os(n);return t.get((await VR(n,e)).tag)||null}async function vD(n,e,t){const r=Ff(n.runner);qe(r,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:i,tag:s,topics:o}=await VR(n,t),{addr:a,subs:l}=Os(n);let c=l.get(s);if(!c){const f={address:a||n,topics:o},d=x=>{let v=i;if(v==null)try{v=n.interface.getEvent(x.topics[0])}catch{}if(v){const A=v,w=i?n.interface.decodeEventLog(i,x.data,x.topics):[];qT(n,t,w,S=>new oie(n,S,t,A,x))}else qT(n,t,[],A=>new qz(n,A,t,x))};let m=[];c={tag:s,listeners:[],start:()=>{m.length||m.push(r.on(f,d))},stop:async()=>{if(m.length==0)return;let x=m;m=[],await Promise.all(x),r.off(f,d)}},l.set(s,c)}return c}let ZT=Promise.resolve();async function pie(n,e,t,r){await ZT;const i=await r0(n,e);if(!i)return!1;const s=i.listeners.length;return i.listeners=i.listeners.filter(({listener:o,once:a})=>{const l=Array.from(t);r&&l.push(r(a?null:o));try{o.call(n,...l)}catch{}return!a}),i.listeners.length===0&&(i.stop(),Os(n).subs.delete(i.tag)),s>0}async function qT(n,e,t,r){try{await ZT}catch{}const i=pie(n,e,t,r);return ZT=i,await i}const C1=["then"];var jse;const S0=class S0{constructor(e,t,r,i){Ee(this,"target");Ee(this,"interface");Ee(this,"runner");Ee(this,"filters");Ee(this,jse);Ee(this,"fallback");xe(typeof e=="string"||cz(e),"invalid value for Contract target","target",e),r==null&&(r=null);const s=YT.from(t);Ht(this,{target:e,runner:r,interface:s}),Object.defineProperty(this,o_,{value:{}});let o,a=null,l=null;if(i){const f=Ff(r);l=new HR(this.interface,f,i)}let c=new Map;if(typeof e=="string")if(Xn(e))a=e,o=Promise.resolve(e);else{const f=Th(r,"resolveName");if(!Mw(f))throw qn("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=f.resolveName(e).then(d=>{if(d==null)throw qn("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return Os(this).addr=d,d})}else o=e.getAddress().then(f=>{if(f==null)throw new Error("TODO");return Os(this).addr=f,f});hie(this,{addrPromise:o,addr:a,deployTx:l,subs:c});const u=new Proxy({},{get:(f,d,m)=>{if(typeof d=="symbol"||C1.indexOf(d)>=0)return Reflect.get(f,d,m);try{return this.getEvent(d)}catch(g){if(!pi(g,"INVALID_ARGUMENT")||g.argument!=="key")throw g}},has:(f,d)=>C1.indexOf(d)>=0?Reflect.has(f,d):Reflect.has(f,d)||this.interface.hasEvent(String(d))});return Ht(this,{filters:u}),Ht(this,{fallback:s.receive||s.fallback?cie(this):null}),new Proxy(this,{get:(f,d,m)=>{if(typeof d=="symbol"||d in f||C1.indexOf(d)>=0)return Reflect.get(f,d,m);try{return f.getFunction(d)}catch(g){if(!pi(g,"INVALID_ARGUMENT")||g.argument!=="key")throw g}},has:(f,d)=>typeof d=="symbol"||d in f||C1.indexOf(d)>=0?Reflect.has(f,d):f.interface.hasFunction(d)})}connect(e){return new S0(this.target,this.interface,e)}attach(e){return new S0(e,this.interface,this.runner)}async getAddress(){return await Os(this).addrPromise}async getDeployedCode(){const e=Ff(this.runner);qe(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const t=await e.getCode(await this.getAddress());return t==="0x"?null:t}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const r=Ff(this.runner);return qe(r!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((i,s)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return i(this);r.once("block",o)}catch(a){s(a)}};o()})}deploymentTransaction(){return Os(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),uie(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),fie(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,t,r){t==null&&(t=0),r==null&&(r="latest");const{addr:i,addrPromise:s}=Os(this),o=i||await s,{fragment:a,topics:l}=await VR(this,e),c={address:o,topics:l,fromBlock:t,toBlock:r},u=Ff(this.runner);return qe(u,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await u.getLogs(c)).map(f=>{let d=a;if(d==null)try{d=this.interface.getEvent(f.topics[0])}catch{}if(d)try{return new zR(f,this.interface,d)}catch(m){return new Zz(f,m)}return new ay(f,u)})}async on(e,t){const r=await vD(this,"on",e);return r.listeners.push({listener:t,once:!1}),r.start(),this}async once(e,t){const r=await vD(this,"once",e);return r.listeners.push({listener:t,once:!0}),r.start(),this}async emit(e,...t){return await qT(this,e,t,null)}async listenerCount(e){if(e){const i=await r0(this,e);return i?i.listeners.length:0}const{subs:t}=Os(this);let r=0;for(const{listeners:i}of t.values())r+=i.length;return r}async listeners(e){if(e){const i=await r0(this,e);return i?i.listeners.map(({listener:s})=>s):[]}const{subs:t}=Os(this);let r=[];for(const{listeners:i}of t.values())r=r.concat(i.map(({listener:s})=>s));return r}async off(e,t){const r=await r0(this,e);if(!r)return this;if(t){const i=r.listeners.map(({listener:s})=>s).indexOf(t);i>=0&&r.listeners.splice(i,1)}return(t==null||r.listeners.length===0)&&(r.stop(),Os(this).subs.delete(r.tag)),this}async removeAllListeners(e){if(e){const t=await r0(this,e);if(!t)return this;t.stop(),Os(this).subs.delete(t.tag)}else{const{subs:t}=Os(this);for(const{tag:r,stop:i}of t.values())i(),t.delete(r)}return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return await this.off(e,t)}static buildClass(e){class t extends S0{constructor(i,s=null){super(i,e,s)}}return t}static from(e,t,r){return r==null&&(r=null),new this(e,t,r)}};jse=o_;let $T=S0;function mie(){return $T}class fu extends mie(){}function vb(n){return n.match(/^ipfs:\/\/ipfs\//i)?n=n.substring(12):n.match(/^ipfs:\/\//i)?n=n.substring(7):xe(!1,"unsupported IPFS format","link",n),`https://gateway.ipfs.io/ipfs/${n}`}class gie{constructor(e){Ee(this,"name");Ht(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,t){throw new Error("unsupported coin")}async decodeAddress(e,t){throw new Error("unsupported coin")}}const sH=new RegExp("^(ipfs)://(.*)$","i"),yD=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),sH,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];var Oc,jf,kc,Ld,d_,oH;const rp=class rp{constructor(e,t,r){Be(this,kc);Ee(this,"provider");Ee(this,"address");Ee(this,"name");Be(this,Oc,void 0);Be(this,jf,void 0);Ht(this,{provider:e,address:t,name:r}),oe(this,Oc,null),oe(this,jf,new fu(t,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e))}async supportsWildcard(){return N(this,Oc)==null&&oe(this,Oc,(async()=>{try{return await N(this,jf).supportsInterface("0x9061b923")}catch(e){if(pi(e,"CALL_EXCEPTION"))return!1;throw oe(this,Oc,null),e}})()),await N(this,Oc)}async getAddress(e){if(e==null&&(e=60),e===60)try{const s=await st(this,kc,Ld).call(this,"addr(bytes32)");return s==null||s===sv?null:s}catch(s){if(pi(s,"CALL_EXCEPTION"))return null;throw s}if(e>=0&&e<2147483648){let s=e+2147483648;const o=await st(this,kc,Ld).call(this,"addr(bytes32,uint)",[s]);if(Xn(o,20))return Bn(o)}let t=null;for(const s of this.provider.plugins)if(s instanceof gie&&s.supportsCoinType(e)){t=s;break}if(t==null)return null;const r=await st(this,kc,Ld).call(this,"addr(bytes32,uint)",[e]);if(r==null||r==="0x")return null;const i=await t.decodeAddress(e,r);if(i!=null)return i;qe(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:r}})}async getText(e){const t=await st(this,kc,Ld).call(this,"text(bytes32,string)",[e]);return t==null||t==="0x"?null:t}async getContentHash(){const e=await st(this,kc,Ld).call(this,"contenthash(bytes32)");if(e==null||e==="0x")return null;const t=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(t){const i=t[1]==="e3010170"?"ipfs":"ipns",s=parseInt(t[4],16);if(t[5].length===s*2)return`${i}://${mee("0x"+t[2])}`}const r=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(r&&r[1].length===64)return`bzz://${r[1]}`;qe(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const t=await this.getText("avatar");if(t==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:t});for(let r=0;r<yD.length;r++){const i=t.match(yD[r]);if(i==null)continue;const s=i[1].toLowerCase();switch(s){case"https":case"data":return e.push({type:"url",value:t}),{linkage:e,url:t};case"ipfs":{const o=vb(t);return e.push({type:"ipfs",value:t}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=s==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:s,value:t});const a=await this.getAddress();if(a==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const l=(i[2]||"").split("/");if(l.length!==2)return e.push({type:`!${s}caip`,value:i[2]||""}),{url:null,linkage:e};const c=l[1],u=new fu(l[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(s==="erc721"){const y=await u.ownerOf(c);if(a!==y)return e.push({type:"!owner",value:y}),{url:null,linkage:e};e.push({type:"owner",value:y})}else if(s==="erc1155"){const y=await u.balanceOf(a,c);if(!y)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:y.toString()})}let f=await u[o](c);if(f==null||f==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:f}),s==="erc1155"&&(f=f.replace("{id}",wu(c,32).substring(2)),e.push({type:"metadata-url-expanded",value:f})),f.match(/^ipfs:/i)&&(f=vb(f)),e.push({type:"metadata-url",value:f});let d={};const m=await new Eu(f).send();m.assertOk();try{d=m.bodyJson}catch{try{e.push({type:"!metadata",value:m.bodyText})}catch{const v=m.body;return v&&e.push({type:"!metadata",value:_t(v)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!d)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(d)});let g=d.image;if(typeof g!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!g.match(/^(https:\/\/|data:)/i)){if(g.match(sH)==null)return e.push({type:"!imageUrl-ipfs",value:g}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:g}),g=vb(g)}return e.push({type:"url",value:g}),{linkage:e,url:g}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const t=await e.getNetwork(),r=t.getPlugin("org.ethers.plugins.network.Ens");return qe(r,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:t}}),r.address}static async fromName(e,t){var i;let r=t;for(;;){if(r===""||r==="."||t!=="eth"&&r==="eth")return null;const s=await st(i=rp,d_,oH).call(i,e,r);if(s!=null){const o=new rp(e,s,t);return r!==t&&!await o.supportsWildcard()?null:o}r=r.split(".").slice(1).join(".")}}};Oc=new WeakMap,jf=new WeakMap,kc=new WeakSet,Ld=async function(e,t){t=(t||[]).slice();const r=N(this,jf).interface;t.unshift(QT(this.name));let i=null;await this.supportsWildcard()&&(i=r.getFunction(e),qe(i,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),t=[Pre(this.name,255),r.encodeFunctionData(i,t)],e="resolve(bytes,bytes)"),t.push({enableCcipRead:!0});try{const s=await N(this,jf)[e](...t);return i?r.decodeFunctionResult(i,s)[0]:s}catch(s){if(!pi(s,"CALL_EXCEPTION"))throw s}return null},d_=new WeakSet,oH=async function(e,t){const r=await rp.getEnsAddress(e);try{const s=await new fu(r,["function resolver(bytes32) view returns (address)"],e).resolver(QT(t),{enableCcipRead:!0});return s===sv?null:s}catch(i){throw i}return null},Be(rp,d_);let a_=rp;const xD=BigInt(0);function yn(n,e){return function(t){return t==null?e:n(t)}}function pv(n,e){return t=>{if(e&&t==null)return null;if(!Array.isArray(t))throw new Error("not an array");return t.map(r=>n(r))}}function ly(n,e){return t=>{const r={};for(const i in n){let s=i;if(e&&i in e&&!(s in t)){for(const o of e[i])if(o in t){s=o;break}}try{const o=n[i](t[s]);o!==void 0&&(r[i]=o)}catch(o){const a=o instanceof Error?o.message:"not-an-error";qe(!1,`invalid value for value.${i} (${a})`,"BAD_DATA",{value:t})}}return r}}function vie(n){switch(n){case!0:case"true":return!0;case!1:case"false":return!1}xe(!1,`invalid boolean; ${JSON.stringify(n)}`,"value",n)}function Im(n){return xe(Xn(n,!0),"invalid data","value",n),n}function hi(n){return xe(Xn(n,32),"invalid hash","value",n),n}const yie=ly({address:Bn,blockHash:hi,blockNumber:Qt,data:Im,index:Qt,removed:yn(vie,!1),topics:pv(hi),transactionHash:hi,transactionIndex:Qt},{index:["logIndex"]});function xie(n){return yie(n)}const Aie=ly({hash:yn(hi),parentHash:hi,parentBeaconBlockRoot:yn(hi,null),number:Qt,timestamp:Qt,nonce:yn(Im),difficulty:Mt,gasLimit:Mt,gasUsed:Mt,stateRoot:yn(hi,null),receiptsRoot:yn(hi,null),blobGasUsed:yn(Mt,null),excessBlobGas:yn(Mt,null),miner:yn(Bn),prevRandao:yn(hi,null),extraData:Im,baseFeePerGas:yn(Mt)},{prevRandao:["mixHash"]});function _ie(n){const e=Aie(n);return e.transactions=n.transactions.map(t=>typeof t=="string"?t:aH(t)),e}const wie=ly({transactionIndex:Qt,blockNumber:Qt,transactionHash:hi,address:Bn,topics:pv(hi),data:Im,index:Qt,blockHash:hi},{index:["logIndex"]});function Eie(n){return wie(n)}const Sie=ly({to:yn(Bn,null),from:yn(Bn,null),contractAddress:yn(Bn,null),index:Qt,root:yn(_t),gasUsed:Mt,blobGasUsed:yn(Mt,null),logsBloom:yn(Im),blockHash:hi,hash:hi,logs:pv(Eie),blockNumber:Qt,cumulativeGasUsed:Mt,effectiveGasPrice:yn(Mt),blobGasPrice:yn(Mt,null),status:yn(Qt),type:yn(Qt,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function bie(n){return Sie(n)}function aH(n){n.to&&Mt(n.to)===xD&&(n.to="0x0000000000000000000000000000000000000000");const e=ly({hash:hi,index:yn(Qt,void 0),type:t=>t==="0x"||t==null?0:Qt(t),accessList:yn(Fh,null),blobVersionedHashes:yn(pv(hi,!0),null),authorizationList:yn(pv(t=>{let r;if(t.signature)r=t.signature;else{let i=t.yParity;i==="0x1b"?i=0:i==="0x1c"&&(i=1),r=Object.assign({},t,{yParity:i})}return{address:Bn(t.address),chainId:Mt(t.chainId),nonce:Mt(t.nonce),signature:Ss.from(r)}},!1),null),blockHash:yn(hi,null),blockNumber:yn(Qt,null),transactionIndex:yn(Qt,null),from:Bn,gasPrice:yn(Mt),maxPriorityFeePerGas:yn(Mt),maxFeePerGas:yn(Mt),maxFeePerBlobGas:yn(Mt,null),gasLimit:Mt,to:yn(Bn,null),value:Mt,nonce:Qt,data:Im,creates:yn(Bn,null),chainId:yn(Mt,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(n);if(e.to==null&&e.creates==null&&(e.creates=hne(e)),(n.type===1||n.type===2)&&n.accessList==null&&(e.accessList=[]),n.signature?e.signature=Ss.from(n.signature):e.signature=Ss.from(n),e.chainId==null){const t=e.signature.legacyChainId;t!=null&&(e.chainId=t)}return e.blockHash&&Mt(e.blockHash)===xD&&(e.blockHash=null),e}const Mie="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class cy{constructor(e){Ee(this,"name");Ht(this,{name:e})}clone(){return new cy(this.name)}}class Tw extends cy{constructor(t,r){t==null&&(t=0);super(`org.ethers.network.plugins.GasCost#${t||0}`);Ee(this,"effectiveBlock");Ee(this,"txBase");Ee(this,"txCreate");Ee(this,"txDataZero");Ee(this,"txDataNonzero");Ee(this,"txAccessListStorageKey");Ee(this,"txAccessListAddress");const i={effectiveBlock:t};function s(o,a){let l=(r||{})[o];l==null&&(l=a),xe(typeof l=="number",`invalud value for ${o}`,"costs",r),i[o]=l}s("txBase",21e3),s("txCreate",32e3),s("txDataZero",4),s("txDataNonzero",16),s("txAccessListStorageKey",1900),s("txAccessListAddress",2400),Ht(this,i)}clone(){return new Tw(this.effectiveBlock,this)}}class Cw extends cy{constructor(t,r){super("org.ethers.plugins.network.Ens");Ee(this,"address");Ee(this,"targetNetwork");Ht(this,{address:t||Mie,targetNetwork:r??1})}clone(){return new Cw(this.address,this.targetNetwork)}}var Cv,Rv;class Tie extends cy{constructor(t,r){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin");Be(this,Cv,void 0);Be(this,Rv,void 0);oe(this,Cv,t),oe(this,Rv,r)}get url(){return N(this,Cv)}get processFunc(){return N(this,Rv)}clone(){return this}}Cv=new WeakMap,Rv=new WeakMap;const yb=new Map;var jp,Yp,Gc;const ip=class ip{constructor(e,t){Be(this,jp,void 0);Be(this,Yp,void 0);Be(this,Gc,void 0);oe(this,jp,e),oe(this,Yp,Mt(t)),oe(this,Gc,new Map)}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return N(this,jp)}set name(e){oe(this,jp,e)}get chainId(){return N(this,Yp)}set chainId(e){oe(this,Yp,Mt(e,"chainId"))}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===Mt(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===Mt(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===Mt(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(N(this,Gc).values())}attachPlugin(e){if(N(this,Gc).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return N(this,Gc).set(e.name,e.clone()),this}getPlugin(e){return N(this,Gc).get(e)||null}getPlugins(e){return this.plugins.filter(t=>t.name.split("#")[0]===e)}clone(){const e=new ip(this.name,this.chainId);return this.plugins.forEach(t=>{e.attachPlugin(t.clone())}),e}computeIntrinsicGas(e){const t=this.getPlugin("org.ethers.plugins.network.GasCost")||new Tw;let r=t.txBase;if(e.to==null&&(r+=t.txCreate),e.data)for(let i=2;i<e.data.length;i+=2)e.data.substring(i,i+2)==="00"?r+=t.txDataZero:r+=t.txDataNonzero;if(e.accessList){const i=Fh(e.accessList);for(const s in i)r+=t.txAccessListAddress+t.txAccessListStorageKey*i[s].storageKeys.length}return r}static from(e){if(Cie(),e==null)return ip.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const t=yb.get(e);if(t)return t();if(typeof e=="bigint")return new ip("unknown",e);xe(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){xe(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const t=new ip(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&t.attachPlugin(new Cw(e.ensAddress,e.ensNetwork)),t}xe(!1,"invalid network","network",e)}static register(e,t){typeof e=="number"&&(e=BigInt(e));const r=yb.get(e);r&&xe(!1,`conflicting network for ${JSON.stringify(r.name)}`,"nameOrChainId",e),yb.set(e,t)}};jp=new WeakMap,Yp=new WeakMap,Gc=new WeakMap;let Ua=ip;function AD(n,e){const t=String(n);if(!t.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${n}`);const r=t.split(".");if(r.length===1&&r.push(""),r.length!==2)throw new Error(`invalid gwei value: ${n}`);for(;r[1].length<e;)r[1]+="0";if(r[1].length>9){let i=BigInt(r[1].substring(0,9));r[1].substring(9).match(/^0+$/)||i++,r[1]=i.toString()}return BigInt(r[0]+r[1])}function _D(n){return new Tie(n,async(e,t,r)=>{r.setHeader("User-Agent","ethers");let i;try{const[s,o]=await Promise.all([r.send(),e()]);i=s;const a=i.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:AD(a.maxFee,9),maxPriorityFeePerGas:AD(a.maxPriorityFee,9)}}catch(s){qe(!1,`error encountered with polygon gas station (${JSON.stringify(r.url)})`,"SERVER_ERROR",{request:r,response:i,error:s})}})}let wD=!1;function Cie(){if(wD)return;wD=!0;function n(e,t,r){const i=function(){const s=new Ua(e,t);return r.ensNetwork!=null&&s.attachPlugin(new Cw(null,r.ensNetwork)),s.attachPlugin(new Tw),(r.plugins||[]).forEach(o=>{s.attachPlugin(o)}),s};Ua.register(e,i),Ua.register(t,i),r.altNames&&r.altNames.forEach(s=>{Ua.register(s,i)})}n("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),n("ropsten",3,{ensNetwork:3}),n("rinkeby",4,{ensNetwork:4}),n("goerli",5,{ensNetwork:5}),n("kovan",42,{ensNetwork:42}),n("sepolia",11155111,{ensNetwork:11155111}),n("holesky",17e3,{ensNetwork:17e3}),n("classic",61,{}),n("classicKotti",6,{}),n("arbitrum",42161,{ensNetwork:1}),n("arbitrum-goerli",421613,{}),n("arbitrum-sepolia",421614,{}),n("base",8453,{ensNetwork:1}),n("base-goerli",84531,{}),n("base-sepolia",84532,{}),n("bnb",56,{ensNetwork:1}),n("bnbt",97,{}),n("filecoin",314,{}),n("filecoin-calibration",314159,{}),n("linea",59144,{ensNetwork:1}),n("linea-goerli",59140,{}),n("linea-sepolia",59141,{}),n("matic",137,{ensNetwork:1,plugins:[_D("https://gasstation.polygon.technology/v2")]}),n("matic-amoy",80002,{}),n("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[_D("https://gasstation-testnet.polygon.technology/v2")]}),n("optimism",10,{ensNetwork:1,plugins:[]}),n("optimism-goerli",420,{}),n("optimism-sepolia",11155420,{}),n("xdai",100,{ensNetwork:1})}function eC(n){return JSON.parse(JSON.stringify(n))}var wl,fo,zc,Ra,Zp,fA;class Rie{constructor(e){Be(this,Zp);Be(this,wl,void 0);Be(this,fo,void 0);Be(this,zc,void 0);Be(this,Ra,void 0);oe(this,wl,e),oe(this,fo,null),oe(this,zc,4e3),oe(this,Ra,-2)}get pollingInterval(){return N(this,zc)}set pollingInterval(e){oe(this,zc,e)}start(){N(this,fo)||(oe(this,fo,N(this,wl)._setTimeout(st(this,Zp,fA).bind(this),N(this,zc))),st(this,Zp,fA).call(this))}stop(){N(this,fo)&&(N(this,wl)._clearTimeout(N(this,fo)),oe(this,fo,null))}pause(e){this.stop(),e&&oe(this,Ra,-2)}resume(){this.start()}}wl=new WeakMap,fo=new WeakMap,zc=new WeakMap,Ra=new WeakMap,Zp=new WeakSet,fA=async function(){try{const e=await N(this,wl).getBlockNumber();if(N(this,Ra)===-2){oe(this,Ra,e);return}if(e!==N(this,Ra)){for(let t=N(this,Ra)+1;t<=e;t++){if(N(this,fo)==null)return;await N(this,wl).emit("block",t)}oe(this,Ra,e)}}catch{}N(this,fo)!=null&&oe(this,fo,N(this,wl)._setTimeout(st(this,Zp,fA).bind(this),N(this,zc)))};var Yf,Zf,Hc;class WR{constructor(e){Be(this,Yf,void 0);Be(this,Zf,void 0);Be(this,Hc,void 0);oe(this,Yf,e),oe(this,Hc,!1),oe(this,Zf,t=>{this._poll(t,N(this,Yf))})}async _poll(e,t){throw new Error("sub-classes must override this")}start(){N(this,Hc)||(oe(this,Hc,!0),N(this,Zf).call(this,-2),N(this,Yf).on("block",N(this,Zf)))}stop(){N(this,Hc)&&(oe(this,Hc,!1),N(this,Yf).off("block",N(this,Zf)))}pause(e){this.stop()}resume(){this.start()}}Yf=new WeakMap,Zf=new WeakMap,Hc=new WeakMap;var qp,El;class Bie extends WR{constructor(t,r){super(t);Be(this,qp,void 0);Be(this,El,void 0);oe(this,qp,r),oe(this,El,-2)}pause(t){t&&oe(this,El,-2),super.pause(t)}async _poll(t,r){const i=await r.getBlock(N(this,qp));i!=null&&(N(this,El)===-2?oe(this,El,i.number):i.number>N(this,El)&&(r.emit(N(this,qp),i.number),oe(this,El,i.number)))}}qp=new WeakMap,El=new WeakMap;var p_;class Pie extends WR{constructor(t,r){super(t);Be(this,p_,void 0);oe(this,p_,eC(r))}async _poll(t,r){throw new Error("@TODO")}}p_=new WeakMap;var $p;class Iie extends WR{constructor(t,r){super(t);Be(this,$p,void 0);oe(this,$p,r)}async _poll(t,r){const i=await r.getTransactionReceipt(N(this,$p));i&&r.emit(N(this,$p),i)}}$p=new WeakMap;var Sl,em,tm,Vc,ho,m_,lH;class XR{constructor(e,t){Be(this,m_);Be(this,Sl,void 0);Be(this,em,void 0);Be(this,tm,void 0);Be(this,Vc,void 0);Be(this,ho,void 0);oe(this,Sl,e),oe(this,em,eC(t)),oe(this,tm,st(this,m_,lH).bind(this)),oe(this,Vc,!1),oe(this,ho,-2)}start(){N(this,Vc)||(oe(this,Vc,!0),N(this,ho)===-2&&N(this,Sl).getBlockNumber().then(e=>{oe(this,ho,e)}),N(this,Sl).on("block",N(this,tm)))}stop(){N(this,Vc)&&(oe(this,Vc,!1),N(this,Sl).off("block",N(this,tm)))}pause(e){this.stop(),e&&oe(this,ho,-2)}resume(){this.start()}}Sl=new WeakMap,em=new WeakMap,tm=new WeakMap,Vc=new WeakMap,ho=new WeakMap,m_=new WeakSet,lH=async function(e){if(N(this,ho)===-2)return;const t=eC(N(this,em));t.fromBlock=N(this,ho)+1,t.toBlock=e;const r=await N(this,Sl).getLogs(t);if(r.length===0){N(this,ho)<e-60&&oe(this,ho,e-60);return}for(const i of r)N(this,Sl).emit(N(this,em),i),oe(this,ho,i.blockNumber)};const Lie=BigInt(2),Nie=10;function R1(n){return n&&typeof n.then=="function"}function hA(n,e){return n+":"+JSON.stringify(e,(t,r)=>{if(r==null)return"null";if(typeof r=="bigint")return`bigint:${r.toString()}`;if(typeof r=="string")return r.toLowerCase();if(typeof r=="object"&&!Array.isArray(r)){const i=Object.keys(r);return i.sort(),i.reduce((s,o)=>(s[o]=r[o],s),{})}return r})}class cH{constructor(e){Ee(this,"name");Ht(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function Die(n){return JSON.parse(JSON.stringify(n))}function tC(n){return n=Array.from(new Set(n).values()),n.sort(),n}async function xb(n,e){if(n==null)throw new Error("invalid event");if(Array.isArray(n)&&(n={topics:n}),typeof n=="string")switch(n){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:n,tag:n}}if(Xn(n,32)){const t=n.toLowerCase();return{type:"transaction",tag:hA("tx",{hash:t}),hash:t}}if(n.orphan){const t=n;return{type:"orphan",tag:hA("orphan",t),filter:Die(t)}}if(n.address||n.topics){const t=n,r={topics:(t.topics||[]).map(i=>i==null?null:Array.isArray(i)?tC(i.map(s=>s.toLowerCase())):i.toLowerCase())};if(t.address){const i=[],s=[],o=a=>{Xn(a)?i.push(a):s.push((async()=>{i.push(await ts(a,e))})())};Array.isArray(t.address)?t.address.forEach(o):o(t.address),s.length&&await Promise.all(s),r.address=tC(i.map(a=>a.toLowerCase()))}return{filter:r,tag:hA("event",r),type:"event"}}xe(!1,"unknown ProviderEvent","event",n)}function Ab(){return new Date().getTime()}const Uie={cacheTimeout:250,pollingInterval:4e3};var Pi,Wc,Ii,nm,Hs,qf,Xc,bl,Bv,po,rm,im,Qi,Fs,Pv,nC,Iv,rC,$f,i0,Lv,iC,eh,s0,sm,dA;class Fie{constructor(e,t){Be(this,Qi);Be(this,Pv);Be(this,Iv);Be(this,$f);Be(this,Lv);Be(this,eh);Be(this,sm);Be(this,Pi,void 0);Be(this,Wc,void 0);Be(this,Ii,void 0);Be(this,nm,void 0);Be(this,Hs,void 0);Be(this,qf,void 0);Be(this,Xc,void 0);Be(this,bl,void 0);Be(this,Bv,void 0);Be(this,po,void 0);Be(this,rm,void 0);Be(this,im,void 0);if(oe(this,im,Object.assign({},Uie,t||{})),e==="any")oe(this,qf,!0),oe(this,Hs,null);else if(e){const r=Ua.from(e);oe(this,qf,!1),oe(this,Hs,Promise.resolve(r)),setTimeout(()=>{this.emit("network",r,null)},0)}else oe(this,qf,!1),oe(this,Hs,null);oe(this,bl,-1),oe(this,Xc,new Map),oe(this,Pi,new Map),oe(this,Wc,new Map),oe(this,Ii,null),oe(this,nm,!1),oe(this,Bv,1),oe(this,po,new Map),oe(this,rm,!1)}get pollingInterval(){return N(this,im).pollingInterval}get provider(){return this}get plugins(){return Array.from(N(this,Wc).values())}attachPlugin(e){if(N(this,Wc).get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return N(this,Wc).set(e.name,e.connect(this)),this}getPlugin(e){return N(this,Wc).get(e)||null}get disableCcipRead(){return N(this,rm)}set disableCcipRead(e){oe(this,rm,!!e)}async ccipReadFetch(e,t,r){if(this.disableCcipRead||r.length===0||e.to==null)return null;const i=e.to.toLowerCase(),s=t.toLowerCase(),o=[];for(let a=0;a<r.length;a++){const l=r[a],c=l.replace("{sender}",i).replace("{data}",s),u=new Eu(c);l.indexOf("{data}")===-1&&(u.body={data:s,sender:i}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:u,index:a,urls:r});let f="unknown error",d;try{d=await u.send()}catch(m){o.push(m.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:{error:m}});continue}try{const m=d.bodyJson;if(m.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:u,result:m}),m.data;m.message&&(f=m.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:m})}catch{}qe(d.statusCode<400||d.statusCode>=500,`response not found during CCIP fetch: ${f}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:l,errorMessage:f}}),o.push(f)}qe(!1,`error encountered during CCIP fetch: ${o.map(a=>JSON.stringify(a)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:r,errorMessages:o}})}_wrapBlock(e,t){return new nie(_ie(e),this)}_wrapLog(e,t){return new ay(xie(e),this)}_wrapTransactionReceipt(e,t){return new Qz(bie(e),this)}_wrapTransactionResponse(e,t){return new dv(aH(e),this)}_detectNetwork(){qe(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){qe(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=Qt(await st(this,Qi,Fs).call(this,{method:"getBlockNumber"}),"%response");return N(this,bl)>=0&&oe(this,bl,e),e}_getAddress(e){return ts(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(Xn(e))return Xn(e,32)?e:Yo(e);if(typeof e=="bigint"&&(e=Qt(e,"blockTag")),typeof e=="number")return e>=0?Yo(e):N(this,bl)>=0?Yo(N(this,bl)+e):this.getBlockNumber().then(t=>Yo(t+e));xe(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const t=(e.topics||[]).map(l=>l==null?null:Array.isArray(l)?tC(l.map(c=>c.toLowerCase())):l.toLowerCase()),r="blockHash"in e?e.blockHash:void 0,i=(l,c,u)=>{let f;switch(l.length){case 0:break;case 1:f=l[0];break;default:l.sort(),f=l}if(r&&(c!=null||u!=null))throw new Error("invalid filter");const d={};return f&&(d.address=f),t.length&&(d.topics=t),c&&(d.fromBlock=c),u&&(d.toBlock=u),r&&(d.blockHash=r),d};let s=[];if(e.address)if(Array.isArray(e.address))for(const l of e.address)s.push(this._getAddress(l));else s.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let a;return"toBlock"in e&&(a=this._getBlockTag(e.toBlock)),s.filter(l=>typeof l!="string").length||o!=null&&typeof o!="string"||a!=null&&typeof a!="string"?Promise.all([Promise.all(s),o,a]).then(l=>i(l[0],l[1],l[2])):i(s,o,a)}_getTransactionRequest(e){const t=s_(e),r=[];if(["to","from"].forEach(i=>{if(t[i]==null)return;const s=ts(t[i],this);R1(s)?r.push(async function(){t[i]=await s}()):t[i]=s}),t.blockTag!=null){const i=this._getBlockTag(t.blockTag);R1(i)?r.push(async function(){t.blockTag=await i}()):t.blockTag=i}return r.length?async function(){return await Promise.all(r),t}():t}async getNetwork(){if(N(this,Hs)==null){const i=(async()=>{try{const s=await this._detectNetwork();return this.emit("network",s,null),s}catch(s){throw N(this,Hs)===i&&oe(this,Hs,null),s}})();return oe(this,Hs,i),(await i).clone()}const e=N(this,Hs),[t,r]=await Promise.all([e,this._detectNetwork()]);return t.chainId!==r.chainId&&(N(this,qf)?(this.emit("network",r,t),N(this,Hs)===e&&oe(this,Hs,Promise.resolve(r))):qe(!1,`network changed: ${t.chainId} => ${r.chainId} `,"NETWORK_ERROR",{event:"changed"})),t.clone()}async getFeeData(){const e=await this.getNetwork(),t=async()=>{const{_block:i,gasPrice:s,priorityFee:o}=await Zi({_block:st(this,Lv,iC).call(this,"latest",!1),gasPrice:(async()=>{try{const u=await st(this,Qi,Fs).call(this,{method:"getGasPrice"});return Mt(u,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const u=await st(this,Qi,Fs).call(this,{method:"getPriorityFee"});return Mt(u,"%response")}catch{}return null})()});let a=null,l=null;const c=this._wrapBlock(i,e);return c&&c.baseFeePerGas&&(l=o??BigInt("1000000000"),a=c.baseFeePerGas*Lie+l),new mD(s,a,l)},r=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(r){const i=new Eu(r.url),s=await r.processFunc(t,this,i);return new mD(s.gasPrice,s.maxFeePerGas,s.maxPriorityFeePerGas)}return await t()}async estimateGas(e){let t=this._getTransactionRequest(e);return R1(t)&&(t=await t),Mt(await st(this,Qi,Fs).call(this,{method:"estimateGas",transaction:t}),"%response")}async call(e){const{tx:t,blockTag:r}=await Zi({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await st(this,Iv,rC).call(this,st(this,Pv,nC).call(this,t,r,e.enableCcipRead?0:-1))}async getBalance(e,t){return Mt(await st(this,$f,i0).call(this,{method:"getBalance"},e,t),"%response")}async getTransactionCount(e,t){return Qt(await st(this,$f,i0).call(this,{method:"getTransactionCount"},e,t),"%response")}async getCode(e,t){return _t(await st(this,$f,i0).call(this,{method:"getCode"},e,t))}async getStorage(e,t,r){const i=Mt(t,"position");return _t(await st(this,$f,i0).call(this,{method:"getStorage",position:i},e,r))}async broadcastTransaction(e){const{blockNumber:t,hash:r,network:i}=await Zi({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),s=qA.from(e);if(s.hash!==r)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(s,i).replaceableTransaction(t)}async getBlock(e,t){const{network:r,params:i}=await Zi({network:this.getNetwork(),params:st(this,Lv,iC).call(this,e,!!t)});return i==null?null:this._wrapBlock(i,r)}async getTransaction(e){const{network:t,params:r}=await Zi({network:this.getNetwork(),params:st(this,Qi,Fs).call(this,{method:"getTransaction",hash:e})});return r==null?null:this._wrapTransactionResponse(r,t)}async getTransactionReceipt(e){const{network:t,params:r}=await Zi({network:this.getNetwork(),params:st(this,Qi,Fs).call(this,{method:"getTransactionReceipt",hash:e})});if(r==null)return null;if(r.gasPrice==null&&r.effectiveGasPrice==null){const i=await st(this,Qi,Fs).call(this,{method:"getTransaction",hash:e});if(i==null)throw new Error("report this; could not find tx or effectiveGasPrice");r.effectiveGasPrice=i.gasPrice}return this._wrapTransactionReceipt(r,t)}async getTransactionResult(e){const{result:t}=await Zi({network:this.getNetwork(),result:st(this,Qi,Fs).call(this,{method:"getTransactionResult",hash:e})});return t==null?null:_t(t)}async getLogs(e){let t=this._getFilter(e);R1(t)&&(t=await t);const{network:r,params:i}=await Zi({network:this.getNetwork(),params:st(this,Qi,Fs).call(this,{method:"getLogs",filter:t})});return i.map(s=>this._wrapLog(s,r))}_getProvider(e){qe(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await a_.fromName(this,e)}async getAvatar(e){const t=await this.getResolver(e);return t?await t.getAvatar():null}async resolveName(e){const t=await this.getResolver(e);return t?await t.getAddress():null}async lookupAddress(e){e=Bn(e);const t=QT(e.substring(2).toLowerCase()+".addr.reverse");try{const r=await a_.getEnsAddress(this),s=await new fu(r,["function resolver(bytes32) view returns (address)"],this).resolver(t);if(s==null||s===sv)return null;const a=await new fu(s,["function name(bytes32) view returns (string)"],this).name(t);return await this.resolveName(a)!==e?null:a}catch(r){if(pi(r,"BAD_DATA")&&r.value==="0x"||pi(r,"CALL_EXCEPTION"))return null;throw r}return null}async waitForTransaction(e,t,r){const i=t??1;return i===0?this.getTransactionReceipt(e):new Promise(async(s,o)=>{let a=null;const l=async c=>{try{const u=await this.getTransactionReceipt(e);if(u!=null&&c-u.blockNumber+1>=i){s(u),a&&(clearTimeout(a),a=null);return}}catch(u){console.log("EEE",u)}this.once("block",l)};r!=null&&(a=setTimeout(()=>{a!=null&&(a=null,this.off("block",l),o(qn("timeout","TIMEOUT",{reason:"timeout"})))},r)),l(await this.getBlockNumber())})}async waitForBlock(e){qe(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const t=N(this,po).get(e);t&&(t.timer&&clearTimeout(t.timer),N(this,po).delete(e))}_setTimeout(e,t){t==null&&(t=0);const r=pg(this,Bv)._++,i=()=>{N(this,po).delete(r),e()};if(this.paused)N(this,po).set(r,{timer:null,func:i,time:t});else{const s=setTimeout(i,t);N(this,po).set(r,{timer:s,func:i,time:Ab()})}return r}_forEachSubscriber(e){for(const t of N(this,Pi).values())e(t.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new cH(e.type);case"block":{const t=new Rie(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new Bie(this,e.type);case"event":return new XR(this,e.filter);case"transaction":return new Iie(this,e.hash);case"orphan":return new Pie(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,t){for(const r of N(this,Pi).values())if(r.subscriber===e){r.started&&r.subscriber.stop(),r.subscriber=t,r.started&&t.start(),N(this,Ii)!=null&&t.pause(N(this,Ii));break}}async on(e,t){const r=await st(this,sm,dA).call(this,e);return r.listeners.push({listener:t,once:!1}),r.started||(r.subscriber.start(),r.started=!0,N(this,Ii)!=null&&r.subscriber.pause(N(this,Ii))),this}async once(e,t){const r=await st(this,sm,dA).call(this,e);return r.listeners.push({listener:t,once:!0}),r.started||(r.subscriber.start(),r.started=!0,N(this,Ii)!=null&&r.subscriber.pause(N(this,Ii))),this}async emit(e,...t){const r=await st(this,eh,s0).call(this,e,t);if(!r||r.listeners.length===0)return!1;const i=r.listeners.length;return r.listeners=r.listeners.filter(({listener:s,once:o})=>{const a=new _G(this,o?null:s,e);try{s.call(this,...t,a)}catch{}return!o}),r.listeners.length===0&&(r.started&&r.subscriber.stop(),N(this,Pi).delete(r.tag)),i>0}async listenerCount(e){if(e){const r=await st(this,eh,s0).call(this,e);return r?r.listeners.length:0}let t=0;for(const{listeners:r}of N(this,Pi).values())t+=r.length;return t}async listeners(e){if(e){const r=await st(this,eh,s0).call(this,e);return r?r.listeners.map(({listener:i})=>i):[]}let t=[];for(const{listeners:r}of N(this,Pi).values())t=t.concat(r.map(({listener:i})=>i));return t}async off(e,t){const r=await st(this,eh,s0).call(this,e);if(!r)return this;if(t){const i=r.listeners.map(({listener:s})=>s).indexOf(t);i>=0&&r.listeners.splice(i,1)}return(!t||r.listeners.length===0)&&(r.started&&r.subscriber.stop(),N(this,Pi).delete(r.tag)),this}async removeAllListeners(e){if(e){const{tag:t,started:r,subscriber:i}=await st(this,sm,dA).call(this,e);r&&i.stop(),N(this,Pi).delete(t)}else for(const[t,{started:r,subscriber:i}]of N(this,Pi))r&&i.stop(),N(this,Pi).delete(t);return this}async addListener(e,t){return await this.on(e,t)}async removeListener(e,t){return this.off(e,t)}get destroyed(){return N(this,nm)}destroy(){this.removeAllListeners();for(const e of N(this,po).keys())this._clearTimeout(e);oe(this,nm,!0)}get paused(){return N(this,Ii)!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(oe(this,bl,-1),N(this,Ii)!=null){if(N(this,Ii)==!!e)return;qe(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(t=>t.pause(e)),oe(this,Ii,!!e);for(const t of N(this,po).values())t.timer&&clearTimeout(t.timer),t.time=Ab()-t.time}resume(){if(N(this,Ii)!=null){this._forEachSubscriber(e=>e.resume()),oe(this,Ii,null);for(const e of N(this,po).values()){let t=e.time;t<0&&(t=0),e.time=Ab(),setTimeout(e.func,t)}}}}Pi=new WeakMap,Wc=new WeakMap,Ii=new WeakMap,nm=new WeakMap,Hs=new WeakMap,qf=new WeakMap,Xc=new WeakMap,bl=new WeakMap,Bv=new WeakMap,po=new WeakMap,rm=new WeakMap,im=new WeakMap,Qi=new WeakSet,Fs=async function(e){const t=N(this,im).cacheTimeout;if(t<0)return await this._perform(e);const r=hA(e.method,e);let i=N(this,Xc).get(r);return i||(i=this._perform(e),N(this,Xc).set(r,i),setTimeout(()=>{N(this,Xc).get(r)===i&&N(this,Xc).delete(r)},t)),await i},Pv=new WeakSet,nC=async function(e,t,r){qe(r<Nie,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:t,enableCcipRead:!0})});const i=s_(e);try{return _t(await this._perform({method:"call",transaction:i,blockTag:t}))}catch(s){if(!this.disableCcipRead&&TR(s)&&s.data&&r>=0&&t==="latest"&&i.to!=null&&gr(s.data,0,4)==="0x556f1830"){const o=s.data,a=await ts(i.to,this);let l;try{l=Hie(gr(s.data,4))}catch(f){qe(!1,f.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:i,info:{data:o}})}qe(l.sender.toLowerCase()===a.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:i,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:l.errorArgs}});const c=await this.ccipReadFetch(i,l.calldata,l.urls);qe(c!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:i,info:{data:s.data,errorArgs:l.errorArgs}});const u={to:a,data:tr([l.selector,zie([c,l.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:u});try{const f=await st(this,Pv,nC).call(this,u,t,r+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},u),result:f}),f}catch(f){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},u),error:f}),f}}throw s}},Iv=new WeakSet,rC=async function(e){const{value:t}=await Zi({network:this.getNetwork(),value:e});return t},$f=new WeakSet,i0=async function(e,t,r){let i=this._getAddress(t),s=this._getBlockTag(r);return(typeof i!="string"||typeof s!="string")&&([i,s]=await Promise.all([i,s])),await st(this,Iv,rC).call(this,st(this,Qi,Fs).call(this,Object.assign(e,{address:i,blockTag:s})))},Lv=new WeakSet,iC=async function(e,t){if(Xn(e,32))return await st(this,Qi,Fs).call(this,{method:"getBlock",blockHash:e,includeTransactions:t});let r=this._getBlockTag(e);return typeof r!="string"&&(r=await r),await st(this,Qi,Fs).call(this,{method:"getBlock",blockTag:r,includeTransactions:t})},eh=new WeakSet,s0=async function(e,t){let r=await xb(e,this);return r.type==="event"&&t&&t.length>0&&t[0].removed===!0&&(r=await xb({orphan:"drop-log",log:t[0]},this)),N(this,Pi).get(r.tag)||null},sm=new WeakSet,dA=async function(e){const t=await xb(e,this),r=t.tag;let i=N(this,Pi).get(r);return i||(i={subscriber:this._getSubscriber(t),tag:r,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},N(this,Pi).set(r,i)),i};function Oie(n,e){try{const t=sC(n,e);if(t)return jA(t)}catch{}return null}function sC(n,e){if(n==="0x")return null;try{const t=Qt(gr(n,e,e+32)),r=Qt(gr(n,t,t+32));return gr(n,t+32,t+32+r)}catch{}return null}function ED(n){const e=kr(n);if(e.length>32)throw new Error("internal; should not happen");const t=new Uint8Array(32);return t.set(e,32-e.length),t}function kie(n){if(n.length%32===0)return n;const e=new Uint8Array(Math.ceil(n.length/32)*32);return e.set(n),e}const Gie=new Uint8Array([]);function zie(n){const e=[];let t=0;for(let r=0;r<n.length;r++)e.push(Gie),t+=32;for(let r=0;r<n.length;r++){const i=an(n[r]);e[r]=ED(t),e.push(ED(i.length)),e.push(kie(i)),t+=32+Math.ceil(i.length/32)*32}return tr(e)}const SD="0x0000000000000000000000000000000000000000000000000000000000000000";function Hie(n){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};qe(gp(n)>=5*32,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const t=gr(n,0,32);qe(gr(t,0,12)===gr(SD,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=gr(t,12);try{const r=[],i=Qt(gr(n,32,64)),s=Qt(gr(n,i,i+32)),o=gr(n,i+32);for(let a=0;a<s;a++){const l=Oie(o,a*32);if(l==null)throw new Error("abort");r.push(l)}e.urls=r}catch{qe(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const r=sC(n,64);if(r==null)throw new Error("abort");e.calldata=r}catch{qe(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}qe(gr(n,100,128)===gr(SD,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=gr(n,96,100);try{const r=sC(n,128);if(r==null)throw new Error("abort");e.extraData=r}catch{qe(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(r=>e[r]),e}function lf(n,e){if(n.provider)return n.provider;qe(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function bD(n,e){let t=s_(e);if(t.to!=null&&(t.to=ts(t.to,n)),t.from!=null){const r=t.from;t.from=Promise.all([n.getAddress(),ts(r,n)]).then(([i,s])=>(xe(i.toLowerCase()===s.toLowerCase(),"transaction from mismatch","tx.from",s),i))}else t.from=n.getAddress();return await Zi(t)}class Vie{constructor(e){Ee(this,"provider");Ht(this,{provider:e||null})}async getNonce(e){return lf(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await bD(this,e)}async populateTransaction(e){const t=lf(this,"populateTransaction"),r=await bD(this,e);r.nonce==null&&(r.nonce=await this.getNonce("pending")),r.gasLimit==null&&(r.gasLimit=await this.estimateGas(r));const i=await this.provider.getNetwork();if(r.chainId!=null){const o=Mt(r.chainId);xe(o===i.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else r.chainId=i.chainId;const s=r.maxFeePerGas!=null||r.maxPriorityFeePerGas!=null;if(r.gasPrice!=null&&(r.type===2||s)?xe(!1,"eip-1559 transaction do not support gasPrice","tx",e):(r.type===0||r.type===1)&&s&&xe(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(r.type===2||r.type==null)&&r.maxFeePerGas!=null&&r.maxPriorityFeePerGas!=null)r.type=2;else if(r.type===0||r.type===1){const o=await t.getFeeData();qe(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice)}else{const o=await t.getFeeData();if(r.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(r.authorizationList&&r.authorizationList.length?r.type=4:r.type=2,r.gasPrice!=null){const a=r.gasPrice;delete r.gasPrice,r.maxFeePerGas=a,r.maxPriorityFeePerGas=a}else r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(qe(!s,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),r.gasPrice==null&&(r.gasPrice=o.gasPrice),r.type=0):qe(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(r.type===2||r.type===3||r.type===4)&&(r.maxFeePerGas==null&&(r.maxFeePerGas=o.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await Zi(r)}async populateAuthorization(e){const t=Object.assign({},e);return t.chainId==null&&(t.chainId=(await lf(this,"getNetwork").getNetwork()).chainId),t.nonce==null&&(t.nonce=await this.getNonce()),t}async estimateGas(e){return lf(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return lf(this,"call").call(await this.populateCall(e))}async resolveName(e){return await lf(this,"resolveName").resolveName(e)}async sendTransaction(e){const t=lf(this,"sendTransaction"),r=await this.populateTransaction(e);delete r.from;const i=qA.from(r);return await t.broadcastTransaction(await this.signTransaction(i))}authorize(e){qe(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}function Wie(n){return JSON.parse(JSON.stringify(n))}var ji,Ba,th,Jc,nh,om,Nv,oC,Dv,aC;class uH{constructor(e){Be(this,Nv);Be(this,Dv);Be(this,ji,void 0);Be(this,Ba,void 0);Be(this,th,void 0);Be(this,Jc,void 0);Be(this,nh,void 0);Be(this,om,void 0);oe(this,ji,e),oe(this,Ba,null),oe(this,th,st(this,Nv,oC).bind(this)),oe(this,Jc,!1),oe(this,nh,null),oe(this,om,!1)}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,t){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}start(){N(this,Jc)||(oe(this,Jc,!0),st(this,Nv,oC).call(this,-2))}stop(){N(this,Jc)&&(oe(this,Jc,!1),oe(this,om,!0),st(this,Dv,aC).call(this),N(this,ji).off("block",N(this,th)))}pause(e){e&&st(this,Dv,aC).call(this),N(this,ji).off("block",N(this,th))}resume(){this.start()}}ji=new WeakMap,Ba=new WeakMap,th=new WeakMap,Jc=new WeakMap,nh=new WeakMap,om=new WeakMap,Nv=new WeakSet,oC=async function(e){try{N(this,Ba)==null&&oe(this,Ba,this._subscribe(N(this,ji)));let t=null;try{t=await N(this,Ba)}catch(s){if(!pi(s,"UNSUPPORTED_OPERATION")||s.operation!=="eth_newFilter")throw s}if(t==null){oe(this,Ba,null),N(this,ji)._recoverSubscriber(this,this._recover(N(this,ji)));return}const r=await N(this,ji).getNetwork();if(N(this,nh)||oe(this,nh,r),N(this,nh).chainId!==r.chainId)throw new Error("chaid changed");if(N(this,om))return;const i=await N(this,ji).send("eth_getFilterChanges",[t]);await this._emitResults(N(this,ji),i)}catch(t){console.log("@TODO",t)}N(this,ji).once("block",N(this,th))},Dv=new WeakSet,aC=function(){const e=N(this,Ba);e&&(oe(this,Ba,null),e.then(t=>{N(this,ji).destroyed||N(this,ji).send("eth_uninstallFilter",[t])}))};var rh;class Xie extends uH{constructor(t,r){super(t);Be(this,rh,void 0);oe(this,rh,Wie(r))}_recover(t){return new XR(t,N(this,rh))}async _subscribe(t){return await t.send("eth_newFilter",[N(this,rh)])}async _emitResults(t,r){for(const i of r)t.emit(N(this,rh),t._wrapLog(i,t._network))}}rh=new WeakMap;class Jie extends uH{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,t){for(const r of t)e.emit("pending",r)}}const Kie="bigint,boolean,function,number,string,symbol".split(/,/g);function pA(n){if(n==null||Kie.indexOf(typeof n)>=0||typeof n.getAddress=="function")return n;if(Array.isArray(n))return n.map(pA);if(typeof n=="object")return Object.keys(n).reduce((e,t)=>(e[t]=n[t],e),{});throw new Error(`should not happen: ${n} (${typeof n})`)}function Qie(n){return new Promise(e=>{setTimeout(e,n)})}function Sd(n){return n&&n.toLowerCase()}function MD(n){return n&&typeof n.pollingInterval=="number"}const fH={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class _b extends Vie{constructor(t,r){super(t);Ee(this,"address");r=Bn(r),Ht(this,{address:r})}connect(t){qe(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const r=pA(t),i=[];if(r.from){const o=r.from;i.push((async()=>{const a=await ts(o,this.provider);xe(a!=null&&a.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),r.from=a})())}else r.from=this.address;if(r.gasLimit==null&&i.push((async()=>{r.gasLimit=await this.provider.estimateGas({...r,from:this.address})})()),r.to!=null){const o=r.to;i.push((async()=>{r.to=await ts(o,this.provider)})())}i.length&&await Promise.all(i);const s=this.provider.getRpcTransaction(r);return this.provider.send("eth_sendTransaction",[s])}async sendTransaction(t){const r=await this.provider.getBlockNumber(),i=await this.sendUncheckedTransaction(t);return await new Promise((s,o)=>{const a=[1e3,100];let l=0;const c=async()=>{try{const u=await this.provider.getTransaction(i);if(u!=null){s(u.replaceableTransaction(r));return}}catch(u){if(pi(u,"CANCELLED")||pi(u,"BAD_DATA")||pi(u,"NETWORK_ERROR")||pi(u,"UNSUPPORTED_OPERATION")){u.info==null&&(u.info={}),u.info.sendTransactionHash=i,o(u);return}if(pi(u,"INVALID_ARGUMENT")&&(l++,u.info==null&&(u.info={}),u.info.sendTransactionHash=i,l>10)){o(u);return}this.provider.emit("error",qn("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:u}))}this.provider._setTimeout(()=>{c()},a.pop()||4e3)};c()})}async signTransaction(t){const r=pA(t);if(r.from){const s=await ts(r.from,this.provider);xe(s!=null&&s.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),r.from=s}else r.from=this.address;const i=this.provider.getRpcTransaction(r);return await this.provider.send("eth_signTransaction",[i])}async signMessage(t){const r=typeof t=="string"?Ga(t):t;return await this.provider.send("personal_sign",[_t(r),this.address.toLowerCase()])}async signTypedData(t,r,i){const s=pA(i),o=await i_.resolveNames(t,r,s,async a=>{const l=await ts(a);return xe(l!=null,"TypedData does not support null address","value",a),l});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(i_.getPayload(o.domain,r,o.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const r=typeof t=="string"?Ga(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),_t(r)])}}var ih,am,Ml,Pa,Xo,mo,ps,Uv,lC;class jie extends Fie{constructor(t,r){super(t,r);Be(this,Uv);Be(this,ih,void 0);Be(this,am,void 0);Be(this,Ml,void 0);Be(this,Pa,void 0);Be(this,Xo,void 0);Be(this,mo,void 0);Be(this,ps,void 0);oe(this,am,1),oe(this,ih,Object.assign({},fH,r||{})),oe(this,Ml,[]),oe(this,Pa,null),oe(this,mo,null),oe(this,ps,null);{let s=null;const o=new Promise(a=>{s=a});oe(this,Xo,{promise:o,resolve:s})}const i=this._getOption("staticNetwork");typeof i=="boolean"?(xe(!i||t!=="any","staticNetwork cannot be used on special network 'any'","options",r),i&&t!=null&&oe(this,mo,Ua.from(t))):i&&(xe(t==null||i.matches(t),"staticNetwork MUST match network object","options",r),oe(this,mo,i))}_getOption(t){return N(this,ih)[t]}get _network(){return qe(N(this,mo),"network is not available yet","NETWORK_ERROR"),N(this,mo)}async _perform(t){if(t.method==="call"||t.method==="estimateGas"){let i=t.transaction;if(i&&i.type!=null&&Mt(i.type)&&i.maxFeePerGas==null&&i.maxPriorityFeePerGas==null){const s=await this.getFeeData();s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null&&(t=Object.assign({},t,{transaction:Object.assign({},i,{type:void 0})}))}}const r=this.getRpcRequest(t);return r!=null?await this.send(r.method,r.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t)if(t===!0){if(N(this,mo))return N(this,mo)}else return t;return N(this,ps)?await N(this,ps):this.ready?(oe(this,ps,(async()=>{try{const r=Ua.from(Mt(await this.send("eth_chainId",[])));return oe(this,ps,null),r}catch(r){throw oe(this,ps,null),r}})()),await N(this,ps)):(oe(this,ps,(async()=>{const r={id:pg(this,am)._++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:r});let i;try{i=(await this._send(r))[0],oe(this,ps,null)}catch(s){throw oe(this,ps,null),this.emit("debug",{action:"receiveRpcError",error:s}),s}if(this.emit("debug",{action:"receiveRpcResult",result:i}),"result"in i)return Ua.from(Mt(i.result));throw this.getRpcError(r,i)})()),await N(this,ps))}_start(){N(this,Xo)==null||N(this,Xo).resolve==null||(N(this,Xo).resolve(),oe(this,Xo,null),(async()=>{for(;N(this,mo)==null&&!this.destroyed;)try{oe(this,mo,await this._detectNetwork())}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",qn("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await Qie(1e3)}st(this,Uv,lC).call(this)})())}async _waitUntilReady(){if(N(this,Xo)!=null)return await N(this,Xo).promise}_getSubscriber(t){return t.type==="pending"?new Jie(this):t.type==="event"?this._getOption("polling")?new XR(this,t.filter):new Xie(this,t.filter):t.type==="orphan"&&t.filter.orphan==="drop-log"?new cH("orphan"):super._getSubscriber(t)}get ready(){return N(this,Xo)==null}getRpcTransaction(t){const r={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(i=>{if(t[i]==null)return;let s=i;i==="gasLimit"&&(s="gas"),r[s]=Yo(Mt(t[i],`tx.${i}`))}),["from","to","data"].forEach(i=>{t[i]!=null&&(r[i]=_t(t[i]))}),t.accessList&&(r.accessList=Fh(t.accessList)),t.blobVersionedHashes&&(r.blobVersionedHashes=t.blobVersionedHashes.map(i=>i.toLowerCase())),t.authorizationList&&(r.authorizationList=t.authorizationList.map(i=>{const s=dz(i);return{address:s.address,nonce:Yo(s.nonce),chainId:Yo(s.chainId),yParity:Yo(s.signature.yParity),r:Yo(s.signature.r),s:Yo(s.signature.s)}})),r}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[Sd(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[Sd(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[Sd(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[Sd(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&t.filter.address!=null&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(Sd):t.filter.address=Sd(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,r){const{method:i}=t,{error:s}=r;if(i==="eth_estimateGas"&&s.message){const l=s.message;if(!l.match(/revert/i)&&l.match(/insufficient funds/i))return qn("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:s}});if(l.match(/nonce/i)&&l.match(/too low/i))return qn("nonce has already been used","NONCE_EXPIRED",{transaction:t.params[0],info:{payload:t,error:s}})}if(i==="eth_call"||i==="eth_estimateGas"){const l=cC(s),c=hv.getBuiltinCallException(i==="eth_call"?"call":"estimateGas",t.params[0],l?l.data:null);return c.info={error:s,payload:t},c}const o=JSON.stringify(Zie(s));if(typeof s.message=="string"&&s.message.match(/user denied|ethers-user-denied/i))return qn("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[i]||"unknown",reason:"rejected",info:{payload:t,error:s}});if(i==="eth_sendRawTransaction"||i==="eth_sendTransaction"){const l=t.params[0];if(o.match(/insufficient funds|base fee exceeds gas limit/i))return qn("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:l,info:{error:s}});if(o.match(/nonce/i)&&o.match(/too low/i))return qn("nonce has already been used","NONCE_EXPIRED",{transaction:l,info:{error:s}});if(o.match(/replacement transaction/i)&&o.match(/underpriced/i))return qn("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:l,info:{error:s}});if(o.match(/only replay-protected/i))return qn("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:i,info:{transaction:l,info:{error:s}}})}let a=!!o.match(/the method .* does not exist/i);return a||s&&s.details&&s.details.startsWith("Unauthorized method:")&&(a=!0),a?qn("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:s,payload:t}}):qn("could not coalesce error","UNKNOWN_ERROR",{error:s,payload:t})}send(t,r){if(this.destroyed)return Promise.reject(qn("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const i=pg(this,am)._++,s=new Promise((o,a)=>{N(this,Ml).push({resolve:o,reject:a,payload:{method:t,params:r,id:i,jsonrpc:"2.0"}})});return st(this,Uv,lC).call(this),s}async getSigner(t){t==null&&(t=0);const r=this.send("eth_accounts",[]);if(typeof t=="number"){const s=await r;if(t>=s.length)throw new Error("no such account");return new _b(this,s[t])}const{accounts:i}=await Zi({network:this.getNetwork(),accounts:r});t=Bn(t);for(const s of i)if(Bn(s)===t)return new _b(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(r=>new _b(this,r))}destroy(){N(this,Pa)&&(clearTimeout(N(this,Pa)),oe(this,Pa,null));for(const{payload:t,reject:r}of N(this,Ml))r(qn("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));oe(this,Ml,[]),super.destroy()}}ih=new WeakMap,am=new WeakMap,Ml=new WeakMap,Pa=new WeakMap,Xo=new WeakMap,mo=new WeakMap,ps=new WeakMap,Uv=new WeakSet,lC=function(){if(N(this,Pa))return;const t=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");oe(this,Pa,setTimeout(()=>{oe(this,Pa,null);const r=N(this,Ml);for(oe(this,Ml,[]);r.length;){const i=[r.shift()];for(;r.length&&i.length!==N(this,ih).batchMaxCount;)if(i.push(r.shift()),JSON.stringify(i.map(o=>o.payload)).length>N(this,ih).batchMaxSize){r.unshift(i.pop());break}(async()=>{const s=i.length===1?i[0].payload:i.map(o=>o.payload);this.emit("debug",{action:"sendRpcPayload",payload:s});try{const o=await this._send(s);this.emit("debug",{action:"receiveRpcResult",result:o});for(const{resolve:a,reject:l,payload:c}of i){if(this.destroyed){l(qn("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:c.method}));continue}const u=o.filter(f=>f.id===c.id)[0];if(u==null){const f=qn("missing response for request","BAD_DATA",{value:o,info:{payload:c}});this.emit("error",f),l(f);continue}if("error"in u){l(this.getRpcError(c,u));continue}a(u.result)}}catch(o){this.emit("debug",{action:"receiveRpcError",error:o});for(const{reject:a}of i)a(o)}})()}},t))};var Kc;class Yie extends jie{constructor(t,r){super(t,r);Be(this,Kc,void 0);let i=this._getOption("pollingInterval");i==null&&(i=fH.pollingInterval),oe(this,Kc,i)}_getSubscriber(t){const r=super._getSubscriber(t);return MD(r)&&(r.pollingInterval=N(this,Kc)),r}get pollingInterval(){return N(this,Kc)}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");oe(this,Kc,t),this._forEachSubscriber(r=>{MD(r)&&(r.pollingInterval=N(this,Kc))})}}Kc=new WeakMap;function cC(n){if(n==null)return null;if(typeof n.message=="string"&&n.message.match(/revert/i)&&Xn(n.data))return{message:n.message,data:n.data};if(typeof n=="object"){for(const e in n){const t=cC(n[e]);if(t)return t}return null}if(typeof n=="string")try{return cC(JSON.parse(n))}catch{}return null}function uC(n,e){if(n!=null){if(typeof n.message=="string"&&e.push(n.message),typeof n=="object")for(const t in n)uC(n[t],e);if(typeof n=="string")try{return uC(JSON.parse(n),e)}catch{}}}function Zie(n){const e=[];return uC(n,e),e}var lm,cm;const Ef=class Ef extends Yie{constructor(t,r,i){const s=Object.assign({},i??{},{batchMaxCount:1});xe(t&&t.request,"invalid EIP-1193 provider","ethereum",t);super(r,s);Be(this,lm,void 0);Be(this,cm,void 0);oe(this,cm,null),i&&i.providerInfo&&oe(this,cm,i.providerInfo),oe(this,lm,async(o,a)=>{const l={method:o,params:a};this.emit("debug",{action:"sendEip1193Request",payload:l});try{const c=await t.request(l);return this.emit("debug",{action:"receiveEip1193Result",result:c}),c}catch(c){const u=new Error(c.message);throw u.code=c.code,u.data=c.data,u.payload=l,this.emit("debug",{action:"receiveEip1193Error",error:u}),u}})}get providerInfo(){return N(this,cm)}async send(t,r){return await this._start(),await super.send(t,r)}async _send(t){xe(!Array.isArray(t),"EIP-1193 does not support batch request","payload",t);try{const r=await N(this,lm).call(this,t.method,t.params||[]);return[{id:t.id,result:r}]}catch(r){return[{id:t.id,error:{code:r.code,data:r.data,message:r.message}}]}}getRpcError(t,r){switch(r=JSON.parse(JSON.stringify(r)),r.error.code||-1){case 4001:r.error.message=`ethers-user-denied: ${r.error.message}`;break;case 4200:r.error.message=`ethers-unsupported: ${r.error.message}`;break}return super.getRpcError(t,r)}async hasSigner(t){t==null&&(t=0);const r=await this.send("eth_accounts",[]);return typeof t=="number"?r.length>t:(t=t.toLowerCase(),r.filter(i=>i.toLowerCase()===t).length!==0)}async getSigner(t){if(t==null&&(t=0),!await this.hasSigner(t))try{await N(this,lm).call(this,"eth_requestAccounts",[])}catch(r){const i=r.payload;throw this.getRpcError(i,{id:i.id,error:r})}return await super.getSigner(t)}static async discover(t){if(t==null&&(t={}),t.provider)return new Ef(t.provider);const r=t.window?t.window:typeof window<"u"?window:null;if(r==null)return null;const i=t.anyProvider;if(i&&r.ethereum)return new Ef(r.ethereum);if(!("addEventListener"in r&&"dispatchEvent"in r&&"removeEventListener"in r))return null;const s=t.timeout?t.timeout:300;return s===0?null:await new Promise((o,a)=>{let l=[];const c=d=>{l.push(d.detail),i&&u()},u=()=>{if(clearTimeout(f),l.length)if(t&&t.filter){const d=t.filter(l.map(m=>Object.assign({},m.info)));if(d==null)o(null);else if(d instanceof Ef)o(d);else{let m=null;if(d.uuid&&(m=l.filter(y=>d.uuid===y.info.uuid)[0]),m){const{provider:g,info:y}=m;o(new Ef(g,void 0,{providerInfo:y}))}else a(qn("filter returned unknown info","UNSUPPORTED_OPERATION",{value:d}))}}else{const{provider:d,info:m}=l[0];o(new Ef(d,void 0,{providerInfo:m}))}else o(null);r.removeEventListener("eip6963:announceProvider",c)},f=setTimeout(()=>{u()},s);r.addEventListener("eip6963:announceProvider",c),r.dispatchEvent(new Event("eip6963:requestProvider"))})}};lm=new WeakMap,cm=new WeakMap;let fC=Ef;const qie=[{id:"market",label:"BETS"},{id:"token",label:"TOKEN"}],$ie=[{id:"agents",label:"Place Bet"},{id:"mybets",label:"My Bets"},{id:"leaders",label:"Leaderboard"},{id:"results",label:"Results"}],wb="0x26813a9B80f43f98cee9045B9f7CdcA816C57777",ese="0x2681...777",TD={chainId:"0x8f",chainName:"Monad",rpcUrls:["https://rpc.monad.xyz"],nativeCurrency:{name:"MON",symbol:"MON",decimals:18},blockExplorerUrls:["https://monadvision.com"]},_c={MON:{symbol:"MON"},MCLAW:{symbol:"MClawIO"}},B1=["#d946ef","#22d3ee","#facc15","#a3e635","#f97316","#ef4444","#8b5cf6","#ec4899","#14b8a6","#f59e0b"];function cf(n){return n?n.slice(0,6)+"..."+n.slice(-4):""}function bd(n){try{const e=BigInt(n),t=e/1000000000000000000n,i=(e%1000000000000000000n).toString().padStart(18,"0").slice(0,4);return i.replace(/0+$/,"")?`${t}.${i.replace(/0+$/,"")}`:t.toString()}catch{return"0"}}function tse({toasts:n,onDismiss:e}){return Me("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2 max-w-sm pointer-events-none",children:n.map(t=>Me("div",{onClick:()=>e(t.id),className:`pointer-events-auto border-2 shadow-[3px_3px_0_black] px-4 py-3 flex items-start gap-2 cursor-pointer transition-opacity ${t.type==="success"?"bg-[#a3e635] text-black border-white":t.type==="error"?"bg-red-500 text-white border-white":t.type==="gold"?"bg-[#facc15] text-black border-white":t.type==="neutral"?"bg-slate-700 text-white border-slate-500":"bg-[#22d3ee] text-black border-white"}`,children:Me("span",{className:"text-xs font-bold flex-1",children:t.message})},t.id))})}function nse(){var et,Re,J,F;const{bettingStatus:n,setBettingStatus:e,currentMatchId:t,lastBetToast:r,bettingResolved:i,winningsDistributed:s,socketRef:o,matchStatus:a}=Uh(),[l,c]=te.useState("market"),[u,f]=te.useState("agents"),[d,m]=te.useState("MON"),[g,y]=te.useState(null),[x,v]=te.useState(null),A=te.useRef(null),w=te.useRef(null),S=te.useRef(null),[M,b]=te.useState(""),[R,P]=te.useState({}),[C,B]=te.useState(null),[H,k]=te.useState(null),[$,U]=te.useState(null),[z,O]=te.useState([]),ie=te.useRef(0),X=te.useCallback((G,de="info")=>{const le=ie.current++;O(ye=>[...ye.slice(-2),{id:le,message:G,type:de}]),setTimeout(()=>{O(ye=>ye.filter(Le=>Le.id!==le))},5e3)},[]),K=te.useCallback(G=>{O(de=>de.filter(le=>le.id!==G))},[]);te.useEffect(()=>{if(!r||g&&r.bettorAddress===g.toLowerCase())return;const G=r.bettorName||cf(r.bettorAddress),de=_c[r.token||"MON"]||_c.MON;X(`${G} bet ${r.amountMON} ${de.symbol} on ${r.agentName}`,"neutral")},[r,g,X]),te.useEffect(()=>{if(!i)return;const G=i.totalPoolMON||"0",de=[];parseFloat(G)>0&&de.push(`${G} MON`);const le=de.length?de.join(", "):"0",ye=i.isDraw?`Draw! ${i.winners.join(" & ")} tied. Pool: ${le}`:`${i.winners[0]} wins! Pool: ${le}`;X(ye,"success")},[i,X]),te.useEffect(()=>{if(s&&g&&s.bettorAddress===g.toLowerCase()){const G=_c[s.token||"MON"]||_c.MON;X(`You won ${s.payoutMON} ${G.symbol}! Auto-sent to your wallet.`,"success"),ne()}},[s,g,X]),te.useEffect(()=>{t&&W(t)},[t,d]);async function W(G){try{const le=await(await fetch(`/api/betting/status/${G}?token=${encodeURIComponent(d)}`)).json();e(le)}catch(de){console.error("Failed to fetch betting status:",de)}}async function V(){if(w.current&&S.current)return!0;if(!window.ethereum)return!1;try{try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:TD.chainId}]})}catch(ye){ye.code===4902&&await window.ethereum.request({method:"wallet_addEthereumChain",params:[TD]})}const G=new fC(window.ethereum),de=await G.getSigner(),le=await de.getAddress();A.current=G,w.current=de,y(le);try{localStorage.setItem("clawio_wallet_address",le)}catch{}return await q(de),fe(G,le),!0}catch(G){return console.warn("[ShooterBetting] ensureSignerReady failed:",G),!1}}te.useEffect(()=>{if(!g)try{const G=localStorage.getItem("clawio_wallet_address");G&&typeof G=="string"&&G.startsWith("0x")&&(y(G),t&&W(t))}catch{}},[]);async function Q(){if(!window.ethereum){X("No wallet detected. Install MetaMask.","error");return}try{const G=await window.ethereum.request({method:"eth_requestAccounts"});if(G&&G.length>0){const de=G[0];y(de);try{localStorage.setItem("clawio_wallet_address",de)}catch{}await V(),X(`Wallet connected: ${cf(de)}`,"success")}}catch(G){console.error("Wallet connection failed:",G),X("Wallet connection failed: "+(G.message||G),"error")}}async function q(G){try{const le=await(await fetch("/api/betting/contract-info")).json();b(le.contractAddress||""),le.contractAddress&&le.abi&&G&&(S.current=new fu(le.contractAddress,le.abi,G))}catch(de){console.error("Failed to load contract info:",de)}}function ne(){A.current&&g&&fe(A.current,g)}async function fe(G,de){try{if(d==="MON"){const le=await G.getBalance(de);v(parseFloat(Dee(le)).toFixed(3))}else{const le=["function balanceOf(address owner) view returns (uint256)"],Le=await new fu(wb,le,G).balanceOf(de);v(parseFloat(BG(Le,18)).toFixed(3))}}catch{v(null)}}te.useEffect(()=>{ne()},[d,g]);async function pe(G){if(!g){X("Connect your wallet first","error");return}if(!S.current&&(!await V()||!S.current)){X("Wallet setup failed. Try connecting manually.","error");return}const de=R[G];if(!de||parseFloat(de)<=0){X("Enter a valid bet amount","error");return}if(!t){X("No active match to bet on","error");return}if(n&&n.status!=="open"){X("Betting is not open yet. Wait for OPEN status.","error");return}const le=d,ye=b3(de),Le=_c[le]||_c.MON;try{X(`Placing bet of ${de} ${Le.symbol} on ${G}...`,"info");const Ve=fD(t.length>31?t.slice(0,31):t),Oe=fD(G.length>31?G.slice(0,31):G);let ze;if(le==="MON")ze=await S.current.placeBet(Ve,Oe,{value:ye});else{const Ie=["function allowance(address owner, address spender) view returns (uint256)","function approve(address spender, uint256 amount) returns (bool)"],gt=new fu(wb,Ie,w.current);await gt.allowance(g,M)<ye&&(X(`Approving ${Le.symbol}...`,"info"),await(await gt.approve(M,ye)).wait()),ze=await S.current.placeMclawBet(Ve,Oe,ye)}X("Transaction submitted. Waiting for confirmation...","info");const Ye=await ze.wait();X(`You bet ${de} ${Le.symbol} on ${G}`,"success"),o.current&&o.current.emit("humanBetPlaced",{matchId:t,bettorAddress:g,agentName:G,amountWei:ye.toString(),token:le,txHash:Ye.hash}),P(Ie=>({...Ie,[G]:""})),ne(),t&&W(t),u==="mybets"&&ge()}catch(Ve){console.error("Bet failed:",Ve),X("Bet failed: "+(Ve.reason||Ve.message||"Transaction failed"),"error")}}async function ge(){if(g)try{const de=await(await fetch(`/api/betting/bets-by-wallet/${g}`)).json();B(de)}catch(G){console.error("Failed to fetch my bets:",G)}}te.useEffect(()=>{u==="mybets"&&g&&ge(),u==="leaders"&&Ce(),u==="results"&&t&&Je(t)},[u,g,t]);async function Ce(){try{const de=await(await fetch(`/api/betting/leaderboard?token=${encodeURIComponent(d)}`)).json();k(de.leaderboard||[])}catch(G){console.error("Failed to fetch leaderboard:",G)}}async function Je(G,de=0){var le;try{const ye=await fetch(`/api/betting/history/${encodeURIComponent(G)}`);if(!ye.ok){if(de<5){const Ve=Xe(G);if(Ve)return Je(Ve,de+1)}U(null);return}const Le=await ye.json();if(!((le=Le.bets)!=null&&le.length)&&de<5){const Ve=Xe(G);if(Ve)return Je(Ve,de+1)}U(Le)}catch{U(null)}}function Xe(G){const de=/^shooter_(\d+)$/.exec(G);if(!de)return null;const le=parseInt(de[1],10);return!Number.isFinite(le)||le<=1?null:`shooter_${le-1}`}function Fe(G,de){if(!de||!n)return null;const le=parseFloat(de);if(isNaN(le)||le<=0)return null;try{const ye=BigInt(n.totalPool||"0"),Le=BigInt(G.pool||"0"),Ve=b3(de),Oe=ye+Ve,ze=Le+Ve;if(Oe>0n&&ze>0n){const Ye=Oe*9000n/10000n,Ie=Number(Ye*1000n/ze)/1e3;return(le*Ie).toFixed(3)}}catch{}return G.multiplier>0?(le*G.multiplier).toFixed(3):null}const j=()=>navigator.clipboard.writeText(wb),Te=n,Ue={pending:"OPENING",open:"OPEN",closed:"LOCKED",resolved:"SETTLED",cancelled:"CANCELLED",none:"--"}[Te==null?void 0:Te.status]||"--",we=_c[d]||_c.MON;return je(sh,{children:[Me(tse,{toasts:z,onDismiss:K}),je("aside",{className:"w-full md:w-80 lg:w-96 flex flex-col z-20 gap-4 flex-shrink-0 order-1",children:[Me("div",{className:"neo-card p-4 shrink-0 bg-slate-800 flex flex-col gap-3",children:je("div",{className:"flex items-center justify-between gap-2",children:[je("a",{href:"/",className:"cursor-pointer flex items-center gap-2 group shrink-0",title:"Back to home",children:[Me("div",{className:"bg-[#d946ef] p-1.5 border-2 border-white group-hover:bg-white group-hover:text-black transition-colors shadow-[2px_2px_0_black] rounded",children:Me("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:Me("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),Me("span",{className:"text-sm font-bold text-white group-hover:text-[#d946ef] transition-colors hidden sm:inline",children:"Back"})]}),je("h1",{className:"text-2xl md:text-3xl neo-font leading-none italic flex-1 text-right",style:{WebkitTextStroke:"1px white"},children:["CLAW ",Me("span",{className:"text-[#d946ef]",children:"SHOOTER"})]})]})}),je("div",{className:"neo-card flex-1 flex flex-col overflow-hidden min-h-[300px] md:min-h-0",children:[Me("div",{className:"flex p-3 gap-2 border-b-2 border-white bg-slate-900/50",children:qie.map(G=>Me("button",{type:"button",className:`flex-1 py-2 text-xs md:text-sm nav-neo ${l===G.id?"active":""}`,onClick:()=>c(G.id),children:G.label},G.id))}),je("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:[l==="market"&&je("div",{className:"space-y-3",children:[g?je("div",{className:"bg-slate-900 p-2 border-2 border-white shadow-[3px_3px_0_black] flex items-center justify-between text-xs",children:[je("div",{children:[Me("span",{className:"font-bold text-[#22d3ee]",children:cf(g)}),x!=null&&je("span",{className:"ml-2 text-slate-400",children:[x," ",we.symbol]})]}),Me("button",{onClick:()=>{y(null),v(null),A.current=null,w.current=null,S.current=null;try{localStorage.removeItem("clawio_wallet_address")}catch{}},className:"text-[10px] text-slate-500 hover:text-white",children:"Disconnect"})]}):Me("button",{onClick:Q,className:"w-full btn-neo btn-cyan text-sm py-2",children:"Connect Wallet"}),je("div",{className:"flex gap-1 bg-[#facc15] border-2 border-white shadow-[2px_2px_0_black] text-[11px] font-black uppercase overflow-hidden",children:[Me("button",{onClick:()=>m("MON"),className:`flex-1 py-1.5 transition-colors ${d==="MON"?"bg-black text-[#facc15]":"bg-transparent text-black/60"}`,children:"MON"}),Me("button",{onClick:()=>m("MCLAW"),className:`flex-1 py-1.5 transition-colors ${d==="MCLAW"?"bg-black text-[#facc15]":"bg-transparent text-black/60"}`,children:"$MClawIO"})]}),je("div",{className:"bg-[#facc15] p-3 border-2 border-white shadow-[4px_4px_0_black] text-black",children:[je("div",{className:"flex items-center justify-between mb-2",children:[je("div",{children:[Me("div",{className:"text-[10px] font-black uppercase opacity-60",children:"Total Pool"}),je("div",{className:"text-xl font-black",children:[(Te==null?void 0:Te.totalPoolMON)||"0"," ",Me("span",{className:"text-sm",children:we.symbol})]})]}),je("div",{className:"text-right",children:[Me("span",{className:"inline-block px-2 py-0.5 bg-black text-[#facc15] text-[10px] font-black uppercase",children:Ue}),je("div",{className:"text-[10px] font-bold mt-0.5 opacity-60",children:[(Te==null?void 0:Te.bettorCount)||0," bettors"]})]})]}),((et=Te==null?void 0:Te.agents)==null?void 0:et.length)>0&&Me("div",{className:"h-2 bg-black/20 flex overflow-hidden border border-black/30",children:Te.agents.map((G,de)=>Me("div",{className:"h-full",style:{width:`${Math.max(G.percentage,2)}%`,background:B1[de%B1.length]},title:`${G.agentName}: ${G.percentage.toFixed(1)}%`},G.agentName))})]}),Me("div",{className:"flex gap-1",children:$ie.map(G=>Me("button",{onClick:()=>f(G.id),className:`flex-1 py-1.5 text-[10px] font-black uppercase border-2 transition-colors ${u===G.id?"bg-[#d946ef] text-white border-white":"bg-slate-700 text-slate-300 border-slate-600 hover:border-white"}`,children:G.label},G.id))}),u==="agents"&&Me("div",{className:"space-y-2",children:(Re=Te==null?void 0:Te.agents)!=null&&Re.length?Te.agents.map((G,de)=>{const le=B1[de%B1.length],ye=Te.status==="open",Le=G.multiplier>0?G.multiplier.toFixed(2)+"x":"--",Ve=typeof G.winRate=="number"?`${(G.winRate*100).toFixed(1)}% win`:"win% --",Oe=R[G.agentName]||"",ze=Fe(G,Oe);return je("div",{className:"bg-slate-800 border-2 border-white p-3 shadow-[3px_3px_0_black]",children:[je("div",{className:"flex items-center justify-between mb-2",children:[je("div",{className:"flex items-center gap-2",children:[Me("div",{className:"w-4 h-4 border-2 border-white",style:{background:le}}),je("div",{className:"flex flex-col",children:[Me("span",{className:"text-sm font-black text-white uppercase",children:G.agentName}),Me("span",{className:"text-[10px] font-bold text-slate-400 leading-tight",children:Ve})]})]}),je("div",{className:"text-right",title:"Payout multiplier",children:[Me("div",{className:"text-[9px] font-bold text-slate-400 uppercase",children:"Payout"}),Me("span",{className:"text-lg neo-font",style:{color:le},children:Le})]})]}),je("div",{className:"flex items-center gap-2 mb-2",children:[Me("div",{className:"flex-1 h-2 bg-slate-900 border border-white/20 overflow-hidden",children:Me("div",{className:"h-full",style:{width:`${Math.max(G.percentage,1)}%`,background:le}})}),je("span",{className:"text-[10px] font-bold text-slate-400 w-12 text-right",children:[G.percentage.toFixed(1),"%"]})]}),je("div",{className:"flex items-center justify-between text-[10px] text-slate-400 font-bold mb-2",children:[je("span",{children:[G.poolMON," ",we.symbol," pooled"]}),je("span",{children:[G.bettorCount," bettor",G.bettorCount!==1?"s":""]})]}),ye&&je("div",{className:"flex flex-col gap-1",children:[je("div",{className:"flex gap-2",children:[Me("input",{type:"number",min:"0.01",step:"0.01",placeholder:we.symbol,value:Oe,onChange:Ye=>P(Ie=>({...Ie,[G.agentName]:Ye.target.value})),className:"flex-1 bg-slate-900 border-2 border-white text-white text-sm px-2 py-1.5 font-mono focus:border-[#facc15] outline-none",style:{maxWidth:100}}),Me("button",{onClick:()=>pe(G.agentName),className:"flex-1 py-1.5 text-xs font-black uppercase border-2 border-white text-black shadow-[2px_2px_0_black] hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-[1px_1px_0_black] transition-all",style:{background:le},children:"Bet"})]}),ze&&je("div",{className:"text-[10px] font-bold text-slate-300",children:["If this bot wins: ~",ze," ",we.symbol," back (after fees)"]})]})]},G.agentName)}):Me("div",{className:"text-center text-sm font-bold text-slate-400 py-10 bg-slate-800 border-2 border-dashed border-slate-600",children:"Waiting for players..."})}),u==="mybets"&&Me("div",{className:"space-y-2",children:g?C?je(sh,{children:[((J=C.statsByToken)==null?void 0:J[d])&&(()=>{const G=C.statsByToken[d],de=BigInt(G.totalBet||"0"),le=BigInt(G.totalPayout||"0"),ye=le-de,Le=ye>=0n?ye===0n?"#94a3b8":"#22c55e":"#ef4444",Ve=ye>0n?"+":ye<0n?"-":"",Oe=ye>=0n?ye:-ye;return je(sh,{children:[je("div",{className:"grid grid-cols-3 gap-2",children:[je("div",{className:"bg-slate-800 border-2 border-white p-2 text-center",children:[Me("div",{className:"text-[9px] font-bold text-slate-400 uppercase",children:"Total Bet"}),je("div",{className:"text-sm font-black text-[#facc15]",children:[bd(de.toString())," ",we.symbol]})]}),je("div",{className:"bg-slate-800 border-2 border-white p-2 text-center",children:[Me("div",{className:"text-[9px] font-bold text-slate-400 uppercase",children:"Total Won"}),je("div",{className:"text-sm font-black text-[#22d3ee]",children:[bd(le.toString())," ",we.symbol]})]}),je("div",{className:"bg-slate-800 border-2 border-white p-2 text-center",children:[Me("div",{className:"text-[9px] font-bold text-slate-400 uppercase",children:"P&L"}),je("div",{className:"text-sm font-black",style:{color:Le},children:[Ve,bd(Oe.toString())," ",we.symbol]})]})]}),je("div",{className:"flex gap-3 text-[10px] font-bold text-slate-400",children:[je("span",{children:[G.totalBets," bets"]}),je("span",{children:[G.totalWins," wins"]}),je("span",{children:[G.matchesPlayed," matches"]})]})]})})(),(()=>{var de;const G=((de=C.betsByToken)==null?void 0:de[d])||[];return G.length?G.map((le,ye)=>je("div",{className:"bg-slate-800 border-2 border-white p-2 flex items-center justify-between",children:[je("div",{children:[Me("span",{className:"text-xs font-black text-[#facc15] uppercase",children:le.agentName}),je("span",{className:"text-xs text-slate-400 ml-2",children:[bd(le.amount)," ",we.symbol]})]}),le.txHash&&je("a",{href:`https://monadvision.com/tx/${le.txHash}`,target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-[#22d3ee] font-mono hover:underline",children:[le.txHash.slice(0,8),"..."]})]},ye)):Me("div",{className:"text-center text-sm font-bold text-slate-400 py-8 bg-slate-800 border-2 border-dashed border-slate-600",children:"No bets placed yet"})})()]}):Me("div",{className:"text-center text-sm text-slate-400 py-4",children:"Loading..."}):Me("div",{className:"text-center text-sm font-bold text-slate-400 py-8 bg-slate-800 border-2 border-dashed border-slate-600",children:"Connect wallet to see your bets"})}),u==="leaders"&&Me("div",{className:"space-y-2",children:!H||H.length===0?Me("div",{className:"text-center text-sm font-bold text-slate-400 py-8 bg-slate-800 border-2 border-dashed border-slate-600",children:"No bets placed yet"}):H.slice(0,20).map((G,de)=>{const le=de+1,Le={1:"#facc15",2:"#94a3b8",3:"#f97316"}[le]||"#64748b";return je("div",{className:"bg-slate-800 border-2 border-white p-2 flex items-center gap-3",children:[Me("div",{className:"w-6 h-6 flex items-center justify-center font-black text-xs border-2 border-white",style:{background:Le,color:"black"},children:le}),je("div",{className:"flex-1 min-w-0",children:[Me("div",{className:"text-xs font-black text-white truncate",children:G.bettorName||cf(G.bettorAddress)}),Me("div",{className:"text-[10px] text-slate-400 font-mono",children:cf(G.bettorAddress)})]}),je("div",{className:"text-right",children:[je("div",{className:"text-xs font-black text-[#facc15]",children:[G.totalVolumeMON," ",we.symbol]}),je("div",{className:"text-[10px] text-slate-400",children:[G.totalBets," bets / ",G.totalWins," wins"]})]})]},de)})}),u==="results"&&Me("div",{className:"space-y-2",children:!$||!((F=$.bets)!=null&&F.length)?Me("div",{className:"text-center text-sm font-bold text-slate-400 py-8 bg-slate-800 border-2 border-dashed border-slate-600",children:"No betting results yet"}):(()=>{const G=$.bets||[],de=$.settlements||[],le=$.pool,ye=(le==null?void 0:le.winner_agent_names)||[],Le=new Set(ye),Ve=new Map;for(const ze of G){const Ye=(ze.bettor_address||"").toLowerCase(),Ie=Ve.get(Ye)||{addr:Ye,name:ze.bettor_name,totalBet:0n,totalPayout:0n,betOnWinner:0n},gt=BigInt(ze.amount||"0");Ie.totalBet+=gt,Le.has(ze.agent_name)&&(Ie.betOnWinner+=gt),Ve.set(Ye,Ie)}for(const ze of de){const Ye=(ze.bettor_address||"").toLowerCase(),Ie=Ve.get(Ye)||{addr:Ye,name:null,totalBet:0n,totalPayout:0n,betOnWinner:0n};Ie.totalPayout+=BigInt(ze.payout_amount||"0"),Ve.set(Ye,Ie)}return Array.from(Ve.values()).sort((ze,Ye)=>Ye.totalPayout>ze.totalPayout?1:Ye.totalPayout<ze.totalPayout?-1:0).map((ze,Ye)=>{const Ie=ze.totalPayout>0n;return je("div",{className:`bg-slate-800 border-2 border-white p-2 flex items-center justify-between text-[10px] ${Ie?"shadow-[3px_3px_0_#facc15]":"shadow-[2px_2px_0_black]"}`,children:[je("div",{className:"flex flex-col min-w-0",children:[Me("span",{className:"font-black text-white truncate",children:ze.name||cf(ze.addr)}),Me("span",{className:"font-mono text-slate-400 truncate",children:cf(ze.addr)})]}),je("div",{className:"text-right ml-2",children:[je("div",{className:"text-slate-300",children:[bd(ze.totalBet.toString())," ",we.symbol," bet"]}),je("div",{className:"text-slate-300",children:[bd(ze.totalPayout.toString())," ",we.symbol," won"]}),Me("div",{className:"font-black text-[#facc15]",children:ze.totalBet>0n?(Number(ze.totalPayout*1000n/ze.totalBet)/1e3).toFixed(2)+"x":"--"})]})]},Ye)})})()})]}),l==="token"&&je("div",{className:"space-y-5",children:[je("div",{className:"bg-slate-800 p-4 border-2 border-white shadow-[4px_4px_0_black]",children:[je("div",{className:"flex items-center gap-3 mb-4",children:[Me("div",{className:"w-12 h-12 rounded-full bg-[#facc15] border-2 border-white flex items-center justify-center",children:Me("span",{className:"text-black font-black text-2xl",children:"$"})}),je("div",{children:[Me("h2",{className:"text-2xl neo-font text-white leading-none tracking-wide",children:"$MClawIO (Monad)"}),Me("span",{className:"text-xs font-bold text-lime-400 bg-lime-400/10 px-2 py-0.5 rounded border border-lime-400/30",children:"-- (24h)"})]})]}),je("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[je("div",{className:"bg-slate-900 p-2 border border-white/20 rounded",children:[Me("div",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-wider",children:"Market Cap"}),Me("div",{className:"text-sm font-mono font-bold text-white",children:"--"})]}),je("div",{className:"bg-slate-900 p-2 border border-white/20 rounded",children:[Me("div",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-wider",children:"Price"}),Me("div",{className:"text-sm font-mono font-bold text-white",children:"--"})]})]}),je("div",{className:"mb-4",children:[Me("div",{className:"text-[10px] text-slate-400 uppercase font-bold mb-1 tracking-wider",children:"Contract Address (Monad CA)"}),je("div",{className:"flex gap-2",children:[Me("button",{type:"button",onClick:j,className:"flex-1 bg-slate-900 border border-white/20 text-[10px] p-2 font-mono text-slate-300 truncate rounded cursor-pointer hover:bg-slate-800 transition-colors text-left",title:"Click to copy",children:ese}),Me("button",{type:"button",onClick:j,className:"px-3 bg-slate-700 border border-white/20 hover:bg-white hover:text-black hover:border-white transition-colors rounded",title:"Copy full address",children:je("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[Me("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),Me("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})})]})]}),Me("a",{href:"https://nad.fun/tokens/0x26813a9B80f43f98cee9045B9f7CdcA816C57777",target:"_blank",rel:"noopener noreferrer",className:"btn-neo btn-yellow w-full text-center block hover:brightness-110",children:"Buy $MClawIO"})]}),je("div",{className:"p-4 border-2 border-dashed border-white/30 rounded-xl bg-slate-900/50",children:[je("h3",{className:"text-sm font-black text-[#d946ef] uppercase mb-2 tracking-wide flex items-center gap-2",children:[Me("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:Me("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z"})}),"Utility"]}),je("p",{className:"text-xs text-slate-300 leading-relaxed font-medium",children:["Claw IO is powered by ",Me("span",{className:"text-[#facc15] font-bold",children:"$MClawIO"})," on Monad. Use tokens for agent skins and betting on live matches."]})]})]})]})]})]})]})}const rse={knife:"Knife",pistol:"Pistol",smg:"SMG",shotgun:"Shotgun",assault_rifle:"Assault Rifle"};function CD(n){const e=Math.floor(n/60),t=Math.floor(n%60);return`${e}:${t.toString().padStart(2,"0")}`}function ise(){const{gameState:n,gamePhase:e,selectedBotId:t,setSelectedBotId:r}=Uh(),[i,s]=te.useState(0),o=(n==null?void 0:n.players)??[],a=(n==null?void 0:n.timeRemaining)??0,l=o.filter(d=>d.alive&&!d.eliminated).length,c=[...o].sort((d,m)=>(m.survivalTime??0)-(d.survivalTime??0)).map(d=>({id:d.id,name:d.name,survivalSeconds:d.survivalTime??0,kills:d.kills??0,deaths:d.deaths??0,lives:d.lives??3,weapon:d.weapon??"knife",ammo:d.ammo??null,eliminated:d.eliminated,alive:d.alive}));return te.useEffect(()=>{if(e!=="playing")return;const d=setInterval(()=>s(m=>m+1),1e3);return()=>clearInterval(d)},[e]),je("aside",{className:"w-full md:w-80 lg:w-96 flex flex-col z-20 gap-4 flex-shrink-0 order-3",children:[je("div",{className:"neo-card p-4 md:p-5",children:[je("div",{className:"flex items-center justify-between mb-2",children:[Me("h3",{className:"text-xs font-black uppercase text-slate-400 tracking-wider",children:"Status"}),Me("span",{className:e==="playing"?"match-phase phase-active":e==="lobby"?"match-phase phase-lobby":"match-phase phase-finished",children:e==="lobby"?"Waiting":e==="countdown"?"Starting...":e==="playing"?"In Progress":"Finished"})]}),je("div",{className:"flex items-center justify-between bg-slate-900 p-3 border-2 border-white",children:[Me("div",{className:"text-2xl md:text-3xl neo-font text-white tabular-nums",children:e==="playing"?CD(a):"--:--"}),je("div",{className:"text-right",children:[Me("div",{className:"text-xs font-bold text-slate-400 uppercase",children:"Time left"}),je("div",{className:"text-2xl font-black text-[#d946ef]",children:[l," / ",o.length]})]})]})]}),je("div",{className:"neo-card flex-1 flex flex-col overflow-hidden min-h-[250px] md:min-h-0",children:[Me("div",{className:"p-4 border-b-2 border-white bg-[#a3e635]",children:je("h3",{className:"text-sm font-black uppercase text-black flex items-center gap-2",children:[Me("svg",{className:"w-4 h-4 text-black",fill:"currentColor",viewBox:"0 0 24 24",children:Me("path",{d:"M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2zM5 8V7h2v3.82C5.84 10.4 5 9.3 5 8zm14 0c0 1.3-.84 2.4-2 2.82V7h2v1z"})}),"Leaderboard"]})}),je("div",{className:"flex-1 overflow-y-auto p-3 custom-scrollbar",children:[Me("div",{className:"text-[10px] font-bold text-slate-500 mb-2 px-0.5",children:"Click a row to follow that agent"}),c.length===0?Me("p",{className:"text-xs text-slate-500 text-center py-4",children:"No agents yet"}):Me("div",{className:"space-y-2",children:c.map((d,m)=>{const g=rse[d.weapon]||d.weapon,y=d.weapon!=="knife"&&d.ammo!=null?` (${d.ammo})`:"",x=t===d.id;return je("button",{type:"button",onClick:()=>r(x?null:d.id),className:`w-full text-left rounded-lg px-2 py-2 border-2 transition cursor-pointer select-none ${d.eliminated?"opacity-50 bg-slate-800/60 border-slate-600":"bg-slate-800/80 border-white/20 hover:border-white/40"} ${x?"ring-2 ring-[#22d3ee] ring-offset-1 border-[#22d3ee]":""}`,children:[je("div",{className:"flex justify-between items-center gap-2",children:[je("span",{className:"font-bold text-white truncate flex items-center gap-1.5",children:[je("span",{className:"text-slate-500 w-5 flex-shrink-0",children:["#",m+1]}),d.name]}),Me("span",{className:"text-[#a3e635] font-mono tabular-nums text-xs whitespace-nowrap flex-shrink-0",children:CD(d.survivalSeconds)})]}),je("div",{className:"flex flex-wrap gap-x-3 gap-y-0.5 mt-1 text-[10px] text-slate-400",children:[je("span",{children:["K: ",d.kills]}),je("span",{children:["D: ",d.deaths]}),je("span",{children:["Lives: ",d.lives]}),je("span",{className:"truncate",children:[g,y]})]})]},d.id)})})]}),Me("div",{className:"p-3 bg-slate-900 text-white border-t-2 border-white flex flex-col gap-1 text-xs font-bold uppercase font-mono",children:Me("div",{className:"text-slate-400",children:"Ranked by survival time"})})]})]})}const sse=15,oo={forward:!1,back:!1,left:!1,right:!1},RD=new Y(0,0,0),Md=new Y(0,6,10),BD=1.5,Eb=12,ose=10;function ase(){const n=te.useRef(),{camera:e}=$n(),{selectedBotId:t,setSelectedBotId:r,gameState:i}=Uh(),s=te.useRef(new Y),o=te.useRef(new Y),a=te.useRef(new Y),l=te.useRef(!1),c=te.useRef(!1),u=te.useRef(!1),f=te.useRef(null),d=()=>{n.current&&(n.current.target.copy(RD),e.position.set(0,40,25),e.lookAt(RD),n.current.update())};return te.useEffect(()=>{d();const m=setTimeout(d,800);return()=>clearTimeout(m)},[e]),te.useEffect(()=>{t===null&&d()},[t]),te.useEffect(()=>{const m=y=>{y.button===0&&(c.current=!0,t&&(u.current=!0))},g=y=>{y.button===0&&(c.current=!1)};return window.addEventListener("pointerdown",m),window.addEventListener("pointerup",g),()=>{window.removeEventListener("pointerdown",m),window.removeEventListener("pointerup",g)}},[t]),te.useEffect(()=>{const m=y=>{const x=y.key.toLowerCase();if(x==="escape"){r(null);return}(x==="w"||y.key==="ArrowUp")&&(oo.forward=!0),(x==="s"||y.key==="ArrowDown")&&(oo.back=!0),(x==="a"||y.key==="ArrowLeft")&&(oo.left=!0),(x==="d"||y.key==="ArrowRight")&&(oo.right=!0)},g=y=>{const x=y.key.toLowerCase();(x==="w"||y.key==="ArrowUp")&&(oo.forward=!1),(x==="s"||y.key==="ArrowDown")&&(oo.back=!1),(x==="a"||y.key==="ArrowLeft")&&(oo.left=!1),(x==="d"||y.key==="ArrowRight")&&(oo.right=!1)};return window.addEventListener("keydown",m),window.addEventListener("keyup",g),()=>{window.removeEventListener("keydown",m),window.removeEventListener("keyup",g)}},[r]),fa((m,g)=>{const y=n.current;if(!y)return;if(t&&(i!=null&&i.players)){f.current!==t&&(l.current=!1,u.current=!1,f.current=t);const M=i.players.find(b=>b.id===t);if(M){const b=M.x??0,R=M.y??0,P=M.z??0,C=new Y(b,R,P);l.current||(a.current.copy(C),s.current.set(b+Md.x,R+Md.y,P+Md.z),o.current.set(b,R+BD,P),l.current=!0),a.current.lerp(C,Math.min(1,ose*g));const B=a.current.x,H=a.current.y,k=a.current.z,$=new Y(B+Md.x,H+Md.y,k+Md.z),U=new Y(B,H+BD,k),z=c.current,O=u.current;z||O?(o.current.lerp(U,Math.min(1,Eb*g)),y.target.copy(o.current),s.current.copy(e.position)):(s.current.lerp($,Math.min(1,Eb*g)),o.current.lerp(U,Math.min(1,Eb*g)),e.position.copy(s.current),y.target.copy(o.current)),y.update()}return}l.current=!1,u.current=!1,f.current=null;const x=y.target,v=e,A=new Y(0,0,-1).applyQuaternion(v.quaternion);A.y=0,A.normalize();const w=new Y(1,0,0).applyQuaternion(v.quaternion);w.y=0,w.normalize();const S=sse*g;oo.forward&&x.addScaledVector(A,-S),oo.back&&x.addScaledVector(A,S),oo.left&&x.addScaledVector(w,-S),oo.right&&x.addScaledVector(w,S)}),Me(Rq,{ref:n,makeDefault:!0,target:[0,0,0],enablePan:!t,enableZoom:!t,enableRotate:!0,minDistance:8,maxDistance:120,maxPolarAngle:Math.PI/2-.1})}const lse="/claw-shooter/sounds",Rw=n=>`${lse}/${encodeURIComponent(n)}`,cse=Rw("bg music.mp3"),use=Rw("death.mp3"),fse=Rw("knife stab.mp3"),PD=Rw("pistol.mp3"),JR=2,hH=Math.min(1,.5*JR*.4),hse=Math.min(1,.7*JR),dH=Math.min(1,.6*JR);function dse(n,e=hH){if(PD)try{const t=()=>{const r=new Audio(PD);r.volume=e,r.play().catch(()=>{})};t(),n==="shotgun"&&setTimeout(t,80)}catch{}}function ID(n,e=dH){if(n)try{const t=new Audio(n);t.volume=e,t.play().catch(()=>{})}catch{}}function pse(){const{shots:n,hits:e}=Uh(),t=te.useRef(null),r=te.useRef(0),i=te.useRef(0);return te.useEffect(()=>{const s=new Audio(cse);s.loop=!0,s.volume=.4,t.current=s;let o=!1;const a=()=>{o||!t.current||t.current.play().then(()=>{o=!0,window.removeEventListener("click",a),window.removeEventListener("keydown",a),window.removeEventListener("pointerdown",a)}).catch(()=>{})};return a(),window.addEventListener("click",a),window.addEventListener("keydown",a),window.addEventListener("pointerdown",a),()=>{s.pause(),t.current=null,window.removeEventListener("click",a),window.removeEventListener("keydown",a),window.removeEventListener("pointerdown",a)}},[]),te.useEffect(()=>{var o;if(!Array.isArray(n))return;if(n.length===0){r.current=0;return}if(n.length<=r.current){r.current=n.length;return}const s=r.current;r.current=n.length;for(let a=s;a<n.length;a++){const l=(o=n[a])==null?void 0:o.weapon;l!=="knife"&&dse(l||"pistol",hH)}},[n==null?void 0:n.length,n]),te.useEffect(()=>{if(!Array.isArray(e))return;if(e.length===0){i.current=0;return}if(e.length<=i.current){i.current=e.length;return}const s=i.current;i.current=e.length;for(let o=s;o<e.length;o++){const a=e[o];a.killed&&ID(use,hse),a.weapon==="knife"&&ID(fse,dH)}},[e==null?void 0:e.length,e]),null}function mse(n){const e=n??Bw,t=To(e);return te.useMemo(()=>{const r=t.scene;r.updateMatrixWorld(!0);const i=new Br().setFromObject(r);i.getCenter(new Y);const s=i.getSize(new Y),o=Math.max(s.x,s.z,.001),a=KR/o,l=a*s.x,c=a*s.z;return{worldSizeX:l,worldSizeZ:c}},[t.scene,e])}class gse extends te.Component{constructor(){super(...arguments);Ee(this,"state",{failed:!1})}static getDerivedStateFromError(){return{failed:!0}}render(){return this.state.failed?Me(gH,{path:mH}):this.props.children}}const pH="/claw-shooter/",Bw=`${pH}map4.glb`,mH=`${pH}map.glb`,KR=90,gH=({path:n,onReady:e})=>{const t=n??Bw,r=To(t);te.useEffect(()=>{r.scene.traverse(a=>{a.isMesh&&(a.visible=!0,a.castShadow=!0,a.receiveShadow=!0)})});const{scale:i,position:s,floorY:o}=te.useMemo(()=>{r.scene.updateMatrixWorld(!0);const a=new Br().setFromObject(r.scene),l=a.getCenter(new Y),c=a.getSize(new Y),u=Math.max(c.x,c.z,.001),f=KR/u,d=new Y(-l.x*f,-l.y*f,-l.z*f),m=d.y-c.y*.5*f;return{scale:f,position:[d.x,d.y,d.z],floorY:m}},[r.scene,t]);return te.useEffect(()=>{e==null||e({floorY:o})},[o,e]),Me("group",{position:s,scale:i,children:Me("primitive",{object:r.scene})})};To.preload(Bw);To.preload(mH);const vse=()=>Me(gse,{children:Me(gH,{})});function yse(n){const e=n??Bw,t=To(e);return te.useMemo(()=>{const r=t.scene.clone();r.updateMatrixWorld(!0);const i=new Br;r.traverse(g=>{if(g.isMesh&&g.geometry){g.geometry.computeBoundingBox();const y=g.geometry.boundingBox.clone();y.applyMatrix4(g.matrixWorld),i.union(y)}});const s=i.getCenter(new Y),o=i.getSize(new Y),a=Math.max(o.x,o.z,.001),l=KR/a,c=-s.x*l,u=-s.y*l,f=-s.z*l,d=[],m=new Y;return r.traverse(g=>{const y=(g.name||"").toLowerCase();/^player_spawn_(1|2|3|4|5|6|7|8|9|10)$/.test(y)&&(g.getWorldPosition(m),d.push({x:m.x*l+c,y:m.y*l+u,z:m.z*l+f}))}),d},[t.scene,e])}const xse="/claw-shooter/";function vH(n){const e=n&&/^G_\d+$/.test(n)?n:"G_1";return`${xse}${e}.glb`}const Ase={Idle:["Idle","Jump_Idle"],Run:["Run"],Idle_Shoot:["Idle_Shoot","Idle_Shoot "],Run_Shoot:["Run_Shoot","Run_Gun"],Death:["Death","death","Death "]},_se={Knife:"knife",Pistol:"pistol",Smg:"smg",SMG_G:"smg",Shotgun:"shotgun",Rifle:"assault_rifle",Rifle_00:"assault_rifle"};function wse(n,e){!n||!e||n.traverse(t=>{const r=_se[t.name];r!==void 0&&(t.visible=r===e)})}function LD(n,e){if(n[e])return n[e];const t=Ase[e];if(t){for(const r of t)if(n[r])return n[r]}return null}function Ese({character:n,animation:e="Idle",weapon:t="knife",bloom:r=!0,...i}){const s=te.useRef(),o=vH(n),{scene:a,animations:l}=To(o),c=te.useMemo(()=>RY.clone(a),[a]),{actions:u}=Bq(l,s);te.useEffect(()=>{},[c]),te.useEffect(()=>{wse(c,t)},[c,t]),te.useEffect(()=>{const g=LD(u,e);if(g)return e==="Death"&&(g.setLoop(A2,1),g.clampWhenFinished=!0),g.reset().fadeIn(.2).play(),()=>g.fadeOut(.2)},[e,u]);const f=e==="Death",d=!!LD(u,"Death");return Me("group",{ref:s,...i,dispose:null,visible:!(f&&!d),children:Me("primitive",{object:c})})}[1,2,3,4,5,6,7,8,9,10].forEach(n=>To.preload(vH(`G_${n}`)));const P1="/claw-shooter/",hC={pistol:`${P1}Pistol.glb`,smg:`${P1}Smg.glb`,shotgun:`${P1}Shotgun.glb`,assault_rifle:`${P1}Rifle.glb`},Sse={pistol:"Pistol",smg:"SMG",shotgun:"Shotgun",assault_rifle:"Assault Rifle"},bse={pistol:16776960,smg:16746496,shotgun:16711680,assault_rifle:65535},Mse=3,Tse=Mse*1.5,Cse=.3;function Rse({id:n,weaponType:e,position:t,taken:r}){if(r)return null;const i=hC[e];if(!i)return null;const s=bse[e]??16776960,o=Sse[e]||e,a=To(i),l=te.useMemo(()=>a.scene.clone(!0),[a.scene]),c=te.useRef(null);fa(()=>{if(c.current){const m=Date.now()/1e3*Math.PI*.8,g=1+.25*Math.sin(m);c.current.scale.setScalar(g)}}),te.useEffect(()=>{l.traverse(m=>{m.isMesh&&(m.castShadow=!0,m.receiveShadow=!0)})},[l]);const u=(t==null?void 0:t.x)??0,f=(t==null?void 0:t.y)??0,d=(t==null?void 0:t.z)??0;return je("group",{position:[u,f,d],children:[Me("group",{position:[0,Cse,0],scale:Tse,children:Me("primitive",{object:l})}),Me("group",{ref:c,position:[0,3.2,0],children:je("mesh",{rotation:[Math.PI,0,0],children:[Me("coneGeometry",{args:[.6,1.2,16]}),Me("meshStandardMaterial",{color:s,emissive:s,emissiveIntensity:.9,transparent:!0,opacity:.85,toneMapped:!1})]})}),Me(Bd,{position:[0,4,0],fontSize:.35,anchorX:"center",anchorY:"middle",color:"white",children:o})]})}Object.keys(hC).forEach(n=>{To.preload(hC[n])});function Bse(){const n=$n(o=>o.gl.domElement),e=$n(o=>o.camera),t=$n(o=>o.raycaster),r=$n(o=>o.scene),{selectedBotId:i,setSelectedBotId:s}=Uh();return te.useEffect(()=>{const o=a=>{var m;const l=n.getBoundingClientRect(),c=(a.clientX-l.left)/l.width*2-1,u=-((a.clientY-l.top)/l.height)*2+1;t.setFromCamera({x:c,y:u},e);const d=t.intersectObjects(r.children,!0)[0];if(d!=null&&d.object){let g=d.object;for(;g;){if((m=g.userData)!=null&&m.botId){const y=g.userData.botId;s(i===y?null:y);return}g=g.parent}}};return n.addEventListener("pointerdown",o),()=>n.removeEventListener("pointerdown",o)},[n,e,t,r,i,s]),null}const yH=new ht("red");yH.multiplyScalar(12);const xH=new ht("yellow");xH.multiplyScalar(12);const Pse=({scale:n,target:e,speed:t})=>{const r=te.useRef();return fa((i,s)=>{r.current.scale.x>0&&(r.current.scale.x=r.current.scale.y=r.current.scale.z-=t*s),r.current.position.lerp(e,t)}),Me(Q4,{ref:r,scale:n,position:[0,0,0]})},Ise=({nb:n=100,position:e,type:t,onEnded:r})=>{const i=te.useMemo(()=>Array.from({length:n},()=>({target:new Y(Jd.randFloat(-.6,.6),Jd.randFloat(-.6,.6),Jd.randFloat(-.6,.6)),scale:.1,speed:Jd.randFloat(.1,.3)})),[n]);return te.useEffect(()=>{const s=setTimeout(()=>{r==null||r()},500);return()=>clearTimeout(s)},[r]),Me("group",{position:[e.x,e.y,e.z],children:je(Hq,{children:[Me("boxGeometry",{}),Me("meshStandardMaterial",{toneMapped:!1,color:t==="player"?yH:xH}),i.map((s,o)=>Me(Pse,{...s},o))]})})},ND={pistol:16776960,smg:16746496,shotgun:16711680,assault_rifle:65535,knife:9741240},Lse={pistol:"#ffff00",smg:"#ff8800",shotgun:"#ff0000",assault_rifle:"#00ffff",knife:"#94a3b8"},DD={smg:[.04,.04,.15],default:[.05,.05,.2]},Nse=1.5,Dse=.7,Use=.5,Qg=Dse+Use,Fse=!1,Ose=1;function kse(n,e,t){return n.alive===!1?"Death":t?e?"Run_Shoot":"Idle_Shoot":e?"Run":"Idle"}const Gse={Aggressive:"#ef4444",Cautious:"#3b82f6",Sniper:"#a855f7",Rusher:"#f97316",Tactician:"#22c55e"};function zse({player:n,prevPosRef:e,shots:t=[],hits:r=[]}){const i=te.useRef(),s=te.useRef(0),o=te.useRef(0),a=te.useRef(),l=te.useRef(),c=te.useRef(!1),u=te.useMemo(()=>{if(!e.current)return!1;const S=n.x-(e.current.x??n.x),M=n.z-(e.current.z??n.z);return Math.sqrt(S*S+M*M)>.01},[n.x,n.z,e]);te.useEffect(()=>{e.current={x:n.x,z:n.z}});const f=r.some(S=>S&&S.victimId===n.id);f&&!c.current&&(s.current=.3),c.current=!!f;const d=n.y??0,m=te.useRef(new Y(n.x,d,n.z));m.current.set(n.x,d,n.z),fa((S,M)=>{if(!i.current)return;i.current.position.lerp(m.current,Math.min(1,6*M));const P=-((n.angle??0)*Math.PI/180)+Math.PI/2;i.current.rotation.y+=(P-i.current.rotation.y)*Math.min(1,10*M),s.current>0&&(s.current=Math.max(0,s.current-M)),a.current&&(a.current.intensity=s.current*15),t.some(B=>B&&B.shooterId===n.id)&&(o.current=Math.max(o.current,.12)),o.current>0&&(o.current=Math.max(0,o.current-M)),l.current&&(l.current.intensity=o.current>0&&n.alive?8:0)});const g=t.some(S=>S&&S.shooterId===n.id),y=kse(n,u,g),x=n.character||"G_1",v=n.personality,A=Gse[v]||"#888",w=n.weapon!=="knife"?` [${(n.weapon||"").replace("_"," ").toUpperCase()}${n.ammo!=null?`: ${n.ammo}`:""}]`:"";return je("group",{ref:i,position:[n.x,d,n.z],userData:{botId:n.id},children:[Me("group",{position:[0,Qg,0],scale:2*Ose,children:Me(Ese,{character:x,animation:y,weapon:n.weapon||"knife"})}),Me("pointLight",{ref:a,position:[0,Qg+1,0],color:"#ff0000",intensity:0,distance:4}),Me("pointLight",{ref:l,position:[0,Qg+1.5,.5],color:Lse[n.weapon]||"#ffff00",intensity:0,distance:5}),n.alive&&je(ON,{position:[0,Qg+3.8,0],children:[Me(Bd,{fontSize:.45,color:"white",outlineWidth:.05,outlineColor:"black",anchorY:"bottom",children:n.name}),v&&je(Bd,{position:[0,.55,0],fontSize:.25,color:A,outlineWidth:.03,outlineColor:"black",anchorY:"bottom",children:[v,w]}),!v&&w&&Me(Bd,{position:[0,.55,0],fontSize:.25,color:"#94a3b8",outlineWidth:.03,outlineColor:"black",anchorY:"bottom",children:w}),Me(Bd,{position:[0,-.42,0],fontSize:.2,color:"#94a3b8",outlineWidth:.02,outlineColor:"black",children:"".repeat(Math.max(0,n.lives??0))}),je("mesh",{position:[0,-.2,0],children:[Me("planeGeometry",{args:[1.6,.16]}),Me("meshBasicMaterial",{color:"#333",transparent:!0,opacity:.7})]}),je("mesh",{position:[-(1.6-1.6*(n.health??100)/100)/2,-.2,.001],children:[Me("planeGeometry",{args:[1.6*(n.health??100)/100,.16]}),Me("meshBasicMaterial",{color:(n.health??100)>60?"#22c55e":(n.health??100)>30?"#eab308":"#ef4444"})]})]}),!n.alive&&n.eliminated&&Me(ON,{position:[0,Qg+2,0],children:je(Bd,{fontSize:.35,color:"#666",outlineWidth:.03,outlineColor:"black",children:[n.name," (eliminated)"]})})]})}const Sb={};function Hse(n){if(Sb[n])return Sb[n];const e=ND[n]??ND.pistol,t=new Ni({color:e,toneMapped:!0});return Sb[n]=t,t}function Vse({bullet:n}){const e=te.useRef(),t=te.useRef(new Y(n.x??0,n.y??0,n.z??0)),r=n.x??0,i=n.y??0,s=n.z??0;if(typeof r!="number"||typeof i!="number"||typeof s!="number")return null;const o=n.weapon||"pistol",a=Hse(o),l=DD[o]??DD.default;t.current.set(r,i,s);const c=r-(n.fromX??r),u=s-(n.fromZ??s),f=Math.sqrt(c*c+u*u)||1,d=Math.atan2(c/f,u/f);return fa((m,g)=>{e.current&&e.current.position.lerp(t.current,Math.min(1,25*g))}),Me("group",{ref:e,position:[r,i,s],"rotation-y":d,scale:Nse,children:Me("mesh",{"position-z":l[2]*.5,material:a,children:Me("boxGeometry",{args:l})})})}const Wse=12,Xse=50,Jse=({downgradedPerformance:n=!1})=>{const{gameState:e,shots:t,hits:r,gamePhase:i}=Uh(),s=te.useRef(new Map),[o,a]=te.useState([]),l=te.useRef(new Set),c=(e==null?void 0:e.players)??[],u=(e==null?void 0:e.pickups)??[],f=(e==null?void 0:e.bullets)??[];mse(),yse();const d=c.length>0?(c[0].y??0)+1.5:1.5;te.useEffect(()=>{const g=(t||[]).filter(v=>v&&v.hit===!0),y=l.current,x=[];for(const v of g)!v._id||y.has(v._id)||(y.add(v._id),x.push({id:v._id,x:v.toX,y:d,z:v.toZ,type:"player"}));for(;y.size>Xse;){const v=y.values().next().value;if(v!==void 0)y.delete(v);else break}x.length>0&&a(v=>[...v,...x].slice(-Wse))},[t,d]);const m=te.useCallback(g=>{a(y=>y.filter(x=>x.id!==g))},[]);for(const g of c)s.current.has(g.id)||s.current.set(g.id,{current:{x:g.x,z:g.z}});return(e==null?void 0:e.phase)==="active"&&Array.isArray(c),je(sh,{children:[Me(Bse,{}),Me(vse,{}),u.map(g=>Me(Rse,{id:g.id,weaponType:g.type,position:new Y(g.x,g.y??.5,g.z),taken:!1},g.id)),f.map(g=>Me(Vse,{bullet:g},g.id)),c.map(g=>Me(zse,{player:g,prevPosRef:s.current.get(g.id),shots:t,hits:r},g.id)),Fse,o.map(g=>Me(Ise,{nb:60,position:{x:g.x,y:g.y,z:g.z},type:g.type,onEnded:()=>m(g.id)},g.id)),Me(a$,{preset:"sunset"})]})};function Kse(){return je(sh,{children:[Me(NZ,{}),je(oee,{children:[Me(pse,{}),Me(cee,{}),je("div",{className:"game-view",children:[Me(nse,{}),Me("div",{id:"game-view-center",className:"canvas-container",children:je(KQ,{shadows:!0,camera:{position:[0,40,25],fov:30,near:2},children:[Me("color",{attach:"background",args:["#242424"]}),Me(Wq,{size:42}),je(te.Suspense,{children:[Me(ase,{}),Me(Jse,{})]}),Me(SZ,{disableNormalPass:!0,children:Me(TZ,{luminanceThreshold:.92,luminanceSmoothing:.4,intensity:1.5,mipmapBlur:!0})})]})}),Me(ise,{})]})]})]})}const Qse=bb.createRoot(document.getElementById("root"));Qse.render(Me(um.StrictMode,{children:Me(Kse,{})}));
